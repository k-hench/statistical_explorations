<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 Rethinking: Chapter 15 | Statistical Explorations</title>
  <meta name="description" content="statistical explorations by kh" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="16 Rethinking: Chapter 15 | Statistical Explorations" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="statistical explorations by kh" />
  <meta name="github-repo" content="k-hench/statistical_explorations" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 Rethinking: Chapter 15 | Statistical Explorations" />
  
  <meta name="twitter:description" content="statistical explorations by kh" />
  

<meta name="author" content="Kosmas Hench" />


<meta name="date" content="2022-03-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rethinking-chapter-14.html"/>
<link rel="next" href="rethinking-chapter-16.html"/>
<script src="libs/header-attrs-2.11.15/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });
  
  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    // var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeText = $('<img style="width:45px;" src="img/both.svg">');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    var buttonColK = $('<div class="check"><input type="checkbox" id="cc_' + id + '" class="btn btn-default btn-xs code-folding-btn pull-right ch1" /><label class="checktrue" for="cc_' + id + '" ></label></div>');

    buttonColK
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    //buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);
    buttonCol.append(buttonColK);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text();
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text();
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<script>
$(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>
<link rel="shortcut icon" href="img/favicon.ico" />
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>

<script>document.write('<div class="btn-group pull-right" style="position: absolute; top: 35px; right: 2%; z-index: 10"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"aria-expanded="true" data-_extension-text-contrast=""><span>global code</span><span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All</a></li><li><a id="rmd-hide-all-code" href="#">Hide All</a></li></ul></div>')</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/k-hench/statistical_explorations">github repository</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro<span></span></a></li>
<li class="chapter" data-level="2" data-path="rethinking-chapter-1.html"><a href="rethinking-chapter-1.html"><i class="fa fa-check"></i><b>2</b> Rethinking: Chapter 1<span></span></a></li>
<li class="chapter" data-level="3" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html"><i class="fa fa-check"></i><b>3</b> Rethinking: Chapter 2<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#counting-possibilities"><i class="fa fa-check"></i><b>3.1</b> Counting possibilities<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#building-a-model"><i class="fa fa-check"></i><b>3.2</b> Building a Model<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#making-the-model-go-bayes-theorem"><i class="fa fa-check"></i><b>3.3</b> Making the model go / Bayes’ Theorem<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#motors-grid-approximation"><i class="fa fa-check"></i><b>3.4</b> Motors: Grid Approximation<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#quadratic-approximation"><i class="fa fa-check"></i><b>3.5</b> Quadratic Approximation<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#marcov-chain-monte-carlo-mcmc"><i class="fa fa-check"></i><b>3.6</b> Marcov Chain Monte Carlo (MCMC)<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#homework"><i class="fa fa-check"></i><b>3.7</b> Homework<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#brms-section"><i class="fa fa-check"></i><b>3.8</b> {brms} section<span></span></a></li>
<li class="chapter" data-level="3.9" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#pymc3-section"><i class="fa fa-check"></i><b>3.9</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html"><i class="fa fa-check"></i><b>4</b> Rethinking: Chapter 3<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>4.1</b> Sampling from a grid approximate posterior<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#sampling-to-summarize"><i class="fa fa-check"></i><b>4.2</b> Sampling to Summarize<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#intervals-of-devined-boundaries"><i class="fa fa-check"></i><b>4.2.1</b> Intervals of devined boundaries<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#intervals-of-defined-mass"><i class="fa fa-check"></i><b>4.2.2</b> Intervals of defined mass<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#point-estimates"><i class="fa fa-check"></i><b>4.3</b> Point estimates<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#sample-to-simulate-prediction"><i class="fa fa-check"></i><b>4.4</b> sample to simulate prediction<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#homework-1"><i class="fa fa-check"></i><b>4.5</b> Homework<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#brms-section-1"><i class="fa fa-check"></i><b>4.6</b> {brms} section<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#pymc3-section-1"><i class="fa fa-check"></i><b>4.7</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html"><i class="fa fa-check"></i><b>5</b> Rethinking: Chapter 4<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>5.1</b> Why normal distributions are normal<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#normal-by-addition"><i class="fa fa-check"></i><b>5.1.1</b> Normal by addition<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#normal-by-multiplication-and-by-log-multiplication"><i class="fa fa-check"></i><b>5.2</b> Normal by multiplication and by log-multiplication<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#using-the-gaussian-distribution"><i class="fa fa-check"></i><b>5.2.1</b> using the Gaussian distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>5.3</b> A language for describing models<span></span></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>5.3.1</b> Gaussian model of height<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#linear-prediction"><i class="fa fa-check"></i><b>5.4</b> Linear Prediction<span></span></a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>5.4.1</b> Finding the posterior Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#curves-from-lines"><i class="fa fa-check"></i><b>5.5</b> Curves from lines<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#splines"><i class="fa fa-check"></i><b>5.6</b> Splines<span></span></a></li>
<li class="chapter" data-level="5.7" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#homework-2"><i class="fa fa-check"></i><b>5.7</b> Homework<span></span></a></li>
<li class="chapter" data-level="5.8" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#brms-section-2"><i class="fa fa-check"></i><b>5.8</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#linear-model-of-adult-height"><i class="fa fa-check"></i><b>5.8.1</b> linear model of adult height<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#pymc3-section-2"><i class="fa fa-check"></i><b>5.9</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html"><i class="fa fa-check"></i><b>6</b> Rethinking: Chapter 5<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#directed-acyclic-graphs"><i class="fa fa-check"></i><b>6.1</b> Directed Acyclic Graphs<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multiple-regression-notion"><i class="fa fa-check"></i><b>6.2</b> Multiple Regression notion<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#visualizations-for-multivariate-regressions"><i class="fa fa-check"></i><b>6.2.1</b> Visualizations for multivariate regressions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#masked-relationship"><i class="fa fa-check"></i><b>6.3</b> Masked relationship<span></span></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#bi-variate-models"><i class="fa fa-check"></i><b>6.3.1</b> Bi-variate models<span></span></a></li>
<li class="chapter" data-level="6.3.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#simulate-a-masking-relationship"><i class="fa fa-check"></i><b>6.3.2</b> Simulate a masking relationship<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#categorical-variables"><i class="fa fa-check"></i><b>6.4</b> Categorical Variables<span></span></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#indicator-vs.-index-variable-binary-categories"><i class="fa fa-check"></i><b>6.4.1</b> Indicator vs. Index variable (binary categories)<span></span></a></li>
<li class="chapter" data-level="6.4.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multiple-categories"><i class="fa fa-check"></i><b>6.4.2</b> Multiple categories<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#homework-3"><i class="fa fa-check"></i><b>6.5</b> Homework<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#brms-section-3"><i class="fa fa-check"></i><b>6.6</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#age-at-marriage-model"><i class="fa fa-check"></i><b>6.6.1</b> Age at marriage Model<span></span></a></li>
<li class="chapter" data-level="6.6.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#marriage-rate-model"><i class="fa fa-check"></i><b>6.6.2</b> Marriage rate Model<span></span></a></li>
<li class="chapter" data-level="6.6.3" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multiple-regression"><i class="fa fa-check"></i><b>6.6.3</b> Multiple regression<span></span></a></li>
<li class="chapter" data-level="6.6.4" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multivariate-posteriors"><i class="fa fa-check"></i><b>6.6.4</b> Multivariate Posteriors<span></span></a></li>
<li class="chapter" data-level="6.6.5" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#counterfactual-plots-1"><i class="fa fa-check"></i><b>6.6.5</b> Counterfactual plots<span></span></a></li>
<li class="chapter" data-level="6.6.6" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#masked-relationships"><i class="fa fa-check"></i><b>6.6.6</b> Masked Relationships<span></span></a></li>
<li class="chapter" data-level="6.6.7" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#categorical-variables-1"><i class="fa fa-check"></i><b>6.6.7</b> Categorical Variables<span></span></a></li>
<li class="chapter" data-level="6.6.8" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#alternative-ways-to-model-multiple-categories"><i class="fa fa-check"></i><b>6.6.8</b> Alternative ways to model multiple categories<span></span></a></li>
<li class="chapter" data-level="6.6.9" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multilevel-anova"><i class="fa fa-check"></i><b>6.6.9</b> Multilevel ANOVA<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#pymc3-section-3"><i class="fa fa-check"></i><b>6.7</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html"><i class="fa fa-check"></i><b>7</b> Rethinking: Chapter 6<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#multicolliniarity"><i class="fa fa-check"></i><b>7.1</b> Multicolliniarity<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#post-treatment-bias"><i class="fa fa-check"></i><b>7.2</b> Post-treatment bias<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#collider-bias"><i class="fa fa-check"></i><b>7.3</b> Collider Bias<span></span></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#the-haunted-dag"><i class="fa fa-check"></i><b>7.3.1</b> The haunted DAG<span></span></a></li>
<li class="chapter" data-level="7.3.2" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#shutting-the-backdoor"><i class="fa fa-check"></i><b>7.3.2</b> Shutting the Backdoor<span></span></a></li>
<li class="chapter" data-level="7.3.3" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#two-roads"><i class="fa fa-check"></i><b>7.3.3</b> Two Roads<span></span></a></li>
<li class="chapter" data-level="7.3.4" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#backdoor-waffles"><i class="fa fa-check"></i><b>7.3.4</b> Backdoor Waffles<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#homework-4"><i class="fa fa-check"></i><b>7.4</b> Homework<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#brms-section-4"><i class="fa fa-check"></i><b>7.5</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#multicolliniarity-1"><i class="fa fa-check"></i><b>7.5.1</b> Multicolliniarity<span></span></a></li>
<li class="chapter" data-level="7.5.2" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#post-treatment-bias-1"><i class="fa fa-check"></i><b>7.5.2</b> Post-treatment bias<span></span></a></li>
<li class="chapter" data-level="7.5.3" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#collider-bias-1"><i class="fa fa-check"></i><b>7.5.3</b> Collider Bias<span></span></a></li>
<li class="chapter" data-level="7.5.4" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#summary"><i class="fa fa-check"></i><b>7.5.4</b> Summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#pymc3-section-4"><i class="fa fa-check"></i><b>7.6</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html"><i class="fa fa-check"></i><b>8</b> Rethinking: Chapter 7<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>8.1</b> The Problem with Parameters<span></span></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#the-burial-of-r2"><i class="fa fa-check"></i><b>8.1.1</b> The burial of R<sup>2</sup><span></span></a></li>
<li class="chapter" data-level="8.1.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#higher-order-polynomials"><i class="fa fa-check"></i><b>8.1.2</b> Higher order polynomials<span></span></a></li>
<li class="chapter" data-level="8.1.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#underfitting"><i class="fa fa-check"></i><b>8.1.3</b> Underfitting<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>8.2</b> Entropy and Accuracy<span></span></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#entropy"><i class="fa fa-check"></i><b>8.2.1</b> Entropy<span></span></a></li>
<li class="chapter" data-level="8.2.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#accuracy"><i class="fa fa-check"></i><b>8.2.2</b> Accuracy<span></span></a></li>
<li class="chapter" data-level="8.2.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#estimating-divergence"><i class="fa fa-check"></i><b>8.2.3</b> Estimating Divergence<span></span></a></li>
<li class="chapter" data-level="8.2.4" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#scoring-the-right-data"><i class="fa fa-check"></i><b>8.2.4</b> Scoring the right data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#golem-taming-regularization"><i class="fa fa-check"></i><b>8.3</b> Golem taming: regularization<span></span></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#cross-validataion"><i class="fa fa-check"></i><b>8.3.1</b> Cross-validataion<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#information-criteria"><i class="fa fa-check"></i><b>8.3.2</b> Information Criteria<span></span></a></li>
<li class="chapter" data-level="8.3.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#comparing-cv-psis-and-waic"><i class="fa fa-check"></i><b>8.3.3</b> Comparing CV, PSIS and WAIC<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#model-comparison"><i class="fa fa-check"></i><b>8.4</b> Model comparison<span></span></a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#model-mis-selection"><i class="fa fa-check"></i><b>8.4.1</b> Model mis-selection<span></span></a></li>
<li class="chapter" data-level="8.4.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#outliers-and-other-illusions"><i class="fa fa-check"></i><b>8.4.2</b> Outliers and other illusions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#homework-5"><i class="fa fa-check"></i><b>8.5</b> Homework<span></span></a></li>
<li class="chapter" data-level="8.6" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#brms-section-5"><i class="fa fa-check"></i><b>8.6</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#the-problem-with-parameters-1"><i class="fa fa-check"></i><b>8.6.1</b> The problem with parameters<span></span></a></li>
<li class="chapter" data-level="8.6.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#entropy-and-accuracy-1"><i class="fa fa-check"></i><b>8.6.2</b> Entropy and accuracy<span></span></a></li>
<li class="chapter" data-level="8.6.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#information-criteria-1"><i class="fa fa-check"></i><b>8.6.3</b> Information criteria<span></span></a></li>
<li class="chapter" data-level="8.6.4" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#model-comparison-1"><i class="fa fa-check"></i><b>8.6.4</b> Model comparison<span></span></a></li>
<li class="chapter" data-level="8.6.5" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#outliers-and-other-illusions-1"><i class="fa fa-check"></i><b>8.6.5</b> Outliers and other illusions<span></span></a></li>
<li class="chapter" data-level="8.6.6" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#brms-r2"><i class="fa fa-check"></i><b>8.6.6</b> {brms} <span class="math inline">\(r^2\)</span><span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#pymc3-section-5"><i class="fa fa-check"></i><b>8.7</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html"><i class="fa fa-check"></i><b>9</b> Rethinking: Chapter 8<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#building-an-interaction"><i class="fa fa-check"></i><b>9.1</b> Building an Interaction<span></span></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#adding-an-index-variable-is-not-enough"><i class="fa fa-check"></i><b>9.1.1</b> Adding an index variable is not enough<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#adding-an-interaction-does-work"><i class="fa fa-check"></i><b>9.1.2</b> Adding an interaction does work<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#symetry-of-interactions"><i class="fa fa-check"></i><b>9.2</b> Symetry of Interactions<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#continuous-interaction"><i class="fa fa-check"></i><b>9.3</b> Continuous Interaction<span></span></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#model-without-interaction"><i class="fa fa-check"></i><b>9.3.1</b> Model without Interaction<span></span></a></li>
<li class="chapter" data-level="9.3.2" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#model-with-interaction"><i class="fa fa-check"></i><b>9.3.2</b> Model with Interaction<span></span></a></li>
<li class="chapter" data-level="9.3.3" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#plotting-the-posterior-predictions"><i class="fa fa-check"></i><b>9.3.3</b> Plotting the Posterior Predictions<span></span></a></li>
<li class="chapter" data-level="9.3.4" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#plotting-the-prior-predictions"><i class="fa fa-check"></i><b>9.3.4</b> Plotting the Prior Predictions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#homework-6"><i class="fa fa-check"></i><b>9.4</b> Homework<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#brms-section-6"><i class="fa fa-check"></i><b>9.5</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#building-an-interaction-1"><i class="fa fa-check"></i><b>9.5.1</b> Building an Interaction<span></span></a></li>
<li class="chapter" data-level="9.5.2" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#plotting-the-interaction"><i class="fa fa-check"></i><b>9.5.2</b> Plotting the Interaction<span></span></a></li>
<li class="chapter" data-level="9.5.3" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#symetry-of-interactions-1"><i class="fa fa-check"></i><b>9.5.3</b> Symetry of Interactions<span></span></a></li>
<li class="chapter" data-level="9.5.4" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#continuous-interactions"><i class="fa fa-check"></i><b>9.5.4</b> Continuous Interactions<span></span></a></li>
<li class="chapter" data-level="9.5.5" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#plotting-the-posterior-predictions-1"><i class="fa fa-check"></i><b>9.5.5</b> Plotting the Posterior Predictions<span></span></a></li>
<li class="chapter" data-level="9.5.6" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#plotting-prior-predictions"><i class="fa fa-check"></i><b>9.5.6</b> Plotting Prior Predictions<span></span></a></li>
<li class="chapter" data-level="9.5.7" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#brms-conditional_effects"><i class="fa fa-check"></i><b>9.5.7</b> {brms} <code>conditional_effects()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#pymc3-section-6"><i class="fa fa-check"></i><b>9.6</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html"><i class="fa fa-check"></i><b>10</b> Rethinking: Chapter 9<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#the-island-kingdom"><i class="fa fa-check"></i><b>10.1</b> The island Kingdom<span></span></a></li>
<li class="chapter" data-level="10.2" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#metropolis-algotithms"><i class="fa fa-check"></i><b>10.2</b> Metropolis algotithms<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>10.3</b> Hamiltonian Monte Carlo<span></span></a></li>
<li class="chapter" data-level="10.4" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#easy-hmc-rethinkingulam"><i class="fa fa-check"></i><b>10.4</b> Easy HMC: <code>rethinking::ulam()</code><span></span></a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#checking-the-chain"><i class="fa fa-check"></i><b>10.4.1</b> Checking the Chain<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i><b>10.5</b> Care and feeding of your Markov Chain<span></span></a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#non-identifiable-parameters"><i class="fa fa-check"></i><b>10.5.1</b> Non-identifiable parameters<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#homework-7"><i class="fa fa-check"></i><b>10.6</b> Homework<span></span></a></li>
<li class="chapter" data-level="10.7" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#brms-section-7"><i class="fa fa-check"></i><b>10.7</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#easy-hmc-brm"><i class="fa fa-check"></i><b>10.7.1</b> Easy HMC: <code>brm{}</code><span></span></a></li>
<li class="chapter" data-level="10.7.2" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#care-and-feeding-of-your-markov-chain-1"><i class="fa fa-check"></i><b>10.7.2</b> Care and feeding of your Markov chain<span></span></a></li>
<li class="chapter" data-level="10.7.3" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#non-identifiable-parameters-1"><i class="fa fa-check"></i><b>10.7.3</b> Non-identifiable parameters<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#pymc3-section-7"><i class="fa fa-check"></i><b>10.8</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html"><i class="fa fa-check"></i><b>11</b> Rethinking: Chapter 10<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#maximum-entropy"><i class="fa fa-check"></i><b>11.1</b> Maximum Entropy<span></span></a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#the-gaussian-family"><i class="fa fa-check"></i><b>11.1.1</b> The Gaussian Family<span></span></a></li>
<li class="chapter" data-level="11.1.2" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#the-binomial-distribution"><i class="fa fa-check"></i><b>11.1.2</b> The Binomial Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#generalized-linear-models"><i class="fa fa-check"></i><b>11.2</b> Generalized linear Models<span></span></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#meet-the-family"><i class="fa fa-check"></i><b>11.2.1</b> Meet the Family<span></span></a></li>
<li class="chapter" data-level="11.2.2" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#linking-linear-models-to-distributions"><i class="fa fa-check"></i><b>11.2.2</b> Linking linear models to distributions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#homework-8"><i class="fa fa-check"></i><b>11.3</b> Homework<span></span></a></li>
<li class="chapter" data-level="11.4" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#brms-section-8"><i class="fa fa-check"></i><b>11.4</b> {brms} section<span></span></a></li>
<li class="chapter" data-level="11.5" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#pymc3-section-8"><i class="fa fa-check"></i><b>11.5</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html"><i class="fa fa-check"></i><b>12</b> Rethinking: Chapter 11<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#binomial-regression"><i class="fa fa-check"></i><b>12.1</b> Binomial Regression<span></span></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#logistic-regression-prosocial-chimpanzees"><i class="fa fa-check"></i><b>12.1.1</b> Logistic Regression: Prosocial chimpanzees<span></span></a></li>
<li class="chapter" data-level="12.1.2" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#relative-shark-and-absolute-deer"><i class="fa fa-check"></i><b>12.1.2</b> Relative Shark and Absolute Deer<span></span></a></li>
<li class="chapter" data-level="12.1.3" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#aggregated-binomial-chimpanzees-again-condensed"><i class="fa fa-check"></i><b>12.1.3</b> Aggregated binomial: Chimpanzees again, condensed<span></span></a></li>
<li class="chapter" data-level="12.1.4" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#aggregated-binomial-graduate-school-admissions"><i class="fa fa-check"></i><b>12.1.4</b> Aggregated binomial: Graduate School Admissions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#poisson-regression"><i class="fa fa-check"></i><b>12.2</b> Poisson Regression<span></span></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#oceanic-tool-complexity"><i class="fa fa-check"></i><b>12.2.1</b> Oceanic Tool Complexity<span></span></a></li>
<li class="chapter" data-level="12.2.2" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#modeling-tool-innovation"><i class="fa fa-check"></i><b>12.2.2</b> Modeling Tool Innovation<span></span></a></li>
<li class="chapter" data-level="12.2.3" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#negative-binomial-gamma-poisson-models"><i class="fa fa-check"></i><b>12.2.3</b> Negative Binomial (gamma-Poisson) models<span></span></a></li>
<li class="chapter" data-level="12.2.4" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#exposure-and-the-offset"><i class="fa fa-check"></i><b>12.2.4</b> Exposure and the Offset<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#multinomial-and-categorical-models"><i class="fa fa-check"></i><b>12.3</b> Multinomial and Categorical Models<span></span></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#predictor-matches-to-outcomes"><i class="fa fa-check"></i><b>12.3.1</b> Predictor Matches to Outcomes<span></span></a></li>
<li class="chapter" data-level="12.3.2" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#predictors-matched-to-observations"><i class="fa fa-check"></i><b>12.3.2</b> Predictors Matched to Observations<span></span></a></li>
<li class="chapter" data-level="12.3.3" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#multinomial-in-disguise-as-poisson"><i class="fa fa-check"></i><b>12.3.3</b> Multinomial in Disguise as Poisson<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#homework-9"><i class="fa fa-check"></i><b>12.4</b> Homework<span></span></a></li>
<li class="chapter" data-level="12.5" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#brms-section-9"><i class="fa fa-check"></i><b>12.5</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#binomial-regression-1"><i class="fa fa-check"></i><b>12.5.1</b> Binomial Regression<span></span></a></li>
<li class="chapter" data-level="12.5.2" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#poisson-regression-1"><i class="fa fa-check"></i><b>12.5.2</b> Poisson Regression<span></span></a></li>
<li class="chapter" data-level="12.5.3" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#multinomial-and-categorical-models-1"><i class="fa fa-check"></i><b>12.5.3</b> Multinomial and Categorical Models<span></span></a></li>
<li class="chapter" data-level="12.5.4" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#survival-analysis"><i class="fa fa-check"></i><b>12.5.4</b> Survival analysis<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#pymc3-section-9"><i class="fa fa-check"></i><b>12.6</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html"><i class="fa fa-check"></i><b>13</b> Rethinking: Chapter 12<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#over-dispersed-counts"><i class="fa fa-check"></i><b>13.1</b> Over-Dispersed Counts<span></span></a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#beta-binomial"><i class="fa fa-check"></i><b>13.1.1</b> Beta-Binomial<span></span></a></li>
<li class="chapter" data-level="13.1.2" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#negative-binomial-or-gamma-poisson"><i class="fa fa-check"></i><b>13.1.2</b> Negative-Binomial or gamma-Poisson<span></span></a></li>
<li class="chapter" data-level="13.1.3" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#over-dispersion-entropy-and-information-criteria"><i class="fa fa-check"></i><b>13.1.3</b> Over-dispersion, Entropy and Information Criteria<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#zero-inflated-outcomes"><i class="fa fa-check"></i><b>13.2</b> Zero-Inflated Outcomes<span></span></a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#zero-inflated-poisson"><i class="fa fa-check"></i><b>13.2.1</b> Zero-Inflated Poisson<span></span></a></li>
<li class="chapter" data-level="13.2.2" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#zero-inflated-model-in-stan"><i class="fa fa-check"></i><b>13.2.2</b> Zero-Inflated Model in Stan<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#ordered-categorical-outcomes"><i class="fa fa-check"></i><b>13.3</b> Ordered Categorical Outcomes<span></span></a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#moral-intuition"><i class="fa fa-check"></i><b>13.3.1</b> Moral Intuition<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#ordered-categorical-predictors"><i class="fa fa-check"></i><b>13.4</b> Ordered Categorical Predictors<span></span></a></li>
<li class="chapter" data-level="13.5" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#homework-10"><i class="fa fa-check"></i><b>13.5</b> Homework<span></span></a></li>
<li class="chapter" data-level="13.6" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#brms-section-10"><i class="fa fa-check"></i><b>13.6</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#over-dispersed-counts-1"><i class="fa fa-check"></i><b>13.6.1</b> Over-dispersed counts<span></span></a></li>
<li class="chapter" data-level="13.6.2" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#zero-inflated-outcomes-1"><i class="fa fa-check"></i><b>13.6.2</b> Zero-inflated outcomes<span></span></a></li>
<li class="chapter" data-level="13.6.3" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#ordered-categorical-outcomes-1"><i class="fa fa-check"></i><b>13.6.3</b> Ordered categorical outcomes<span></span></a></li>
<li class="chapter" data-level="13.6.4" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#ordered-categorical-predictors-1"><i class="fa fa-check"></i><b>13.6.4</b> Ordered categorical predictors<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="rethinking-chapter-12.html"><a href="rethinking-chapter-12.html#pymc3-section-10"><i class="fa fa-check"></i><b>13.7</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html"><i class="fa fa-check"></i><b>14</b> Rethinking: Chapter 13<span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#multilevel-tadpoles"><i class="fa fa-check"></i><b>14.1</b> Multilevel tadpoles<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#varying-effects-and-the-underfittingoverfitting-tade-off"><i class="fa fa-check"></i><b>14.2</b> Varying Effects and the Underfitting/Overfitting Tade-Off<span></span></a></li>
<li class="chapter" data-level="14.3" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>14.3</b> More than One Type of Cluster<span></span></a></li>
<li class="chapter" data-level="14.4" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i><b>14.4</b> Divergent Transitions and Non-Centered Priors<span></span></a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#the-devils-funnel"><i class="fa fa-check"></i><b>14.4.1</b> The Devil’s Funnel<span></span></a></li>
<li class="chapter" data-level="14.4.2" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#non-centered-chimpanzees"><i class="fa fa-check"></i><b>14.4.2</b> Non-Centered Chimpanzees<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>14.5</b> Multilevel Posterior Predictions<span></span></a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#posterior-prediction-for-same-clusters"><i class="fa fa-check"></i><b>14.5.1</b> Posterior Prediction for Same Clusters<span></span></a></li>
<li class="chapter" data-level="14.5.2" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#posterior-predictions-for-new-clusters"><i class="fa fa-check"></i><b>14.5.2</b> Posterior Predictions for New Clusters<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#homework-11"><i class="fa fa-check"></i><b>14.6</b> Homework<span></span></a></li>
<li class="chapter" data-level="14.7" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#brms-section-11"><i class="fa fa-check"></i><b>14.7</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#multilevel-tadpoles-1"><i class="fa fa-check"></i><b>14.7.1</b> Multilevel Tadpoles<span></span></a></li>
<li class="chapter" data-level="14.7.2" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#varying-effects-and-the-underfittingoverfitting-trade-off"><i class="fa fa-check"></i><b>14.7.2</b> Varying Effects and the Underfitting/Overfitting Trade-Off<span></span></a></li>
<li class="chapter" data-level="14.7.3" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#more-than-one-type-of-cluster-1"><i class="fa fa-check"></i><b>14.7.3</b> More than one Type of Cluster<span></span></a></li>
<li class="chapter" data-level="14.7.4" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#divergent-transitions-and-non-centered-priors-1"><i class="fa fa-check"></i><b>14.7.4</b> Divergent Transitions and Non-Centered Priors<span></span></a></li>
<li class="chapter" data-level="14.7.5" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#multilevel-posterior-predictions-1"><i class="fa fa-check"></i><b>14.7.5</b> Multilevel Posterior Predictions<span></span></a></li>
<li class="chapter" data-level="14.7.6" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#bonus-post-stratification-in-an-example"><i class="fa fa-check"></i><b>14.7.6</b> Bonus: Post-stratification in an example<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="rethinking-chapter-13.html"><a href="rethinking-chapter-13.html#pymc3-section-11"><i class="fa fa-check"></i><b>14.8</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html"><i class="fa fa-check"></i><b>15</b> Rethinking: Chapter 14<span></span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>15.1</b> Varying Slopes by Construction<span></span></a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#simulate-the-population"><i class="fa fa-check"></i><b>15.1.1</b> Simulate the Population<span></span></a></li>
<li class="chapter" data-level="15.1.2" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#simulate-observations"><i class="fa fa-check"></i><b>15.1.2</b> Simulate Observations<span></span></a></li>
<li class="chapter" data-level="15.1.3" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#the-varying-slopes-model"><i class="fa fa-check"></i><b>15.1.3</b> The Varying Slopes Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#advanced-varying-slopes"><i class="fa fa-check"></i><b>15.2</b> Advanced Varying Slopes<span></span></a></li>
<li class="chapter" data-level="15.3" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#instruments-and-causal-design"><i class="fa fa-check"></i><b>15.3</b> Instruments and Causal Design<span></span></a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#instrumental-variables"><i class="fa fa-check"></i><b>15.3.1</b> Instrumental Variables<span></span></a></li>
<li class="chapter" data-level="15.3.2" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#other-designs"><i class="fa fa-check"></i><b>15.3.2</b> Other Designs<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#social-relations-and-correlated-varying-effects"><i class="fa fa-check"></i><b>15.4</b> Social Relations and Correlated Varying Effects<span></span></a></li>
<li class="chapter" data-level="15.5" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#continous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>15.5</b> Continous Categories and the Gaussian Process<span></span></a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#spatial-autocorrelatioin-in-oceanic-tools"><i class="fa fa-check"></i><b>15.5.1</b> Spatial autocorrelatioin in Oceanic Tools<span></span></a></li>
<li class="chapter" data-level="15.5.2" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#phylogenetic-distance"><i class="fa fa-check"></i><b>15.5.2</b> Phylogenetic Distance<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#homework-12"><i class="fa fa-check"></i><b>15.6</b> Homework<span></span></a></li>
<li class="chapter" data-level="15.7" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#brms-section-12"><i class="fa fa-check"></i><b>15.7</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#varying-slopes-by-construction-1"><i class="fa fa-check"></i><b>15.7.1</b> Varying Slopes by Construction<span></span></a></li>
<li class="chapter" data-level="15.7.2" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#advanced-varying-slopes-1"><i class="fa fa-check"></i><b>15.7.2</b> Advanced varying slopes<span></span></a></li>
<li class="chapter" data-level="15.7.3" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#instruments-and-causal-designs"><i class="fa fa-check"></i><b>15.7.3</b> Instruments and Causal Designs<span></span></a></li>
<li class="chapter" data-level="15.7.4" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#social-relations-as-correlated-varying-effects"><i class="fa fa-check"></i><b>15.7.4</b> Social Relations as Correlated Varying Effects<span></span></a></li>
<li class="chapter" data-level="15.7.5" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>15.7.5</b> Continuous Categories and the Gaussian Process<span></span></a></li>
<li class="chapter" data-level="15.7.6" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#multilevel-growth-models-and-the-melsm-brms-only"><i class="fa fa-check"></i><b>15.7.6</b> Multilevel Growth Models and the MELSM (<span>brms only</span>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="rethinking-chapter-14.html"><a href="rethinking-chapter-14.html#pymc3-section-12"><i class="fa fa-check"></i><b>15.8</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html"><i class="fa fa-check"></i><b>16</b> Rethinking: Chapter 15<span></span></a>
<ul>
<li class="chapter" data-level="16.1" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#measurement-error"><i class="fa fa-check"></i><b>16.1</b> Measurement Error<span></span></a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#error-on-the-outcome"><i class="fa fa-check"></i><b>16.1.1</b> Error on the Outcome<span></span></a></li>
<li class="chapter" data-level="16.1.2" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#error-on-both-outcome-and-predictor"><i class="fa fa-check"></i><b>16.1.2</b> Error on Both Outcome and Predictor<span></span></a></li>
<li class="chapter" data-level="16.1.3" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#measurement-terrors"><i class="fa fa-check"></i><b>16.1.3</b> Measurement Terrors<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#missing-data"><i class="fa fa-check"></i><b>16.2</b> Missing Data<span></span></a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#dag-ate-my-homework"><i class="fa fa-check"></i><b>16.2.1</b> DAG ate my Homework<span></span></a></li>
<li class="chapter" data-level="16.2.2" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#imputing-primates"><i class="fa fa-check"></i><b>16.2.2</b> Imputing Primates<span></span></a></li>
<li class="chapter" data-level="16.2.3" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#where-is-your-god-now"><i class="fa fa-check"></i><b>16.2.3</b> Where is Your God Now?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#categorical-errors-and-discrete-absences"><i class="fa fa-check"></i><b>16.3</b> Categorical Errors and Discrete Absences<span></span></a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#discrete-cats"><i class="fa fa-check"></i><b>16.3.1</b> Discrete Cats<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#homework-13"><i class="fa fa-check"></i><b>16.4</b> Homework<span></span></a></li>
<li class="chapter" data-level="16.5" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#brms-section-13"><i class="fa fa-check"></i><b>16.5</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#measurement-error-1"><i class="fa fa-check"></i><b>16.5.1</b> Measurement Error<span></span></a></li>
<li class="chapter" data-level="16.5.2" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#missing-data-1"><i class="fa fa-check"></i><b>16.5.2</b> Missing Data<span></span></a></li>
<li class="chapter" data-level="16.5.3" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#categorical-errors-and-discrete-absences-1"><i class="fa fa-check"></i><b>16.5.3</b> Categorical Errors and Discrete Absences<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="rethinking-chapter-15.html"><a href="rethinking-chapter-15.html#pymc3-section-13"><i class="fa fa-check"></i><b>16.6</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html"><i class="fa fa-check"></i><b>17</b> Rethinking: Chapter 16<span></span></a>
<ul>
<li class="chapter" data-level="17.1" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#geometric-people"><i class="fa fa-check"></i><b>17.1</b> Geometric People<span></span></a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#the-scientific-model"><i class="fa fa-check"></i><b>17.1.1</b> The Scientific Model<span></span></a></li>
<li class="chapter" data-level="17.1.2" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#the-statistical-model"><i class="fa fa-check"></i><b>17.1.2</b> The Statistical Model<span></span></a></li>
<li class="chapter" data-level="17.1.3" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#glm-in-disguise"><i class="fa fa-check"></i><b>17.1.3</b> GLM in Disguise<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#hidden-minds-and-observed-behavior"><i class="fa fa-check"></i><b>17.2</b> Hidden Minds and Observed Behavior<span></span></a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#the-scientific-model-1"><i class="fa fa-check"></i><b>17.2.1</b> The Scientific Model<span></span></a></li>
<li class="chapter" data-level="17.2.2" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#the-statistical-model-1"><i class="fa fa-check"></i><b>17.2.2</b> The Statistical Model<span></span></a></li>
<li class="chapter" data-level="17.2.3" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#coding-up-the-statistical-model"><i class="fa fa-check"></i><b>17.2.3</b> Coding up the statistical model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#ordinary-differntial-nut-cracking"><i class="fa fa-check"></i><b>17.3</b> Ordinary Differntial Nut Cracking<span></span></a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#the-scientific-model-2"><i class="fa fa-check"></i><b>17.3.1</b> The Scientific Model<span></span></a></li>
<li class="chapter" data-level="17.3.2" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#statistical-model"><i class="fa fa-check"></i><b>17.3.2</b> Statistical Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#population-dynamics"><i class="fa fa-check"></i><b>17.4</b> Population Dynamics<span></span></a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#the-scientific-model-3"><i class="fa fa-check"></i><b>17.4.1</b> The Scientific Model<span></span></a></li>
<li class="chapter" data-level="17.4.2" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#the-statistical-model-2"><i class="fa fa-check"></i><b>17.4.2</b> The Statistical Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#homework-14"><i class="fa fa-check"></i><b>17.5</b> Homework<span></span></a></li>
<li class="chapter" data-level="17.6" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#brms-section-14"><i class="fa fa-check"></i><b>17.6</b> {brms} section<span></span></a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#geometric-people-1"><i class="fa fa-check"></i><b>17.6.1</b> Geometric People<span></span></a></li>
<li class="chapter" data-level="17.6.2" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#hidden-minds-and-observed-behavior-1"><i class="fa fa-check"></i><b>17.6.2</b> Hidden Minds and Observed Behavior<span></span></a></li>
<li class="chapter" data-level="17.6.3" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#ordinary-differential-nut-cracking"><i class="fa fa-check"></i><b>17.6.3</b> Ordinary Differential Nut Cracking<span></span></a></li>
<li class="chapter" data-level="17.6.4" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#population-dynamics-1"><i class="fa fa-check"></i><b>17.6.4</b> Population dynamics<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="rethinking-chapter-16.html"><a href="rethinking-chapter-16.html#pymc3-section-14"><i class="fa fa-check"></i><b>17.7</b> pymc3 section<span></span></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="rethinking-chapter-17.html"><a href="rethinking-chapter-17.html"><i class="fa fa-check"></i><b>18</b> Rethinking: Chapter 17<span></span></a></li>
<li class="chapter" data-level="19" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html"><i class="fa fa-check"></i><b>19</b> Bayesian Statistics the Fun Way<span></span></a>
<ul>
<li class="chapter" data-level="19.1" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#conditioning-probabilities"><i class="fa fa-check"></i><b>19.1</b> Conditioning Probabilities<span></span></a></li>
<li class="chapter" data-level="19.2" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#combining-probailities-based-on-logic"><i class="fa fa-check"></i><b>19.2</b> Combining Probailities based on logic<span></span></a></li>
<li class="chapter" data-level="19.3" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#the-binomial-distribution-1"><i class="fa fa-check"></i><b>19.3</b> The binomial distribution<span></span></a></li>
<li class="chapter" data-level="19.4" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#the-beta-distribution"><i class="fa fa-check"></i><b>19.4</b> The beta distribution<span></span></a></li>
<li class="chapter" data-level="19.5" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#bayes-theorem"><i class="fa fa-check"></i><b>19.5</b> Bayes’ Theorem<span></span></a></li>
<li class="chapter" data-level="19.6" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#parameter-estimation-i"><i class="fa fa-check"></i><b>19.6</b> Parameter Estimation (I)<span></span></a></li>
<li class="chapter" data-level="19.7" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#the-normal-distribution"><i class="fa fa-check"></i><b>19.7</b> The normal distribution<span></span></a></li>
<li class="chapter" data-level="19.8" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#cummulative-density-and-quantile-function"><i class="fa fa-check"></i><b>19.8</b> Cummulative Density and Quantile Function<span></span></a></li>
<li class="chapter" data-level="19.9" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#parameter-estimation-with-prior-probabilities"><i class="fa fa-check"></i><b>19.9</b> Parameter estimation with prior probabilities<span></span></a></li>
<li class="chapter" data-level="19.10" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#monte-carlosimulation"><i class="fa fa-check"></i><b>19.10</b> Monte CarloSimulation<span></span></a></li>
<li class="chapter" data-level="19.11" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#posterior-odds"><i class="fa fa-check"></i><b>19.11</b> Posterior Odds<span></span></a></li>
<li class="chapter" data-level="19.12" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#parameter-estimation-ii"><i class="fa fa-check"></i><b>19.12</b> Parameter Estimation (II)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html"><i class="fa fa-check"></i><b>20</b> Mixed Models with R<span></span></a>
<ul>
<li class="chapter" data-level="20.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#standard-regregression-model"><i class="fa fa-check"></i><b>20.1</b> Standard regregression model<span></span></a></li>
<li class="chapter" data-level="20.2" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#mixed-nodel"><i class="fa fa-check"></i><b>20.2</b> mixed nodel<span></span></a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#student-specific-effect-initial-depiction"><i class="fa fa-check"></i><b>20.2.1</b> student specific effect (initial depiction)<span></span></a></li>
<li class="chapter" data-level="20.2.2" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#as-multi-level-model"><i class="fa fa-check"></i><b>20.2.2</b> as multi-level model<span></span></a></li>
<li class="chapter" data-level="20.2.3" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#mixed-model"><i class="fa fa-check"></i><b>20.2.3</b> Mixed Model<span></span></a></li>
<li class="chapter" data-level="20.2.4" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#estimation-of-random-effects"><i class="fa fa-check"></i><b>20.2.4</b> Estimation of random effects<span></span></a></li>
<li class="chapter" data-level="20.2.5" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#prediction"><i class="fa fa-check"></i><b>20.2.5</b> Prediction<span></span></a></li>
<li class="chapter" data-level="20.2.6" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#cluster-level-covariates"><i class="fa fa-check"></i><b>20.2.6</b> Cluster Level Covariates<span></span></a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#add-random-slope"><i class="fa fa-check"></i><b>20.3</b> Add random slope<span></span></a></li>
<li class="chapter" data-level="20.4" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#cross-classified-models"><i class="fa fa-check"></i><b>20.4</b> Cross Classified models<span></span></a></li>
<li class="chapter" data-level="20.5" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#hierachical-structure"><i class="fa fa-check"></i><b>20.5</b> Hierachical structure<span></span></a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#crossed-vs.-nested"><i class="fa fa-check"></i><b>20.5.1</b> Crossed vs. nested<span></span></a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#residual-structure"><i class="fa fa-check"></i><b>20.6</b> Residual Structure<span></span></a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#heterogeneous-variance"><i class="fa fa-check"></i><b>20.6.1</b> Heterogeneous variance<span></span></a></li>
<li class="chapter" data-level="20.6.2" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#autocorrelation"><i class="fa fa-check"></i><b>20.6.2</b> Autocorrelation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#generalized-linear-mixed-models"><i class="fa fa-check"></i><b>20.7</b> Generalized Linear Mixed Models<span></span></a></li>
<li class="chapter" data-level="20.8" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#issues-considderations"><i class="fa fa-check"></i><b>20.8</b> Issues/ Considderations<span></span></a>
<ul>
<li class="chapter" data-level="20.8.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#model-comparison-2"><i class="fa fa-check"></i><b>20.8.1</b> Model comparison<span></span></a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#formula-summary"><i class="fa fa-check"></i><b>20.9</b> Formula summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="references-and-session-info.html"><a href="references-and-session-info.html"><i class="fa fa-check"></i><b>21</b> References and Session Info<span></span></a>
<ul>
<li class="chapter" data-level="21.1" data-path="references-and-session-info.html"><a href="references-and-session-info.html#session-info"><i class="fa fa-check"></i><b>21.1</b> Session Info<span></span></a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="references-and-session-info.html"><a href="references-and-session-info.html#r-settings"><i class="fa fa-check"></i><b>21.1.1</b> R settings<span></span></a></li>
<li class="chapter" data-level="21.1.2" data-path="references-and-session-info.html"><a href="references-and-session-info.html#python-settings"><i class="fa fa-check"></i><b>21.1.2</b> Python settings<span></span></a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="references-and-session-info.html"><a href="references-and-session-info.html#references"><i class="fa fa-check"></i><b>21.2</b> References<span></span></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Explorations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rethinking-chapter-15" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">16</span> Rethinking: Chapter 15<a href="rethinking-chapter-15.html#rethinking-chapter-15" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Missing Data and Other Opportunities</strong></p>
<p>by <a href="https://xcelab.net/rm/statistical-rethinking/">Richard McElreath</a>, building on the Summaries by <a href="https://bookdown.org/content/4857/">Solomon Kurz</a>.</p>
<div class="sourceCode" id="cb1635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1635-1"><a href="rethinking-chapter-15.html#cb1635-1" aria-hidden="true" tabindex="-1"></a>sim_pancake <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb1635-2"><a href="rethinking-chapter-15.html#cb1635-2" aria-hidden="true" tabindex="-1"></a>  pancake <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb1635-3"><a href="rethinking-chapter-15.html#cb1635-3" aria-hidden="true" tabindex="-1"></a>  sides <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1635-4"><a href="rethinking-chapter-15.html#cb1635-4" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">2</span>,<span class="dv">3</span>)[, pancake]</span>
<span id="cb1635-5"><a href="rethinking-chapter-15.html#cb1635-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(sides)</span>
<span id="cb1635-6"><a href="rethinking-chapter-15.html#cb1635-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1635-7"><a href="rethinking-chapter-15.html#cb1635-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1635-8"><a href="rethinking-chapter-15.html#cb1635-8" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="fl">1e4</span>, <span class="fu">sim_pancake</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1635-9"><a href="rethinking-chapter-15.html#cb1635-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1635-10"><a href="rethinking-chapter-15.html#cb1635-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1635-11"><a href="rethinking-chapter-15.html#cb1635-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1635-12"><a href="rethinking-chapter-15.html#cb1635-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="at">nm =</span> <span class="fu">c</span>(<span class="st">&quot;up&quot;</span>, <span class="st">&quot;down&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1635-13"><a href="rethinking-chapter-15.html#cb1635-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">burnt_up =</span> <span class="fu">sum</span>(up),</span>
<span id="cb1635-14"><a href="rethinking-chapter-15.html#cb1635-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">burnt_both =</span> <span class="fu">sum</span>(up <span class="sc">&amp;</span> down)) <span class="sc">%&gt;%</span> </span>
<span id="cb1635-15"><a href="rethinking-chapter-15.html#cb1635-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob_both_burnt =</span> burnt_both<span class="sc">/</span> burnt_up)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 × 3
#&gt;   burnt_up burnt_both prob_both_burnt
#&gt;      &lt;dbl&gt;      &lt;int&gt;           &lt;dbl&gt;
#&gt; 1     5074       3357           0.662</code></pre>
<div id="measurement-error" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Measurement Error<a href="rethinking-chapter-15.html#measurement-error" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1637-1"><a href="rethinking-chapter-15.html#cb1637-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb1637-2"><a href="rethinking-chapter-15.html#cb1637-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;WaffleDivorce&quot;</span>)</span>
<span id="cb1637-3"><a href="rethinking-chapter-15.html#cb1637-3" aria-hidden="true" tabindex="-1"></a>data_waffle <span class="ot">&lt;-</span> WaffleDivorce <span class="sc">%&gt;%</span> </span>
<span id="cb1637-4"><a href="rethinking-chapter-15.html#cb1637-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1637-5"><a href="rethinking-chapter-15.html#cb1637-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(Divorce, Marriage, MedianAgeMarriage),</span>
<span id="cb1637-6"><a href="rethinking-chapter-15.html#cb1637-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">.fns =</span> standardize,</span>
<span id="cb1637-7"><a href="rethinking-chapter-15.html#cb1637-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">.names =</span> <span class="st">&quot;{str_to_lower(.col)}_std&quot;</span>),</span>
<span id="cb1637-8"><a href="rethinking-chapter-15.html#cb1637-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">waffle_pop =</span> WaffleHouses <span class="sc">/</span> Population,</span>
<span id="cb1637-9"><a href="rethinking-chapter-15.html#cb1637-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">divorce_sd =</span> Divorce.SE <span class="sc">/</span> <span class="fu">sd</span>(Divorce),</span>
<span id="cb1637-10"><a href="rethinking-chapter-15.html#cb1637-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">marriage_sd =</span> Marriage.SE <span class="sc">/</span> <span class="fu">sd</span>(Marriage)) <span class="sc">%&gt;%</span> </span>
<span id="cb1637-11"><a href="rethinking-chapter-15.html#cb1637-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">median_age_std =</span> <span class="st">&quot;medianagemarriage_std&quot;</span>) </span>
<span id="cb1637-12"><a href="rethinking-chapter-15.html#cb1637-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1637-13"><a href="rethinking-chapter-15.html#cb1637-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> data_waffle <span class="sc">%&gt;%</span> </span>
<span id="cb1637-14"><a href="rethinking-chapter-15.html#cb1637-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MedianAgeMarriage, <span class="at">y =</span> Divorce))</span>
<span id="cb1637-15"><a href="rethinking-chapter-15.html#cb1637-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1637-16"><a href="rethinking-chapter-15.html#cb1637-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data_waffle <span class="sc">%&gt;%</span> </span>
<span id="cb1637-17"><a href="rethinking-chapter-15.html#cb1637-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(Population), <span class="at">y =</span> Divorce))</span>
<span id="cb1637-18"><a href="rethinking-chapter-15.html#cb1637-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1637-19"><a href="rethinking-chapter-15.html#cb1637-19" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">&amp;</span></span>
<span id="cb1637-20"><a href="rethinking-chapter-15.html#cb1637-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Divorce <span class="sc">-</span> Divorce.SE,</span>
<span id="cb1637-21"><a href="rethinking-chapter-15.html#cb1637-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymax =</span> Divorce <span class="sc">+</span> Divorce.SE),</span>
<span id="cb1637-22"><a href="rethinking-chapter-15.html#cb1637-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fatten =</span> <span class="dv">3</span>,</span>
<span id="cb1637-23"><a href="rethinking-chapter-15.html#cb1637-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1637-24"><a href="rethinking-chapter-15.html#cb1637-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linewidth =</span> .<span class="dv">3</span>,</span>
<span id="cb1637-25"><a href="rethinking-chapter-15.html#cb1637-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> clr0,</span>
<span id="cb1637-26"><a href="rethinking-chapter-15.html#cb1637-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr0dd)</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-1-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div id="error-on-the-outcome" class="section level3 hasAnchor" number="16.1.1">
<h3><span class="header-section-number">16.1.1</span> Error on the Outcome<a href="rethinking-chapter-15.html#error-on-the-outcome" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1638-1"><a href="rethinking-chapter-15.html#cb1638-1" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(D_obs <span class="sc">~</span> D <span class="sc">+</span> E_D,</span>
<span id="cb1638-2"><a href="rethinking-chapter-15.html#cb1638-2" aria-hidden="true" tabindex="-1"></a>       D <span class="sc">~</span> A <span class="sc">+</span> M,</span>
<span id="cb1638-3"><a href="rethinking-chapter-15.html#cb1638-3" aria-hidden="true" tabindex="-1"></a>       M <span class="sc">~</span> A,</span>
<span id="cb1638-4"><a href="rethinking-chapter-15.html#cb1638-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1638-5"><a href="rethinking-chapter-15.html#cb1638-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">outcome =</span> <span class="st">&quot;D_obs&quot;</span>,</span>
<span id="cb1638-6"><a href="rethinking-chapter-15.html#cb1638-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;E_D&quot;</span>),</span>
<span id="cb1638-7"><a href="rethinking-chapter-15.html#cb1638-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>),</span>
<span id="cb1638-8"><a href="rethinking-chapter-15.html#cb1638-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb1638-9"><a href="rethinking-chapter-15.html#cb1638-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1638-10"><a href="rethinking-chapter-15.html#cb1638-10" aria-hidden="true" tabindex="-1"></a>dag <span class="sc">%&gt;%</span></span>
<span id="cb1638-11"><a href="rethinking-chapter-15.html#cb1638-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1638-12"><a href="rethinking-chapter-15.html#cb1638-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1638-13"><a href="rethinking-chapter-15.html#cb1638-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>),</span>
<span id="cb1638-14"><a href="rethinking-chapter-15.html#cb1638-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>)),</span>
<span id="cb1638-15"><a href="rethinking-chapter-15.html#cb1638-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">&quot;(.*)_([a-zA-Z]*)&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1[</span><span class="sc">\\</span><span class="st">2]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1638-16"><a href="rethinking-chapter-15.html#cb1638-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1638-17"><a href="rethinking-chapter-15.html#cb1638-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.6</span>)) <span class="sc">+</span></span>
<span id="cb1638-18"><a href="rethinking-chapter-15.html#cb1638-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb1638-19"><a href="rethinking-chapter-15.html#cb1638-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1638-20"><a href="rethinking-chapter-15.html#cb1638-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-2-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math display">\[
\begin{array}{rclr}
\color{#B35136}{D_{\textrm{OBS}, i}} &amp; \sim &amp; \color{#B35136}{\textrm{Normal}(D_{\textrm{TRUE}}, D_{\textrm{SE}, i})} &amp; \textrm{[distribution of observed values]}\\
\color{#B35136}{D_{\textrm{TRUE},i}} &amp; \sim &amp; \textrm{Normal}(\mu_{i}, \sigma) &amp; \textrm{[distribution of true values]}\\
\mu_{i} &amp; = &amp; \alpha + \beta_{A} ~ A_{i} + \beta_{M} ~ M_{i} &amp; \textrm{[linear model to asses A }\rightarrow\textrm{ D]}\\
\alpha &amp; \sim &amp; \textrm{Normal}(0, 0.2) &amp;&amp;\\
\beta_{A} &amp; \sim &amp; \textrm{Normal}(0, 0.5) &amp;&amp;\\
\beta_{M} &amp; \sim &amp; \textrm{Normal}(0, 0.5) &amp;&amp;\\
\sigma &amp; \sim &amp; \textrm{Exponential}(1) &amp;&amp;\\
\end{array}
\]</span></p>
<div class="sourceCode" id="cb1639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1639-1"><a href="rethinking-chapter-15.html#cb1639-1" aria-hidden="true" tabindex="-1"></a>data_waffle_list <span class="ot">&lt;-</span> data_waffle <span class="sc">%&gt;%</span> </span>
<span id="cb1639-2"><a href="rethinking-chapter-15.html#cb1639-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">divorce_obs =</span> divorce_std, divorce_sd,</span>
<span id="cb1639-3"><a href="rethinking-chapter-15.html#cb1639-3" aria-hidden="true" tabindex="-1"></a>                marriage_std, median_age_std, marriage_sd) <span class="sc">%&gt;%</span> </span>
<span id="cb1639-4"><a href="rethinking-chapter-15.html#cb1639-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(., <span class="fu">list</span>(<span class="at">N =</span> <span class="fu">nrow</span>(.)))</span>
<span id="cb1639-5"><a href="rethinking-chapter-15.html#cb1639-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1639-6"><a href="rethinking-chapter-15.html#cb1639-6" aria-hidden="true" tabindex="-1"></a>model_divorce <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1639-7"><a href="rethinking-chapter-15.html#cb1639-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1639-8"><a href="rethinking-chapter-15.html#cb1639-8" aria-hidden="true" tabindex="-1"></a>    divorce_obs <span class="sc">~</span> <span class="fu">dnorm</span>( divorce_true, divorce_sd ),</span>
<span id="cb1639-9"><a href="rethinking-chapter-15.html#cb1639-9" aria-hidden="true" tabindex="-1"></a>    vector[N]<span class="sc">:</span>divorce_true <span class="sc">~</span> <span class="fu">dnorm</span>( mu, sigma ),</span>
<span id="cb1639-10"><a href="rethinking-chapter-15.html#cb1639-10" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_age <span class="sc">*</span> median_age_std <span class="sc">+</span> beta_marriage <span class="sc">*</span> marriage_std,</span>
<span id="cb1639-11"><a href="rethinking-chapter-15.html#cb1639-11" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.2</span> ),</span>
<span id="cb1639-12"><a href="rethinking-chapter-15.html#cb1639-12" aria-hidden="true" tabindex="-1"></a>    beta_age <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1639-13"><a href="rethinking-chapter-15.html#cb1639-13" aria-hidden="true" tabindex="-1"></a>    beta_marriage <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1639-14"><a href="rethinking-chapter-15.html#cb1639-14" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb1639-15"><a href="rethinking-chapter-15.html#cb1639-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1639-16"><a href="rethinking-chapter-15.html#cb1639-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_waffle_list,</span>
<span id="cb1639-17"><a href="rethinking-chapter-15.html#cb1639-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1639-18"><a href="rethinking-chapter-15.html#cb1639-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1639-19"><a href="rethinking-chapter-15.html#cb1639-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_lik =</span> <span class="cn">TRUE</span></span>
<span id="cb1639-20"><a href="rethinking-chapter-15.html#cb1639-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1640-1"><a href="rethinking-chapter-15.html#cb1640-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_divorce, <span class="at">depth =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1640-2"><a href="rethinking-chapter-15.html#cb1640-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">divorce_true[1]</td>
<td align="right">1.18</td>
<td align="right">0.37</td>
<td align="right">0.59</td>
<td align="right">1.76</td>
<td align="right">2120.60</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[2]</td>
<td align="right">0.69</td>
<td align="right">0.55</td>
<td align="right">-0.17</td>
<td align="right">1.58</td>
<td align="right">1996.13</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[3]</td>
<td align="right">0.42</td>
<td align="right">0.35</td>
<td align="right">-0.12</td>
<td align="right">0.98</td>
<td align="right">2375.88</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[4]</td>
<td align="right">1.41</td>
<td align="right">0.47</td>
<td align="right">0.66</td>
<td align="right">2.18</td>
<td align="right">2359.62</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[5]</td>
<td align="right">-0.90</td>
<td align="right">0.13</td>
<td align="right">-1.11</td>
<td align="right">-0.70</td>
<td align="right">2994.41</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[6]</td>
<td align="right">0.66</td>
<td align="right">0.41</td>
<td align="right">0.02</td>
<td align="right">1.32</td>
<td align="right">2478.57</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[7]</td>
<td align="right">-1.36</td>
<td align="right">0.36</td>
<td align="right">-1.94</td>
<td align="right">-0.77</td>
<td align="right">3093.85</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[8]</td>
<td align="right">-0.33</td>
<td align="right">0.47</td>
<td align="right">-1.10</td>
<td align="right">0.45</td>
<td align="right">2626.66</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[9]</td>
<td align="right">-1.90</td>
<td align="right">0.61</td>
<td align="right">-2.82</td>
<td align="right">-0.95</td>
<td align="right">1823.13</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[10]</td>
<td align="right">-0.62</td>
<td align="right">0.17</td>
<td align="right">-0.89</td>
<td align="right">-0.35</td>
<td align="right">2365.09</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[11]</td>
<td align="right">0.77</td>
<td align="right">0.29</td>
<td align="right">0.32</td>
<td align="right">1.23</td>
<td align="right">2276.66</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[12]</td>
<td align="right">-0.55</td>
<td align="right">0.48</td>
<td align="right">-1.32</td>
<td align="right">0.21</td>
<td align="right">1886.35</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[13]</td>
<td align="right">0.16</td>
<td align="right">0.48</td>
<td align="right">-0.61</td>
<td align="right">0.94</td>
<td align="right">1645.43</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[14]</td>
<td align="right">-0.87</td>
<td align="right">0.23</td>
<td align="right">-1.23</td>
<td align="right">-0.51</td>
<td align="right">2823.17</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[15]</td>
<td align="right">0.56</td>
<td align="right">0.30</td>
<td align="right">0.07</td>
<td align="right">1.06</td>
<td align="right">2575.91</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[16]</td>
<td align="right">0.29</td>
<td align="right">0.40</td>
<td align="right">-0.33</td>
<td align="right">0.93</td>
<td align="right">2920.37</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[17]</td>
<td align="right">0.50</td>
<td align="right">0.41</td>
<td align="right">-0.16</td>
<td align="right">1.16</td>
<td align="right">2632.67</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[18]</td>
<td align="right">1.26</td>
<td align="right">0.36</td>
<td align="right">0.68</td>
<td align="right">1.83</td>
<td align="right">2541.17</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[19]</td>
<td align="right">0.42</td>
<td align="right">0.38</td>
<td align="right">-0.18</td>
<td align="right">1.03</td>
<td align="right">2512.71</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[20]</td>
<td align="right">0.40</td>
<td align="right">0.54</td>
<td align="right">-0.46</td>
<td align="right">1.30</td>
<td align="right">1723.19</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[21]</td>
<td align="right">-0.54</td>
<td align="right">0.32</td>
<td align="right">-1.06</td>
<td align="right">-0.02</td>
<td align="right">3017.09</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[22]</td>
<td align="right">-1.09</td>
<td align="right">0.26</td>
<td align="right">-1.50</td>
<td align="right">-0.67</td>
<td align="right">2994.50</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[23]</td>
<td align="right">-0.27</td>
<td align="right">0.26</td>
<td align="right">-0.70</td>
<td align="right">0.15</td>
<td align="right">2668.85</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[24]</td>
<td align="right">-1.00</td>
<td align="right">0.30</td>
<td align="right">-1.50</td>
<td align="right">-0.51</td>
<td align="right">2692.42</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[25]</td>
<td align="right">0.44</td>
<td align="right">0.42</td>
<td align="right">-0.21</td>
<td align="right">1.12</td>
<td align="right">2152.32</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[26]</td>
<td align="right">-0.04</td>
<td align="right">0.32</td>
<td align="right">-0.54</td>
<td align="right">0.47</td>
<td align="right">3088.87</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[27]</td>
<td align="right">-0.03</td>
<td align="right">0.50</td>
<td align="right">-0.85</td>
<td align="right">0.76</td>
<td align="right">2789.47</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[28]</td>
<td align="right">-0.15</td>
<td align="right">0.40</td>
<td align="right">-0.81</td>
<td align="right">0.48</td>
<td align="right">2779.04</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[29]</td>
<td align="right">-0.27</td>
<td align="right">0.50</td>
<td align="right">-1.04</td>
<td align="right">0.55</td>
<td align="right">2013.86</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[30]</td>
<td align="right">-1.80</td>
<td align="right">0.24</td>
<td align="right">-2.19</td>
<td align="right">-1.41</td>
<td align="right">2759.28</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[31]</td>
<td align="right">0.17</td>
<td align="right">0.42</td>
<td align="right">-0.48</td>
<td align="right">0.85</td>
<td align="right">2360.02</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[32]</td>
<td align="right">-1.66</td>
<td align="right">0.16</td>
<td align="right">-1.92</td>
<td align="right">-1.40</td>
<td align="right">2786.49</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[33]</td>
<td align="right">0.11</td>
<td align="right">0.25</td>
<td align="right">-0.28</td>
<td align="right">0.52</td>
<td align="right">4394.88</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[34]</td>
<td align="right">-0.05</td>
<td align="right">0.51</td>
<td align="right">-0.91</td>
<td align="right">0.75</td>
<td align="right">2082.49</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[35]</td>
<td align="right">-0.12</td>
<td align="right">0.23</td>
<td align="right">-0.48</td>
<td align="right">0.25</td>
<td align="right">3614.20</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[36]</td>
<td align="right">1.27</td>
<td align="right">0.41</td>
<td align="right">0.61</td>
<td align="right">1.92</td>
<td align="right">3162.86</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[37]</td>
<td align="right">0.23</td>
<td align="right">0.36</td>
<td align="right">-0.36</td>
<td align="right">0.81</td>
<td align="right">2302.28</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[38]</td>
<td align="right">-1.02</td>
<td align="right">0.22</td>
<td align="right">-1.37</td>
<td align="right">-0.67</td>
<td align="right">2445.56</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[39]</td>
<td align="right">-0.91</td>
<td align="right">0.55</td>
<td align="right">-1.74</td>
<td align="right">-0.01</td>
<td align="right">1596.33</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[40]</td>
<td align="right">-0.69</td>
<td align="right">0.33</td>
<td align="right">-1.22</td>
<td align="right">-0.18</td>
<td align="right">2408.26</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[41]</td>
<td align="right">0.24</td>
<td align="right">0.53</td>
<td align="right">-0.62</td>
<td align="right">1.06</td>
<td align="right">2567.16</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[42]</td>
<td align="right">0.73</td>
<td align="right">0.34</td>
<td align="right">0.22</td>
<td align="right">1.28</td>
<td align="right">2103.94</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[43]</td>
<td align="right">0.19</td>
<td align="right">0.19</td>
<td align="right">-0.12</td>
<td align="right">0.50</td>
<td align="right">3015.36</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[44]</td>
<td align="right">0.80</td>
<td align="right">0.42</td>
<td align="right">0.13</td>
<td align="right">1.48</td>
<td align="right">2321.58</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[45]</td>
<td align="right">-0.43</td>
<td align="right">0.54</td>
<td align="right">-1.25</td>
<td align="right">0.44</td>
<td align="right">3009.24</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[46]</td>
<td align="right">-0.39</td>
<td align="right">0.26</td>
<td align="right">-0.80</td>
<td align="right">0.03</td>
<td align="right">2700.26</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[47]</td>
<td align="right">0.13</td>
<td align="right">0.30</td>
<td align="right">-0.35</td>
<td align="right">0.62</td>
<td align="right">2733.99</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[48]</td>
<td align="right">0.56</td>
<td align="right">0.47</td>
<td align="right">-0.17</td>
<td align="right">1.32</td>
<td align="right">3033.50</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">divorce_true[49]</td>
<td align="right">-0.64</td>
<td align="right">0.28</td>
<td align="right">-1.08</td>
<td align="right">-0.21</td>
<td align="right">2805.86</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">divorce_true[50]</td>
<td align="right">0.85</td>
<td align="right">0.57</td>
<td align="right">-0.07</td>
<td align="right">1.74</td>
<td align="right">1840.04</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.05</td>
<td align="right">0.09</td>
<td align="right">-0.20</td>
<td align="right">0.10</td>
<td align="right">1585.93</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_age</td>
<td align="right">-0.61</td>
<td align="right">0.16</td>
<td align="right">-0.86</td>
<td align="right">-0.36</td>
<td align="right">1169.42</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">beta_marriage</td>
<td align="right">0.05</td>
<td align="right">0.17</td>
<td align="right">-0.21</td>
<td align="right">0.32</td>
<td align="right">1014.84</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.59</td>
<td align="right">0.10</td>
<td align="right">0.43</td>
<td align="right">0.76</td>
<td align="right">769.88</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1641-1"><a href="rethinking-chapter-15.html#cb1641-1" aria-hidden="true" tabindex="-1"></a>d_obs_vs_d_est <span class="ot">&lt;-</span>  <span class="fu">precis</span>(model_divorce, <span class="at">depth =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1641-2"><a href="rethinking-chapter-15.html#cb1641-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1641-3"><a href="rethinking-chapter-15.html#cb1641-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;param&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1641-4"><a href="rethinking-chapter-15.html#cb1641-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1641-5"><a href="rethinking-chapter-15.html#cb1641-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;divorce_true&quot;</span>, param)) <span class="sc">%&gt;%</span> </span>
<span id="cb1641-6"><a href="rethinking-chapter-15.html#cb1641-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_waffle <span class="sc">%&gt;%</span> </span>
<span id="cb1641-7"><a href="rethinking-chapter-15.html#cb1641-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Loc, Divorce,divorce_std, divorce_sd, median_age_std ), .)</span>
<span id="cb1641-8"><a href="rethinking-chapter-15.html#cb1641-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1641-9"><a href="rethinking-chapter-15.html#cb1641-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> d_obs_vs_d_est <span class="sc">%&gt;%</span> </span>
<span id="cb1641-10"><a href="rethinking-chapter-15.html#cb1641-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> divorce_sd, <span class="at">y =</span>  divorce_std <span class="sc">-</span> mean)) <span class="sc">+</span></span>
<span id="cb1641-11"><a href="rethinking-chapter-15.html#cb1641-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb1641-12"><a href="rethinking-chapter-15.html#cb1641-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1641-13"><a href="rethinking-chapter-15.html#cb1641-13" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> Loc),</span>
<span id="cb1641-14"><a href="rethinking-chapter-15.html#cb1641-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">max.overlaps =</span> <span class="dv">1</span>,</span>
<span id="cb1641-15"><a href="rethinking-chapter-15.html#cb1641-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">family =</span> fnt_sel)</span>
<span id="cb1641-16"><a href="rethinking-chapter-15.html#cb1641-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1641-17"><a href="rethinking-chapter-15.html#cb1641-17" aria-hidden="true" tabindex="-1"></a>posterior_pred_se <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_divorce) <span class="sc">%&gt;%</span> </span>
<span id="cb1641-18"><a href="rethinking-chapter-15.html#cb1641-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1641-19"><a href="rethinking-chapter-15.html#cb1641-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(alpha, beta_age)  <span class="sc">%&gt;%</span> </span>
<span id="cb1641-20"><a href="rethinking-chapter-15.html#cb1641-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(alpha, beta_age),</span>
<span id="cb1641-21"><a href="rethinking-chapter-15.html#cb1641-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">age =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">to =</span> <span class="fl">3.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1641-22"><a href="rethinking-chapter-15.html#cb1641-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> alpha <span class="sc">+</span> beta_age <span class="sc">*</span> age)</span>
<span id="cb1641-23"><a href="rethinking-chapter-15.html#cb1641-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1641-24"><a href="rethinking-chapter-15.html#cb1641-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1641-25"><a href="rethinking-chapter-15.html#cb1641-25" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> d_obs_vs_d_est <span class="sc">%&gt;%</span> </span>
<span id="cb1641-26"><a href="rethinking-chapter-15.html#cb1641-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> median_age_std)) <span class="sc">+</span></span>
<span id="cb1641-27"><a href="rethinking-chapter-15.html#cb1641-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_lineribbon</span>(<span class="at">data =</span> posterior_pred_se,</span>
<span id="cb1641-28"><a href="rethinking-chapter-15.html#cb1641-28" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">y =</span> fitted, <span class="at">x =</span> age),</span>
<span id="cb1641-29"><a href="rethinking-chapter-15.html#cb1641-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">.width =</span> .<span class="dv">89</span>, <span class="at">size =</span> .<span class="dv">25</span>, </span>
<span id="cb1641-30"><a href="rethinking-chapter-15.html#cb1641-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr0d, <span class="at">fill =</span> fll0) <span class="sc">+</span></span>
<span id="cb1641-31"><a href="rethinking-chapter-15.html#cb1641-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> divorce_std, <span class="at">ymax =</span> mean),</span>
<span id="cb1641-32"><a href="rethinking-chapter-15.html#cb1641-32" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> clr0d)<span class="sc">+</span></span>
<span id="cb1641-33"><a href="rethinking-chapter-15.html#cb1641-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> divorce_std), </span>
<span id="cb1641-34"><a href="rethinking-chapter-15.html#cb1641-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0, </span>
<span id="cb1641-35"><a href="rethinking-chapter-15.html#cb1641-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1641-36"><a href="rethinking-chapter-15.html#cb1641-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean), </span>
<span id="cb1641-37"><a href="rethinking-chapter-15.html#cb1641-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_current, <span class="at">fill =</span> <span class="fu">clr_lighten</span>(clr_current),</span>
<span id="cb1641-38"><a href="rethinking-chapter-15.html#cb1641-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1641-39"><a href="rethinking-chapter-15.html#cb1641-39" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">abs</span>(divorce_std <span class="sc">-</span> mean) <span class="sc">&gt;</span> .<span class="dv">35</span>),</span>
<span id="cb1641-40"><a href="rethinking-chapter-15.html#cb1641-40" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">aes</span>(<span class="at">y =</span> divorce_std, <span class="at">label =</span> Loc),</span>
<span id="cb1641-41"><a href="rethinking-chapter-15.html#cb1641-41" aria-hidden="true" tabindex="-1"></a>                           <span class="at">max.overlaps =</span> <span class="dv">2</span>,</span>
<span id="cb1641-42"><a href="rethinking-chapter-15.html#cb1641-42" aria-hidden="true" tabindex="-1"></a>                            <span class="at">family =</span> fnt_sel) <span class="sc">+</span></span>
<span id="cb1641-43"><a href="rethinking-chapter-15.html#cb1641-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="fl">2.2</span>), <span class="at">expand =</span> <span class="dv">0</span>)</span>
<span id="cb1641-44"><a href="rethinking-chapter-15.html#cb1641-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1641-45"><a href="rethinking-chapter-15.html#cb1641-45" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-5-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="error-on-both-outcome-and-predictor" class="section level3 hasAnchor" number="16.1.2">
<h3><span class="header-section-number">16.1.2</span> Error on Both Outcome and Predictor<a href="rethinking-chapter-15.html#error-on-both-outcome-and-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1642-1"><a href="rethinking-chapter-15.html#cb1642-1" aria-hidden="true" tabindex="-1"></a>dag2 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(D_obs <span class="sc">~</span> D <span class="sc">+</span> E_D,</span>
<span id="cb1642-2"><a href="rethinking-chapter-15.html#cb1642-2" aria-hidden="true" tabindex="-1"></a>       D <span class="sc">~</span> A <span class="sc">+</span> M,</span>
<span id="cb1642-3"><a href="rethinking-chapter-15.html#cb1642-3" aria-hidden="true" tabindex="-1"></a>       M <span class="sc">~</span> A,</span>
<span id="cb1642-4"><a href="rethinking-chapter-15.html#cb1642-4" aria-hidden="true" tabindex="-1"></a>       M_obs <span class="sc">~</span> M <span class="sc">+</span> E_M,</span>
<span id="cb1642-5"><a href="rethinking-chapter-15.html#cb1642-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1642-6"><a href="rethinking-chapter-15.html#cb1642-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">outcome =</span> <span class="st">&quot;D_obs&quot;</span>,</span>
<span id="cb1642-7"><a href="rethinking-chapter-15.html#cb1642-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;E_D&quot;</span>, <span class="st">&quot;M_obs&quot;</span>,<span class="st">&quot;E_M&quot;</span>),</span>
<span id="cb1642-8"><a href="rethinking-chapter-15.html#cb1642-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>),</span>
<span id="cb1642-9"><a href="rethinking-chapter-15.html#cb1642-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb1642-10"><a href="rethinking-chapter-15.html#cb1642-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1642-11"><a href="rethinking-chapter-15.html#cb1642-11" aria-hidden="true" tabindex="-1"></a>dag2 <span class="sc">%&gt;%</span></span>
<span id="cb1642-12"><a href="rethinking-chapter-15.html#cb1642-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1642-13"><a href="rethinking-chapter-15.html#cb1642-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1642-14"><a href="rethinking-chapter-15.html#cb1642-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M_obs&quot;</span>),</span>
<span id="cb1642-15"><a href="rethinking-chapter-15.html#cb1642-15" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>)),</span>
<span id="cb1642-16"><a href="rethinking-chapter-15.html#cb1642-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">&quot;(.*)_([a-zA-Z]*)&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1[</span><span class="sc">\\</span><span class="st">2]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1642-17"><a href="rethinking-chapter-15.html#cb1642-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1642-18"><a href="rethinking-chapter-15.html#cb1642-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.6</span>)) <span class="sc">+</span></span>
<span id="cb1642-19"><a href="rethinking-chapter-15.html#cb1642-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb1642-20"><a href="rethinking-chapter-15.html#cb1642-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1642-21"><a href="rethinking-chapter-15.html#cb1642-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-6-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math display">\[
\begin{array}{rclr}
D_{\textrm{OBS}, i} &amp; \sim &amp; \textrm{Normal}(D_{\textrm{TRUE}}, D_{\textrm{SE}, i}) &amp; \textrm{[distribution of observed D values]}\\
D_{\textrm{TRUE},i} &amp; \sim &amp; \textrm{Normal}(\mu_{i}, \sigma) &amp; \textrm{[distribution of true D values]}\\
\mu_{i} &amp; = &amp; \alpha + \beta_{A} ~ A_{i} + \color{#B35136}{\beta_{M} ~ M_{\textrm{TRUE}, i}} &amp; \textrm{[linear model]}\\
\color{#B35136}{M_{\textrm{OBS},i}} &amp; \sim &amp; \color{#B35136}{\textrm{Normal}(M_{\textrm{TRUE},i}, M_{\textrm{SE},i})} &amp; \textrm{[distribution of observed M values]}\\
\color{#B35136}{M_{\textrm{TRUE},i}} &amp; \sim &amp; \color{#B35136}{\textrm{Normal}(0,1)} &amp; \textrm{[distribution of true M values]} \\
\alpha &amp; \sim &amp; \textrm{Normal}(0, 0.2) &amp;&amp;\\
\beta_{A} &amp; \sim &amp; \textrm{Normal}(0, 0.5) &amp;&amp;\\
\beta_{M} &amp; \sim &amp; \textrm{Normal}(0, 0.5) &amp;&amp;\\
\sigma &amp; \sim &amp; \textrm{Exponential}(1) &amp;&amp;\\
\end{array}
\]</span></p>
<div class="sourceCode" id="cb1643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1643-1"><a href="rethinking-chapter-15.html#cb1643-1" aria-hidden="true" tabindex="-1"></a>model_divorce_error_out <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1643-2"><a href="rethinking-chapter-15.html#cb1643-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1643-3"><a href="rethinking-chapter-15.html#cb1643-3" aria-hidden="true" tabindex="-1"></a>    divorce_obs <span class="sc">~</span> <span class="fu">dnorm</span>( divorce_true, divorce_sd ),</span>
<span id="cb1643-4"><a href="rethinking-chapter-15.html#cb1643-4" aria-hidden="true" tabindex="-1"></a>    vector[N]<span class="sc">:</span>divorce_true <span class="sc">~</span> <span class="fu">dnorm</span>( mu, sigma ),</span>
<span id="cb1643-5"><a href="rethinking-chapter-15.html#cb1643-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_age <span class="sc">*</span> median_age_std <span class="sc">+</span> beta_marriage <span class="sc">*</span> marriage_true[i],</span>
<span id="cb1643-6"><a href="rethinking-chapter-15.html#cb1643-6" aria-hidden="true" tabindex="-1"></a>    marriage_std <span class="sc">~</span> <span class="fu">dnorm</span>( marriage_true, marriage_sd ),</span>
<span id="cb1643-7"><a href="rethinking-chapter-15.html#cb1643-7" aria-hidden="true" tabindex="-1"></a>    vector[N]<span class="sc">:</span>marriage_true <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1643-8"><a href="rethinking-chapter-15.html#cb1643-8" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.2</span> ),</span>
<span id="cb1643-9"><a href="rethinking-chapter-15.html#cb1643-9" aria-hidden="true" tabindex="-1"></a>    beta_age <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1643-10"><a href="rethinking-chapter-15.html#cb1643-10" aria-hidden="true" tabindex="-1"></a>    beta_marriage <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1643-11"><a href="rethinking-chapter-15.html#cb1643-11" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb1643-12"><a href="rethinking-chapter-15.html#cb1643-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1643-13"><a href="rethinking-chapter-15.html#cb1643-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_waffle_list,</span>
<span id="cb1643-14"><a href="rethinking-chapter-15.html#cb1643-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1643-15"><a href="rethinking-chapter-15.html#cb1643-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1643-16"><a href="rethinking-chapter-15.html#cb1643-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_lik =</span> <span class="cn">TRUE</span></span>
<span id="cb1643-17"><a href="rethinking-chapter-15.html#cb1643-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1644-1"><a href="rethinking-chapter-15.html#cb1644-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract.samples</span>(model_divorce_error_out) <span class="sc">%&gt;%</span> </span>
<span id="cb1644-2"><a href="rethinking-chapter-15.html#cb1644-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1644-3"><a href="rethinking-chapter-15.html#cb1644-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(divorce_true, marriage_true) <span class="sc">%&gt;%</span> </span>
<span id="cb1644-4"><a href="rethinking-chapter-15.html#cb1644-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">divorce_true =</span> <span class="fu">colMeans</span>(<span class="fu">as_tibble</span>(divorce_true)),</span>
<span id="cb1644-5"><a href="rethinking-chapter-15.html#cb1644-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">marriage_true =</span> <span class="fu">colMeans</span>(<span class="fu">as_tibble</span>(marriage_true))) <span class="sc">%&gt;%</span> </span>
<span id="cb1644-6"><a href="rethinking-chapter-15.html#cb1644-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_cols</span>(data_waffle <span class="sc">%&gt;%</span></span>
<span id="cb1644-7"><a href="rethinking-chapter-15.html#cb1644-7" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(Loc, Divorce,divorce_std, divorce_sd,</span>
<span id="cb1644-8"><a href="rethinking-chapter-15.html#cb1644-8" aria-hidden="true" tabindex="-1"></a>                            median_age_std, marriage_std ), .) <span class="sc">%&gt;%</span></span>
<span id="cb1644-9"><a href="rethinking-chapter-15.html#cb1644-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1644-10"><a href="rethinking-chapter-15.html#cb1644-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> marriage_std, <span class="at">xend =</span> marriage_true,</span>
<span id="cb1644-11"><a href="rethinking-chapter-15.html#cb1644-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> divorce_std, <span class="at">yend =</span> divorce_true ),</span>
<span id="cb1644-12"><a href="rethinking-chapter-15.html#cb1644-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> clr0d ) <span class="sc">+</span></span>
<span id="cb1644-13"><a href="rethinking-chapter-15.html#cb1644-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> marriage_std,</span>
<span id="cb1644-14"><a href="rethinking-chapter-15.html#cb1644-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> divorce_std),</span>
<span id="cb1644-15"><a href="rethinking-chapter-15.html#cb1644-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0,</span>
<span id="cb1644-16"><a href="rethinking-chapter-15.html#cb1644-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1644-17"><a href="rethinking-chapter-15.html#cb1644-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> marriage_true,</span>
<span id="cb1644-18"><a href="rethinking-chapter-15.html#cb1644-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> divorce_true), </span>
<span id="cb1644-19"><a href="rethinking-chapter-15.html#cb1644-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_current, <span class="at">fill =</span> <span class="fu">clr_lighten</span>(clr_current),</span>
<span id="cb1644-20"><a href="rethinking-chapter-15.html#cb1644-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1644-21"><a href="rethinking-chapter-15.html#cb1644-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;shrinkage of both marriage rate and divorce rate&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-8-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="measurement-terrors" class="section level3 hasAnchor" number="16.1.3">
<h3><span class="header-section-number">16.1.3</span> Measurement Terrors<a href="rethinking-chapter-15.html#measurement-terrors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1645-1"><a href="rethinking-chapter-15.html#cb1645-1" aria-hidden="true" tabindex="-1"></a>dag3 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(D_obs <span class="sc">~</span> D <span class="sc">+</span> E_D,</span>
<span id="cb1645-2"><a href="rethinking-chapter-15.html#cb1645-2" aria-hidden="true" tabindex="-1"></a>       D <span class="sc">~</span> A <span class="sc">+</span> M,</span>
<span id="cb1645-3"><a href="rethinking-chapter-15.html#cb1645-3" aria-hidden="true" tabindex="-1"></a>       M <span class="sc">~</span> A,</span>
<span id="cb1645-4"><a href="rethinking-chapter-15.html#cb1645-4" aria-hidden="true" tabindex="-1"></a>       M_obs <span class="sc">~</span> M <span class="sc">+</span> E_M,</span>
<span id="cb1645-5"><a href="rethinking-chapter-15.html#cb1645-5" aria-hidden="true" tabindex="-1"></a>       E_M <span class="sc">~</span> P,</span>
<span id="cb1645-6"><a href="rethinking-chapter-15.html#cb1645-6" aria-hidden="true" tabindex="-1"></a>       E_D <span class="sc">~</span> P,</span>
<span id="cb1645-7"><a href="rethinking-chapter-15.html#cb1645-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1645-8"><a href="rethinking-chapter-15.html#cb1645-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">outcome =</span> <span class="st">&quot;D_obs&quot;</span>,</span>
<span id="cb1645-9"><a href="rethinking-chapter-15.html#cb1645-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;E_D&quot;</span>, <span class="st">&quot;M_obs&quot;</span>,<span class="st">&quot;E_M&quot;</span>, <span class="st">&quot;P&quot;</span>),</span>
<span id="cb1645-10"><a href="rethinking-chapter-15.html#cb1645-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>),</span>
<span id="cb1645-11"><a href="rethinking-chapter-15.html#cb1645-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">5</span>)))</span>
<span id="cb1645-12"><a href="rethinking-chapter-15.html#cb1645-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1645-13"><a href="rethinking-chapter-15.html#cb1645-13" aria-hidden="true" tabindex="-1"></a>dag3 <span class="sc">%&gt;%</span></span>
<span id="cb1645-14"><a href="rethinking-chapter-15.html#cb1645-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1645-15"><a href="rethinking-chapter-15.html#cb1645-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1645-16"><a href="rethinking-chapter-15.html#cb1645-16" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M_obs&quot;</span>, <span class="st">&quot;P&quot;</span>),</span>
<span id="cb1645-17"><a href="rethinking-chapter-15.html#cb1645-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>)),</span>
<span id="cb1645-18"><a href="rethinking-chapter-15.html#cb1645-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">&quot;(.*)_([a-zA-Z]*)&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1[</span><span class="sc">\\</span><span class="st">2]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1645-19"><a href="rethinking-chapter-15.html#cb1645-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1645-20"><a href="rethinking-chapter-15.html#cb1645-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">6</span>,</span>
<span id="cb1645-21"><a href="rethinking-chapter-15.html#cb1645-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">2.1</span>),</span>
<span id="cb1645-22"><a href="rethinking-chapter-15.html#cb1645-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb1645-23"><a href="rethinking-chapter-15.html#cb1645-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-9-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1646-1"><a href="rethinking-chapter-15.html#cb1646-1" aria-hidden="true" tabindex="-1"></a>dag4 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(D_obs <span class="sc">~</span> D <span class="sc">+</span> E_D,</span>
<span id="cb1646-2"><a href="rethinking-chapter-15.html#cb1646-2" aria-hidden="true" tabindex="-1"></a>       D <span class="sc">~</span> A <span class="sc">+</span> M,</span>
<span id="cb1646-3"><a href="rethinking-chapter-15.html#cb1646-3" aria-hidden="true" tabindex="-1"></a>       M <span class="sc">~</span> A,</span>
<span id="cb1646-4"><a href="rethinking-chapter-15.html#cb1646-4" aria-hidden="true" tabindex="-1"></a>       M_obs <span class="sc">~</span> M <span class="sc">+</span> E_M,</span>
<span id="cb1646-5"><a href="rethinking-chapter-15.html#cb1646-5" aria-hidden="true" tabindex="-1"></a>       E_D <span class="sc">~</span> M,</span>
<span id="cb1646-6"><a href="rethinking-chapter-15.html#cb1646-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1646-7"><a href="rethinking-chapter-15.html#cb1646-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">outcome =</span> <span class="st">&quot;D_obs&quot;</span>,</span>
<span id="cb1646-8"><a href="rethinking-chapter-15.html#cb1646-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;E_D&quot;</span>, <span class="st">&quot;M_obs&quot;</span>,<span class="st">&quot;E_M&quot;</span>),</span>
<span id="cb1646-9"><a href="rethinking-chapter-15.html#cb1646-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>),</span>
<span id="cb1646-10"><a href="rethinking-chapter-15.html#cb1646-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb1646-11"><a href="rethinking-chapter-15.html#cb1646-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1646-12"><a href="rethinking-chapter-15.html#cb1646-12" aria-hidden="true" tabindex="-1"></a>dag4 <span class="sc">%&gt;%</span></span>
<span id="cb1646-13"><a href="rethinking-chapter-15.html#cb1646-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1646-14"><a href="rethinking-chapter-15.html#cb1646-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1646-15"><a href="rethinking-chapter-15.html#cb1646-15" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M_obs&quot;</span>, <span class="st">&quot;P&quot;</span>),</span>
<span id="cb1646-16"><a href="rethinking-chapter-15.html#cb1646-16" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>)),</span>
<span id="cb1646-17"><a href="rethinking-chapter-15.html#cb1646-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">&quot;(.*)_([a-zA-Z]*)&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1[</span><span class="sc">\\</span><span class="st">2]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1646-18"><a href="rethinking-chapter-15.html#cb1646-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1646-19"><a href="rethinking-chapter-15.html#cb1646-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">6</span>,</span>
<span id="cb1646-20"><a href="rethinking-chapter-15.html#cb1646-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.6</span>),</span>
<span id="cb1646-21"><a href="rethinking-chapter-15.html#cb1646-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb1646-22"><a href="rethinking-chapter-15.html#cb1646-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-10-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1647-1"><a href="rethinking-chapter-15.html#cb1647-1" aria-hidden="true" tabindex="-1"></a>dag5 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb1647-2"><a href="rethinking-chapter-15.html#cb1647-2" aria-hidden="true" tabindex="-1"></a>  A_obs <span class="sc">~</span> A <span class="sc">+</span> E_A,</span>
<span id="cb1647-3"><a href="rethinking-chapter-15.html#cb1647-3" aria-hidden="true" tabindex="-1"></a>  M <span class="sc">~</span> A,</span>
<span id="cb1647-4"><a href="rethinking-chapter-15.html#cb1647-4" aria-hidden="true" tabindex="-1"></a>  D <span class="sc">~</span> A,</span>
<span id="cb1647-5"><a href="rethinking-chapter-15.html#cb1647-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1647-6"><a href="rethinking-chapter-15.html#cb1647-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;A&quot;</span>,</span>
<span id="cb1647-7"><a href="rethinking-chapter-15.html#cb1647-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;E_A&quot;</span>, <span class="st">&quot;A_obs&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;D&quot;</span>),</span>
<span id="cb1647-8"><a href="rethinking-chapter-15.html#cb1647-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span> ),</span>
<span id="cb1647-9"><a href="rethinking-chapter-15.html#cb1647-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb1647-10"><a href="rethinking-chapter-15.html#cb1647-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1647-11"><a href="rethinking-chapter-15.html#cb1647-11" aria-hidden="true" tabindex="-1"></a>dag5 <span class="sc">%&gt;%</span></span>
<span id="cb1647-12"><a href="rethinking-chapter-15.html#cb1647-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1647-13"><a href="rethinking-chapter-15.html#cb1647-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1647-14"><a href="rethinking-chapter-15.html#cb1647-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A_obs&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;D&quot;</span>),</span>
<span id="cb1647-15"><a href="rethinking-chapter-15.html#cb1647-15" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>)),</span>
<span id="cb1647-16"><a href="rethinking-chapter-15.html#cb1647-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">&quot;(.*)_([a-zA-Z]*)&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1[</span><span class="sc">\\</span><span class="st">2]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1647-17"><a href="rethinking-chapter-15.html#cb1647-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1647-18"><a href="rethinking-chapter-15.html#cb1647-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">6</span>,</span>
<span id="cb1647-19"><a href="rethinking-chapter-15.html#cb1647-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.6</span>),</span>
<span id="cb1647-20"><a href="rethinking-chapter-15.html#cb1647-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb1647-21"><a href="rethinking-chapter-15.html#cb1647-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-11-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1648-1"><a href="rethinking-chapter-15.html#cb1648-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb1648-2"><a href="rethinking-chapter-15.html#cb1648-2" aria-hidden="true" tabindex="-1"></a>data_sim <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">age =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb1648-3"><a href="rethinking-chapter-15.html#cb1648-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">marriage =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="sc">-</span>age),</span>
<span id="cb1648-4"><a href="rethinking-chapter-15.html#cb1648-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">divorce =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> age),</span>
<span id="cb1648-5"><a href="rethinking-chapter-15.html#cb1648-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">age_obs =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> age))</span></code></pre></div>
</div>
</div>
<div id="missing-data" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> Missing Data<a href="rethinking-chapter-15.html#missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="dag-ate-my-homework" class="section level3 hasAnchor" number="16.2.1">
<h3><span class="header-section-number">16.2.1</span> DAG ate my Homework<a href="rethinking-chapter-15.html#dag-ate-my-homework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1649-1"><a href="rethinking-chapter-15.html#cb1649-1" aria-hidden="true" tabindex="-1"></a>annotate_dag <span class="ot">&lt;-</span> <span class="cf">function</span>(dag){</span>
<span id="cb1649-2"><a href="rethinking-chapter-15.html#cb1649-2" aria-hidden="true" tabindex="-1"></a>  dag <span class="sc">%&gt;%</span></span>
<span id="cb1649-3"><a href="rethinking-chapter-15.html#cb1649-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1649-4"><a href="rethinking-chapter-15.html#cb1649-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;Hs&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1649-5"><a href="rethinking-chapter-15.html#cb1649-5" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;D&quot;</span>),</span>
<span id="cb1649-6"><a href="rethinking-chapter-15.html#cb1649-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>)),</span>
<span id="cb1649-7"><a href="rethinking-chapter-15.html#cb1649-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">&quot;Hs&quot;</span>,<span class="st">&quot;H^&#39;*&#39;&quot;</span>))</span>
<span id="cb1649-8"><a href="rethinking-chapter-15.html#cb1649-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1649-9"><a href="rethinking-chapter-15.html#cb1649-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1649-10"><a href="rethinking-chapter-15.html#cb1649-10" aria-hidden="true" tabindex="-1"></a>dag6 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb1649-11"><a href="rethinking-chapter-15.html#cb1649-11" aria-hidden="true" tabindex="-1"></a>  Hs <span class="sc">~</span> H <span class="sc">+</span> D,</span>
<span id="cb1649-12"><a href="rethinking-chapter-15.html#cb1649-12" aria-hidden="true" tabindex="-1"></a>  H <span class="sc">~</span> S,</span>
<span id="cb1649-13"><a href="rethinking-chapter-15.html#cb1649-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;S&quot;</span>,</span>
<span id="cb1649-14"><a href="rethinking-chapter-15.html#cb1649-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;Hs&quot;</span>,</span>
<span id="cb1649-15"><a href="rethinking-chapter-15.html#cb1649-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Hs&quot;</span>),</span>
<span id="cb1649-16"><a href="rethinking-chapter-15.html#cb1649-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1649-17"><a href="rethinking-chapter-15.html#cb1649-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span> ))) <span class="sc">%&gt;%</span> </span>
<span id="cb1649-18"><a href="rethinking-chapter-15.html#cb1649-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate_dag</span>()</span>
<span id="cb1649-19"><a href="rethinking-chapter-15.html#cb1649-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1649-20"><a href="rethinking-chapter-15.html#cb1649-20" aria-hidden="true" tabindex="-1"></a>dag7 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb1649-21"><a href="rethinking-chapter-15.html#cb1649-21" aria-hidden="true" tabindex="-1"></a>  Hs <span class="sc">~</span> H <span class="sc">+</span> D,</span>
<span id="cb1649-22"><a href="rethinking-chapter-15.html#cb1649-22" aria-hidden="true" tabindex="-1"></a>  H <span class="sc">~</span> S,</span>
<span id="cb1649-23"><a href="rethinking-chapter-15.html#cb1649-23" aria-hidden="true" tabindex="-1"></a>  D <span class="sc">~</span> S,</span>
<span id="cb1649-24"><a href="rethinking-chapter-15.html#cb1649-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;S&quot;</span>,</span>
<span id="cb1649-25"><a href="rethinking-chapter-15.html#cb1649-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;Hs&quot;</span>,</span>
<span id="cb1649-26"><a href="rethinking-chapter-15.html#cb1649-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Hs&quot;</span>),</span>
<span id="cb1649-27"><a href="rethinking-chapter-15.html#cb1649-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1649-28"><a href="rethinking-chapter-15.html#cb1649-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span> ))) <span class="sc">%&gt;%</span> </span>
<span id="cb1649-29"><a href="rethinking-chapter-15.html#cb1649-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate_dag</span>()</span>
<span id="cb1649-30"><a href="rethinking-chapter-15.html#cb1649-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1649-31"><a href="rethinking-chapter-15.html#cb1649-31" aria-hidden="true" tabindex="-1"></a>dag8 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb1649-32"><a href="rethinking-chapter-15.html#cb1649-32" aria-hidden="true" tabindex="-1"></a>  Hs <span class="sc">~</span> H <span class="sc">+</span> D,</span>
<span id="cb1649-33"><a href="rethinking-chapter-15.html#cb1649-33" aria-hidden="true" tabindex="-1"></a>  H <span class="sc">~</span> S <span class="sc">+</span> X,</span>
<span id="cb1649-34"><a href="rethinking-chapter-15.html#cb1649-34" aria-hidden="true" tabindex="-1"></a>  D <span class="sc">~</span> X,</span>
<span id="cb1649-35"><a href="rethinking-chapter-15.html#cb1649-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;S&quot;</span>,</span>
<span id="cb1649-36"><a href="rethinking-chapter-15.html#cb1649-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;Hs&quot;</span>,</span>
<span id="cb1649-37"><a href="rethinking-chapter-15.html#cb1649-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Hs&quot;</span>, <span class="st">&quot;X&quot;</span>),</span>
<span id="cb1649-38"><a href="rethinking-chapter-15.html#cb1649-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">5</span> ),</span>
<span id="cb1649-39"><a href="rethinking-chapter-15.html#cb1649-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">5</span> ))) <span class="sc">%&gt;%</span> </span>
<span id="cb1649-40"><a href="rethinking-chapter-15.html#cb1649-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate_dag</span>()</span>
<span id="cb1649-41"><a href="rethinking-chapter-15.html#cb1649-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1649-42"><a href="rethinking-chapter-15.html#cb1649-42" aria-hidden="true" tabindex="-1"></a>dag9 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb1649-43"><a href="rethinking-chapter-15.html#cb1649-43" aria-hidden="true" tabindex="-1"></a>  Hs <span class="sc">~</span> H <span class="sc">+</span> D,</span>
<span id="cb1649-44"><a href="rethinking-chapter-15.html#cb1649-44" aria-hidden="true" tabindex="-1"></a>  H <span class="sc">~</span> S,</span>
<span id="cb1649-45"><a href="rethinking-chapter-15.html#cb1649-45" aria-hidden="true" tabindex="-1"></a>  D <span class="sc">~</span> H,</span>
<span id="cb1649-46"><a href="rethinking-chapter-15.html#cb1649-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;S&quot;</span>,</span>
<span id="cb1649-47"><a href="rethinking-chapter-15.html#cb1649-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;Hs&quot;</span>,</span>
<span id="cb1649-48"><a href="rethinking-chapter-15.html#cb1649-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Hs&quot;</span>),</span>
<span id="cb1649-49"><a href="rethinking-chapter-15.html#cb1649-49" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1649-50"><a href="rethinking-chapter-15.html#cb1649-50" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span> ))) <span class="sc">%&gt;%</span> </span>
<span id="cb1649-51"><a href="rethinking-chapter-15.html#cb1649-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate_dag</span>()</span>
<span id="cb1649-52"><a href="rethinking-chapter-15.html#cb1649-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1649-53"><a href="rethinking-chapter-15.html#cb1649-53" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(dag6, dag7, dag8, dag9)  <span class="sc">%&gt;%</span> </span>
<span id="cb1649-54"><a href="rethinking-chapter-15.html#cb1649-54" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(plot_dag, <span class="at">clr_in =</span> clr_current) <span class="sc">%&gt;%</span> </span>
<span id="cb1649-55"><a href="rethinking-chapter-15.html#cb1649-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_plots</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">tag_level =</span> <span class="st">&quot;new&quot;</span>) <span class="sc">+</span></span>
<span id="cb1649-56"><a href="rethinking-chapter-15.html#cb1649-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;a&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb1649-57"><a href="rethinking-chapter-15.html#cb1649-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">6</span>,</span>
<span id="cb1649-58"><a href="rethinking-chapter-15.html#cb1649-58" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1649-59"><a href="rethinking-chapter-15.html#cb1649-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="sc">&amp;</span></span>
<span id="cb1649-60"><a href="rethinking-chapter-15.html#cb1649-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel),</span>
<span id="cb1649-61"><a href="rethinking-chapter-15.html#cb1649-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-13-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1650-1"><a href="rethinking-chapter-15.html#cb1650-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1650-2"><a href="rethinking-chapter-15.html#cb1650-2" aria-hidden="true" tabindex="-1"></a>data_homework_a <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1650-3"><a href="rethinking-chapter-15.html#cb1650-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">study =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb1650-4"><a href="rethinking-chapter-15.html#cb1650-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">homework =</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">10</span> , <span class="fu">inv_logit</span>(study)),</span>
<span id="cb1650-5"><a href="rethinking-chapter-15.html#cb1650-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dog =</span> <span class="fu">rbern</span>( n ),</span>
<span id="cb1650-6"><a href="rethinking-chapter-15.html#cb1650-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">homework_missing =</span> <span class="fu">if_else</span>(dog <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA_integer_</span> , homework))</span>
<span id="cb1650-7"><a href="rethinking-chapter-15.html#cb1650-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1650-8"><a href="rethinking-chapter-15.html#cb1650-8" aria-hidden="true" tabindex="-1"></a>data_homework_b <span class="ot">&lt;-</span> data_homework_a <span class="sc">%&gt;%</span> </span>
<span id="cb1650-9"><a href="rethinking-chapter-15.html#cb1650-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dog =</span> <span class="fu">as.integer</span>(study <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb1650-10"><a href="rethinking-chapter-15.html#cb1650-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">homework_missing =</span> <span class="fu">if_else</span>(dog <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA_integer_</span> , homework))</span>
<span id="cb1650-11"><a href="rethinking-chapter-15.html#cb1650-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1650-12"><a href="rethinking-chapter-15.html#cb1650-12" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb1650-13"><a href="rethinking-chapter-15.html#cb1650-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1650-14"><a href="rethinking-chapter-15.html#cb1650-14" aria-hidden="true" tabindex="-1"></a>data_homework_c <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1650-15"><a href="rethinking-chapter-15.html#cb1650-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb1650-16"><a href="rethinking-chapter-15.html#cb1650-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">study =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb1650-17"><a href="rethinking-chapter-15.html#cb1650-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">homework =</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">10</span> , <span class="fu">inv_logit</span>(<span class="dv">2</span> <span class="sc">+</span> study <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> x )),</span>
<span id="cb1650-18"><a href="rethinking-chapter-15.html#cb1650-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">dog =</span> <span class="fu">as.integer</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb1650-19"><a href="rethinking-chapter-15.html#cb1650-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">homework_missing =</span> <span class="fu">if_else</span>(dog <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA_integer_</span> , homework))</span></code></pre></div>
<div class="sourceCode" id="cb1651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1651-1"><a href="rethinking-chapter-15.html#cb1651-1" aria-hidden="true" tabindex="-1"></a>data_homework_c_list <span class="ot">&lt;-</span> data_homework_c <span class="sc">%&gt;%</span> </span>
<span id="cb1651-2"><a href="rethinking-chapter-15.html#cb1651-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(study, homework) <span class="sc">%&gt;%</span> </span>
<span id="cb1651-3"><a href="rethinking-chapter-15.html#cb1651-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1651-4"><a href="rethinking-chapter-15.html#cb1651-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1651-5"><a href="rethinking-chapter-15.html#cb1651-5" aria-hidden="true" tabindex="-1"></a>model_hw_full <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1651-6"><a href="rethinking-chapter-15.html#cb1651-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1651-7"><a href="rethinking-chapter-15.html#cb1651-7" aria-hidden="true" tabindex="-1"></a>    homework <span class="sc">~</span> <span class="fu">binomial</span>( <span class="dv">10</span>, p ),</span>
<span id="cb1651-8"><a href="rethinking-chapter-15.html#cb1651-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_study <span class="sc">*</span> study,</span>
<span id="cb1651-9"><a href="rethinking-chapter-15.html#cb1651-9" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1651-10"><a href="rethinking-chapter-15.html#cb1651-10" aria-hidden="true" tabindex="-1"></a>    beta_study <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="fl">0.5</span> )</span>
<span id="cb1651-11"><a href="rethinking-chapter-15.html#cb1651-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1651-12"><a href="rethinking-chapter-15.html#cb1651-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_homework_c_list,</span>
<span id="cb1651-13"><a href="rethinking-chapter-15.html#cb1651-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1651-14"><a href="rethinking-chapter-15.html#cb1651-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1651-15"><a href="rethinking-chapter-15.html#cb1651-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb1651-16"><a href="rethinking-chapter-15.html#cb1651-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1652-1"><a href="rethinking-chapter-15.html#cb1652-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_hw_full) <span class="sc">%&gt;%</span> </span>
<span id="cb1652-2"><a href="rethinking-chapter-15.html#cb1652-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">1.26</td>
<td align="right">0.02</td>
<td align="right">1.22</td>
<td align="right">1.29</td>
<td align="right">1264.47</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_study</td>
<td align="right">0.61</td>
<td align="right">0.03</td>
<td align="right">0.57</td>
<td align="right">0.65</td>
<td align="right">1051.59</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1653-1"><a href="rethinking-chapter-15.html#cb1653-1" aria-hidden="true" tabindex="-1"></a>data_homework_c_list2 <span class="ot">&lt;-</span> data_homework_c <span class="sc">%&gt;%</span></span>
<span id="cb1653-2"><a href="rethinking-chapter-15.html#cb1653-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(homework_missing)) <span class="sc">%&gt;%</span> </span>
<span id="cb1653-3"><a href="rethinking-chapter-15.html#cb1653-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(study, homework) <span class="sc">%&gt;%</span> </span>
<span id="cb1653-4"><a href="rethinking-chapter-15.html#cb1653-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1653-5"><a href="rethinking-chapter-15.html#cb1653-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1653-6"><a href="rethinking-chapter-15.html#cb1653-6" aria-hidden="true" tabindex="-1"></a>model_hw_missing <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1653-7"><a href="rethinking-chapter-15.html#cb1653-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1653-8"><a href="rethinking-chapter-15.html#cb1653-8" aria-hidden="true" tabindex="-1"></a>    homework <span class="sc">~</span> <span class="fu">binomial</span>( <span class="dv">10</span>, p ),</span>
<span id="cb1653-9"><a href="rethinking-chapter-15.html#cb1653-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_study <span class="sc">*</span> study,</span>
<span id="cb1653-10"><a href="rethinking-chapter-15.html#cb1653-10" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1653-11"><a href="rethinking-chapter-15.html#cb1653-11" aria-hidden="true" tabindex="-1"></a>    beta_study <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="fl">0.5</span> )</span>
<span id="cb1653-12"><a href="rethinking-chapter-15.html#cb1653-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1653-13"><a href="rethinking-chapter-15.html#cb1653-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_homework_c_list2,</span>
<span id="cb1653-14"><a href="rethinking-chapter-15.html#cb1653-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1653-15"><a href="rethinking-chapter-15.html#cb1653-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1653-16"><a href="rethinking-chapter-15.html#cb1653-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb1653-17"><a href="rethinking-chapter-15.html#cb1653-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1654-1"><a href="rethinking-chapter-15.html#cb1654-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_hw_missing) <span class="sc">%&gt;%</span> </span>
<span id="cb1654-2"><a href="rethinking-chapter-15.html#cb1654-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">3.06</td>
<td align="right">0.07</td>
<td align="right">2.94</td>
<td align="right">3.18</td>
<td align="right">767.92</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">beta_study</td>
<td align="right">0.89</td>
<td align="right">0.06</td>
<td align="right">0.80</td>
<td align="right">1.00</td>
<td align="right">680.65</td>
<td align="right">1.01</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1655-1"><a href="rethinking-chapter-15.html#cb1655-1" aria-hidden="true" tabindex="-1"></a>data_homework_c_list3 <span class="ot">&lt;-</span> data_homework_c <span class="sc">%&gt;%</span></span>
<span id="cb1655-2"><a href="rethinking-chapter-15.html#cb1655-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dog =</span> <span class="fu">as.integer</span>(<span class="fu">abs</span>(x) <span class="sc">&lt;</span> <span class="dv">1</span> ),</span>
<span id="cb1655-3"><a href="rethinking-chapter-15.html#cb1655-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">homework_missing =</span> <span class="fu">if_else</span>(dog <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA_integer_</span> , homework)) <span class="sc">%&gt;%</span> </span>
<span id="cb1655-4"><a href="rethinking-chapter-15.html#cb1655-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(homework_missing)) <span class="sc">%&gt;%</span> </span>
<span id="cb1655-5"><a href="rethinking-chapter-15.html#cb1655-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(study, homework) <span class="sc">%&gt;%</span> </span>
<span id="cb1655-6"><a href="rethinking-chapter-15.html#cb1655-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1655-7"><a href="rethinking-chapter-15.html#cb1655-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1655-8"><a href="rethinking-chapter-15.html#cb1655-8" aria-hidden="true" tabindex="-1"></a>model_hw_opposite_effect <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1655-9"><a href="rethinking-chapter-15.html#cb1655-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1655-10"><a href="rethinking-chapter-15.html#cb1655-10" aria-hidden="true" tabindex="-1"></a>    homework <span class="sc">~</span> <span class="fu">binomial</span>( <span class="dv">10</span>, p ),</span>
<span id="cb1655-11"><a href="rethinking-chapter-15.html#cb1655-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_study <span class="sc">*</span> study,</span>
<span id="cb1655-12"><a href="rethinking-chapter-15.html#cb1655-12" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1655-13"><a href="rethinking-chapter-15.html#cb1655-13" aria-hidden="true" tabindex="-1"></a>    beta_study <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="fl">0.5</span> )</span>
<span id="cb1655-14"><a href="rethinking-chapter-15.html#cb1655-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1655-15"><a href="rethinking-chapter-15.html#cb1655-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_homework_c_list3,</span>
<span id="cb1655-16"><a href="rethinking-chapter-15.html#cb1655-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1655-17"><a href="rethinking-chapter-15.html#cb1655-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1655-18"><a href="rethinking-chapter-15.html#cb1655-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb1655-19"><a href="rethinking-chapter-15.html#cb1655-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1656-1"><a href="rethinking-chapter-15.html#cb1656-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_hw_opposite_effect) <span class="sc">%&gt;%</span> </span>
<span id="cb1656-2"><a href="rethinking-chapter-15.html#cb1656-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.73</td>
<td align="right">0.04</td>
<td align="right">0.67</td>
<td align="right">0.79</td>
<td align="right">1448.69</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_study</td>
<td align="right">0.35</td>
<td align="right">0.04</td>
<td align="right">0.29</td>
<td align="right">0.41</td>
<td align="right">1329.66</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1657-1"><a href="rethinking-chapter-15.html#cb1657-1" aria-hidden="true" tabindex="-1"></a>data_homework_d <span class="ot">&lt;-</span> data_homework_a <span class="sc">%&gt;%</span> </span>
<span id="cb1657-2"><a href="rethinking-chapter-15.html#cb1657-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dog =</span> <span class="fu">as.integer</span>(homework <span class="sc">&lt;</span> <span class="dv">5</span>),</span>
<span id="cb1657-3"><a href="rethinking-chapter-15.html#cb1657-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">homework_missing =</span> <span class="fu">if_else</span>(dog <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA_integer_</span> , homework))</span>
<span id="cb1657-4"><a href="rethinking-chapter-15.html#cb1657-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1657-5"><a href="rethinking-chapter-15.html#cb1657-5" aria-hidden="true" tabindex="-1"></a>data_homework_c_list4 <span class="ot">&lt;-</span> data_homework_d <span class="sc">%&gt;%</span></span>
<span id="cb1657-6"><a href="rethinking-chapter-15.html#cb1657-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(homework_missing)) <span class="sc">%&gt;%</span> </span>
<span id="cb1657-7"><a href="rethinking-chapter-15.html#cb1657-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(study, homework) <span class="sc">%&gt;%</span> </span>
<span id="cb1657-8"><a href="rethinking-chapter-15.html#cb1657-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1657-9"><a href="rethinking-chapter-15.html#cb1657-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1657-10"><a href="rethinking-chapter-15.html#cb1657-10" aria-hidden="true" tabindex="-1"></a>model_hw_unfixable <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1657-11"><a href="rethinking-chapter-15.html#cb1657-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1657-12"><a href="rethinking-chapter-15.html#cb1657-12" aria-hidden="true" tabindex="-1"></a>    homework <span class="sc">~</span> <span class="fu">binomial</span>( <span class="dv">10</span>, p ),</span>
<span id="cb1657-13"><a href="rethinking-chapter-15.html#cb1657-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_study <span class="sc">*</span> study,</span>
<span id="cb1657-14"><a href="rethinking-chapter-15.html#cb1657-14" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1657-15"><a href="rethinking-chapter-15.html#cb1657-15" aria-hidden="true" tabindex="-1"></a>    beta_study <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="fl">0.5</span> )</span>
<span id="cb1657-16"><a href="rethinking-chapter-15.html#cb1657-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1657-17"><a href="rethinking-chapter-15.html#cb1657-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_homework_c_list4,</span>
<span id="cb1657-18"><a href="rethinking-chapter-15.html#cb1657-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1657-19"><a href="rethinking-chapter-15.html#cb1657-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1657-20"><a href="rethinking-chapter-15.html#cb1657-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb1657-21"><a href="rethinking-chapter-15.html#cb1657-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1658-1"><a href="rethinking-chapter-15.html#cb1658-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_hw_unfixable) <span class="sc">%&gt;%</span> </span>
<span id="cb1658-2"><a href="rethinking-chapter-15.html#cb1658-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.44</td>
<td align="right">0.10</td>
<td align="right">0.29</td>
<td align="right">0.60</td>
<td align="right">640.41</td>
<td align="right">1.01</td>
</tr>
<tr class="even">
<td align="left">beta_study</td>
<td align="right">0.50</td>
<td align="right">0.11</td>
<td align="right">0.33</td>
<td align="right">0.68</td>
<td align="right">727.25</td>
<td align="right">1.01</td>
</tr>
</tbody>
</table>
</div>
<div id="imputing-primates" class="section level3 hasAnchor" number="16.2.2">
<h3><span class="header-section-number">16.2.2</span> Imputing Primates<a href="rethinking-chapter-15.html#imputing-primates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1659-1"><a href="rethinking-chapter-15.html#cb1659-1" aria-hidden="true" tabindex="-1"></a>dag10 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb1659-2"><a href="rethinking-chapter-15.html#cb1659-2" aria-hidden="true" tabindex="-1"></a>  K <span class="sc">~</span> M <span class="sc">+</span> B,</span>
<span id="cb1659-3"><a href="rethinking-chapter-15.html#cb1659-3" aria-hidden="true" tabindex="-1"></a>  B <span class="sc">~</span> U,</span>
<span id="cb1659-4"><a href="rethinking-chapter-15.html#cb1659-4" aria-hidden="true" tabindex="-1"></a>  M <span class="sc">~</span> U,</span>
<span id="cb1659-5"><a href="rethinking-chapter-15.html#cb1659-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1659-6"><a href="rethinking-chapter-15.html#cb1659-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;K&quot;</span>,</span>
<span id="cb1659-7"><a href="rethinking-chapter-15.html#cb1659-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb1659-8"><a href="rethinking-chapter-15.html#cb1659-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span> ),</span>
<span id="cb1659-9"><a href="rethinking-chapter-15.html#cb1659-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb1659-10"><a href="rethinking-chapter-15.html#cb1659-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1659-11"><a href="rethinking-chapter-15.html#cb1659-11" aria-hidden="true" tabindex="-1"></a>dag10 <span class="sc">%&gt;%</span></span>
<span id="cb1659-12"><a href="rethinking-chapter-15.html#cb1659-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1659-13"><a href="rethinking-chapter-15.html#cb1659-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;K&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1659-14"><a href="rethinking-chapter-15.html#cb1659-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb1659-15"><a href="rethinking-chapter-15.html#cb1659-15" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1659-16"><a href="rethinking-chapter-15.html#cb1659-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1659-17"><a href="rethinking-chapter-15.html#cb1659-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">6</span>,</span>
<span id="cb1659-18"><a href="rethinking-chapter-15.html#cb1659-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1659-19"><a href="rethinking-chapter-15.html#cb1659-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb1659-20"><a href="rethinking-chapter-15.html#cb1659-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-23-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1660-1"><a href="rethinking-chapter-15.html#cb1660-1" aria-hidden="true" tabindex="-1"></a>primate_dag <span class="ot">&lt;-</span> <span class="cf">function</span>(dag){</span>
<span id="cb1660-2"><a href="rethinking-chapter-15.html#cb1660-2" aria-hidden="true" tabindex="-1"></a>  dag <span class="sc">%&gt;%</span></span>
<span id="cb1660-3"><a href="rethinking-chapter-15.html#cb1660-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1660-4"><a href="rethinking-chapter-15.html#cb1660-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;K&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1660-5"><a href="rethinking-chapter-15.html#cb1660-5" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;Bs&quot;</span>, <span class="st">&quot;Rb&quot;</span>),</span>
<span id="cb1660-6"><a href="rethinking-chapter-15.html#cb1660-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>)),</span>
<span id="cb1660-7"><a href="rethinking-chapter-15.html#cb1660-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">&quot;Bs&quot;</span>,<span class="st">&quot;B^&#39;*&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1660-8"><a href="rethinking-chapter-15.html#cb1660-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_replace</span>( <span class="st">&quot;Rb&quot;</span>,<span class="st">&quot;R[B]&quot;</span>) )</span>
<span id="cb1660-9"><a href="rethinking-chapter-15.html#cb1660-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1660-10"><a href="rethinking-chapter-15.html#cb1660-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1660-11"><a href="rethinking-chapter-15.html#cb1660-11" aria-hidden="true" tabindex="-1"></a>dag11 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb1660-12"><a href="rethinking-chapter-15.html#cb1660-12" aria-hidden="true" tabindex="-1"></a>  K <span class="sc">~</span> M <span class="sc">+</span> B,</span>
<span id="cb1660-13"><a href="rethinking-chapter-15.html#cb1660-13" aria-hidden="true" tabindex="-1"></a>  B <span class="sc">~</span> U,</span>
<span id="cb1660-14"><a href="rethinking-chapter-15.html#cb1660-14" aria-hidden="true" tabindex="-1"></a>  M <span class="sc">~</span> U,</span>
<span id="cb1660-15"><a href="rethinking-chapter-15.html#cb1660-15" aria-hidden="true" tabindex="-1"></a>  Bs <span class="sc">~</span> B <span class="sc">+</span> Rb,</span>
<span id="cb1660-16"><a href="rethinking-chapter-15.html#cb1660-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1660-17"><a href="rethinking-chapter-15.html#cb1660-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;K&quot;</span>,</span>
<span id="cb1660-18"><a href="rethinking-chapter-15.html#cb1660-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;Bs&quot;</span>, <span class="st">&quot;Rb&quot;</span>),</span>
<span id="cb1660-19"><a href="rethinking-chapter-15.html#cb1660-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">5</span> ),</span>
<span id="cb1660-20"><a href="rethinking-chapter-15.html#cb1660-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>, <span class="dv">0</span>, .<span class="dv">75</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1660-21"><a href="rethinking-chapter-15.html#cb1660-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">primate_dag</span>()</span>
<span id="cb1660-22"><a href="rethinking-chapter-15.html#cb1660-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1660-23"><a href="rethinking-chapter-15.html#cb1660-23" aria-hidden="true" tabindex="-1"></a>dag12 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb1660-24"><a href="rethinking-chapter-15.html#cb1660-24" aria-hidden="true" tabindex="-1"></a>  K <span class="sc">~</span> M <span class="sc">+</span> B,</span>
<span id="cb1660-25"><a href="rethinking-chapter-15.html#cb1660-25" aria-hidden="true" tabindex="-1"></a>  B <span class="sc">~</span> U,</span>
<span id="cb1660-26"><a href="rethinking-chapter-15.html#cb1660-26" aria-hidden="true" tabindex="-1"></a>  M <span class="sc">~</span> U,</span>
<span id="cb1660-27"><a href="rethinking-chapter-15.html#cb1660-27" aria-hidden="true" tabindex="-1"></a>  Bs <span class="sc">~</span> B <span class="sc">+</span> Rb,</span>
<span id="cb1660-28"><a href="rethinking-chapter-15.html#cb1660-28" aria-hidden="true" tabindex="-1"></a>  Rb <span class="sc">~</span> M,</span>
<span id="cb1660-29"><a href="rethinking-chapter-15.html#cb1660-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1660-30"><a href="rethinking-chapter-15.html#cb1660-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;K&quot;</span>,</span>
<span id="cb1660-31"><a href="rethinking-chapter-15.html#cb1660-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;Bs&quot;</span>, <span class="st">&quot;Rb&quot;</span>),</span>
<span id="cb1660-32"><a href="rethinking-chapter-15.html#cb1660-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">5</span> ),</span>
<span id="cb1660-33"><a href="rethinking-chapter-15.html#cb1660-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>, <span class="dv">0</span>, .<span class="dv">75</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1660-34"><a href="rethinking-chapter-15.html#cb1660-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">primate_dag</span>()</span>
<span id="cb1660-35"><a href="rethinking-chapter-15.html#cb1660-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1660-36"><a href="rethinking-chapter-15.html#cb1660-36" aria-hidden="true" tabindex="-1"></a>dag13 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb1660-37"><a href="rethinking-chapter-15.html#cb1660-37" aria-hidden="true" tabindex="-1"></a>  K <span class="sc">~</span> M <span class="sc">+</span> B,</span>
<span id="cb1660-38"><a href="rethinking-chapter-15.html#cb1660-38" aria-hidden="true" tabindex="-1"></a>  B <span class="sc">~</span> U,</span>
<span id="cb1660-39"><a href="rethinking-chapter-15.html#cb1660-39" aria-hidden="true" tabindex="-1"></a>  M <span class="sc">~</span> U,</span>
<span id="cb1660-40"><a href="rethinking-chapter-15.html#cb1660-40" aria-hidden="true" tabindex="-1"></a>  Bs <span class="sc">~</span> B <span class="sc">+</span> Rb,</span>
<span id="cb1660-41"><a href="rethinking-chapter-15.html#cb1660-41" aria-hidden="true" tabindex="-1"></a>  Rb <span class="sc">~</span> B,</span>
<span id="cb1660-42"><a href="rethinking-chapter-15.html#cb1660-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1660-43"><a href="rethinking-chapter-15.html#cb1660-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;K&quot;</span>,</span>
<span id="cb1660-44"><a href="rethinking-chapter-15.html#cb1660-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;Bs&quot;</span>, <span class="st">&quot;Rb&quot;</span>),</span>
<span id="cb1660-45"><a href="rethinking-chapter-15.html#cb1660-45" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">5</span> ),</span>
<span id="cb1660-46"><a href="rethinking-chapter-15.html#cb1660-46" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>, <span class="dv">0</span>, .<span class="dv">75</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1660-47"><a href="rethinking-chapter-15.html#cb1660-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">primate_dag</span>()</span>
<span id="cb1660-48"><a href="rethinking-chapter-15.html#cb1660-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1660-49"><a href="rethinking-chapter-15.html#cb1660-49" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(dag11, dag12, dag13)  <span class="sc">%&gt;%</span> </span>
<span id="cb1660-50"><a href="rethinking-chapter-15.html#cb1660-50" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(plot_dag, <span class="at">clr_in =</span> clr_current) <span class="sc">%&gt;%</span> </span>
<span id="cb1660-51"><a href="rethinking-chapter-15.html#cb1660-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_plots</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">tag_level =</span> <span class="st">&quot;new&quot;</span>) <span class="sc">+</span></span>
<span id="cb1660-52"><a href="rethinking-chapter-15.html#cb1660-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;a&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb1660-53"><a href="rethinking-chapter-15.html#cb1660-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">6</span>,</span>
<span id="cb1660-54"><a href="rethinking-chapter-15.html#cb1660-54" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1660-55"><a href="rethinking-chapter-15.html#cb1660-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.6</span>)) <span class="sc">&amp;</span></span>
<span id="cb1660-56"><a href="rethinking-chapter-15.html#cb1660-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel),</span>
<span id="cb1660-57"><a href="rethinking-chapter-15.html#cb1660-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-24-1.svg" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1661-1"><a href="rethinking-chapter-15.html#cb1661-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(</span>
<span id="cb1661-2"><a href="rethinking-chapter-15.html#cb1661-2" aria-hidden="true" tabindex="-1"></a>  K <span class="sc">~</span> M <span class="sc">+</span> B,</span>
<span id="cb1661-3"><a href="rethinking-chapter-15.html#cb1661-3" aria-hidden="true" tabindex="-1"></a>  B <span class="sc">~</span> U <span class="sc">+</span> V,</span>
<span id="cb1661-4"><a href="rethinking-chapter-15.html#cb1661-4" aria-hidden="true" tabindex="-1"></a>  M <span class="sc">~</span> U,</span>
<span id="cb1661-5"><a href="rethinking-chapter-15.html#cb1661-5" aria-hidden="true" tabindex="-1"></a>  Bs <span class="sc">~</span> B <span class="sc">+</span> Rb,</span>
<span id="cb1661-6"><a href="rethinking-chapter-15.html#cb1661-6" aria-hidden="true" tabindex="-1"></a>  Rb <span class="sc">~</span> V,</span>
<span id="cb1661-7"><a href="rethinking-chapter-15.html#cb1661-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1661-8"><a href="rethinking-chapter-15.html#cb1661-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;K&quot;</span>,</span>
<span id="cb1661-9"><a href="rethinking-chapter-15.html#cb1661-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;Bs&quot;</span>, <span class="st">&quot;Rb&quot;</span>, <span class="st">&quot;V&quot;</span>),</span>
<span id="cb1661-10"><a href="rethinking-chapter-15.html#cb1661-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.25</span> ),</span>
<span id="cb1661-11"><a href="rethinking-chapter-15.html#cb1661-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>, <span class="dv">0</span>, .<span class="dv">75</span>, .<span class="dv">75</span>, <span class="dv">0</span>, .<span class="dv">375</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1661-12"><a href="rethinking-chapter-15.html#cb1661-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">primate_dag</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1661-13"><a href="rethinking-chapter-15.html#cb1661-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1661-14"><a href="rethinking-chapter-15.html#cb1661-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">6</span>,</span>
<span id="cb1661-15"><a href="rethinking-chapter-15.html#cb1661-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.6</span>),</span>
<span id="cb1661-16"><a href="rethinking-chapter-15.html#cb1661-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, .<span class="dv">87</span>)) <span class="sc">+</span></span>
<span id="cb1661-17"><a href="rethinking-chapter-15.html#cb1661-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-25-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math display">\[
\begin{array}{rclr}
K_{i} &amp; \sim &amp; \textrm{Normal}(\mu_{i}, \sigma) &amp; \textrm{[ distribution for outcome }k\textrm{ ]}\\
\mu_{i} &amp; = &amp; \alpha + \beta_{B} \color{#B35136}{B_{i}} + \beta_{M}~\textrm{log} M_{i} &amp; \textrm{[ linear model ]}\\
\color{#B35136}{B_{i}} &amp; \sim &amp; \color{#B35136}{\textrm{Normal}(\nu, \sigma_{B})} &amp; \textrm{[ distribution of obs/missing }B\textrm{ ]}\\
\alpha &amp; \sim &amp; \textrm{Normal}(0,0.5) &amp; \\
\beta_{B} &amp; \sim &amp; \textrm{Normal}(0,0.5) &amp; \\
\beta_{M} &amp; \sim &amp; \textrm{Normal}(0,0.5) &amp; \\
\sigma &amp; \sim &amp; \textrm{Exponential}(1) &amp; \\
\nu &amp; \sim &amp; \textrm{Normal}(0.5, 1) &amp; \\
\sigma_{B} &amp; \sim &amp; \textrm{Exponential}(1) &amp; \\
\end{array}
\]</span></p>
<div class="sourceCode" id="cb1662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1662-1"><a href="rethinking-chapter-15.html#cb1662-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(milk)</span>
<span id="cb1662-2"><a href="rethinking-chapter-15.html#cb1662-2" aria-hidden="true" tabindex="-1"></a>data_milk_full <span class="ot">&lt;-</span> milk <span class="sc">%&gt;%</span> </span>
<span id="cb1662-3"><a href="rethinking-chapter-15.html#cb1662-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1662-4"><a href="rethinking-chapter-15.html#cb1662-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mass.log =</span> <span class="fu">log</span>(mass),</span>
<span id="cb1662-5"><a href="rethinking-chapter-15.html#cb1662-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">neocortex.prop =</span> neocortex.perc <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb1662-6"><a href="rethinking-chapter-15.html#cb1662-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">kcal.per.g</span><span class="st">`</span>, <span class="st">`</span><span class="at">neocortex.prop</span><span class="st">`</span>, <span class="st">`</span><span class="at">mass.log</span><span class="st">`</span>),</span>
<span id="cb1662-7"><a href="rethinking-chapter-15.html#cb1662-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">.fns =</span> standardize,</span>
<span id="cb1662-8"><a href="rethinking-chapter-15.html#cb1662-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">.names =</span> <span class="st">&quot;{str_remove_all(.col, &#39;</span><span class="sc">\\\\</span><span class="st">..*&#39;)}_std&quot;</span>))</span>
<span id="cb1662-9"><a href="rethinking-chapter-15.html#cb1662-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1662-10"><a href="rethinking-chapter-15.html#cb1662-10" aria-hidden="true" tabindex="-1"></a>data_milk_list <span class="ot">&lt;-</span> data_milk_full <span class="sc">%&gt;%</span> </span>
<span id="cb1662-11"><a href="rethinking-chapter-15.html#cb1662-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, kcal_std, neocortex_std, mass_std) <span class="sc">%&gt;%</span> </span>
<span id="cb1662-12"><a href="rethinking-chapter-15.html#cb1662-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1662-13"><a href="rethinking-chapter-15.html#cb1662-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1662-14"><a href="rethinking-chapter-15.html#cb1662-14" aria-hidden="true" tabindex="-1"></a>model_primates_imputed <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1662-15"><a href="rethinking-chapter-15.html#cb1662-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1662-16"><a href="rethinking-chapter-15.html#cb1662-16" aria-hidden="true" tabindex="-1"></a>    kcal_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu, sigma ),</span>
<span id="cb1662-17"><a href="rethinking-chapter-15.html#cb1662-17" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_brain <span class="sc">*</span> neocortex_std <span class="sc">+</span> beta_mass <span class="sc">*</span> mass_std,</span>
<span id="cb1662-18"><a href="rethinking-chapter-15.html#cb1662-18" aria-hidden="true" tabindex="-1"></a>    neocortex_std <span class="sc">~</span> <span class="fu">dnorm</span>( nu, sigma_brain ),</span>
<span id="cb1662-19"><a href="rethinking-chapter-15.html#cb1662-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>( alpha, nu ) <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1662-20"><a href="rethinking-chapter-15.html#cb1662-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(beta_brain, beta_mass ) <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1662-21"><a href="rethinking-chapter-15.html#cb1662-21" aria-hidden="true" tabindex="-1"></a>    sigma_brain <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>),</span>
<span id="cb1662-22"><a href="rethinking-chapter-15.html#cb1662-22" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb1662-23"><a href="rethinking-chapter-15.html#cb1662-23" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1662-24"><a href="rethinking-chapter-15.html#cb1662-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_milk_list,</span>
<span id="cb1662-25"><a href="rethinking-chapter-15.html#cb1662-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1662-26"><a href="rethinking-chapter-15.html#cb1662-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1662-27"><a href="rethinking-chapter-15.html#cb1662-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb1662-28"><a href="rethinking-chapter-15.html#cb1662-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1663-1"><a href="rethinking-chapter-15.html#cb1663-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_primates_imputed, <span class="at">depth =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1663-2"><a href="rethinking-chapter-15.html#cb1663-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">nu</td>
<td align="right">-0.06</td>
<td align="right">0.21</td>
<td align="right">-0.39</td>
<td align="right">0.28</td>
<td align="right">2210.15</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">alpha</td>
<td align="right">0.03</td>
<td align="right">0.17</td>
<td align="right">-0.23</td>
<td align="right">0.29</td>
<td align="right">2240.59</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">beta_mass</td>
<td align="right">-0.55</td>
<td align="right">0.20</td>
<td align="right">-0.85</td>
<td align="right">-0.22</td>
<td align="right">1114.24</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">beta_brain</td>
<td align="right">0.50</td>
<td align="right">0.23</td>
<td align="right">0.11</td>
<td align="right">0.87</td>
<td align="right">831.86</td>
<td align="right">1.01</td>
</tr>
<tr class="odd">
<td align="left">sigma_brain</td>
<td align="right">1.01</td>
<td align="right">0.17</td>
<td align="right">0.77</td>
<td align="right">1.33</td>
<td align="right">1444.15</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.84</td>
<td align="right">0.14</td>
<td align="right">0.64</td>
<td align="right">1.08</td>
<td align="right">1255.77</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">neocortex_std_impute[1]</td>
<td align="right">-0.60</td>
<td align="right">0.90</td>
<td align="right">-1.99</td>
<td align="right">0.84</td>
<td align="right">2237.08</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">neocortex_std_impute[2]</td>
<td align="right">-0.70</td>
<td align="right">0.94</td>
<td align="right">-2.18</td>
<td align="right">0.82</td>
<td align="right">2266.74</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">neocortex_std_impute[3]</td>
<td align="right">-0.70</td>
<td align="right">0.93</td>
<td align="right">-2.14</td>
<td align="right">0.80</td>
<td align="right">2007.44</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">neocortex_std_impute[4]</td>
<td align="right">-0.30</td>
<td align="right">0.90</td>
<td align="right">-1.73</td>
<td align="right">1.12</td>
<td align="right">2470.97</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">neocortex_std_impute[5]</td>
<td align="right">0.44</td>
<td align="right">0.90</td>
<td align="right">-0.99</td>
<td align="right">1.89</td>
<td align="right">2917.91</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">neocortex_std_impute[6]</td>
<td align="right">-0.20</td>
<td align="right">0.91</td>
<td align="right">-1.57</td>
<td align="right">1.25</td>
<td align="right">2303.80</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">neocortex_std_impute[7]</td>
<td align="right">0.21</td>
<td align="right">0.90</td>
<td align="right">-1.22</td>
<td align="right">1.61</td>
<td align="right">3195.30</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">neocortex_std_impute[8]</td>
<td align="right">0.26</td>
<td align="right">0.89</td>
<td align="right">-1.15</td>
<td align="right">1.66</td>
<td align="right">2089.83</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">neocortex_std_impute[9]</td>
<td align="right">0.50</td>
<td align="right">0.87</td>
<td align="right">-0.86</td>
<td align="right">1.91</td>
<td align="right">2308.11</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">neocortex_std_impute[10]</td>
<td align="right">-0.44</td>
<td align="right">0.88</td>
<td align="right">-1.84</td>
<td align="right">0.92</td>
<td align="right">2664.65</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">neocortex_std_impute[11]</td>
<td align="right">-0.30</td>
<td align="right">0.90</td>
<td align="right">-1.75</td>
<td align="right">1.19</td>
<td align="right">2810.75</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">neocortex_std_impute[12]</td>
<td align="right">0.15</td>
<td align="right">0.89</td>
<td align="right">-1.27</td>
<td align="right">1.53</td>
<td align="right">2816.22</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1664-1"><a href="rethinking-chapter-15.html#cb1664-1" aria-hidden="true" tabindex="-1"></a>data_milk_list2 <span class="ot">&lt;-</span> data_milk_full <span class="sc">%&gt;%</span> </span>
<span id="cb1664-2"><a href="rethinking-chapter-15.html#cb1664-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(neocortex_std)) <span class="sc">%&gt;%</span> </span>
<span id="cb1664-3"><a href="rethinking-chapter-15.html#cb1664-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, kcal_std, neocortex_std, mass_std) <span class="sc">%&gt;%</span> </span>
<span id="cb1664-4"><a href="rethinking-chapter-15.html#cb1664-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1664-5"><a href="rethinking-chapter-15.html#cb1664-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1664-6"><a href="rethinking-chapter-15.html#cb1664-6" aria-hidden="true" tabindex="-1"></a>model_primates_non_missing <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1664-7"><a href="rethinking-chapter-15.html#cb1664-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1664-8"><a href="rethinking-chapter-15.html#cb1664-8" aria-hidden="true" tabindex="-1"></a>    kcal_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu, sigma ),</span>
<span id="cb1664-9"><a href="rethinking-chapter-15.html#cb1664-9" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_brain <span class="sc">*</span> neocortex_std <span class="sc">+</span> beta_mass <span class="sc">*</span> mass_std,</span>
<span id="cb1664-10"><a href="rethinking-chapter-15.html#cb1664-10" aria-hidden="true" tabindex="-1"></a>    neocortex_std <span class="sc">~</span> <span class="fu">dnorm</span>( nu, sigma_brain ),</span>
<span id="cb1664-11"><a href="rethinking-chapter-15.html#cb1664-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>( alpha, nu ) <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1664-12"><a href="rethinking-chapter-15.html#cb1664-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(beta_brain, beta_mass ) <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1664-13"><a href="rethinking-chapter-15.html#cb1664-13" aria-hidden="true" tabindex="-1"></a>    sigma_brain <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>),</span>
<span id="cb1664-14"><a href="rethinking-chapter-15.html#cb1664-14" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb1664-15"><a href="rethinking-chapter-15.html#cb1664-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1664-16"><a href="rethinking-chapter-15.html#cb1664-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_milk_list2,</span>
<span id="cb1664-17"><a href="rethinking-chapter-15.html#cb1664-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1664-18"><a href="rethinking-chapter-15.html#cb1664-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1664-19"><a href="rethinking-chapter-15.html#cb1664-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb1664-20"><a href="rethinking-chapter-15.html#cb1664-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1665-1"><a href="rethinking-chapter-15.html#cb1665-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_primates_non_missing) <span class="sc">%&gt;%</span> </span>
<span id="cb1665-2"><a href="rethinking-chapter-15.html#cb1665-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">nu</td>
<td align="right">0.00</td>
<td align="right">0.23</td>
<td align="right">-0.37</td>
<td align="right">0.36</td>
<td align="right">1778.70</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">alpha</td>
<td align="right">0.10</td>
<td align="right">0.19</td>
<td align="right">-0.20</td>
<td align="right">0.40</td>
<td align="right">1423.18</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">beta_mass</td>
<td align="right">-0.64</td>
<td align="right">0.26</td>
<td align="right">-1.04</td>
<td align="right">-0.20</td>
<td align="right">923.00</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_brain</td>
<td align="right">0.60</td>
<td align="right">0.29</td>
<td align="right">0.12</td>
<td align="right">1.06</td>
<td align="right">870.94</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">sigma_brain</td>
<td align="right">1.03</td>
<td align="right">0.18</td>
<td align="right">0.79</td>
<td align="right">1.37</td>
<td align="right">1908.36</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.87</td>
<td align="right">0.19</td>
<td align="right">0.63</td>
<td align="right">1.22</td>
<td align="right">871.92</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1666-1"><a href="rethinking-chapter-15.html#cb1666-1" aria-hidden="true" tabindex="-1"></a>missing_mean <span class="ot">&lt;-</span> <span class="fu">coeftab</span>(model_primates_non_missing,</span>
<span id="cb1666-2"><a href="rethinking-chapter-15.html#cb1666-2" aria-hidden="true" tabindex="-1"></a>                        model_primates_imputed)<span class="sc">@</span>coefs <span class="sc">%&gt;%</span> </span>
<span id="cb1666-3"><a href="rethinking-chapter-15.html#cb1666-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1666-4"><a href="rethinking-chapter-15.html#cb1666-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;param&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1666-5"><a href="rethinking-chapter-15.html#cb1666-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1666-6"><a href="rethinking-chapter-15.html#cb1666-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(param <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;beta_brain&quot;</span>, <span class="st">&quot;beta_mass&quot;</span>)) </span>
<span id="cb1666-7"><a href="rethinking-chapter-15.html#cb1666-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1666-8"><a href="rethinking-chapter-15.html#cb1666-8" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftab</span>(model_primates_non_missing,</span>
<span id="cb1666-9"><a href="rethinking-chapter-15.html#cb1666-9" aria-hidden="true" tabindex="-1"></a>        model_primates_imputed)<span class="sc">@</span>se <span class="sc">%&gt;%</span> </span>
<span id="cb1666-10"><a href="rethinking-chapter-15.html#cb1666-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1666-11"><a href="rethinking-chapter-15.html#cb1666-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;param&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1666-12"><a href="rethinking-chapter-15.html#cb1666-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1666-13"><a href="rethinking-chapter-15.html#cb1666-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(param <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;beta_brain&quot;</span>, <span class="st">&quot;beta_mass&quot;</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb1666-14"><a href="rethinking-chapter-15.html#cb1666-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="at">nm =</span> <span class="fu">c</span>(<span class="st">&quot;param&quot;</span>, <span class="fu">names</span>(missing_mean)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]))<span class="sc">%&gt;%</span> </span>
<span id="cb1666-15"><a href="rethinking-chapter-15.html#cb1666-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>param, <span class="at">names_to =</span> <span class="st">&quot;model&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;se&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1666-16"><a href="rethinking-chapter-15.html#cb1666-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(missing_mean <span class="sc">%&gt;%</span> </span>
<span id="cb1666-17"><a href="rethinking-chapter-15.html#cb1666-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>param, <span class="at">names_to =</span> <span class="st">&quot;model&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;mean&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1666-18"><a href="rethinking-chapter-15.html#cb1666-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">str_remove</span>(model, <span class="st">&quot;model_primates_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1666-19"><a href="rethinking-chapter-15.html#cb1666-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb1666-20"><a href="rethinking-chapter-15.html#cb1666-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean, <span class="at">xmin =</span> mean <span class="sc">-</span> se, <span class="at">xmax =</span> mean<span class="sc">+</span>se),</span>
<span id="cb1666-21"><a href="rethinking-chapter-15.html#cb1666-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb1666-22"><a href="rethinking-chapter-15.html#cb1666-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(param <span class="sc">~</span> ., <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>)  <span class="sc">+</span></span>
<span id="cb1666-23"><a href="rethinking-chapter-15.html#cb1666-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-30-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1667-1"><a href="rethinking-chapter-15.html#cb1667-1" aria-hidden="true" tabindex="-1"></a>primates_posterior <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_primates_imputed) <span class="sc">%&gt;%</span> </span>
<span id="cb1667-2"><a href="rethinking-chapter-15.html#cb1667-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1667-3"><a href="rethinking-chapter-15.html#cb1667-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1667-4"><a href="rethinking-chapter-15.html#cb1667-4" aria-hidden="true" tabindex="-1"></a>imputed_neocortex <span class="ot">&lt;-</span> primates_posterior<span class="sc">$</span>neocortex_std_impute <span class="sc">%&gt;%</span> </span>
<span id="cb1667-5"><a href="rethinking-chapter-15.html#cb1667-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1667-6"><a href="rethinking-chapter-15.html#cb1667-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1667-7"><a href="rethinking-chapter-15.html#cb1667-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb1667-8"><a href="rethinking-chapter-15.html#cb1667-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pi =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">value =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">055</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>, .<span class="dv">955</span>)),</span>
<span id="cb1667-9"><a href="rethinking-chapter-15.html#cb1667-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;ll&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;hh&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb1667-10"><a href="rethinking-chapter-15.html#cb1667-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_remove</span>(name, <span class="st">&quot;V&quot;</span>) <span class="sc">%&gt;%</span>  <span class="fu">as.integer</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1667-11"><a href="rethinking-chapter-15.html#cb1667-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb1667-12"><a href="rethinking-chapter-15.html#cb1667-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pi) <span class="sc">%&gt;%</span> </span>
<span id="cb1667-13"><a href="rethinking-chapter-15.html#cb1667-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> label, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb1667-14"><a href="rethinking-chapter-15.html#cb1667-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_milk_full <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(neocortex.perc)),.)</span>
<span id="cb1667-15"><a href="rethinking-chapter-15.html#cb1667-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1667-16"><a href="rethinking-chapter-15.html#cb1667-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> data_milk_list <span class="sc">%&gt;%</span> </span>
<span id="cb1667-17"><a href="rethinking-chapter-15.html#cb1667-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1667-18"><a href="rethinking-chapter-15.html#cb1667-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(neocortex_std)) <span class="sc">%&gt;%</span> </span>
<span id="cb1667-19"><a href="rethinking-chapter-15.html#cb1667-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> neocortex_std, <span class="at">y =</span> kcal_std)) <span class="sc">+</span></span>
<span id="cb1667-20"><a href="rethinking-chapter-15.html#cb1667-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">data =</span> imputed_neocortex,</span>
<span id="cb1667-21"><a href="rethinking-chapter-15.html#cb1667-21" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">xmin =</span> ll, <span class="at">x =</span> m ,<span class="at">xmax =</span> hh),</span>
<span id="cb1667-22"><a href="rethinking-chapter-15.html#cb1667-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0,</span>
<span id="cb1667-23"><a href="rethinking-chapter-15.html#cb1667-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fatten  =</span> <span class="fl">2.6</span>) <span class="sc">+</span></span>
<span id="cb1667-24"><a href="rethinking-chapter-15.html#cb1667-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clr_current, <span class="at">size =</span> <span class="fl">1.6</span>)</span>
<span id="cb1667-25"><a href="rethinking-chapter-15.html#cb1667-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1667-26"><a href="rethinking-chapter-15.html#cb1667-26" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data_milk_list <span class="sc">%&gt;%</span> </span>
<span id="cb1667-27"><a href="rethinking-chapter-15.html#cb1667-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1667-28"><a href="rethinking-chapter-15.html#cb1667-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(neocortex_std)) <span class="sc">%&gt;%</span> </span>
<span id="cb1667-29"><a href="rethinking-chapter-15.html#cb1667-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> neocortex_std, <span class="at">x =</span> mass_std)) <span class="sc">+</span></span>
<span id="cb1667-30"><a href="rethinking-chapter-15.html#cb1667-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">data =</span> imputed_neocortex,</span>
<span id="cb1667-31"><a href="rethinking-chapter-15.html#cb1667-31" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">ymin =</span> ll, <span class="at">y =</span> m ,<span class="at">ymax =</span> hh),</span>
<span id="cb1667-32"><a href="rethinking-chapter-15.html#cb1667-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0,</span>
<span id="cb1667-33"><a href="rethinking-chapter-15.html#cb1667-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fatten  =</span> <span class="fl">2.6</span>) <span class="sc">+</span></span>
<span id="cb1667-34"><a href="rethinking-chapter-15.html#cb1667-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clr_current, <span class="at">size =</span> <span class="fl">1.6</span>)</span>
<span id="cb1667-35"><a href="rethinking-chapter-15.html#cb1667-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1667-36"><a href="rethinking-chapter-15.html#cb1667-36" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-31-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>Updating the imputation within the model to take the correlation of <code>mass_std</code> and <code>neocortex_std</code> into account:</p>
<p><span class="math display">\[
(M_{i}, B_{i}) \sim \textrm{MVNormal}\left(( \mu_{M}, \mu_{B}), S \right)
\]</span></p>
<div class="sourceCode" id="cb1668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1668-1"><a href="rethinking-chapter-15.html#cb1668-1" aria-hidden="true" tabindex="-1"></a>model_primates_impute_covar <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1668-2"><a href="rethinking-chapter-15.html#cb1668-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1668-3"><a href="rethinking-chapter-15.html#cb1668-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># kcal as function of neocortex and mass</span></span>
<span id="cb1668-4"><a href="rethinking-chapter-15.html#cb1668-4" aria-hidden="true" tabindex="-1"></a>    kcal_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu, sigma ),</span>
<span id="cb1668-5"><a href="rethinking-chapter-15.html#cb1668-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_brain <span class="sc">*</span> neocortex_merge <span class="sc">+</span> beta_mass <span class="sc">*</span> mass_std,</span>
<span id="cb1668-6"><a href="rethinking-chapter-15.html#cb1668-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1668-7"><a href="rethinking-chapter-15.html#cb1668-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mass and neocortex correlation</span></span>
<span id="cb1668-8"><a href="rethinking-chapter-15.html#cb1668-8" aria-hidden="true" tabindex="-1"></a>    mass_neocortex <span class="sc">~</span> <span class="fu">multi_normal</span>( <span class="fu">c</span>( mu_mass, mu_neocortex ), Rho_nm, Sigma_nm ),</span>
<span id="cb1668-9"><a href="rethinking-chapter-15.html#cb1668-9" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">29</span>, <span class="dv">2</span>]<span class="sc">:</span>mass_neocortex <span class="ot">&lt;&lt;-</span> <span class="fu">append_col</span>( mass_std, neocortex_merge ),</span>
<span id="cb1668-10"><a href="rethinking-chapter-15.html#cb1668-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1668-11"><a href="rethinking-chapter-15.html#cb1668-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># define neocortex_merge as mix of observed and imputed values</span></span>
<span id="cb1668-12"><a href="rethinking-chapter-15.html#cb1668-12" aria-hidden="true" tabindex="-1"></a>    vector[<span class="dv">29</span>]<span class="sc">:</span>neocortex_merge <span class="ot">&lt;-</span> <span class="fu">merge_missing</span>( neocortex_std, neocortex_std_impute ),</span>
<span id="cb1668-13"><a href="rethinking-chapter-15.html#cb1668-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1668-14"><a href="rethinking-chapter-15.html#cb1668-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># priors</span></span>
<span id="cb1668-15"><a href="rethinking-chapter-15.html#cb1668-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>( alpha, mu_mass, mu_neocortex ) <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1668-16"><a href="rethinking-chapter-15.html#cb1668-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>( beta_brain, beta_mass ) <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1668-17"><a href="rethinking-chapter-15.html#cb1668-17" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>),</span>
<span id="cb1668-18"><a href="rethinking-chapter-15.html#cb1668-18" aria-hidden="true" tabindex="-1"></a>    Rho_nm <span class="sc">~</span> <span class="fu">lkj_corr</span>(<span class="dv">2</span>),</span>
<span id="cb1668-19"><a href="rethinking-chapter-15.html#cb1668-19" aria-hidden="true" tabindex="-1"></a>    Sigma_nm <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb1668-20"><a href="rethinking-chapter-15.html#cb1668-20" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1668-21"><a href="rethinking-chapter-15.html#cb1668-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_milk_list,</span>
<span id="cb1668-22"><a href="rethinking-chapter-15.html#cb1668-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1668-23"><a href="rethinking-chapter-15.html#cb1668-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb1668-24"><a href="rethinking-chapter-15.html#cb1668-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1669-1"><a href="rethinking-chapter-15.html#cb1669-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_primates_impute_covar, <span class="at">depth =</span> <span class="dv">3</span>,</span>
<span id="cb1669-2"><a href="rethinking-chapter-15.html#cb1669-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;beta_mass&quot;</span>, <span class="st">&quot;beta_brain&quot;</span>, <span class="st">&quot;Rho_nm&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1669-3"><a href="rethinking-chapter-15.html#cb1669-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">beta_mass</td>
<td align="right">-0.65</td>
<td align="right">0.22</td>
<td align="right">-0.98</td>
<td align="right">-0.29</td>
<td align="right">1153.75</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_brain</td>
<td align="right">0.59</td>
<td align="right">0.25</td>
<td align="right">0.17</td>
<td align="right">0.96</td>
<td align="right">938.43</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Rho_nm[1,1]</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">Rho_nm[1,2]</td>
<td align="right">0.61</td>
<td align="right">0.13</td>
<td align="right">0.37</td>
<td align="right">0.79</td>
<td align="right">1300.92</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Rho_nm[2,1]</td>
<td align="right">0.61</td>
<td align="right">0.13</td>
<td align="right">0.37</td>
<td align="right">0.79</td>
<td align="right">1300.92</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Rho_nm[2,2]</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1670-1"><a href="rethinking-chapter-15.html#cb1670-1" aria-hidden="true" tabindex="-1"></a>primates_posterior_covar <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_primates_impute_covar) <span class="sc">%&gt;%</span> </span>
<span id="cb1670-2"><a href="rethinking-chapter-15.html#cb1670-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1670-3"><a href="rethinking-chapter-15.html#cb1670-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1670-4"><a href="rethinking-chapter-15.html#cb1670-4" aria-hidden="true" tabindex="-1"></a>imputed_neocortex_covar <span class="ot">&lt;-</span> primates_posterior_covar<span class="sc">$</span>neocortex_std_impute <span class="sc">%&gt;%</span> </span>
<span id="cb1670-5"><a href="rethinking-chapter-15.html#cb1670-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1670-6"><a href="rethinking-chapter-15.html#cb1670-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1670-7"><a href="rethinking-chapter-15.html#cb1670-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb1670-8"><a href="rethinking-chapter-15.html#cb1670-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pi =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">value =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">055</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>, .<span class="dv">955</span>)),</span>
<span id="cb1670-9"><a href="rethinking-chapter-15.html#cb1670-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;ll&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;hh&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb1670-10"><a href="rethinking-chapter-15.html#cb1670-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_remove</span>(name, <span class="st">&quot;V&quot;</span>) <span class="sc">%&gt;%</span>  <span class="fu">as.integer</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1670-11"><a href="rethinking-chapter-15.html#cb1670-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb1670-12"><a href="rethinking-chapter-15.html#cb1670-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pi) <span class="sc">%&gt;%</span> </span>
<span id="cb1670-13"><a href="rethinking-chapter-15.html#cb1670-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> label, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb1670-14"><a href="rethinking-chapter-15.html#cb1670-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_milk_full <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(neocortex.perc)),.)</span>
<span id="cb1670-15"><a href="rethinking-chapter-15.html#cb1670-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1670-16"><a href="rethinking-chapter-15.html#cb1670-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> data_milk_list <span class="sc">%&gt;%</span> </span>
<span id="cb1670-17"><a href="rethinking-chapter-15.html#cb1670-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1670-18"><a href="rethinking-chapter-15.html#cb1670-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(neocortex_std)) <span class="sc">%&gt;%</span> </span>
<span id="cb1670-19"><a href="rethinking-chapter-15.html#cb1670-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> neocortex_std, <span class="at">y =</span> kcal_std)) <span class="sc">+</span></span>
<span id="cb1670-20"><a href="rethinking-chapter-15.html#cb1670-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">data =</span> imputed_neocortex_covar,</span>
<span id="cb1670-21"><a href="rethinking-chapter-15.html#cb1670-21" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">xmin =</span> ll, <span class="at">x =</span> m ,<span class="at">xmax =</span> hh),</span>
<span id="cb1670-22"><a href="rethinking-chapter-15.html#cb1670-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0,</span>
<span id="cb1670-23"><a href="rethinking-chapter-15.html#cb1670-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fatten  =</span> <span class="fl">2.6</span>) <span class="sc">+</span></span>
<span id="cb1670-24"><a href="rethinking-chapter-15.html#cb1670-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clr_current, <span class="at">size =</span> <span class="fl">1.6</span>)</span>
<span id="cb1670-25"><a href="rethinking-chapter-15.html#cb1670-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1670-26"><a href="rethinking-chapter-15.html#cb1670-26" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data_milk_list <span class="sc">%&gt;%</span> </span>
<span id="cb1670-27"><a href="rethinking-chapter-15.html#cb1670-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1670-28"><a href="rethinking-chapter-15.html#cb1670-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(neocortex_std)) <span class="sc">%&gt;%</span> </span>
<span id="cb1670-29"><a href="rethinking-chapter-15.html#cb1670-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> neocortex_std, <span class="at">x =</span> mass_std)) <span class="sc">+</span></span>
<span id="cb1670-30"><a href="rethinking-chapter-15.html#cb1670-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">data =</span> imputed_neocortex_covar,</span>
<span id="cb1670-31"><a href="rethinking-chapter-15.html#cb1670-31" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">ymin =</span> ll, <span class="at">y =</span> m ,<span class="at">ymax =</span> hh),</span>
<span id="cb1670-32"><a href="rethinking-chapter-15.html#cb1670-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0,</span>
<span id="cb1670-33"><a href="rethinking-chapter-15.html#cb1670-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fatten  =</span> <span class="fl">2.6</span>) <span class="sc">+</span></span>
<span id="cb1670-34"><a href="rethinking-chapter-15.html#cb1670-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clr_current, <span class="at">size =</span> <span class="fl">1.6</span>)</span>
<span id="cb1670-35"><a href="rethinking-chapter-15.html#cb1670-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1670-36"><a href="rethinking-chapter-15.html#cb1670-36" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-34-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1671-1"><a href="rethinking-chapter-15.html#cb1671-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stancode</span>(model_primates_imputed)</span></code></pre></div>
<pre><code>#&gt; functions{
#&gt; 
#&gt; 
#&gt;     vector merge_missing( int[] miss_indexes , vector x_obs , vector x_miss ) {
#&gt;         int N = dims(x_obs)[1];
#&gt;         int N_miss = dims(x_miss)[1];
#&gt;         vector[N] merged;
#&gt;         merged = x_obs;
#&gt;         for ( i in 1:N_miss )
#&gt;             merged[ miss_indexes[i] ] = x_miss[i];
#&gt;         return merged;
#&gt;     }
#&gt; }
#&gt; data{
#&gt;     int species[29];
#&gt;     vector[29] kcal_std;
#&gt;     vector[29] mass_std;
#&gt;     vector[29] neocortex_std;
#&gt;     int neocortex_std_missidx[12];
#&gt; }
#&gt; parameters{
#&gt;     real nu;
#&gt;     real alpha;
#&gt;     real beta_mass;
#&gt;     real beta_brain;
#&gt;     real&lt;lower=0&gt; sigma_brain;
#&gt;     real&lt;lower=0&gt; sigma;
#&gt;     vector[12] neocortex_std_impute;
#&gt; }
#&gt; model{
#&gt;     vector[29] mu;
#&gt;     vector[29] neocortex_std_merge;
#&gt;     sigma ~ exponential( 1 );
#&gt;     sigma_brain ~ exponential( 1 );
#&gt;     beta_brain ~ normal( 0 , 0.5 );
#&gt;     beta_mass ~ normal( 0 , 0.5 );
#&gt;     alpha ~ normal( 0 , 0.5 );
#&gt;     nu ~ normal( 0 , 0.5 );
#&gt;     neocortex_std_merge = merge_missing(neocortex_std_missidx, to_vector(neocortex_std), neocortex_std_impute);
#&gt;     neocortex_std_merge ~ normal( nu , sigma_brain );
#&gt;     for ( i in 1:29 ) {
#&gt;         mu[i] = alpha + beta_brain * neocortex_std_merge[i] + beta_mass * mass_std[i];
#&gt;     }
#&gt;     kcal_std ~ normal( mu , sigma );
#&gt; }</code></pre>
</div>
<div id="where-is-your-god-now" class="section level3 hasAnchor" number="16.2.3">
<h3><span class="header-section-number">16.2.3</span> Where is Your God Now?<a href="rethinking-chapter-15.html#where-is-your-god-now" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1673-1"><a href="rethinking-chapter-15.html#cb1673-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Moralizing_gods)</span>
<span id="cb1673-2"><a href="rethinking-chapter-15.html#cb1673-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1673-3"><a href="rethinking-chapter-15.html#cb1673-3" aria-hidden="true" tabindex="-1"></a>data_gods <span class="ot">&lt;-</span> Moralizing_gods <span class="sc">%&gt;%</span> </span>
<span id="cb1673-4"><a href="rethinking-chapter-15.html#cb1673-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1673-5"><a href="rethinking-chapter-15.html#cb1673-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1673-6"><a href="rethinking-chapter-15.html#cb1673-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1673-7"><a href="rethinking-chapter-15.html#cb1673-7" aria-hidden="true" tabindex="-1"></a>data_gods <span class="sc">%&gt;%</span> </span>
<span id="cb1673-8"><a href="rethinking-chapter-15.html#cb1673-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(moralizing_gods) <span class="sc">%&gt;%</span> </span>
<span id="cb1673-9"><a href="rethinking-chapter-15.html#cb1673-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>#&gt; # A tibble: 3 × 2
#&gt; # Groups:   moralizing_gods [3]
#&gt;   moralizing_gods     n
#&gt;             &lt;int&gt; &lt;int&gt;
#&gt; 1               0    17
#&gt; 2               1   319
#&gt; 3              NA   528</code></pre>
<div class="sourceCode" id="cb1675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1675-1"><a href="rethinking-chapter-15.html#cb1675-1" aria-hidden="true" tabindex="-1"></a>data_gods <span class="sc">%&gt;%</span> </span>
<span id="cb1675-2"><a href="rethinking-chapter-15.html#cb1675-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(moralizing_gods, writing) <span class="sc">%&gt;%</span> </span>
<span id="cb1675-3"><a href="rethinking-chapter-15.html#cb1675-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1675-4"><a href="rethinking-chapter-15.html#cb1675-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;writing&quot;</span>,</span>
<span id="cb1675-5"><a href="rethinking-chapter-15.html#cb1675-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 3 × 3
#&gt; # Groups:   moralizing_gods [3]
#&gt;   moralizing_gods   `0`   `1`
#&gt;             &lt;int&gt; &lt;int&gt; &lt;int&gt;
#&gt; 1               0    16     1
#&gt; 2               1     9   310
#&gt; 3              NA   442    86</code></pre>
<div class="sourceCode" id="cb1677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1677-1"><a href="rethinking-chapter-15.html#cb1677-1" aria-hidden="true" tabindex="-1"></a>data_gods <span class="sc">%&gt;%</span> </span>
<span id="cb1677-2"><a href="rethinking-chapter-15.html#cb1677-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> population)) <span class="sc">+</span></span>
<span id="cb1677-3"><a href="rethinking-chapter-15.html#cb1677-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(moralizing_gods),</span>
<span id="cb1677-4"><a href="rethinking-chapter-15.html#cb1677-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="fu">factor</span>(moralizing_gods)),</span>
<span id="cb1677-5"><a href="rethinking-chapter-15.html#cb1677-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> .<span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb1677-6"><a href="rethinking-chapter-15.html#cb1677-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">19</span>), <span class="at">na.value =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb1677-7"><a href="rethinking-chapter-15.html#cb1677-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> clr_current, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> clr_current), <span class="at">na.value =</span> clr0dd) <span class="sc">+</span></span>
<span id="cb1677-8"><a href="rethinking-chapter-15.html#cb1677-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-36-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1678-1"><a href="rethinking-chapter-15.html#cb1678-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(</span>
<span id="cb1678-2"><a href="rethinking-chapter-15.html#cb1678-2" aria-hidden="true" tabindex="-1"></a>  Gs <span class="sc">~</span> G <span class="sc">+</span> Rg,</span>
<span id="cb1678-3"><a href="rethinking-chapter-15.html#cb1678-3" aria-hidden="true" tabindex="-1"></a>  Rg <span class="sc">~</span> W,</span>
<span id="cb1678-4"><a href="rethinking-chapter-15.html#cb1678-4" aria-hidden="true" tabindex="-1"></a>  W <span class="sc">~</span> P,</span>
<span id="cb1678-5"><a href="rethinking-chapter-15.html#cb1678-5" aria-hidden="true" tabindex="-1"></a>  P <span class="sc">~</span> G,</span>
<span id="cb1678-6"><a href="rethinking-chapter-15.html#cb1678-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;G&quot;</span>,</span>
<span id="cb1678-7"><a href="rethinking-chapter-15.html#cb1678-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;P&quot;</span>,</span>
<span id="cb1678-8"><a href="rethinking-chapter-15.html#cb1678-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;P&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;Gs&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;Rg&quot;</span>),</span>
<span id="cb1678-9"><a href="rethinking-chapter-15.html#cb1678-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>, .<span class="dv">25</span>, .<span class="dv">75</span> ),</span>
<span id="cb1678-10"><a href="rethinking-chapter-15.html#cb1678-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1678-11"><a href="rethinking-chapter-15.html#cb1678-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1678-12"><a href="rethinking-chapter-15.html#cb1678-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;P&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1678-13"><a href="rethinking-chapter-15.html#cb1678-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Gs&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;Rg&quot;</span>),</span>
<span id="cb1678-14"><a href="rethinking-chapter-15.html#cb1678-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>)),</span>
<span id="cb1678-15"><a href="rethinking-chapter-15.html#cb1678-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">&quot;Gs&quot;</span>,<span class="st">&quot;G^&#39;*&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1678-16"><a href="rethinking-chapter-15.html#cb1678-16" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_replace</span>( <span class="st">&quot;Rg&quot;</span>,<span class="st">&quot;R[G]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1678-17"><a href="rethinking-chapter-15.html#cb1678-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1678-18"><a href="rethinking-chapter-15.html#cb1678-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">35</span>,</span>
<span id="cb1678-19"><a href="rethinking-chapter-15.html#cb1678-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1678-20"><a href="rethinking-chapter-15.html#cb1678-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb1678-21"><a href="rethinking-chapter-15.html#cb1678-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-37-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1679-1"><a href="rethinking-chapter-15.html#cb1679-1" aria-hidden="true" tabindex="-1"></a>data_gods <span class="sc">%&gt;%</span> </span>
<span id="cb1679-2"><a href="rethinking-chapter-15.html#cb1679-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(polity <span class="sc">==</span> <span class="st">&quot;Big Island Hawaii&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1679-3"><a href="rethinking-chapter-15.html#cb1679-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(year, writing,moralizing_gods) <span class="sc">%&gt;%</span> </span>
<span id="cb1679-4"><a href="rethinking-chapter-15.html#cb1679-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span></code></pre></div>
<p><span class="math display">\[\begin{bmatrix} 1000 &amp;1100 &amp;1200 \\1300 &amp;1400 &amp;1500 \\1600 &amp;1700 &amp;1800 \\0 &amp;0 &amp;0 \\0 &amp;0 &amp;0 \\0 &amp;0 &amp;0 \\NA &amp;NA &amp;NA \\NA &amp;NA &amp;NA \\NA &amp;NA &amp;1 \\ \end{bmatrix}\]</span></p>
</div>
</div>
<div id="categorical-errors-and-discrete-absences" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Categorical Errors and Discrete Absences<a href="rethinking-chapter-15.html#categorical-errors-and-discrete-absences" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="discrete-cats" class="section level3 hasAnchor" number="16.3.1">
<h3><span class="header-section-number">16.3.1</span> Discrete Cats<a href="rethinking-chapter-15.html#discrete-cats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1680-1"><a href="rethinking-chapter-15.html#cb1680-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(</span>
<span id="cb1680-2"><a href="rethinking-chapter-15.html#cb1680-2" aria-hidden="true" tabindex="-1"></a>  Cs <span class="sc">~</span> C <span class="sc">+</span> Rc,</span>
<span id="cb1680-3"><a href="rethinking-chapter-15.html#cb1680-3" aria-hidden="true" tabindex="-1"></a>  N <span class="sc">~</span> C,</span>
<span id="cb1680-4"><a href="rethinking-chapter-15.html#cb1680-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;Cs&quot;</span>,</span>
<span id="cb1680-5"><a href="rethinking-chapter-15.html#cb1680-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;N&quot;</span>,</span>
<span id="cb1680-6"><a href="rethinking-chapter-15.html#cb1680-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Rc&quot;</span>, <span class="st">&quot;Cs&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;N&quot;</span>),</span>
<span id="cb1680-7"><a href="rethinking-chapter-15.html#cb1680-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="fl">1.5</span> ),</span>
<span id="cb1680-8"><a href="rethinking-chapter-15.html#cb1680-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1680-9"><a href="rethinking-chapter-15.html#cb1680-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1680-10"><a href="rethinking-chapter-15.html#cb1680-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;N&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1680-11"><a href="rethinking-chapter-15.html#cb1680-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Cs&quot;</span>, <span class="st">&quot;Rc&quot;</span>),</span>
<span id="cb1680-12"><a href="rethinking-chapter-15.html#cb1680-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>)),</span>
<span id="cb1680-13"><a href="rethinking-chapter-15.html#cb1680-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">&quot;Cs&quot;</span>,<span class="st">&quot;C^&#39;*&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1680-14"><a href="rethinking-chapter-15.html#cb1680-14" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_replace</span>( <span class="st">&quot;Rc&quot;</span>,<span class="st">&quot;R[C]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1680-15"><a href="rethinking-chapter-15.html#cb1680-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1680-16"><a href="rethinking-chapter-15.html#cb1680-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>,</span>
<span id="cb1680-17"><a href="rethinking-chapter-15.html#cb1680-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.6</span>),</span>
<span id="cb1680-18"><a href="rethinking-chapter-15.html#cb1680-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1680-19"><a href="rethinking-chapter-15.html#cb1680-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-39-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math display">\[
\begin{array}{rclr}
N_{i} &amp; \sim &amp; \textrm{Poisson}(\lambda_{i}) &amp; \textrm{[ probability of notes sung ]}\\
\textrm{log}~\lambda_{i} &amp; = &amp; \alpha + \beta~C_{i} &amp; \textrm{[ rate of notes as funtion of cat ]}\\
C_{i} &amp; \sim &amp; \textrm{Bernoulli}(k) &amp; \textrm{[ probability cat is present ]} \\
R_{C, i} &amp; \sim &amp; \textrm{Bernoulli}(r) &amp; \textrm{[ probability of not knowing } C_{i} \textrm{ ]} \\
\end{array}
\]</span></p>
<div class="sourceCode" id="cb1681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1681-1"><a href="rethinking-chapter-15.html#cb1681-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1681-2"><a href="rethinking-chapter-15.html#cb1681-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1681-3"><a href="rethinking-chapter-15.html#cb1681-3" aria-hidden="true" tabindex="-1"></a>n_houses <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1681-4"><a href="rethinking-chapter-15.html#cb1681-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1681-5"><a href="rethinking-chapter-15.html#cb1681-5" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb1681-6"><a href="rethinking-chapter-15.html#cb1681-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb1681-7"><a href="rethinking-chapter-15.html#cb1681-7" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> .<span class="dv">2</span></span>
<span id="cb1681-8"><a href="rethinking-chapter-15.html#cb1681-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1681-9"><a href="rethinking-chapter-15.html#cb1681-9" aria-hidden="true" tabindex="-1"></a>data_cats <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1681-10"><a href="rethinking-chapter-15.html#cb1681-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cat =</span> <span class="fu">rbern</span>( n_houses, k ),</span>
<span id="cb1681-11"><a href="rethinking-chapter-15.html#cb1681-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">notes =</span> <span class="fu">rpois</span>( n_houses, alpha <span class="sc">+</span> beta <span class="sc">*</span> cat ),</span>
<span id="cb1681-12"><a href="rethinking-chapter-15.html#cb1681-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">r_c =</span> <span class="fu">rbern</span>( n_houses, r ),</span>
<span id="cb1681-13"><a href="rethinking-chapter-15.html#cb1681-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">cat_obs =</span> <span class="fu">if_else</span>(r_c <span class="sc">==</span> <span class="dv">0</span>, cat , <span class="sc">-</span>9L)</span>
<span id="cb1681-14"><a href="rethinking-chapter-15.html#cb1681-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The likelihood to observe <span class="math inline">\(N_i\)</span> notes, conditional on <span class="math inline">\(C_i\)</span> is</p>
<p><span class="math display">\[
\begin{array}{rcl}
\textrm{Pr}(N_{i}) &amp; = &amp; (\textrm{probability of cat}) (\textrm{probability of } N_{i} \textrm{ when there is a cat})~+ \\
 &amp; &amp; (\textrm{probability of no cat})  (\textrm{probability of } N_{i} \textrm{ whenthere is no cat}) \\
\textrm{Pr}(N_{i}) &amp; = &amp; \textrm{Pr}(C_{i} = 1)~\textrm{Pr}(N_{i} | C_{i} = 1) + \textrm{Pr}(C_{i} = 0)~\textrm{Pr}(N_{i} | C_{i} = 0) 
\end{array}
\]</span></p>
<div class="sourceCode" id="cb1682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1682-1"><a href="rethinking-chapter-15.html#cb1682-1" aria-hidden="true" tabindex="-1"></a>model_cat <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1682-2"><a href="rethinking-chapter-15.html#cb1682-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1682-3"><a href="rethinking-chapter-15.html#cb1682-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># singing bird model</span></span>
<span id="cb1682-4"><a href="rethinking-chapter-15.html#cb1682-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cat presence is known </span></span>
<span id="cb1682-5"><a href="rethinking-chapter-15.html#cb1682-5" aria-hidden="true" tabindex="-1"></a>    notes <span class="sc">|</span> r_c <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span>  <span class="fu">poisson</span>(lambda),</span>
<span id="cb1682-6"><a href="rethinking-chapter-15.html#cb1682-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(lambda) <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> cat_obs,</span>
<span id="cb1682-7"><a href="rethinking-chapter-15.html#cb1682-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1682-8"><a href="rethinking-chapter-15.html#cb1682-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cat NA</span></span>
<span id="cb1682-9"><a href="rethinking-chapter-15.html#cb1682-9" aria-hidden="true" tabindex="-1"></a>    notes <span class="sc">|</span> r_c <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fu">custom</span>(</span>
<span id="cb1682-10"><a href="rethinking-chapter-15.html#cb1682-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">log_sum_exp</span>(</span>
<span id="cb1682-11"><a href="rethinking-chapter-15.html#cb1682-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">log</span>(k) <span class="sc">+</span> <span class="fu">poisson_lpmf</span>( notes <span class="sc">|</span> <span class="fu">exp</span>(alpha <span class="sc">+</span> beta)),</span>
<span id="cb1682-12"><a href="rethinking-chapter-15.html#cb1682-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> k) <span class="sc">+</span> <span class="fu">poisson_lpmf</span>(notes <span class="sc">|</span> <span class="fu">exp</span>(alpha)) </span>
<span id="cb1682-13"><a href="rethinking-chapter-15.html#cb1682-13" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1682-14"><a href="rethinking-chapter-15.html#cb1682-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1682-15"><a href="rethinking-chapter-15.html#cb1682-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># priors</span></span>
<span id="cb1682-16"><a href="rethinking-chapter-15.html#cb1682-16" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1682-17"><a href="rethinking-chapter-15.html#cb1682-17" aria-hidden="true" tabindex="-1"></a>    beta <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1682-18"><a href="rethinking-chapter-15.html#cb1682-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sneaking cat model</span></span>
<span id="cb1682-19"><a href="rethinking-chapter-15.html#cb1682-19" aria-hidden="true" tabindex="-1"></a>    cat <span class="sc">|</span> r_c <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">bernoulli</span>(k),</span>
<span id="cb1682-20"><a href="rethinking-chapter-15.html#cb1682-20" aria-hidden="true" tabindex="-1"></a>    k <span class="sc">~</span> <span class="fu">beta</span>( <span class="dv">2</span>, <span class="dv">2</span> )</span>
<span id="cb1682-21"><a href="rethinking-chapter-15.html#cb1682-21" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1682-22"><a href="rethinking-chapter-15.html#cb1682-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1682-23"><a href="rethinking-chapter-15.html#cb1682-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">chain =</span> <span class="dv">4</span>,</span>
<span id="cb1682-24"><a href="rethinking-chapter-15.html#cb1682-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1682-25"><a href="rethinking-chapter-15.html#cb1682-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_cats</span>
<span id="cb1682-26"><a href="rethinking-chapter-15.html#cb1682-26" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><span class="math display">\[
\textrm{Pr}(C_{i} = 1 | N_{i} ) =  \frac{\textrm{Pr}(N_{i} | C_{i} = 1 )~\textrm{Pr}(C_{i} = 1)}{\textrm{Pr}(N_{i} | C_{i} = 1)~\textrm{Pr}(C_{i} = 1) + \textrm{Pr}(N_{i} | C_{i} = 0)~\textrm{Pr}(C_{i} = 0)} 
\]</span></p>
<div class="sourceCode" id="cb1683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1683-1"><a href="rethinking-chapter-15.html#cb1683-1" aria-hidden="true" tabindex="-1"></a>data_cats_list <span class="ot">&lt;-</span> data_cats <span class="sc">%&gt;%</span> </span>
<span id="cb1683-2"><a href="rethinking-chapter-15.html#cb1683-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1683-3"><a href="rethinking-chapter-15.html#cb1683-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(., <span class="fu">list</span>(<span class="at">n_houses =</span> n_houses))</span>
<span id="cb1683-4"><a href="rethinking-chapter-15.html#cb1683-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1683-5"><a href="rethinking-chapter-15.html#cb1683-5" aria-hidden="true" tabindex="-1"></a>model_cat_gq <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1683-6"><a href="rethinking-chapter-15.html#cb1683-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1683-7"><a href="rethinking-chapter-15.html#cb1683-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># singing bird model</span></span>
<span id="cb1683-8"><a href="rethinking-chapter-15.html#cb1683-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cat presence is known </span></span>
<span id="cb1683-9"><a href="rethinking-chapter-15.html#cb1683-9" aria-hidden="true" tabindex="-1"></a>    notes <span class="sc">|</span> r_c <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span>  <span class="fu">poisson</span>(lambda),</span>
<span id="cb1683-10"><a href="rethinking-chapter-15.html#cb1683-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(lambda) <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> cat_obs,</span>
<span id="cb1683-11"><a href="rethinking-chapter-15.html#cb1683-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1683-12"><a href="rethinking-chapter-15.html#cb1683-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cat NA</span></span>
<span id="cb1683-13"><a href="rethinking-chapter-15.html#cb1683-13" aria-hidden="true" tabindex="-1"></a>    notes <span class="sc">|</span> r_c <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fu">custom</span>(</span>
<span id="cb1683-14"><a href="rethinking-chapter-15.html#cb1683-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">log_sum_exp</span>(</span>
<span id="cb1683-15"><a href="rethinking-chapter-15.html#cb1683-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">log</span>(k) <span class="sc">+</span> <span class="fu">poisson_lpmf</span>( notes <span class="sc">|</span> <span class="fu">exp</span>(alpha <span class="sc">+</span> beta)),</span>
<span id="cb1683-16"><a href="rethinking-chapter-15.html#cb1683-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> k) <span class="sc">+</span> <span class="fu">poisson_lpmf</span>(notes <span class="sc">|</span> <span class="fu">exp</span>(alpha)) </span>
<span id="cb1683-17"><a href="rethinking-chapter-15.html#cb1683-17" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1683-18"><a href="rethinking-chapter-15.html#cb1683-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1683-19"><a href="rethinking-chapter-15.html#cb1683-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># priors</span></span>
<span id="cb1683-20"><a href="rethinking-chapter-15.html#cb1683-20" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1683-21"><a href="rethinking-chapter-15.html#cb1683-21" aria-hidden="true" tabindex="-1"></a>    beta <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1683-22"><a href="rethinking-chapter-15.html#cb1683-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sneaking cat model</span></span>
<span id="cb1683-23"><a href="rethinking-chapter-15.html#cb1683-23" aria-hidden="true" tabindex="-1"></a>    cat <span class="sc">|</span> r_c <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">bernoulli</span>(k),</span>
<span id="cb1683-24"><a href="rethinking-chapter-15.html#cb1683-24" aria-hidden="true" tabindex="-1"></a>    k <span class="sc">~</span> <span class="fu">beta</span>( <span class="dv">2</span>, <span class="dv">2</span> ),</span>
<span id="cb1683-25"><a href="rethinking-chapter-15.html#cb1683-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># imputed values</span></span>
<span id="cb1683-26"><a href="rethinking-chapter-15.html#cb1683-26" aria-hidden="true" tabindex="-1"></a>    gq<span class="sc">&gt;</span> vector[n_houses]<span class="sc">:</span>pr_c1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(lp_c1) <span class="sc">/</span> (<span class="fu">exp</span>(lp_c1) <span class="sc">+</span> <span class="fu">exp</span>(lp_c0)),</span>
<span id="cb1683-27"><a href="rethinking-chapter-15.html#cb1683-27" aria-hidden="true" tabindex="-1"></a>    gq<span class="sc">&gt;</span> vector[n_houses]<span class="sc">:</span>lp_c1 <span class="ot">&lt;-</span> <span class="fu">log</span>(k) <span class="sc">+</span> <span class="fu">poisson_lpmf</span>(notes[i] <span class="sc">|</span> <span class="fu">exp</span>(alpha <span class="sc">+</span> beta)),</span>
<span id="cb1683-28"><a href="rethinking-chapter-15.html#cb1683-28" aria-hidden="true" tabindex="-1"></a>    gq<span class="sc">&gt;</span> vector[n_houses]<span class="sc">:</span>lp_c0 <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> k) <span class="sc">+</span> <span class="fu">poisson_lpmf</span>(notes[i] <span class="sc">|</span> <span class="fu">exp</span>(alpha))</span>
<span id="cb1683-29"><a href="rethinking-chapter-15.html#cb1683-29" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1683-30"><a href="rethinking-chapter-15.html#cb1683-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1683-31"><a href="rethinking-chapter-15.html#cb1683-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">chain =</span> <span class="dv">4</span>,</span>
<span id="cb1683-32"><a href="rethinking-chapter-15.html#cb1683-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1683-33"><a href="rethinking-chapter-15.html#cb1683-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_cats_list</span>
<span id="cb1683-34"><a href="rethinking-chapter-15.html#cb1683-34" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Example for a non-binary categorical value (multiple options, eg up to two cats):</p>
<pre><code>notes | r_c == 1 ~ custom(
  log_sum_exp(
    binomial_lpmf(2|2, k) + poisson_lpmf( notes | exp(alpha + beta * 2)),
    binomial_lpmf(1|2, k) + poisson_lpmf( notes | exp(alpha + beta * 1)),
    binomial_lpmf(0|2, k) + poisson_lpmf(notes | exp(alpha + beta * 0)) 
  )</code></pre>
<p>The extension for multiple categorical variables (eg. cat <em>and</em> dog) with missing values expands to the following.</p>
<p>If both cat and dog are NA:</p>
<p><span class="math display">\[
\begin{array}{rcl}
\textrm{Pr}(N_{i}) &amp; = &amp; \textrm{Pr}(C_{i} = 1)~\textrm{Pr}(D_{i} = 1)~\textrm{Pr}(N_{i} | C_{i} = 1, D_{i} = 1)~+\\
&amp;&amp;\textrm{Pr}(C_{i} = 1)~\textrm{Pr}(D_{i} = 0)~\textrm{Pr}(N_{i} | C_{i} = 1, D_{i} = 0)~+ \\
&amp;&amp;\textrm{Pr}(C_{i} = 0)~\textrm{Pr}(D_{i} = 1)~\textrm{Pr}(N_{i} | C_{i} = 0, D_{i} = 1)~+ \\
&amp;&amp;\textrm{Pr}(C_{i} = 0)~\textrm{Pr}(D_{i} = 0)~\textrm{Pr}(N_{i} | C_{i} = 0, D_{i} = 0)
\end{array}
\]</span></p>
<p>If cat is NA and dog is known present:</p>
<p><span class="math display">\[
\begin{array}{rcl}
\textrm{Pr}(N_{i}) &amp; = &amp; \textrm{Pr}(C_{i} = 1)~\textrm{Pr}(N_{i} | C_{i} = 1, D_{i} = 1) + \textrm{Pr}(C_{i} = 0)~\textrm{Pr}(N_{i} | C_{i} = 0, D_{i} = 1) 
\end{array}
\]</span></p>
<p>likewise, if dog is NA and cat is known absent:</p>
<p><span class="math display">\[
\begin{array}{rcl}
\textrm{Pr}(N_{i}) &amp; = &amp; \textrm{Pr}(D_{i} = 1)~\textrm{Pr}(N_{i} | C_{i} = 0, D_{i} = 1) + \textrm{Pr}(D_{i} = 0)~\textrm{Pr}(N_{i} | C_{i} = 0, D_{i} = 0) 
\end{array}
\]</span>
(all combinations need to be accounted for though)</p>
<hr />
<div class="sourceCode" id="cb1685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1685-1"><a href="rethinking-chapter-15.html#cb1685-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb1685-2"><a href="rethinking-chapter-15.html#cb1685-2" aria-hidden="true" tabindex="-1"></a>chapter15_models <span class="ot">&lt;-</span> <span class="fu">env</span>(</span>
<span id="cb1685-3"><a href="rethinking-chapter-15.html#cb1685-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1685-4"><a href="rethinking-chapter-15.html#cb1685-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1685-5"><a href="rethinking-chapter-15.html#cb1685-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(chapter15_models, <span class="st">&quot;envs/chapter15_models.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="homework-13" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Homework<a href="rethinking-chapter-15.html#homework-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>E1</strong></p>
<p><span class="math display">\[
\begin{array}{rcl}
T_{i} &amp; \sim &amp; \textrm{Poisson}(\mu_{i})\\
\textrm{log}~\mu_{i} &amp; = &amp; \alpha + \beta ~ \textrm{log}~P_{\textrm{TRUE},i}\\
P_{\textrm{TRUE}, i} &amp; \sim &amp;  \textrm{Normal}(P_{\textrm{OBS},i}, P_{\textrm{SE}})\\
\alpha &amp; \sim &amp; \textrm{Normal}(0, 1.5)\\
\beta &amp; \sim &amp; \textrm{Normal}(0, 1) \\
P_{SE} &amp; \sim &amp; \textrm{Exponential}(1)
\end{array}
\]</span></p>
<p><strong>E2</strong></p>
<p><span class="math display">\[
\begin{array}{rcl}
T_{i} &amp; \sim &amp; \textrm{Poisson}(\mu_{i})\\
\textrm{log}~\mu_{i} &amp; = &amp; \alpha + \beta ~ P_{\textrm{TRUE},i}\\
P_{\textrm{TRUE}, i} &amp; \sim &amp;  \textrm{Normal}(\overline{P_{\textrm{OBS}}}, P_{\textrm{SE}})\\
\alpha &amp; \sim &amp; \textrm{Normal}(0, 1.5)\\
\beta &amp; \sim &amp; \textrm{Normal}(0, 1) \\
\overline{P_{\textrm{OBS}}} &amp; \sim &amp; \textrm{Normal}(0, 1) \\
P_{SE} &amp; \sim &amp; \textrm{Exponential}(1)
\end{array}
\]</span></p>
<p><strong>M1</strong></p>
<p><span class="math display">\[
\begin{array}{rclr}
K_{i} &amp; \sim &amp; \textrm{Normal}(\mu_{i}, \sigma) &amp; \textrm{[ distribution for outcome }k\textrm{ ]}\\
\mu_{i} &amp; = &amp; \alpha + \beta_{B} \color{#B35136}{B_{i}} + \beta_{M}~\textrm{log} M_{i} &amp; \textrm{[ linear model ]}\\
\color{#B35136}{B_{i}} &amp; \sim &amp; \color{#B35136}{\textrm{Normal}(\nu, \sigma_{B})} &amp; \textrm{[ distribution of obs/missing }B\textrm{ ]}\\
\alpha &amp; \sim &amp; \textrm{Normal}(0,0.5) &amp; \\
\beta_{B} &amp; \sim &amp; \textrm{Normal}(0,0.5) &amp; \\
\beta_{M} &amp; \sim &amp; \textrm{Normal}(0,0.5) &amp; \\
\sigma &amp; \sim &amp; \textrm{Exponential}(1) &amp; \\
\nu &amp; \sim &amp; \textrm{Normal}(0.5, 1) &amp; \\
\sigma_{B} &amp; \sim &amp; \textrm{Exponential}(1) &amp; \\
\end{array}
\]</span></p>
<p>This imputation model assumes that the data generating process behind brain size in primates is gaussian with the average <span class="math inline">\(\nu\)</span> and a standard deviation of <span class="math inline">\(\sigma_{B}\)</span>.
It furthermore assumes that error in measurement is also gaussian, centered on the actual values (0), but with an variance that is equal to the on in the data generating process.
Importantly, the error generating process is assumed to be <em>random</em>.</p>
<p><strong>M2</strong></p>
<div class="sourceCode" id="cb1686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1686-1"><a href="rethinking-chapter-15.html#cb1686-1" aria-hidden="true" tabindex="-1"></a>data_milk_list2 <span class="ot">&lt;-</span> data_milk_full <span class="sc">%&gt;%</span></span>
<span id="cb1686-2"><a href="rethinking-chapter-15.html#cb1686-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, kcal_std, </span>
<span id="cb1686-3"><a href="rethinking-chapter-15.html#cb1686-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">neocortex_prop =</span> neocortex.prop, mass_std) <span class="sc">%&gt;%</span></span>
<span id="cb1686-4"><a href="rethinking-chapter-15.html#cb1686-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1686-5"><a href="rethinking-chapter-15.html#cb1686-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1686-6"><a href="rethinking-chapter-15.html#cb1686-6" aria-hidden="true" tabindex="-1"></a>model_primates_beta <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1686-7"><a href="rethinking-chapter-15.html#cb1686-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1686-8"><a href="rethinking-chapter-15.html#cb1686-8" aria-hidden="true" tabindex="-1"></a>    kcal_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu, sigma ),</span>
<span id="cb1686-9"><a href="rethinking-chapter-15.html#cb1686-9" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb1686-10"><a href="rethinking-chapter-15.html#cb1686-10" aria-hidden="true" tabindex="-1"></a>      beta_brain <span class="sc">*</span> ( neocortex_prop <span class="sc">-</span> <span class="fl">0.67</span> ) <span class="sc">+</span></span>
<span id="cb1686-11"><a href="rethinking-chapter-15.html#cb1686-11" aria-hidden="true" tabindex="-1"></a>      beta_mass <span class="sc">*</span> mass_std,</span>
<span id="cb1686-12"><a href="rethinking-chapter-15.html#cb1686-12" aria-hidden="true" tabindex="-1"></a>    neocortex_prop <span class="sc">~</span> <span class="fu">dbeta2</span>( nu, theta_brain ),</span>
<span id="cb1686-13"><a href="rethinking-chapter-15.html#cb1686-13" aria-hidden="true" tabindex="-1"></a>    nu <span class="sc">~</span> <span class="fu">dbeta</span>( <span class="dv">2</span>, <span class="dv">2</span> ),</span>
<span id="cb1686-14"><a href="rethinking-chapter-15.html#cb1686-14" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1686-15"><a href="rethinking-chapter-15.html#cb1686-15" aria-hidden="true" tabindex="-1"></a>    beta_brain <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">10</span> ), </span>
<span id="cb1686-16"><a href="rethinking-chapter-15.html#cb1686-16" aria-hidden="true" tabindex="-1"></a>    beta_mass <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1686-17"><a href="rethinking-chapter-15.html#cb1686-17" aria-hidden="true" tabindex="-1"></a>    theta_brain <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>),</span>
<span id="cb1686-18"><a href="rethinking-chapter-15.html#cb1686-18" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>),</span>
<span id="cb1686-19"><a href="rethinking-chapter-15.html#cb1686-19" aria-hidden="true" tabindex="-1"></a>    vector[<span class="dv">12</span>]<span class="sc">:</span>neocortex_prop_impute <span class="sc">~</span> <span class="fu">uniform</span>( <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1686-20"><a href="rethinking-chapter-15.html#cb1686-20" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1686-21"><a href="rethinking-chapter-15.html#cb1686-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_milk_list2,</span>
<span id="cb1686-22"><a href="rethinking-chapter-15.html#cb1686-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1686-23"><a href="rethinking-chapter-15.html#cb1686-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1686-24"><a href="rethinking-chapter-15.html#cb1686-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb1686-25"><a href="rethinking-chapter-15.html#cb1686-25" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1687-1"><a href="rethinking-chapter-15.html#cb1687-1" aria-hidden="true" tabindex="-1"></a>primates_posterior <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_primates_beta) <span class="sc">%&gt;%</span> </span>
<span id="cb1687-2"><a href="rethinking-chapter-15.html#cb1687-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1687-3"><a href="rethinking-chapter-15.html#cb1687-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1687-4"><a href="rethinking-chapter-15.html#cb1687-4" aria-hidden="true" tabindex="-1"></a>imputed_neocortex <span class="ot">&lt;-</span> primates_posterior<span class="sc">$</span>neocortex_prop_impute <span class="sc">%&gt;%</span> </span>
<span id="cb1687-5"><a href="rethinking-chapter-15.html#cb1687-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1687-6"><a href="rethinking-chapter-15.html#cb1687-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1687-7"><a href="rethinking-chapter-15.html#cb1687-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb1687-8"><a href="rethinking-chapter-15.html#cb1687-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pi =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">value =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">055</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>, .<span class="dv">955</span>)),</span>
<span id="cb1687-9"><a href="rethinking-chapter-15.html#cb1687-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;ll&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;hh&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb1687-10"><a href="rethinking-chapter-15.html#cb1687-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_remove</span>(name, <span class="st">&quot;V&quot;</span>) <span class="sc">%&gt;%</span>  <span class="fu">as.integer</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1687-11"><a href="rethinking-chapter-15.html#cb1687-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb1687-12"><a href="rethinking-chapter-15.html#cb1687-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pi) <span class="sc">%&gt;%</span> </span>
<span id="cb1687-13"><a href="rethinking-chapter-15.html#cb1687-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> label, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb1687-14"><a href="rethinking-chapter-15.html#cb1687-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_milk_full <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(neocortex.perc)),.)</span>
<span id="cb1687-15"><a href="rethinking-chapter-15.html#cb1687-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1687-16"><a href="rethinking-chapter-15.html#cb1687-16" aria-hidden="true" tabindex="-1"></a>data_milk_list2 <span class="sc">%&gt;%</span> </span>
<span id="cb1687-17"><a href="rethinking-chapter-15.html#cb1687-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1687-18"><a href="rethinking-chapter-15.html#cb1687-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(neocortex_prop)) <span class="sc">%&gt;%</span> </span>
<span id="cb1687-19"><a href="rethinking-chapter-15.html#cb1687-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> neocortex_prop, <span class="at">y =</span> kcal_std)) <span class="sc">+</span></span>
<span id="cb1687-20"><a href="rethinking-chapter-15.html#cb1687-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">data =</span> imputed_neocortex,</span>
<span id="cb1687-21"><a href="rethinking-chapter-15.html#cb1687-21" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">xmin =</span> ll, <span class="at">x =</span> m ,<span class="at">xmax =</span> hh),</span>
<span id="cb1687-22"><a href="rethinking-chapter-15.html#cb1687-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0,</span>
<span id="cb1687-23"><a href="rethinking-chapter-15.html#cb1687-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fatten  =</span> <span class="fl">2.6</span>) <span class="sc">+</span></span>
<span id="cb1687-24"><a href="rethinking-chapter-15.html#cb1687-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clr_current, <span class="at">size =</span> <span class="fl">1.6</span>)</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-43-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>M3</strong></p>
<div class="sourceCode" id="cb1688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1688-1"><a href="rethinking-chapter-15.html#cb1688-1" aria-hidden="true" tabindex="-1"></a>model_divorce_double_se <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1688-2"><a href="rethinking-chapter-15.html#cb1688-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1688-3"><a href="rethinking-chapter-15.html#cb1688-3" aria-hidden="true" tabindex="-1"></a>    divorce_obs <span class="sc">~</span> <span class="fu">dnorm</span>( divorce_true, divorce_sd <span class="sc">*</span> <span class="fl">2.0</span> ),</span>
<span id="cb1688-4"><a href="rethinking-chapter-15.html#cb1688-4" aria-hidden="true" tabindex="-1"></a>    vector[N]<span class="sc">:</span>divorce_true <span class="sc">~</span> <span class="fu">dnorm</span>( mu, sigma ),</span>
<span id="cb1688-5"><a href="rethinking-chapter-15.html#cb1688-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_age <span class="sc">*</span> median_age_std <span class="sc">+</span> beta_marriage <span class="sc">*</span> marriage_std,</span>
<span id="cb1688-6"><a href="rethinking-chapter-15.html#cb1688-6" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.2</span> ),</span>
<span id="cb1688-7"><a href="rethinking-chapter-15.html#cb1688-7" aria-hidden="true" tabindex="-1"></a>    beta_age <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1688-8"><a href="rethinking-chapter-15.html#cb1688-8" aria-hidden="true" tabindex="-1"></a>    beta_marriage <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1688-9"><a href="rethinking-chapter-15.html#cb1688-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb1688-10"><a href="rethinking-chapter-15.html#cb1688-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1688-11"><a href="rethinking-chapter-15.html#cb1688-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_waffle_list,</span>
<span id="cb1688-12"><a href="rethinking-chapter-15.html#cb1688-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1688-13"><a href="rethinking-chapter-15.html#cb1688-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1688-14"><a href="rethinking-chapter-15.html#cb1688-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_lik =</span> <span class="cn">TRUE</span></span>
<span id="cb1688-15"><a href="rethinking-chapter-15.html#cb1688-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><span class="math inline">\(\rightarrow\)</span> lots of divergent transitions</p>
<div class="sourceCode" id="cb1689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1689-1"><a href="rethinking-chapter-15.html#cb1689-1" aria-hidden="true" tabindex="-1"></a>model_divorce_double_se_noncentered <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1689-2"><a href="rethinking-chapter-15.html#cb1689-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1689-3"><a href="rethinking-chapter-15.html#cb1689-3" aria-hidden="true" tabindex="-1"></a>    divorce_obs <span class="sc">~</span> <span class="fu">dnorm</span>( mu <span class="sc">+</span> z_true <span class="sc">*</span> sigma, divorce_sd <span class="sc">*</span> <span class="fl">2.0</span> ),</span>
<span id="cb1689-4"><a href="rethinking-chapter-15.html#cb1689-4" aria-hidden="true" tabindex="-1"></a>    vector[N]<span class="sc">:</span>z_true <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1689-5"><a href="rethinking-chapter-15.html#cb1689-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_age <span class="sc">*</span> median_age_std <span class="sc">+</span> beta_marriage <span class="sc">*</span> marriage_std,</span>
<span id="cb1689-6"><a href="rethinking-chapter-15.html#cb1689-6" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.2</span> ),</span>
<span id="cb1689-7"><a href="rethinking-chapter-15.html#cb1689-7" aria-hidden="true" tabindex="-1"></a>    beta_age <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1689-8"><a href="rethinking-chapter-15.html#cb1689-8" aria-hidden="true" tabindex="-1"></a>    beta_marriage <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="fl">0.5</span> ),</span>
<span id="cb1689-9"><a href="rethinking-chapter-15.html#cb1689-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb1689-10"><a href="rethinking-chapter-15.html#cb1689-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1689-11"><a href="rethinking-chapter-15.html#cb1689-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_waffle_list,</span>
<span id="cb1689-12"><a href="rethinking-chapter-15.html#cb1689-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1689-13"><a href="rethinking-chapter-15.html#cb1689-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1689-14"><a href="rethinking-chapter-15.html#cb1689-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_lik =</span> <span class="cn">TRUE</span></span>
<span id="cb1689-15"><a href="rethinking-chapter-15.html#cb1689-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1690-1"><a href="rethinking-chapter-15.html#cb1690-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_divorce) <span class="sc">%&gt;%</span> </span>
<span id="cb1690-2"><a href="rethinking-chapter-15.html#cb1690-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.05</td>
<td align="right">0.09</td>
<td align="right">-0.20</td>
<td align="right">0.10</td>
<td align="right">1585.93</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_age</td>
<td align="right">-0.61</td>
<td align="right">0.16</td>
<td align="right">-0.86</td>
<td align="right">-0.36</td>
<td align="right">1169.42</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">beta_marriage</td>
<td align="right">0.05</td>
<td align="right">0.17</td>
<td align="right">-0.21</td>
<td align="right">0.32</td>
<td align="right">1014.84</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.59</td>
<td align="right">0.10</td>
<td align="right">0.43</td>
<td align="right">0.76</td>
<td align="right">769.88</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1691-1"><a href="rethinking-chapter-15.html#cb1691-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_divorce_double_se_noncentered) <span class="sc">%&gt;%</span> </span>
<span id="cb1691-2"><a href="rethinking-chapter-15.html#cb1691-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.12</td>
<td align="right">0.10</td>
<td align="right">-0.28</td>
<td align="right">0.04</td>
<td align="right">2738.54</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">beta_age</td>
<td align="right">-0.65</td>
<td align="right">0.17</td>
<td align="right">-0.91</td>
<td align="right">-0.37</td>
<td align="right">2324.01</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">beta_marriage</td>
<td align="right">0.19</td>
<td align="right">0.19</td>
<td align="right">-0.12</td>
<td align="right">0.48</td>
<td align="right">2191.71</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.15</td>
<td align="right">0.11</td>
<td align="right">0.01</td>
<td align="right">0.35</td>
<td align="right">815.90</td>
<td align="right">1.01</td>
</tr>
</tbody>
</table>
<p><strong>M4</strong></p>
<div class="sourceCode" id="cb1692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1692-1"><a href="rethinking-chapter-15.html#cb1692-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(</span>
<span id="cb1692-2"><a href="rethinking-chapter-15.html#cb1692-2" aria-hidden="true" tabindex="-1"></a>  Z <span class="sc">~</span> Y,</span>
<span id="cb1692-3"><a href="rethinking-chapter-15.html#cb1692-3" aria-hidden="true" tabindex="-1"></a>  Y <span class="sc">~</span> X,</span>
<span id="cb1692-4"><a href="rethinking-chapter-15.html#cb1692-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb1692-5"><a href="rethinking-chapter-15.html#cb1692-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb1692-6"><a href="rethinking-chapter-15.html#cb1692-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;Z&quot;</span>),</span>
<span id="cb1692-7"><a href="rethinking-chapter-15.html#cb1692-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span> ),</span>
<span id="cb1692-8"><a href="rethinking-chapter-15.html#cb1692-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1692-9"><a href="rethinking-chapter-15.html#cb1692-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1692-10"><a href="rethinking-chapter-15.html#cb1692-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1692-11"><a href="rethinking-chapter-15.html#cb1692-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Z&quot;</span>, <span class="st">&quot;X&quot;</span>),</span>
<span id="cb1692-12"><a href="rethinking-chapter-15.html#cb1692-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1692-13"><a href="rethinking-chapter-15.html#cb1692-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1692-14"><a href="rethinking-chapter-15.html#cb1692-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>,</span>
<span id="cb1692-15"><a href="rethinking-chapter-15.html#cb1692-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1692-16"><a href="rethinking-chapter-15.html#cb1692-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1692-17"><a href="rethinking-chapter-15.html#cb1692-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb1692-18"><a href="rethinking-chapter-15.html#cb1692-18" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/M4-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1693-1"><a href="rethinking-chapter-15.html#cb1693-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb1693-2"><a href="rethinking-chapter-15.html#cb1693-2" aria-hidden="true" tabindex="-1"></a>data_sim_dag <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb1693-3"><a href="rethinking-chapter-15.html#cb1693-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> <span class="fu">rnorm</span>(n, x),</span>
<span id="cb1693-4"><a href="rethinking-chapter-15.html#cb1693-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">z =</span> <span class="fu">rnorm</span>(n , y))</span>
<span id="cb1693-5"><a href="rethinking-chapter-15.html#cb1693-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1693-6"><a href="rethinking-chapter-15.html#cb1693-6" aria-hidden="true" tabindex="-1"></a>model_sim_dag <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1693-7"><a href="rethinking-chapter-15.html#cb1693-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span>  <span class="fu">alist</span>(</span>
<span id="cb1693-8"><a href="rethinking-chapter-15.html#cb1693-8" aria-hidden="true" tabindex="-1"></a>    y <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ),</span>
<span id="cb1693-9"><a href="rethinking-chapter-15.html#cb1693-9" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_x <span class="sc">*</span> x <span class="sc">+</span> beta_z <span class="sc">*</span> z,</span>
<span id="cb1693-10"><a href="rethinking-chapter-15.html#cb1693-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(alpha, beta_x, beta_z) <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1693-11"><a href="rethinking-chapter-15.html#cb1693-11" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb1693-12"><a href="rethinking-chapter-15.html#cb1693-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1693-13"><a href="rethinking-chapter-15.html#cb1693-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_sim_dag,</span>
<span id="cb1693-14"><a href="rethinking-chapter-15.html#cb1693-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1693-15"><a href="rethinking-chapter-15.html#cb1693-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1694-1"><a href="rethinking-chapter-15.html#cb1694-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_sim_dag) <span class="sc">%&gt;%</span> </span>
<span id="cb1694-2"><a href="rethinking-chapter-15.html#cb1694-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">beta_z</td>
<td align="right">0.45</td>
<td align="right">0.02</td>
<td align="right">0.41</td>
<td align="right">0.48</td>
<td align="right">1441.44</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_x</td>
<td align="right">0.51</td>
<td align="right">0.04</td>
<td align="right">0.45</td>
<td align="right">0.57</td>
<td align="right">1426.12</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.01</td>
<td align="right">0.03</td>
<td align="right">-0.06</td>
<td align="right">0.04</td>
<td align="right">1870.59</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.72</td>
<td align="right">0.02</td>
<td align="right">0.68</td>
<td align="right">0.75</td>
<td align="right">1857.25</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p><strong>M5</strong></p>
<div class="sourceCode" id="cb1695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1695-1"><a href="rethinking-chapter-15.html#cb1695-1" aria-hidden="true" tabindex="-1"></a>birds_posterior <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_cat_gq) <span class="sc">%&gt;%</span> </span>
<span id="cb1695-2"><a href="rethinking-chapter-15.html#cb1695-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1695-3"><a href="rethinking-chapter-15.html#cb1695-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1695-4"><a href="rethinking-chapter-15.html#cb1695-4" aria-hidden="true" tabindex="-1"></a>birds_posterior<span class="sc">$</span>pr_c1 <span class="sc">%&gt;%</span> </span>
<span id="cb1695-5"><a href="rethinking-chapter-15.html#cb1695-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1695-6"><a href="rethinking-chapter-15.html#cb1695-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1695-7"><a href="rethinking-chapter-15.html#cb1695-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_cats_list <span class="sc">%&gt;%</span> </span>
<span id="cb1695-8"><a href="rethinking-chapter-15.html#cb1695-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1695-9"><a href="rethinking-chapter-15.html#cb1695-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cat_idx =</span> <span class="fu">row_number</span>()), .) <span class="sc">%&gt;%</span> </span>
<span id="cb1695-10"><a href="rethinking-chapter-15.html#cb1695-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">&quot;..&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1695-11"><a href="rethinking-chapter-15.html#cb1695-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cat_idx) <span class="sc">%&gt;%</span> </span>
<span id="cb1695-12"><a href="rethinking-chapter-15.html#cb1695-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cat =</span> cat[[<span class="dv">1</span>]],</span>
<span id="cb1695-13"><a href="rethinking-chapter-15.html#cb1695-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">pi =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">value =</span> <span class="fu">c</span>(<span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">055</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>, .<span class="dv">955</span>)), <span class="fu">mean</span>(value)),</span>
<span id="cb1695-14"><a href="rethinking-chapter-15.html#cb1695-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;ll&#39;</span>, <span class="st">&#39;l&#39;</span>, <span class="st">&#39;m&#39;</span>, <span class="st">&#39;h&#39;</span>, <span class="st">&#39;hh&#39;</span>, <span class="st">&#39;mean&#39;</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb1695-15"><a href="rethinking-chapter-15.html#cb1695-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1695-16"><a href="rethinking-chapter-15.html#cb1695-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pi) <span class="sc">%&gt;%</span> </span>
<span id="cb1695-17"><a href="rethinking-chapter-15.html#cb1695-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;labels&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1695-18"><a href="rethinking-chapter-15.html#cb1695-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cat_idx =</span> <span class="fu">fct_reorder</span>(<span class="fu">as.character</span>(cat_idx), mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb1695-19"><a href="rethinking-chapter-15.html#cb1695-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cat_idx)) <span class="sc">+</span></span>
<span id="cb1695-20"><a href="rethinking-chapter-15.html#cb1695-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ll, <span class="at">ymax =</span> hh),</span>
<span id="cb1695-21"><a href="rethinking-chapter-15.html#cb1695-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> clr_current, <span class="at">size =</span> .<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb1695-22"><a href="rethinking-chapter-15.html#cb1695-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> m, <span class="at">shape =</span> <span class="fu">factor</span>(cat)),</span>
<span id="cb1695-23"><a href="rethinking-chapter-15.html#cb1695-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_current, <span class="at">fill =</span> <span class="fu">clr_lighten</span>(clr_current, .<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb1695-24"><a href="rethinking-chapter-15.html#cb1695-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1695-25"><a href="rethinking-chapter-15.html#cb1695-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">21</span>, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">19</span>), <span class="at">guide =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/M5-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>M6</strong></p>
<div class="sourceCode" id="cb1696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1696-1"><a href="rethinking-chapter-15.html#cb1696-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1696-2"><a href="rethinking-chapter-15.html#cb1696-2" aria-hidden="true" tabindex="-1"></a>data_sim_dog <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">.idx =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb1696-3"><a href="rethinking-chapter-15.html#cb1696-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">s =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb1696-4"><a href="rethinking-chapter-15.html#cb1696-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">h =</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">10</span>, <span class="fu">inv_logit</span>(s)),</span>
<span id="cb1696-5"><a href="rethinking-chapter-15.html#cb1696-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">d =</span> <span class="fu">rbern</span>(n),</span>
<span id="cb1696-6"><a href="rethinking-chapter-15.html#cb1696-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">h_missing =</span> <span class="fu">if_else</span>(d <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA_integer_</span>, h))</span></code></pre></div>
<div class="sourceCode" id="cb1697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1697-1"><a href="rethinking-chapter-15.html#cb1697-1" aria-hidden="true" tabindex="-1"></a>data_sim_dog_list_1 <span class="ot">&lt;-</span> data_sim_dog <span class="sc">%&gt;%</span> </span>
<span id="cb1697-2"><a href="rethinking-chapter-15.html#cb1697-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.idx) <span class="sc">%&gt;%</span> </span>
<span id="cb1697-3"><a href="rethinking-chapter-15.html#cb1697-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(h_missing)) <span class="sc">%&gt;%</span> </span>
<span id="cb1697-4"><a href="rethinking-chapter-15.html#cb1697-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1697-5"><a href="rethinking-chapter-15.html#cb1697-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1697-6"><a href="rethinking-chapter-15.html#cb1697-6" aria-hidden="true" tabindex="-1"></a>model_sim_dog_1 <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1697-7"><a href="rethinking-chapter-15.html#cb1697-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1697-8"><a href="rethinking-chapter-15.html#cb1697-8" aria-hidden="true" tabindex="-1"></a>    h_missing <span class="sc">~</span> <span class="fu">binomial</span>( <span class="dv">10</span> , p ),</span>
<span id="cb1697-9"><a href="rethinking-chapter-15.html#cb1697-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_s <span class="sc">*</span> s,</span>
<span id="cb1697-10"><a href="rethinking-chapter-15.html#cb1697-10" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ),</span>
<span id="cb1697-11"><a href="rethinking-chapter-15.html#cb1697-11" aria-hidden="true" tabindex="-1"></a>    beta_s <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb1697-12"><a href="rethinking-chapter-15.html#cb1697-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1697-13"><a href="rethinking-chapter-15.html#cb1697-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_sim_dog_list_1,</span>
<span id="cb1697-14"><a href="rethinking-chapter-15.html#cb1697-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1697-15"><a href="rethinking-chapter-15.html#cb1697-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1698-1"><a href="rethinking-chapter-15.html#cb1698-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( model_sim_dog_1 ) <span class="sc">%&gt;%</span> </span>
<span id="cb1698-2"><a href="rethinking-chapter-15.html#cb1698-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.13</td>
<td align="right">0.10</td>
<td align="right">-0.29</td>
<td align="right">0.02</td>
<td align="right">1336.04</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_s</td>
<td align="right">0.97</td>
<td align="right">0.12</td>
<td align="right">0.79</td>
<td align="right">1.16</td>
<td align="right">1138.22</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1699-1"><a href="rethinking-chapter-15.html#cb1699-1" aria-hidden="true" tabindex="-1"></a>data_sim_dog_list_2 <span class="ot">&lt;-</span> data_sim_dog <span class="sc">%&gt;%</span> </span>
<span id="cb1699-2"><a href="rethinking-chapter-15.html#cb1699-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.idx) <span class="sc">%&gt;%</span> </span>
<span id="cb1699-3"><a href="rethinking-chapter-15.html#cb1699-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">h_missing =</span> <span class="fu">if_else</span>(s <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="cn">NA_integer_</span>, h)) <span class="sc">%&gt;%</span> </span>
<span id="cb1699-4"><a href="rethinking-chapter-15.html#cb1699-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(h_missing)) <span class="sc">%&gt;%</span> </span>
<span id="cb1699-5"><a href="rethinking-chapter-15.html#cb1699-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1699-6"><a href="rethinking-chapter-15.html#cb1699-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1699-7"><a href="rethinking-chapter-15.html#cb1699-7" aria-hidden="true" tabindex="-1"></a>model_sim_dog_2 <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1699-8"><a href="rethinking-chapter-15.html#cb1699-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1699-9"><a href="rethinking-chapter-15.html#cb1699-9" aria-hidden="true" tabindex="-1"></a>    h_missing <span class="sc">~</span> <span class="fu">binomial</span>( <span class="dv">10</span> , p ),</span>
<span id="cb1699-10"><a href="rethinking-chapter-15.html#cb1699-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_s <span class="sc">*</span> s,</span>
<span id="cb1699-11"><a href="rethinking-chapter-15.html#cb1699-11" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ),</span>
<span id="cb1699-12"><a href="rethinking-chapter-15.html#cb1699-12" aria-hidden="true" tabindex="-1"></a>    beta_s <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb1699-13"><a href="rethinking-chapter-15.html#cb1699-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1699-14"><a href="rethinking-chapter-15.html#cb1699-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_sim_dog_list_2,</span>
<span id="cb1699-15"><a href="rethinking-chapter-15.html#cb1699-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1699-16"><a href="rethinking-chapter-15.html#cb1699-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1700-1"><a href="rethinking-chapter-15.html#cb1700-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( model_sim_dog_2 ) <span class="sc">%&gt;%</span> </span>
<span id="cb1700-2"><a href="rethinking-chapter-15.html#cb1700-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.26</td>
<td align="right">0.13</td>
<td align="right">-0.47</td>
<td align="right">-0.05</td>
<td align="right">695.29</td>
<td align="right">1.01</td>
</tr>
<tr class="even">
<td align="left">beta_s</td>
<td align="right">0.80</td>
<td align="right">0.16</td>
<td align="right">0.55</td>
<td align="right">1.06</td>
<td align="right">656.18</td>
<td align="right">1.01</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1701-1"><a href="rethinking-chapter-15.html#cb1701-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1701-2"><a href="rethinking-chapter-15.html#cb1701-2" aria-hidden="true" tabindex="-1"></a>data_sim_dog_3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">.idx =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb1701-3"><a href="rethinking-chapter-15.html#cb1701-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">s =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb1701-4"><a href="rethinking-chapter-15.html#cb1701-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">h =</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">10</span>, <span class="fu">inv_logit</span>(s)),</span>
<span id="cb1701-5"><a href="rethinking-chapter-15.html#cb1701-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">d =</span> <span class="fu">if_else</span>(h <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1701-6"><a href="rethinking-chapter-15.html#cb1701-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">h_missing =</span> <span class="fu">if_else</span>(d <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA_integer_</span>, h),</span>
<span id="cb1701-7"><a href="rethinking-chapter-15.html#cb1701-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">h_dummy =</span> <span class="fu">if_else</span>(d <span class="sc">==</span> <span class="dv">1</span>, <span class="sc">-</span>9L, h))</span></code></pre></div>
<div class="sourceCode" id="cb1702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1702-1"><a href="rethinking-chapter-15.html#cb1702-1" aria-hidden="true" tabindex="-1"></a>data_sim_dog_list_3 <span class="ot">&lt;-</span> data_sim_dog_3 <span class="sc">%&gt;%</span> </span>
<span id="cb1702-2"><a href="rethinking-chapter-15.html#cb1702-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.idx) <span class="sc">%&gt;%</span> </span>
<span id="cb1702-3"><a href="rethinking-chapter-15.html#cb1702-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(h_missing)) <span class="sc">%&gt;%</span> </span>
<span id="cb1702-4"><a href="rethinking-chapter-15.html#cb1702-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1702-5"><a href="rethinking-chapter-15.html#cb1702-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1702-6"><a href="rethinking-chapter-15.html#cb1702-6" aria-hidden="true" tabindex="-1"></a>model_sim_dog_3 <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1702-7"><a href="rethinking-chapter-15.html#cb1702-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1702-8"><a href="rethinking-chapter-15.html#cb1702-8" aria-hidden="true" tabindex="-1"></a>    h_missing <span class="sc">~</span> <span class="fu">binomial</span>( <span class="dv">10</span> , p ),</span>
<span id="cb1702-9"><a href="rethinking-chapter-15.html#cb1702-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_s <span class="sc">*</span> s,</span>
<span id="cb1702-10"><a href="rethinking-chapter-15.html#cb1702-10" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ),</span>
<span id="cb1702-11"><a href="rethinking-chapter-15.html#cb1702-11" aria-hidden="true" tabindex="-1"></a>    beta_s <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb1702-12"><a href="rethinking-chapter-15.html#cb1702-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1702-13"><a href="rethinking-chapter-15.html#cb1702-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_sim_dog_list_3,</span>
<span id="cb1702-14"><a href="rethinking-chapter-15.html#cb1702-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1702-15"><a href="rethinking-chapter-15.html#cb1702-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1703-1"><a href="rethinking-chapter-15.html#cb1703-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( model_sim_dog_3 ) <span class="sc">%&gt;%</span> </span>
<span id="cb1703-2"><a href="rethinking-chapter-15.html#cb1703-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.42</td>
<td align="right">0.11</td>
<td align="right">0.24</td>
<td align="right">0.59</td>
<td align="right">929.64</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_s</td>
<td align="right">0.57</td>
<td align="right">0.12</td>
<td align="right">0.37</td>
<td align="right">0.76</td>
<td align="right">902.92</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1704-1"><a href="rethinking-chapter-15.html#cb1704-1" aria-hidden="true" tabindex="-1"></a>data_sim_dog_list_4 <span class="ot">&lt;-</span> data_sim_dog_3 <span class="sc">%&gt;%</span> </span>
<span id="cb1704-2"><a href="rethinking-chapter-15.html#cb1704-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.idx, <span class="sc">-</span> h_missing) <span class="sc">%&gt;%</span> </span>
<span id="cb1704-3"><a href="rethinking-chapter-15.html#cb1704-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as.list</span>()</span>
<span id="cb1704-4"><a href="rethinking-chapter-15.html#cb1704-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1704-5"><a href="rethinking-chapter-15.html#cb1704-5" aria-hidden="true" tabindex="-1"></a>stan_sim_dog_4 <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb1704-6"><a href="rethinking-chapter-15.html#cb1704-6" aria-hidden="true" tabindex="-1"></a><span class="st">data{</span></span>
<span id="cb1704-7"><a href="rethinking-chapter-15.html#cb1704-7" aria-hidden="true" tabindex="-1"></a><span class="st">int h_dummy[100];</span></span>
<span id="cb1704-8"><a href="rethinking-chapter-15.html#cb1704-8" aria-hidden="true" tabindex="-1"></a><span class="st">vector[100] s;</span></span>
<span id="cb1704-9"><a href="rethinking-chapter-15.html#cb1704-9" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1704-10"><a href="rethinking-chapter-15.html#cb1704-10" aria-hidden="true" tabindex="-1"></a><span class="st">parameters{</span></span>
<span id="cb1704-11"><a href="rethinking-chapter-15.html#cb1704-11" aria-hidden="true" tabindex="-1"></a><span class="st">real alpha;</span></span>
<span id="cb1704-12"><a href="rethinking-chapter-15.html#cb1704-12" aria-hidden="true" tabindex="-1"></a><span class="st">real beta_s;</span></span>
<span id="cb1704-13"><a href="rethinking-chapter-15.html#cb1704-13" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1704-14"><a href="rethinking-chapter-15.html#cb1704-14" aria-hidden="true" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb1704-15"><a href="rethinking-chapter-15.html#cb1704-15" aria-hidden="true" tabindex="-1"></a><span class="st">vector[100] p;</span></span>
<span id="cb1704-16"><a href="rethinking-chapter-15.html#cb1704-16" aria-hidden="true" tabindex="-1"></a><span class="st">beta_s ~ normal( 0 , 0.5 );</span></span>
<span id="cb1704-17"><a href="rethinking-chapter-15.html#cb1704-17" aria-hidden="true" tabindex="-1"></a><span class="st">alpha ~ normal( 0 , 1.5 );</span></span>
<span id="cb1704-18"><a href="rethinking-chapter-15.html#cb1704-18" aria-hidden="true" tabindex="-1"></a><span class="st">for ( i in 1:100 ) {</span></span>
<span id="cb1704-19"><a href="rethinking-chapter-15.html#cb1704-19" aria-hidden="true" tabindex="-1"></a><span class="st">p[i] = alpha + beta_s * s[i];</span></span>
<span id="cb1704-20"><a href="rethinking-chapter-15.html#cb1704-20" aria-hidden="true" tabindex="-1"></a><span class="st">p[i] = inv_logit(p[i]);</span></span>
<span id="cb1704-21"><a href="rethinking-chapter-15.html#cb1704-21" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1704-22"><a href="rethinking-chapter-15.html#cb1704-22" aria-hidden="true" tabindex="-1"></a><span class="st">for ( i in 1:100 ) {</span></span>
<span id="cb1704-23"><a href="rethinking-chapter-15.html#cb1704-23" aria-hidden="true" tabindex="-1"></a><span class="st">if ( h_dummy[i] &gt; -1 ) h_dummy[i] ~ binomial( 10 , p[i] );</span></span>
<span id="cb1704-24"><a href="rethinking-chapter-15.html#cb1704-24" aria-hidden="true" tabindex="-1"></a><span class="st">if ( h_dummy[i] &lt; 0 ) {</span></span>
<span id="cb1704-25"><a href="rethinking-chapter-15.html#cb1704-25" aria-hidden="true" tabindex="-1"></a><span class="st">vector[5] pv;</span></span>
<span id="cb1704-26"><a href="rethinking-chapter-15.html#cb1704-26" aria-hidden="true" tabindex="-1"></a><span class="st">for ( j in 0:4 ) pv[j+1] = binomial_lpmf( j | 10 , p[i] );</span></span>
<span id="cb1704-27"><a href="rethinking-chapter-15.html#cb1704-27" aria-hidden="true" tabindex="-1"></a><span class="st">target += log_sum_exp( pv );</span></span>
<span id="cb1704-28"><a href="rethinking-chapter-15.html#cb1704-28" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1704-29"><a href="rethinking-chapter-15.html#cb1704-29" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1704-30"><a href="rethinking-chapter-15.html#cb1704-30" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1704-31"><a href="rethinking-chapter-15.html#cb1704-31" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb1704-32"><a href="rethinking-chapter-15.html#cb1704-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1704-33"><a href="rethinking-chapter-15.html#cb1704-33" aria-hidden="true" tabindex="-1"></a>model_sim_dog_4 <span class="ot">&lt;-</span> <span class="fu">stan</span>( <span class="at">model_code =</span> stan_sim_dog_4,</span>
<span id="cb1704-34"><a href="rethinking-chapter-15.html#cb1704-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> data_sim_dog_list_4,</span>
<span id="cb1704-35"><a href="rethinking-chapter-15.html#cb1704-35" aria-hidden="true" tabindex="-1"></a>                         <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1704-36"><a href="rethinking-chapter-15.html#cb1704-36" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cores =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1705-1"><a href="rethinking-chapter-15.html#cb1705-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( model_sim_dog_4 ) <span class="sc">%&gt;%</span> </span>
<span id="cb1705-2"><a href="rethinking-chapter-15.html#cb1705-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.11</td>
<td align="right">0.08</td>
<td align="right">-0.24</td>
<td align="right">0.02</td>
<td align="right">1100.75</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_s</td>
<td align="right">0.84</td>
<td align="right">0.10</td>
<td align="right">0.69</td>
<td align="right">1.00</td>
<td align="right">1038.57</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1706-1"><a href="rethinking-chapter-15.html#cb1706-1" aria-hidden="true" tabindex="-1"></a>gq_code <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb1706-2"><a href="rethinking-chapter-15.html#cb1706-2" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb1706-3"><a href="rethinking-chapter-15.html#cb1706-3" aria-hidden="true" tabindex="-1"></a><span class="st"> int H_impute[100];</span></span>
<span id="cb1706-4"><a href="rethinking-chapter-15.html#cb1706-4" aria-hidden="true" tabindex="-1"></a><span class="st">  for ( i in 1:100 ) {</span></span>
<span id="cb1706-5"><a href="rethinking-chapter-15.html#cb1706-5" aria-hidden="true" tabindex="-1"></a><span class="st">   real p = inv_logit(alpha + beta_s * s[i]);</span></span>
<span id="cb1706-6"><a href="rethinking-chapter-15.html#cb1706-6" aria-hidden="true" tabindex="-1"></a><span class="st">   if ( h_dummy[i] &gt; -1 ) H_impute[i] = h_dummy[i];</span></span>
<span id="cb1706-7"><a href="rethinking-chapter-15.html#cb1706-7" aria-hidden="true" tabindex="-1"></a><span class="st">   if ( h_dummy[i] &lt; 0 ) {</span></span>
<span id="cb1706-8"><a href="rethinking-chapter-15.html#cb1706-8" aria-hidden="true" tabindex="-1"></a><span class="st">    // compute Pr( h_dummy==j | p , h_dummy &lt; 5 )</span></span>
<span id="cb1706-9"><a href="rethinking-chapter-15.html#cb1706-9" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[5] lbp;</span></span>
<span id="cb1706-10"><a href="rethinking-chapter-15.html#cb1706-10" aria-hidden="true" tabindex="-1"></a><span class="st">    real Z;</span></span>
<span id="cb1706-11"><a href="rethinking-chapter-15.html#cb1706-11" aria-hidden="true" tabindex="-1"></a><span class="st">    for ( j in 0:4 ) lbp[j+1] = binomial_lpmf( j | 10 , p );</span></span>
<span id="cb1706-12"><a href="rethinking-chapter-15.html#cb1706-12" aria-hidden="true" tabindex="-1"></a><span class="st">    // convert to probabilities by normalizing</span></span>
<span id="cb1706-13"><a href="rethinking-chapter-15.html#cb1706-13" aria-hidden="true" tabindex="-1"></a><span class="st">    Z = log_sum_exp( lbp );</span></span>
<span id="cb1706-14"><a href="rethinking-chapter-15.html#cb1706-14" aria-hidden="true" tabindex="-1"></a><span class="st">    for ( j in 1:5 ) lbp[j] = exp( lbp[j] - Z );</span></span>
<span id="cb1706-15"><a href="rethinking-chapter-15.html#cb1706-15" aria-hidden="true" tabindex="-1"></a><span class="st">    // generate random sample from posterior</span></span>
<span id="cb1706-16"><a href="rethinking-chapter-15.html#cb1706-16" aria-hidden="true" tabindex="-1"></a><span class="st">    H_impute[i] = categorical_rng( lbp ) - 1;</span></span>
<span id="cb1706-17"><a href="rethinking-chapter-15.html#cb1706-17" aria-hidden="true" tabindex="-1"></a><span class="st">   }</span></span>
<span id="cb1706-18"><a href="rethinking-chapter-15.html#cb1706-18" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb1706-19"><a href="rethinking-chapter-15.html#cb1706-19" aria-hidden="true" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb1706-20"><a href="rethinking-chapter-15.html#cb1706-20" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb1706-21"><a href="rethinking-chapter-15.html#cb1706-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1706-22"><a href="rethinking-chapter-15.html#cb1706-22" aria-hidden="true" tabindex="-1"></a>code_new <span class="ot">&lt;-</span> <span class="fu">concat</span>( stan_sim_dog_4 , gq_code )</span>
<span id="cb1706-23"><a href="rethinking-chapter-15.html#cb1706-23" aria-hidden="true" tabindex="-1"></a>model_sim_dog_5 <span class="ot">&lt;-</span> <span class="fu">stan</span>( <span class="at">model_code =</span> code_new ,</span>
<span id="cb1706-24"><a href="rethinking-chapter-15.html#cb1706-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data_sim_dog_list_4,</span>
<span id="cb1706-25"><a href="rethinking-chapter-15.html#cb1706-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1706-26"><a href="rethinking-chapter-15.html#cb1706-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cores =</span> <span class="dv">4</span> )</span></code></pre></div>
<div class="sourceCode" id="cb1707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1707-1"><a href="rethinking-chapter-15.html#cb1707-1" aria-hidden="true" tabindex="-1"></a>sim_dog_5_posterior <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_sim_dog_5) <span class="sc">%&gt;%</span> </span>
<span id="cb1707-2"><a href="rethinking-chapter-15.html#cb1707-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1707-3"><a href="rethinking-chapter-15.html#cb1707-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1707-4"><a href="rethinking-chapter-15.html#cb1707-4" aria-hidden="true" tabindex="-1"></a>sim_dog_5_posterior<span class="sc">$</span>H_impute <span class="sc">%&gt;%</span> </span>
<span id="cb1707-5"><a href="rethinking-chapter-15.html#cb1707-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1707-6"><a href="rethinking-chapter-15.html#cb1707-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1707-7"><a href="rethinking-chapter-15.html#cb1707-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_sim_dog_3,. )  <span class="sc">%&gt;%</span> </span>
<span id="cb1707-8"><a href="rethinking-chapter-15.html#cb1707-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(<span class="fu">is.na</span>(h_missing)) <span class="sc">%&gt;%</span> </span>
<span id="cb1707-9"><a href="rethinking-chapter-15.html#cb1707-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">&lt;</span> <span class="dv">25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1707-10"><a href="rethinking-chapter-15.html#cb1707-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">&#39;..&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1707-11"><a href="rethinking-chapter-15.html#cb1707-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb1707-12"><a href="rethinking-chapter-15.html#cb1707-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..count..,</span>
<span id="cb1707-13"><a href="rethinking-chapter-15.html#cb1707-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> (value <span class="sc">==</span> h), <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(color))),</span>
<span id="cb1707-14"><a href="rethinking-chapter-15.html#cb1707-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb1707-15"><a href="rethinking-chapter-15.html#cb1707-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.idx <span class="sc">~</span> ., <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1707-16"><a href="rethinking-chapter-15.html#cb1707-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> <span class="ot">=</span> clr_current, <span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> <span class="ot">=</span> clr0d), </span>
<span id="cb1707-17"><a href="rethinking-chapter-15.html#cb1707-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-58-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H1</strong></p>
<div class="sourceCode" id="cb1708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1708-1"><a href="rethinking-chapter-15.html#cb1708-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(elephants)</span>
<span id="cb1708-2"><a href="rethinking-chapter-15.html#cb1708-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1708-3"><a href="rethinking-chapter-15.html#cb1708-3" aria-hidden="true" tabindex="-1"></a>data_elephant <span class="ot">&lt;-</span> elephants <span class="sc">%&gt;%</span></span>
<span id="cb1708-4"><a href="rethinking-chapter-15.html#cb1708-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1708-5"><a href="rethinking-chapter-15.html#cb1708-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="fu">everything</span>(), <span class="at">.fn =</span> str_to_lower) <span class="sc">%&gt;%</span> </span>
<span id="cb1708-6"><a href="rethinking-chapter-15.html#cb1708-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_cent =</span> age <span class="sc">-</span> <span class="dv">20</span>)</span>
<span id="cb1708-7"><a href="rethinking-chapter-15.html#cb1708-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1708-8"><a href="rethinking-chapter-15.html#cb1708-8" aria-hidden="true" tabindex="-1"></a>data_elephant <span class="sc">%&gt;%</span> </span>
<span id="cb1708-9"><a href="rethinking-chapter-15.html#cb1708-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> matings)) <span class="sc">+</span></span>
<span id="cb1708-10"><a href="rethinking-chapter-15.html#cb1708-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="fu">fll_current</span>(), <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1708-11"><a href="rethinking-chapter-15.html#cb1708-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="fu">clr_alpha</span>(<span class="fu">clr_lighten</span>(clr_current)))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/H1-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>Thinking about the relationship between <code>age</code> and <code>matings</code>:</p>
<p>Entering the <em>as is</em> introduces exponential relationship (caused by the log link):</p>
<p><span class="math display">\[
\textrm{log}~\lambda_{i} = \alpha + \beta A_{i} \Rightarrow \lambda_{i} = \textrm{exp}(\alpha + \beta A_{i}) = \textrm{exp}(\alpha) ~ \textrm{exp}(\beta A_{i})
\]</span>
Alternatively, assuming a logarithmic relationship with increasing / diminishing returns with age (depending if <span class="math inline">\(\beta \gt 1\)</span> or <span class="math inline">\(\beta \lt 1\)</span>).</p>
<p><span class="math display">\[
\textrm{log}~\lambda_{i} = \alpha + \textrm{log} \beta A_{i} \Rightarrow \lambda_{i} = \textrm{exp}(\alpha)~A_{i}^{\beta}
\]</span></p>
<div class="sourceCode" id="cb1709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1709-1"><a href="rethinking-chapter-15.html#cb1709-1" aria-hidden="true" tabindex="-1"></a>model_elephant_logistic <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1709-2"><a href="rethinking-chapter-15.html#cb1709-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1709-3"><a href="rethinking-chapter-15.html#cb1709-3" aria-hidden="true" tabindex="-1"></a>    matings <span class="sc">~</span> <span class="fu">dpois</span>(lambda),</span>
<span id="cb1709-4"><a href="rethinking-chapter-15.html#cb1709-4" aria-hidden="true" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha) <span class="sc">*</span> age_cent <span class="sc">^</span> beta_age,</span>
<span id="cb1709-5"><a href="rethinking-chapter-15.html#cb1709-5" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1709-6"><a href="rethinking-chapter-15.html#cb1709-6" aria-hidden="true" tabindex="-1"></a>    beta_age <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1709-7"><a href="rethinking-chapter-15.html#cb1709-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1709-8"><a href="rethinking-chapter-15.html#cb1709-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_elephant,</span>
<span id="cb1709-9"><a href="rethinking-chapter-15.html#cb1709-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1709-10"><a href="rethinking-chapter-15.html#cb1709-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb1709-11"><a href="rethinking-chapter-15.html#cb1709-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1710-1"><a href="rethinking-chapter-15.html#cb1710-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_elephant_logistic) <span class="sc">%&gt;%</span> </span>
<span id="cb1710-2"><a href="rethinking-chapter-15.html#cb1710-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-1.5</td>
<td align="right">0.52</td>
<td align="right">-2.30</td>
<td align="right">-0.67</td>
<td align="right">306.68</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_age</td>
<td align="right">0.9</td>
<td align="right">0.18</td>
<td align="right">0.61</td>
<td align="right">1.18</td>
<td align="right">306.55</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1711-1"><a href="rethinking-chapter-15.html#cb1711-1" aria-hidden="true" tabindex="-1"></a>new_elephant <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">age_cent =</span> <span class="fu">seq</span>(<span class="dv">25</span>, <span class="dv">55</span>,</span>
<span id="cb1711-2"><a href="rethinking-chapter-15.html#cb1711-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">length.out =</span> <span class="dv">31</span>)<span class="sc">-</span><span class="dv">20</span>)</span>
<span id="cb1711-3"><a href="rethinking-chapter-15.html#cb1711-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1711-4"><a href="rethinking-chapter-15.html#cb1711-4" aria-hidden="true" tabindex="-1"></a>elephant_posterior_predict <span class="ot">&lt;-</span> <span class="fu">link</span>(model_elephant_logistic,</span>
<span id="cb1711-5"><a href="rethinking-chapter-15.html#cb1711-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">data =</span> new_elephant) <span class="sc">%&gt;%</span> </span>
<span id="cb1711-6"><a href="rethinking-chapter-15.html#cb1711-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1711-7"><a href="rethinking-chapter-15.html#cb1711-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1711-8"><a href="rethinking-chapter-15.html#cb1711-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(new_elephant,. ) <span class="sc">%&gt;%</span> </span>
<span id="cb1711-9"><a href="rethinking-chapter-15.html#cb1711-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_cent) <span class="sc">%&gt;%</span> </span>
<span id="cb1711-10"><a href="rethinking-chapter-15.html#cb1711-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>age_cent) <span class="sc">%&gt;%</span> </span>
<span id="cb1711-11"><a href="rethinking-chapter-15.html#cb1711-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pi =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">value =</span> <span class="fu">quantile</span>(value, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">055</span>,.<span class="dv">5</span>,.<span class="dv">955</span>)),</span>
<span id="cb1711-12"><a href="rethinking-chapter-15.html#cb1711-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;ll&quot;</span>,<span class="st">&quot;m&quot;</span>,<span class="st">&quot;hh&quot;</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb1711-13"><a href="rethinking-chapter-15.html#cb1711-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pi) <span class="sc">%&gt;%</span> </span>
<span id="cb1711-14"><a href="rethinking-chapter-15.html#cb1711-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> value, <span class="at">names_from =</span> label) </span>
<span id="cb1711-15"><a href="rethinking-chapter-15.html#cb1711-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1711-16"><a href="rethinking-chapter-15.html#cb1711-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> elephant_posterior_predict <span class="sc">%&gt;%</span> </span>
<span id="cb1711-17"><a href="rethinking-chapter-15.html#cb1711-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb1711-18"><a href="rethinking-chapter-15.html#cb1711-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>,</span>
<span id="cb1711-19"><a href="rethinking-chapter-15.html#cb1711-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> age_cent <span class="sc">+</span> <span class="dv">20</span>, <span class="at">ymin =</span> ll, <span class="at">y =</span> m, <span class="at">ymax =</span> hh),</span>
<span id="cb1711-20"><a href="rethinking-chapter-15.html#cb1711-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> clr0dd, <span class="at">fill =</span> fll0, <span class="at">size =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1711-21"><a href="rethinking-chapter-15.html#cb1711-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">data =</span> data_elephant, <span class="fu">aes</span>(<span class="at">y =</span> matings),</span>
<span id="cb1711-22"><a href="rethinking-chapter-15.html#cb1711-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="fu">fll_current</span>(), <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1711-23"><a href="rethinking-chapter-15.html#cb1711-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="fu">clr_alpha</span>(<span class="fu">clr_lighten</span>(clr_current)))</span></code></pre></div>
<p>Including an error-assumption into the model</p>
<div class="sourceCode" id="cb1712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1712-1"><a href="rethinking-chapter-15.html#cb1712-1" aria-hidden="true" tabindex="-1"></a>model_elephant_error <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1712-2"><a href="rethinking-chapter-15.html#cb1712-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1712-3"><a href="rethinking-chapter-15.html#cb1712-3" aria-hidden="true" tabindex="-1"></a>    matings <span class="sc">~</span> <span class="fu">dpois</span>(lambda),</span>
<span id="cb1712-4"><a href="rethinking-chapter-15.html#cb1712-4" aria-hidden="true" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha) <span class="sc">*</span> age_est[i] <span class="sc">^</span> beta_age,</span>
<span id="cb1712-5"><a href="rethinking-chapter-15.html#cb1712-5" aria-hidden="true" tabindex="-1"></a>    age_cent <span class="sc">~</span> <span class="fu">dnorm</span>(age_est, <span class="dv">5</span>),</span>
<span id="cb1712-6"><a href="rethinking-chapter-15.html#cb1712-6" aria-hidden="true" tabindex="-1"></a>    vector[<span class="dv">41</span>]<span class="sc">:</span>age_est <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb1712-7"><a href="rethinking-chapter-15.html#cb1712-7" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1712-8"><a href="rethinking-chapter-15.html#cb1712-8" aria-hidden="true" tabindex="-1"></a>    beta_age <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1712-9"><a href="rethinking-chapter-15.html#cb1712-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1712-10"><a href="rethinking-chapter-15.html#cb1712-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_elephant,</span>
<span id="cb1712-11"><a href="rethinking-chapter-15.html#cb1712-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1712-12"><a href="rethinking-chapter-15.html#cb1712-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb1712-13"><a href="rethinking-chapter-15.html#cb1712-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1713-1"><a href="rethinking-chapter-15.html#cb1713-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_elephant_error) <span class="sc">%&gt;%</span> </span>
<span id="cb1713-2"><a href="rethinking-chapter-15.html#cb1713-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-1.31</td>
<td align="right">0.58</td>
<td align="right">-2.25</td>
<td align="right">-0.39</td>
<td align="right">975.78</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_age</td>
<td align="right">0.84</td>
<td align="right">0.20</td>
<td align="right">0.52</td>
<td align="right">1.16</td>
<td align="right">992.57</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1714-1"><a href="rethinking-chapter-15.html#cb1714-1" aria-hidden="true" tabindex="-1"></a>elephant_posterior <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_elephant_error) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-2"><a href="rethinking-chapter-15.html#cb1714-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1714-3"><a href="rethinking-chapter-15.html#cb1714-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1714-4"><a href="rethinking-chapter-15.html#cb1714-4" aria-hidden="true" tabindex="-1"></a>elephant_age_estimates <span class="ot">&lt;-</span> elephant_posterior<span class="sc">$</span>age_est<span class="sc">%&gt;%</span> </span>
<span id="cb1714-5"><a href="rethinking-chapter-15.html#cb1714-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()  <span class="sc">%&gt;%</span> </span>
<span id="cb1714-6"><a href="rethinking-chapter-15.html#cb1714-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1714-7"><a href="rethinking-chapter-15.html#cb1714-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">elephant_idx =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-8"><a href="rethinking-chapter-15.html#cb1714-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>elephant_idx) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-9"><a href="rethinking-chapter-15.html#cb1714-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(elephant_idx) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-10"><a href="rethinking-chapter-15.html#cb1714-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pi =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">value =</span> <span class="fu">quantile</span>(value, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">055</span>, .<span class="dv">5</span>, .<span class="dv">955</span>)),</span>
<span id="cb1714-11"><a href="rethinking-chapter-15.html#cb1714-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;ll&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;hh&quot;</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-12"><a href="rethinking-chapter-15.html#cb1714-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pi) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-13"><a href="rethinking-chapter-15.html#cb1714-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> value, <span class="at">names_from =</span> label) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-14"><a href="rethinking-chapter-15.html#cb1714-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_elephant,. ) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-15"><a href="rethinking-chapter-15.html#cb1714-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">jitter =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">n</span>(),<span class="sc">-</span>.<span class="dv">15</span>, .<span class="dv">15</span>))</span>
<span id="cb1714-16"><a href="rethinking-chapter-15.html#cb1714-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1714-17"><a href="rethinking-chapter-15.html#cb1714-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1714-18"><a href="rethinking-chapter-15.html#cb1714-18" aria-hidden="true" tabindex="-1"></a>elephant_error_posterior_predict <span class="ot">&lt;-</span> <span class="fu">link</span>(model_elephant_error,</span>
<span id="cb1714-19"><a href="rethinking-chapter-15.html#cb1714-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">data =</span> new_elephant) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-20"><a href="rethinking-chapter-15.html#cb1714-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1714-21"><a href="rethinking-chapter-15.html#cb1714-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1714-22"><a href="rethinking-chapter-15.html#cb1714-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(new_elephant,. ) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-23"><a href="rethinking-chapter-15.html#cb1714-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_cent) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-24"><a href="rethinking-chapter-15.html#cb1714-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>age_cent) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-25"><a href="rethinking-chapter-15.html#cb1714-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pi =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">value =</span> <span class="fu">quantile</span>(value, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">055</span>,.<span class="dv">5</span>,.<span class="dv">955</span>)),</span>
<span id="cb1714-26"><a href="rethinking-chapter-15.html#cb1714-26" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;ll&quot;</span>,<span class="st">&quot;m&quot;</span>,<span class="st">&quot;hh&quot;</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-27"><a href="rethinking-chapter-15.html#cb1714-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pi) <span class="sc">%&gt;%</span> </span>
<span id="cb1714-28"><a href="rethinking-chapter-15.html#cb1714-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> value, <span class="at">names_from =</span> label) </span>
<span id="cb1714-29"><a href="rethinking-chapter-15.html#cb1714-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1714-30"><a href="rethinking-chapter-15.html#cb1714-30" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> elephant_error_posterior_predict <span class="sc">%&gt;%</span> </span>
<span id="cb1714-31"><a href="rethinking-chapter-15.html#cb1714-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb1714-32"><a href="rethinking-chapter-15.html#cb1714-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>,</span>
<span id="cb1714-33"><a href="rethinking-chapter-15.html#cb1714-33" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> age_cent <span class="sc">+</span> <span class="dv">20</span>, <span class="at">ymin =</span> ll, <span class="at">y =</span> m, <span class="at">ymax =</span> hh),</span>
<span id="cb1714-34"><a href="rethinking-chapter-15.html#cb1714-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> clr0dd, <span class="at">fill =</span> fll0, <span class="at">size =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1714-35"><a href="rethinking-chapter-15.html#cb1714-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1714-36"><a href="rethinking-chapter-15.html#cb1714-36" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_smooth</span>(<span class="at">data =</span> elephant_posterior_predict,</span>
<span id="cb1714-37"><a href="rethinking-chapter-15.html#cb1714-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>,</span>
<span id="cb1714-38"><a href="rethinking-chapter-15.html#cb1714-38" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> age_cent <span class="sc">+</span> <span class="dv">20</span>, <span class="at">ymin =</span> ll, <span class="at">y =</span> m, <span class="at">ymax =</span> hh),</span>
<span id="cb1714-39"><a href="rethinking-chapter-15.html#cb1714-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">clr_lighten</span>(clr_current,.<span class="dv">7</span>),</span>
<span id="cb1714-40"><a href="rethinking-chapter-15.html#cb1714-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="fu">clr_alpha</span>(<span class="fu">clr_lighten</span>(clr_current,.<span class="dv">7</span>), .<span class="dv">2</span>), <span class="at">size =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1714-41"><a href="rethinking-chapter-15.html#cb1714-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> elephant_age_estimates,</span>
<span id="cb1714-42"><a href="rethinking-chapter-15.html#cb1714-42" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> matings <span class="sc">+</span> jitter, </span>
<span id="cb1714-43"><a href="rethinking-chapter-15.html#cb1714-43" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> matings <span class="sc">+</span> jitter,</span>
<span id="cb1714-44"><a href="rethinking-chapter-15.html#cb1714-44" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> m <span class="sc">+</span> <span class="dv">20</span>),</span>
<span id="cb1714-45"><a href="rethinking-chapter-15.html#cb1714-45" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;pt&quot;</span>)),</span>
<span id="cb1714-46"><a href="rethinking-chapter-15.html#cb1714-46" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> clr0d) <span class="sc">+</span></span>
<span id="cb1714-47"><a href="rethinking-chapter-15.html#cb1714-47" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">data =</span> elephant_age_estimates, <span class="fu">aes</span>(<span class="at">y =</span> matings <span class="sc">+</span> jitter),</span>
<span id="cb1714-48"><a href="rethinking-chapter-15.html#cb1714-48" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="fu">fll_current</span>(), <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1714-49"><a href="rethinking-chapter-15.html#cb1714-49" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="fu">clr_alpha</span>(<span class="fu">clr_lighten</span>(clr_current))) <span class="sc">+</span></span>
<span id="cb1714-50"><a href="rethinking-chapter-15.html#cb1714-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> elephant_age_estimates,</span>
<span id="cb1714-51"><a href="rethinking-chapter-15.html#cb1714-51" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> m <span class="sc">+</span> <span class="dv">20</span>, <span class="at">y =</span> matings <span class="sc">+</span> jitter))</span>
<span id="cb1714-52"><a href="rethinking-chapter-15.html#cb1714-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1714-53"><a href="rethinking-chapter-15.html#cb1714-53" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-64-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H2</strong></p>
<div class="sourceCode" id="cb1715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1715-1"><a href="rethinking-chapter-15.html#cb1715-1" aria-hidden="true" tabindex="-1"></a>model_elephant_error_double <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1715-2"><a href="rethinking-chapter-15.html#cb1715-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1715-3"><a href="rethinking-chapter-15.html#cb1715-3" aria-hidden="true" tabindex="-1"></a>    matings <span class="sc">~</span> <span class="fu">dpois</span>(lambda),</span>
<span id="cb1715-4"><a href="rethinking-chapter-15.html#cb1715-4" aria-hidden="true" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha) <span class="sc">*</span> age_est[i] <span class="sc">^</span> beta_age,</span>
<span id="cb1715-5"><a href="rethinking-chapter-15.html#cb1715-5" aria-hidden="true" tabindex="-1"></a>    age_cent <span class="sc">~</span> <span class="fu">dnorm</span>(age_est, <span class="dv">10</span>),</span>
<span id="cb1715-6"><a href="rethinking-chapter-15.html#cb1715-6" aria-hidden="true" tabindex="-1"></a>    vector[<span class="dv">41</span>]<span class="sc">:</span>age_est <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb1715-7"><a href="rethinking-chapter-15.html#cb1715-7" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1715-8"><a href="rethinking-chapter-15.html#cb1715-8" aria-hidden="true" tabindex="-1"></a>    beta_age <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1715-9"><a href="rethinking-chapter-15.html#cb1715-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1715-10"><a href="rethinking-chapter-15.html#cb1715-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_elephant,</span>
<span id="cb1715-11"><a href="rethinking-chapter-15.html#cb1715-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1715-12"><a href="rethinking-chapter-15.html#cb1715-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb1715-13"><a href="rethinking-chapter-15.html#cb1715-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1715-14"><a href="rethinking-chapter-15.html#cb1715-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1715-15"><a href="rethinking-chapter-15.html#cb1715-15" aria-hidden="true" tabindex="-1"></a>model_elephant_error_quad <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1715-16"><a href="rethinking-chapter-15.html#cb1715-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1715-17"><a href="rethinking-chapter-15.html#cb1715-17" aria-hidden="true" tabindex="-1"></a>    matings <span class="sc">~</span> <span class="fu">dpois</span>(lambda),</span>
<span id="cb1715-18"><a href="rethinking-chapter-15.html#cb1715-18" aria-hidden="true" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha) <span class="sc">*</span> age_est[i] <span class="sc">^</span> beta_age,</span>
<span id="cb1715-19"><a href="rethinking-chapter-15.html#cb1715-19" aria-hidden="true" tabindex="-1"></a>    age_cent <span class="sc">~</span> <span class="fu">dnorm</span>(age_est, <span class="dv">20</span>),</span>
<span id="cb1715-20"><a href="rethinking-chapter-15.html#cb1715-20" aria-hidden="true" tabindex="-1"></a>    vector[<span class="dv">41</span>]<span class="sc">:</span>age_est <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb1715-21"><a href="rethinking-chapter-15.html#cb1715-21" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1715-22"><a href="rethinking-chapter-15.html#cb1715-22" aria-hidden="true" tabindex="-1"></a>    beta_age <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1715-23"><a href="rethinking-chapter-15.html#cb1715-23" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1715-24"><a href="rethinking-chapter-15.html#cb1715-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_elephant,</span>
<span id="cb1715-25"><a href="rethinking-chapter-15.html#cb1715-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1715-26"><a href="rethinking-chapter-15.html#cb1715-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb1715-27"><a href="rethinking-chapter-15.html#cb1715-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1715-28"><a href="rethinking-chapter-15.html#cb1715-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1715-29"><a href="rethinking-chapter-15.html#cb1715-29" aria-hidden="true" tabindex="-1"></a>model_elephant_error_100 <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1715-30"><a href="rethinking-chapter-15.html#cb1715-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1715-31"><a href="rethinking-chapter-15.html#cb1715-31" aria-hidden="true" tabindex="-1"></a>    matings <span class="sc">~</span> <span class="fu">dpois</span>(lambda),</span>
<span id="cb1715-32"><a href="rethinking-chapter-15.html#cb1715-32" aria-hidden="true" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha) <span class="sc">*</span> age_est[i] <span class="sc">^</span> beta_age,</span>
<span id="cb1715-33"><a href="rethinking-chapter-15.html#cb1715-33" aria-hidden="true" tabindex="-1"></a>    age_cent <span class="sc">~</span> <span class="fu">dnorm</span>(age_est, <span class="dv">40</span>),</span>
<span id="cb1715-34"><a href="rethinking-chapter-15.html#cb1715-34" aria-hidden="true" tabindex="-1"></a>    vector[<span class="dv">41</span>]<span class="sc">:</span>age_est <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb1715-35"><a href="rethinking-chapter-15.html#cb1715-35" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1715-36"><a href="rethinking-chapter-15.html#cb1715-36" aria-hidden="true" tabindex="-1"></a>    beta_age <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1715-37"><a href="rethinking-chapter-15.html#cb1715-37" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1715-38"><a href="rethinking-chapter-15.html#cb1715-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_elephant,</span>
<span id="cb1715-39"><a href="rethinking-chapter-15.html#cb1715-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1715-40"><a href="rethinking-chapter-15.html#cb1715-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb1715-41"><a href="rethinking-chapter-15.html#cb1715-41" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1716-1"><a href="rethinking-chapter-15.html#cb1716-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_elephant_error_double) <span class="sc">%&gt;%</span> </span>
<span id="cb1716-2"><a href="rethinking-chapter-15.html#cb1716-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-1.10</td>
<td align="right">0.56</td>
<td align="right">-2.02</td>
<td align="right">-0.24</td>
<td align="right">657.24</td>
<td align="right">1.01</td>
</tr>
<tr class="even">
<td align="left">beta_age</td>
<td align="right">0.75</td>
<td align="right">0.19</td>
<td align="right">0.46</td>
<td align="right">1.03</td>
<td align="right">662.25</td>
<td align="right">1.01</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1717-1"><a href="rethinking-chapter-15.html#cb1717-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_elephant_error_quad) <span class="sc">%&gt;%</span> </span>
<span id="cb1717-2"><a href="rethinking-chapter-15.html#cb1717-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.97</td>
<td align="right">0.56</td>
<td align="right">-1.87</td>
<td align="right">-0.08</td>
<td align="right">677.29</td>
<td align="right">1.01</td>
</tr>
<tr class="even">
<td align="left">beta_age</td>
<td align="right">0.66</td>
<td align="right">0.18</td>
<td align="right">0.38</td>
<td align="right">0.94</td>
<td align="right">662.11</td>
<td align="right">1.01</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1718-1"><a href="rethinking-chapter-15.html#cb1718-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_elephant_error_100) <span class="sc">%&gt;%</span> </span>
<span id="cb1718-2"><a href="rethinking-chapter-15.html#cb1718-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.95</td>
<td align="right">0.61</td>
<td align="right">-1.97</td>
<td align="right">0.01</td>
<td align="right">767.41</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_age</td>
<td align="right">0.56</td>
<td align="right">0.17</td>
<td align="right">0.31</td>
<td align="right">0.83</td>
<td align="right">754.71</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p><strong>H3</strong></p>
<div class="sourceCode" id="cb1719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1719-1"><a href="rethinking-chapter-15.html#cb1719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb1719-2"><a href="rethinking-chapter-15.html#cb1719-2" aria-hidden="true" tabindex="-1"></a>data_impute <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>), <span class="cn">NA</span>),</span>
<span id="cb1719-3"><a href="rethinking-chapter-15.html#cb1719-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, x), <span class="dv">100</span>))</span>
<span id="cb1719-4"><a href="rethinking-chapter-15.html#cb1719-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1719-5"><a href="rethinking-chapter-15.html#cb1719-5" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( <span class="fu">lm</span>(y <span class="sc">~</span> x, data_impute) ) <span class="sc">%&gt;%</span> </span>
<span id="cb1719-6"><a href="rethinking-chapter-15.html#cb1719-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.24</td>
<td align="right">0.28</td>
<td align="right">-0.20</td>
<td align="right">0.68</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1.42</td>
<td align="right">0.52</td>
<td align="right">0.59</td>
<td align="right">2.26</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\begin{array}{rcl}
y_{i} &amp; \sim &amp; \textrm{Normal}(\mu_{i}, \sigma)\\
\mu_{i} &amp; = &amp; \alpha + \beta x_{i}\\
x_{i} &amp; \sim &amp; \textrm{Normal}(0, 1)\\
\alpha &amp; \sim &amp; \textrm{Normal}(0, 1)\\
\beta &amp; \sim &amp; \textrm{Normal}(0, 100)\\
\sigma &amp; \sim &amp; \textrm{Exponential}(1)\\
\end{array}
\]</span></p>
<div class="sourceCode" id="cb1720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1720-1"><a href="rethinking-chapter-15.html#cb1720-1" aria-hidden="true" tabindex="-1"></a>model_impute <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1720-2"><a href="rethinking-chapter-15.html#cb1720-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1720-3"><a href="rethinking-chapter-15.html#cb1720-3" aria-hidden="true" tabindex="-1"></a>    y <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb1720-4"><a href="rethinking-chapter-15.html#cb1720-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> x,</span>
<span id="cb1720-5"><a href="rethinking-chapter-15.html#cb1720-5" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1720-6"><a href="rethinking-chapter-15.html#cb1720-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>( alpha, beta ) <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb1720-7"><a href="rethinking-chapter-15.html#cb1720-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb1720-8"><a href="rethinking-chapter-15.html#cb1720-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1720-9"><a href="rethinking-chapter-15.html#cb1720-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_impute,</span>
<span id="cb1720-10"><a href="rethinking-chapter-15.html#cb1720-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1720-11"><a href="rethinking-chapter-15.html#cb1720-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1720-12"><a href="rethinking-chapter-15.html#cb1720-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb1720-13"><a href="rethinking-chapter-15.html#cb1720-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">99</span>)</span>
<span id="cb1720-14"><a href="rethinking-chapter-15.html#cb1720-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1721-1"><a href="rethinking-chapter-15.html#cb1721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_impute, <span class="at">depth =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1721-2"><a href="rethinking-chapter-15.html#cb1721-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">beta</td>
<td align="right">21.74</td>
<td align="right">3.60</td>
<td align="right">16.68</td>
<td align="right">28.12</td>
<td align="right">2820.88</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">alpha</td>
<td align="right">2.20</td>
<td align="right">2.97</td>
<td align="right">-2.40</td>
<td align="right">6.96</td>
<td align="right">3706.15</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">9.44</td>
<td align="right">1.90</td>
<td align="right">6.81</td>
<td align="right">12.85</td>
<td align="right">2962.53</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">x_impute[1]</td>
<td align="right">3.85</td>
<td align="right">0.70</td>
<td align="right">2.74</td>
<td align="right">5.00</td>
<td align="right">2561.12</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1722-1"><a href="rethinking-chapter-15.html#cb1722-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract.samples</span>(model_impute) <span class="sc">%&gt;%</span> </span>
<span id="cb1722-2"><a href="rethinking-chapter-15.html#cb1722-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1722-3"><a href="rethinking-chapter-15.html#cb1722-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(     <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(my_lower, <span class="at">col =</span> clr_dark)),</span>
<span id="cb1722-4"><a href="rethinking-chapter-15.html#cb1722-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">diag =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(my_diag, <span class="at">fill =</span> fll0,</span>
<span id="cb1722-5"><a href="rethinking-chapter-15.html#cb1722-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">col =</span> clr_dark, <span class="at">adjust =</span> .<span class="dv">7</span>)),</span>
<span id="cb1722-6"><a href="rethinking-chapter-15.html#cb1722-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(my_upper ,</span>
<span id="cb1722-7"><a href="rethinking-chapter-15.html#cb1722-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">family =</span> fnt_sel)) ) <span class="sc">+</span></span>
<span id="cb1722-8"><a href="rethinking-chapter-15.html#cb1722-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> clr_dark, <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-68-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1723-1"><a href="rethinking-chapter-15.html#cb1723-1" aria-hidden="true" tabindex="-1"></a>new_impute <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">31</span>)</span>
<span id="cb1723-2"><a href="rethinking-chapter-15.html#cb1723-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1723-3"><a href="rethinking-chapter-15.html#cb1723-3" aria-hidden="true" tabindex="-1"></a>impute_summary_prep <span class="ot">&lt;-</span>  <span class="fu">extract.samples</span>(model_impute) <span class="sc">%&gt;%</span> </span>
<span id="cb1723-4"><a href="rethinking-chapter-15.html#cb1723-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1723-5"><a href="rethinking-chapter-15.html#cb1723-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">case =</span> <span class="fu">c</span>(<span class="st">&#39;positive&#39;</span>, <span class="st">&#39;negative&#39;</span>)[<span class="dv">2</span> <span class="sc">-</span> (beta <span class="sc">&gt;</span> <span class="dv">0</span>)])</span>
<span id="cb1723-6"><a href="rethinking-chapter-15.html#cb1723-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1723-7"><a href="rethinking-chapter-15.html#cb1723-7" aria-hidden="true" tabindex="-1"></a>impute_summary <span class="ot">&lt;-</span>impute_summary_prep <span class="sc">%&gt;%</span> </span>
<span id="cb1723-8"><a href="rethinking-chapter-15.html#cb1723-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">map2</span>(alpha, beta,</span>
<span id="cb1723-9"><a href="rethinking-chapter-15.html#cb1723-9" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(a, b){</span>
<span id="cb1723-10"><a href="rethinking-chapter-15.html#cb1723-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">tibble</span>(<span class="at">x =</span> new_impute,</span>
<span id="cb1723-11"><a href="rethinking-chapter-15.html#cb1723-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> a <span class="sc">+</span> b <span class="sc">*</span> new_impute)})) <span class="sc">%&gt;%</span> </span>
<span id="cb1723-12"><a href="rethinking-chapter-15.html#cb1723-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(mu) <span class="sc">%&gt;%</span> </span>
<span id="cb1723-13"><a href="rethinking-chapter-15.html#cb1723-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(case, x) <span class="sc">%&gt;%</span> </span>
<span id="cb1723-14"><a href="rethinking-chapter-15.html#cb1723-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pi =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">value =</span> <span class="fu">quantile</span>(y, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">055</span>,.<span class="dv">5</span>,.<span class="dv">955</span>)),</span>
<span id="cb1723-15"><a href="rethinking-chapter-15.html#cb1723-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;ll&quot;</span>,<span class="st">&quot;m&quot;</span>,<span class="st">&quot;hh&quot;</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb1723-16"><a href="rethinking-chapter-15.html#cb1723-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pi) <span class="sc">%&gt;%</span> </span>
<span id="cb1723-17"><a href="rethinking-chapter-15.html#cb1723-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> value, <span class="at">names_from =</span> label) </span>
<span id="cb1723-18"><a href="rethinking-chapter-15.html#cb1723-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1723-19"><a href="rethinking-chapter-15.html#cb1723-19" aria-hidden="true" tabindex="-1"></a>impute_summary <span class="sc">%&gt;%</span> </span>
<span id="cb1723-20"><a href="rethinking-chapter-15.html#cb1723-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1723-21"><a href="rethinking-chapter-15.html#cb1723-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>,</span>
<span id="cb1723-22"><a href="rethinking-chapter-15.html#cb1723-22" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> ll, <span class="at">y =</span> m ,<span class="at">ymax =</span> hh),</span>
<span id="cb1723-23"><a href="rethinking-chapter-15.html#cb1723-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">3</span>, <span class="at">color =</span> clr0dd, <span class="at">fill =</span> fll0)<span class="sc">+</span></span>
<span id="cb1723-24"><a href="rethinking-chapter-15.html#cb1723-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> impute_summary_prep <span class="sc">%&gt;%</span></span>
<span id="cb1723-25"><a href="rethinking-chapter-15.html#cb1723-25" aria-hidden="true" tabindex="-1"></a>               <span class="fu">group_by</span>(case) <span class="sc">%&gt;%</span></span>
<span id="cb1723-26"><a href="rethinking-chapter-15.html#cb1723-26" aria-hidden="true" tabindex="-1"></a>               <span class="fu">summarise</span>( <span class="at">x_impute =</span> <span class="fu">mean</span>(x_impute)) <span class="sc">%&gt;%</span> </span>
<span id="cb1723-27"><a href="rethinking-chapter-15.html#cb1723-27" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">y =</span> data_impute<span class="sc">$</span>y[<span class="fu">is.na</span>(data_impute<span class="sc">$</span>x)]),</span>
<span id="cb1723-28"><a href="rethinking-chapter-15.html#cb1723-28" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x_impute, <span class="at">y =</span> y),</span>
<span id="cb1723-29"><a href="rethinking-chapter-15.html#cb1723-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1723-30"><a href="rethinking-chapter-15.html#cb1723-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_current, </span>
<span id="cb1723-31"><a href="rethinking-chapter-15.html#cb1723-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="fu">fll_current</span>(), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1723-32"><a href="rethinking-chapter-15.html#cb1723-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_impute,<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y ),</span>
<span id="cb1723-33"><a href="rethinking-chapter-15.html#cb1723-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> clr0d, <span class="at">fill =</span> fll0, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb1723-34"><a href="rethinking-chapter-15.html#cb1723-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(case <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb1723-35"><a href="rethinking-chapter-15.html#cb1723-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-69-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H4</strong></p>
<div class="sourceCode" id="cb1724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1724-1"><a href="rethinking-chapter-15.html#cb1724-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Primates301)</span>
<span id="cb1724-2"><a href="rethinking-chapter-15.html#cb1724-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1724-3"><a href="rethinking-chapter-15.html#cb1724-3" aria-hidden="true" tabindex="-1"></a>data_primates <span class="ot">&lt;-</span> Primates301 <span class="sc">%&gt;%</span> </span>
<span id="cb1724-4"><a href="rethinking-chapter-15.html#cb1724-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1724-5"><a href="rethinking-chapter-15.html#cb1724-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name, brain, body) <span class="sc">%&gt;%</span> </span>
<span id="cb1724-6"><a href="rethinking-chapter-15.html#cb1724-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(brain),</span>
<span id="cb1724-7"><a href="rethinking-chapter-15.html#cb1724-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">complete.cases</span>(body)) <span class="sc">%&gt;%</span> </span>
<span id="cb1724-8"><a href="rethinking-chapter-15.html#cb1724-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> brain<span class="sc">:</span>body,</span>
<span id="cb1724-9"><a href="rethinking-chapter-15.html#cb1724-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">.fns =</span> <span class="cf">function</span>(x){x <span class="sc">/</span> <span class="fu">max</span>(x)},</span>
<span id="cb1724-10"><a href="rethinking-chapter-15.html#cb1724-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">.names =</span> <span class="st">&quot;{.col}_scl&quot;</span>),</span>
<span id="cb1724-11"><a href="rethinking-chapter-15.html#cb1724-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">across</span>(<span class="at">.cols =</span> brain_scl<span class="sc">:</span>body_scl,</span>
<span id="cb1724-12"><a href="rethinking-chapter-15.html#cb1724-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">.fns =</span> <span class="cf">function</span>(x){x <span class="sc">*</span> .<span class="dv">1</span>},</span>
<span id="cb1724-13"><a href="rethinking-chapter-15.html#cb1724-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">.names =</span> <span class="st">&quot;{.col}_se&quot;</span>))</span></code></pre></div>
<p>Modeling with the relationship</p>
<p><span class="math display">\[
\begin{array}{rcl}
B_{i} &amp; \sim &amp; \textrm{Log-Normal}(\mu_{i}, \sigma)\\
\mu_{i} &amp; = \alpha + \beta~\textrm{log} M_{i}
\end{array}
\]</span>
which implies</p>
<p><span class="math display">\[
E(B_{i}|M_{i}) = \textrm{exp}(\alpha) M_{i}^{\beta}
\]</span></p>
<div class="sourceCode" id="cb1725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1725-1"><a href="rethinking-chapter-15.html#cb1725-1" aria-hidden="true" tabindex="-1"></a>model_primates_error_prep <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1725-2"><a href="rethinking-chapter-15.html#cb1725-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1725-3"><a href="rethinking-chapter-15.html#cb1725-3" aria-hidden="true" tabindex="-1"></a>    brain_scl <span class="sc">~</span> <span class="fu">dlnorm</span>(mu, sigma),</span>
<span id="cb1725-4"><a href="rethinking-chapter-15.html#cb1725-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> <span class="fu">log</span>(body_scl),</span>
<span id="cb1725-5"><a href="rethinking-chapter-15.html#cb1725-5" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1725-6"><a href="rethinking-chapter-15.html#cb1725-6" aria-hidden="true" tabindex="-1"></a>    beta <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1725-7"><a href="rethinking-chapter-15.html#cb1725-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">exponential</span>(<span class="dv">1</span>)</span>
<span id="cb1725-8"><a href="rethinking-chapter-15.html#cb1725-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1725-9"><a href="rethinking-chapter-15.html#cb1725-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_primates,</span>
<span id="cb1725-10"><a href="rethinking-chapter-15.html#cb1725-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1725-11"><a href="rethinking-chapter-15.html#cb1725-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span></span>
<span id="cb1725-12"><a href="rethinking-chapter-15.html#cb1725-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1726-1"><a href="rethinking-chapter-15.html#cb1726-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_primates_error_prep) <span class="sc">%&gt;%</span> </span>
<span id="cb1726-2"><a href="rethinking-chapter-15.html#cb1726-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.43</td>
<td align="right">0.06</td>
<td align="right">0.33</td>
<td align="right">0.53</td>
<td align="right">534.36</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta</td>
<td align="right">0.78</td>
<td align="right">0.01</td>
<td align="right">0.76</td>
<td align="right">0.81</td>
<td align="right">535.80</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.29</td>
<td align="right">0.02</td>
<td align="right">0.27</td>
<td align="right">0.32</td>
<td align="right">1079.64</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1727-1"><a href="rethinking-chapter-15.html#cb1727-1" aria-hidden="true" tabindex="-1"></a>data_primates_list <span class="ot">&lt;-</span> data_primates <span class="sc">%&gt;%</span> </span>
<span id="cb1727-2"><a href="rethinking-chapter-15.html#cb1727-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1727-3"><a href="rethinking-chapter-15.html#cb1727-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(., <span class="at">n_b =</span> <span class="fu">length</span>(data_primates<span class="sc">$</span>name))</span>
<span id="cb1727-4"><a href="rethinking-chapter-15.html#cb1727-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1727-5"><a href="rethinking-chapter-15.html#cb1727-5" aria-hidden="true" tabindex="-1"></a>model_primates_error <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1727-6"><a href="rethinking-chapter-15.html#cb1727-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1727-7"><a href="rethinking-chapter-15.html#cb1727-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># brain model</span></span>
<span id="cb1727-8"><a href="rethinking-chapter-15.html#cb1727-8" aria-hidden="true" tabindex="-1"></a>  brain_scl <span class="sc">~</span> <span class="fu">normal</span>( brain_true, brain_scl_se ),</span>
<span id="cb1727-9"><a href="rethinking-chapter-15.html#cb1727-9" aria-hidden="true" tabindex="-1"></a>  vector[n_b]<span class="sc">:</span>brain_true <span class="sc">~</span> <span class="fu">dlnorm</span>( mu, sigma ),</span>
<span id="cb1727-10"><a href="rethinking-chapter-15.html#cb1727-10" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> <span class="fu">log</span>( body_true[i] ),</span>
<span id="cb1727-11"><a href="rethinking-chapter-15.html#cb1727-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># body model</span></span>
<span id="cb1727-12"><a href="rethinking-chapter-15.html#cb1727-12" aria-hidden="true" tabindex="-1"></a>  body_scl <span class="sc">~</span> <span class="fu">normal</span>( body_true, body_scl_se ),</span>
<span id="cb1727-13"><a href="rethinking-chapter-15.html#cb1727-13" aria-hidden="true" tabindex="-1"></a>  vector[n_b]<span class="sc">:</span>body_true <span class="sc">~</span> <span class="fu">normal</span>( <span class="fl">0.5</span>, <span class="dv">1</span> ),</span>
<span id="cb1727-14"><a href="rethinking-chapter-15.html#cb1727-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># priors</span></span>
<span id="cb1727-15"><a href="rethinking-chapter-15.html#cb1727-15" aria-hidden="true" tabindex="-1"></a>  alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1727-16"><a href="rethinking-chapter-15.html#cb1727-16" aria-hidden="true" tabindex="-1"></a>  beta <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1727-17"><a href="rethinking-chapter-15.html#cb1727-17" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">exponential</span>(<span class="dv">1</span>)</span>
<span id="cb1727-18"><a href="rethinking-chapter-15.html#cb1727-18" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1727-19"><a href="rethinking-chapter-15.html#cb1727-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_primates_list,</span>
<span id="cb1727-20"><a href="rethinking-chapter-15.html#cb1727-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">start=</span><span class="fu">list</span>( <span class="at">body_true =</span> data_primates_list<span class="sc">$</span>body_scl,</span>
<span id="cb1727-21"><a href="rethinking-chapter-15.html#cb1727-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">brain_true =</span> data_primates_list<span class="sc">$</span>brain_scl ),</span>
<span id="cb1727-22"><a href="rethinking-chapter-15.html#cb1727-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1727-23"><a href="rethinking-chapter-15.html#cb1727-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1727-24"><a href="rethinking-chapter-15.html#cb1727-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">max_treedepth =</span> <span class="dv">15</span>)</span>
<span id="cb1727-25"><a href="rethinking-chapter-15.html#cb1727-25" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1728-1"><a href="rethinking-chapter-15.html#cb1728-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_primates_error) <span class="sc">%&gt;%</span> </span>
<span id="cb1728-2"><a href="rethinking-chapter-15.html#cb1728-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.41</td>
<td align="right">0.06</td>
<td align="right">0.32</td>
<td align="right">0.51</td>
<td align="right">2564.35</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta</td>
<td align="right">0.78</td>
<td align="right">0.01</td>
<td align="right">0.76</td>
<td align="right">0.81</td>
<td align="right">2591.35</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.26</td>
<td align="right">0.02</td>
<td align="right">0.23</td>
<td align="right">0.29</td>
<td align="right">3159.17</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1729-1"><a href="rethinking-chapter-15.html#cb1729-1" aria-hidden="true" tabindex="-1"></a>primates_posterior <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_primates_error) <span class="sc">%&gt;%</span> </span>
<span id="cb1729-2"><a href="rethinking-chapter-15.html#cb1729-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1729-3"><a href="rethinking-chapter-15.html#cb1729-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1729-4"><a href="rethinking-chapter-15.html#cb1729-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1729-5"><a href="rethinking-chapter-15.html#cb1729-5" aria-hidden="true" tabindex="-1"></a>  (primates_posterior[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ] <span class="sc">%&gt;%</span></span>
<span id="cb1729-6"><a href="rethinking-chapter-15.html#cb1729-6" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">select</span>(alpha, beta) <span class="sc">%&gt;%</span> </span>
<span id="cb1729-7"><a href="rethinking-chapter-15.html#cb1729-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">pmap</span>(<span class="at">.f =</span> <span class="cf">function</span>(alpha, beta, ...){</span>
<span id="cb1729-8"><a href="rethinking-chapter-15.html#cb1729-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){</span>
<span id="cb1729-9"><a href="rethinking-chapter-15.html#cb1729-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">exp</span>(alpha) <span class="sc">*</span> x <span class="sc">^</span> beta</span>
<span id="cb1729-10"><a href="rethinking-chapter-15.html#cb1729-10" aria-hidden="true" tabindex="-1"></a>       },</span>
<span id="cb1729-11"><a href="rethinking-chapter-15.html#cb1729-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1729-12"><a href="rethinking-chapter-15.html#cb1729-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">geom =</span> <span class="st">&#39;line&#39;</span>,</span>
<span id="cb1729-13"><a href="rethinking-chapter-15.html#cb1729-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> fll0dd, <span class="at">size =</span> .<span class="dv">2</span>)</span>
<span id="cb1729-14"><a href="rethinking-chapter-15.html#cb1729-14" aria-hidden="true" tabindex="-1"></a>     })) <span class="sc">+</span></span>
<span id="cb1729-15"><a href="rethinking-chapter-15.html#cb1729-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_primates,</span>
<span id="cb1729-16"><a href="rethinking-chapter-15.html#cb1729-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> body_scl, <span class="at">y =</span> brain_scl),</span>
<span id="cb1729-17"><a href="rethinking-chapter-15.html#cb1729-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_current, <span class="at">fill =</span> <span class="fu">fll_current</span>(),</span>
<span id="cb1729-18"><a href="rethinking-chapter-15.html#cb1729-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb1729-19"><a href="rethinking-chapter-15.html#cb1729-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb1730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1730-1"><a href="rethinking-chapter-15.html#cb1730-1" aria-hidden="true" tabindex="-1"></a>primate_estimates <span class="ot">&lt;-</span> primates_posterior<span class="sc">$</span>brain_true <span class="sc">%&gt;%</span> </span>
<span id="cb1730-2"><a href="rethinking-chapter-15.html#cb1730-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1730-3"><a href="rethinking-chapter-15.html#cb1730-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1730-4"><a href="rethinking-chapter-15.html#cb1730-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.idx =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1730-5"><a href="rethinking-chapter-15.html#cb1730-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>.idx, <span class="at">values_to =</span> <span class="st">&#39;brain_scl&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1730-6"><a href="rethinking-chapter-15.html#cb1730-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(primates_posterior<span class="sc">$</span>body_true <span class="sc">%&gt;%</span> </span>
<span id="cb1730-7"><a href="rethinking-chapter-15.html#cb1730-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1730-8"><a href="rethinking-chapter-15.html#cb1730-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1730-9"><a href="rethinking-chapter-15.html#cb1730-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.idx =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1730-10"><a href="rethinking-chapter-15.html#cb1730-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>.idx, <span class="at">values_to =</span> <span class="st">&#39;body_scl&#39;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb1730-11"><a href="rethinking-chapter-15.html#cb1730-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.idx) <span class="sc">%&gt;%</span> </span>
<span id="cb1730-12"><a href="rethinking-chapter-15.html#cb1730-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pi =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">brain_val =</span> <span class="fu">quantile</span>(brain_scl, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, .<span class="dv">955</span>)),</span>
<span id="cb1730-13"><a href="rethinking-chapter-15.html#cb1730-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">body_val =</span> <span class="fu">quantile</span>(body_scl, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, .<span class="dv">955</span>)),</span>
<span id="cb1730-14"><a href="rethinking-chapter-15.html#cb1730-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;ll&quot;</span>,<span class="st">&quot;m&quot;</span>,<span class="st">&quot;hh&quot;</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb1730-15"><a href="rethinking-chapter-15.html#cb1730-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pi) <span class="sc">%&gt;%</span> </span>
<span id="cb1730-16"><a href="rethinking-chapter-15.html#cb1730-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> label, <span class="at">values_from =</span> <span class="fu">c</span>(brain_val, body_val))</span>
<span id="cb1730-17"><a href="rethinking-chapter-15.html#cb1730-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1730-18"><a href="rethinking-chapter-15.html#cb1730-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1730-19"><a href="rethinking-chapter-15.html#cb1730-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">body_scl =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">101</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1730-20"><a href="rethinking-chapter-15.html#cb1730-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">brain_scl =</span> <span class="fu">map_dbl</span>(body_scl,</span>
<span id="cb1730-21"><a href="rethinking-chapter-15.html#cb1730-21" aria-hidden="true" tabindex="-1"></a>                             <span class="cf">function</span>(x){</span>
<span id="cb1730-22"><a href="rethinking-chapter-15.html#cb1730-22" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">mean</span>( <span class="fu">exp</span>(primates_posterior<span class="sc">$</span>alpha) <span class="sc">*</span> x <span class="sc">^</span> primates_posterior<span class="sc">$</span>beta )</span>
<span id="cb1730-23"><a href="rethinking-chapter-15.html#cb1730-23" aria-hidden="true" tabindex="-1"></a>                             })) <span class="sc">%&gt;%</span> </span>
<span id="cb1730-24"><a href="rethinking-chapter-15.html#cb1730-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_scl, <span class="at">y =</span> brain_scl)) <span class="sc">+</span></span>
<span id="cb1730-25"><a href="rethinking-chapter-15.html#cb1730-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> clr0dd) <span class="sc">+</span></span>
<span id="cb1730-26"><a href="rethinking-chapter-15.html#cb1730-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> primate_estimates,</span>
<span id="cb1730-27"><a href="rethinking-chapter-15.html#cb1730-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> body_val_m,</span>
<span id="cb1730-28"><a href="rethinking-chapter-15.html#cb1730-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> brain_val_m),</span>
<span id="cb1730-29"><a href="rethinking-chapter-15.html#cb1730-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_current, <span class="at">fill =</span> <span class="fu">fll_current</span>(),</span>
<span id="cb1730-30"><a href="rethinking-chapter-15.html#cb1730-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb1730-31"><a href="rethinking-chapter-15.html#cb1730-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_primates,</span>
<span id="cb1730-32"><a href="rethinking-chapter-15.html#cb1730-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0dd, <span class="at">fill =</span> fll0,</span>
<span id="cb1730-33"><a href="rethinking-chapter-15.html#cb1730-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="fl">1.75</span>) <span class="sc">+</span></span>
<span id="cb1730-34"><a href="rethinking-chapter-15.html#cb1730-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.05</span>))</span></code></pre></div>
<div class="sourceCode" id="cb1731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1731-1"><a href="rethinking-chapter-15.html#cb1731-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> primates_posterior<span class="sc">$</span>brain_true <span class="sc">%&gt;%</span> </span>
<span id="cb1731-2"><a href="rethinking-chapter-15.html#cb1731-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1731-3"><a href="rethinking-chapter-15.html#cb1731-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1731-4"><a href="rethinking-chapter-15.html#cb1731-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.idx =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1731-5"><a href="rethinking-chapter-15.html#cb1731-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>.idx, <span class="at">values_to =</span> <span class="st">&#39;brain_scl&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1731-6"><a href="rethinking-chapter-15.html#cb1731-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(primates_posterior<span class="sc">$</span>body_true <span class="sc">%&gt;%</span> </span>
<span id="cb1731-7"><a href="rethinking-chapter-15.html#cb1731-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1731-8"><a href="rethinking-chapter-15.html#cb1731-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1731-9"><a href="rethinking-chapter-15.html#cb1731-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.idx =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1731-10"><a href="rethinking-chapter-15.html#cb1731-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>.idx, <span class="at">values_to =</span> <span class="st">&#39;body_scl&#39;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb1731-11"><a href="rethinking-chapter-15.html#cb1731-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_scl, <span class="at">y =</span> brain_scl)) <span class="sc">+</span></span>
<span id="cb1731-12"><a href="rethinking-chapter-15.html#cb1731-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> .idx),</span>
<span id="cb1731-13"><a href="rethinking-chapter-15.html#cb1731-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">level =</span> .<span class="dv">5</span>,</span>
<span id="cb1731-14"><a href="rethinking-chapter-15.html#cb1731-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&#39;polygon&#39;</span>,</span>
<span id="cb1731-15"><a href="rethinking-chapter-15.html#cb1731-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> clr0d, <span class="at">fill =</span> fll0)  <span class="sc">+</span></span>
<span id="cb1731-16"><a href="rethinking-chapter-15.html#cb1731-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">data =</span> primate_estimates,</span>
<span id="cb1731-17"><a href="rethinking-chapter-15.html#cb1731-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> body_val_m,</span>
<span id="cb1731-18"><a href="rethinking-chapter-15.html#cb1731-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> brain_val_m),</span>
<span id="cb1731-19"><a href="rethinking-chapter-15.html#cb1731-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_current, <span class="at">fill =</span> <span class="fu">fll_current</span>(),</span>
<span id="cb1731-20"><a href="rethinking-chapter-15.html#cb1731-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>) </span>
<span id="cb1731-21"><a href="rethinking-chapter-15.html#cb1731-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1731-22"><a href="rethinking-chapter-15.html#cb1731-22" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-76-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H5</strong></p>
<div class="sourceCode" id="cb1732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1732-1"><a href="rethinking-chapter-15.html#cb1732-1" aria-hidden="true" tabindex="-1"></a>Primates301 <span class="sc">%&gt;%</span> </span>
<span id="cb1732-2"><a href="rethinking-chapter-15.html#cb1732-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1732-3"><a href="rethinking-chapter-15.html#cb1732-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(),</span>
<span id="cb1732-4"><a href="rethinking-chapter-15.html#cb1732-4" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x){<span class="fu">sum</span>(<span class="fu">is.na</span>(x))})) <span class="sc">%&gt;%</span> </span>
<span id="cb1732-5"><a href="rethinking-chapter-15.html#cb1732-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1732-6"><a href="rethinking-chapter-15.html#cb1732-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1732-7"><a href="rethinking-chapter-15.html#cb1732-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;column&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1732-8"><a href="rethinking-chapter-15.html#cb1732-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">n_na =</span> V1) <span class="sc">%&gt;%</span> </span>
<span id="cb1732-9"><a href="rethinking-chapter-15.html#cb1732-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>#&gt; # A tibble: 16 × 2
#&gt;    column               n_na
#&gt;    &lt;chr&gt;               &lt;int&gt;
#&gt;  1 name                    0
#&gt;  2 genus                   0
#&gt;  3 species                 0
#&gt;  4 subspecies            267
#&gt;  5 spp_id                  0
#&gt;  6 genus_id                0
#&gt;  7 social_learning        98
#&gt;  8 research_effort       115
#&gt;  9 brain                 117
#&gt; 10 body                   63
#&gt; 11 group_size            114
#&gt; 12 gestation             161
#&gt; 13 weaning               185
#&gt; 14 longevity             181
#&gt; 15 sex_maturity          194
#&gt; 16 maternal_investment   197</code></pre>
<div class="sourceCode" id="cb1734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1734-1"><a href="rethinking-chapter-15.html#cb1734-1" aria-hidden="true" tabindex="-1"></a>data_primates_2 <span class="ot">&lt;-</span> Primates301 <span class="sc">%&gt;%</span> </span>
<span id="cb1734-2"><a href="rethinking-chapter-15.html#cb1734-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1734-3"><a href="rethinking-chapter-15.html#cb1734-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name, brain, body) <span class="sc">%&gt;%</span> </span>
<span id="cb1734-4"><a href="rethinking-chapter-15.html#cb1734-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(body)) <span class="sc">%&gt;%</span> </span>
<span id="cb1734-5"><a href="rethinking-chapter-15.html#cb1734-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> brain<span class="sc">:</span>body,</span>
<span id="cb1734-6"><a href="rethinking-chapter-15.html#cb1734-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">.fns =</span> <span class="cf">function</span>(x){x <span class="sc">/</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)},</span>
<span id="cb1734-7"><a href="rethinking-chapter-15.html#cb1734-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">.names =</span> <span class="st">&quot;{.col}_scl&quot;</span>))</span>
<span id="cb1734-8"><a href="rethinking-chapter-15.html#cb1734-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1734-9"><a href="rethinking-chapter-15.html#cb1734-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1734-10"><a href="rethinking-chapter-15.html#cb1734-10" aria-hidden="true" tabindex="-1"></a>data_primates_2 <span class="sc">%&gt;%</span> </span>
<span id="cb1734-11"><a href="rethinking-chapter-15.html#cb1734-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_scl, <span class="at">y =</span> <span class="fu">is.na</span>(brain_scl))) <span class="sc">+</span></span>
<span id="cb1734-12"><a href="rethinking-chapter-15.html#cb1734-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clr0dd, <span class="at">fill =</span> fll0,</span>
<span id="cb1734-13"><a href="rethinking-chapter-15.html#cb1734-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1734-14"><a href="rethinking-chapter-15.html#cb1734-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(.<span class="dv">9</span>,<span class="fl">2.1</span>),</span>
<span id="cb1734-15"><a href="rethinking-chapter-15.html#cb1734-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1734-16"><a href="rethinking-chapter-15.html#cb1734-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">expand =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/H5-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1735-1"><a href="rethinking-chapter-15.html#cb1735-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(</span>
<span id="cb1735-2"><a href="rethinking-chapter-15.html#cb1735-2" aria-hidden="true" tabindex="-1"></a>  Bs <span class="sc">~</span> B <span class="sc">+</span> Rb,</span>
<span id="cb1735-3"><a href="rethinking-chapter-15.html#cb1735-3" aria-hidden="true" tabindex="-1"></a>  Rb <span class="sc">~</span> M,</span>
<span id="cb1735-4"><a href="rethinking-chapter-15.html#cb1735-4" aria-hidden="true" tabindex="-1"></a>  B <span class="sc">~</span> M,</span>
<span id="cb1735-5"><a href="rethinking-chapter-15.html#cb1735-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb1735-6"><a href="rethinking-chapter-15.html#cb1735-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">&quot;Bs&quot;</span>,</span>
<span id="cb1735-7"><a href="rethinking-chapter-15.html#cb1735-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;Rb&quot;</span>, <span class="st">&quot;Bs&quot;</span>),</span>
<span id="cb1735-8"><a href="rethinking-chapter-15.html#cb1735-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1735-9"><a href="rethinking-chapter-15.html#cb1735-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1735-10"><a href="rethinking-chapter-15.html#cb1735-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1735-11"><a href="rethinking-chapter-15.html#cb1735-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;Bs&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb1735-12"><a href="rethinking-chapter-15.html#cb1735-12" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;Rb&quot;</span>, <span class="st">&quot;Rg&quot;</span>),</span>
<span id="cb1735-13"><a href="rethinking-chapter-15.html#cb1735-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>)),</span>
<span id="cb1735-14"><a href="rethinking-chapter-15.html#cb1735-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">&quot;Bs&quot;</span>,<span class="st">&quot;B^&#39;*&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1735-15"><a href="rethinking-chapter-15.html#cb1735-15" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_replace</span>( <span class="st">&quot;Rb&quot;</span>,<span class="st">&quot;R[B]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1735-16"><a href="rethinking-chapter-15.html#cb1735-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1735-17"><a href="rethinking-chapter-15.html#cb1735-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">75</span>,</span>
<span id="cb1735-18"><a href="rethinking-chapter-15.html#cb1735-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1735-19"><a href="rethinking-chapter-15.html#cb1735-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb1735-20"><a href="rethinking-chapter-15.html#cb1735-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb1735-21"><a href="rethinking-chapter-15.html#cb1735-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-77-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1736-1"><a href="rethinking-chapter-15.html#cb1736-1" aria-hidden="true" tabindex="-1"></a>data_primates_2_list <span class="ot">&lt;-</span> data_primates_2 <span class="sc">%&gt;%</span> </span>
<span id="cb1736-2"><a href="rethinking-chapter-15.html#cb1736-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(brain_scl, body_scl) <span class="sc">%&gt;%</span> </span>
<span id="cb1736-3"><a href="rethinking-chapter-15.html#cb1736-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1736-4"><a href="rethinking-chapter-15.html#cb1736-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1736-5"><a href="rethinking-chapter-15.html#cb1736-5" aria-hidden="true" tabindex="-1"></a>model_primates_missing_default <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1736-6"><a href="rethinking-chapter-15.html#cb1736-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1736-7"><a href="rethinking-chapter-15.html#cb1736-7" aria-hidden="true" tabindex="-1"></a>    brain_scl <span class="sc">~</span> <span class="fu">dlnorm</span>( mu, sigma ),</span>
<span id="cb1736-8"><a href="rethinking-chapter-15.html#cb1736-8" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> <span class="fu">log</span>( body_scl ),</span>
<span id="cb1736-9"><a href="rethinking-chapter-15.html#cb1736-9" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1736-10"><a href="rethinking-chapter-15.html#cb1736-10" aria-hidden="true" tabindex="-1"></a>    beta <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1736-11"><a href="rethinking-chapter-15.html#cb1736-11" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">exponential</span>(<span class="dv">1</span>)</span>
<span id="cb1736-12"><a href="rethinking-chapter-15.html#cb1736-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1736-13"><a href="rethinking-chapter-15.html#cb1736-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_primates_2_list,</span>
<span id="cb1736-14"><a href="rethinking-chapter-15.html#cb1736-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1736-15"><a href="rethinking-chapter-15.html#cb1736-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1736-16"><a href="rethinking-chapter-15.html#cb1736-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>( <span class="at">brain_scl_impute =</span> <span class="fu">rep</span>( .<span class="dv">5</span>, <span class="dv">56</span> ))</span>
<span id="cb1736-17"><a href="rethinking-chapter-15.html#cb1736-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1736-18"><a href="rethinking-chapter-15.html#cb1736-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1736-19"><a href="rethinking-chapter-15.html#cb1736-19" aria-hidden="true" tabindex="-1"></a>model_primates_missing_explicit <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1736-20"><a href="rethinking-chapter-15.html#cb1736-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1736-21"><a href="rethinking-chapter-15.html#cb1736-21" aria-hidden="true" tabindex="-1"></a>    brain_scl_merge <span class="sc">~</span> <span class="fu">dlnorm</span>( mu, sigma ),</span>
<span id="cb1736-22"><a href="rethinking-chapter-15.html#cb1736-22" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> <span class="fu">log</span>( body_scl ),</span>
<span id="cb1736-23"><a href="rethinking-chapter-15.html#cb1736-23" aria-hidden="true" tabindex="-1"></a>    brain_scl_merge <span class="ot">&lt;-</span> <span class="fu">merge_missing</span>( brain_scl, brain_scl_impute ),</span>
<span id="cb1736-24"><a href="rethinking-chapter-15.html#cb1736-24" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1736-25"><a href="rethinking-chapter-15.html#cb1736-25" aria-hidden="true" tabindex="-1"></a>    beta <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1736-26"><a href="rethinking-chapter-15.html#cb1736-26" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">exponential</span>(<span class="dv">1</span>)</span>
<span id="cb1736-27"><a href="rethinking-chapter-15.html#cb1736-27" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1736-28"><a href="rethinking-chapter-15.html#cb1736-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_primates_2_list,</span>
<span id="cb1736-29"><a href="rethinking-chapter-15.html#cb1736-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1736-30"><a href="rethinking-chapter-15.html#cb1736-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1736-31"><a href="rethinking-chapter-15.html#cb1736-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>( <span class="at">brain_scl_impute =</span> <span class="fu">rep</span>( .<span class="dv">5</span>, <span class="dv">56</span> ))</span>
<span id="cb1736-32"><a href="rethinking-chapter-15.html#cb1736-32" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1737-1"><a href="rethinking-chapter-15.html#cb1737-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_primates_missing_default) <span class="sc">%&gt;%</span> </span>
<span id="cb1737-2"><a href="rethinking-chapter-15.html#cb1737-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.43</td>
<td align="right">0.06</td>
<td align="right">0.34</td>
<td align="right">0.52</td>
<td align="right">825.24</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta</td>
<td align="right">0.78</td>
<td align="right">0.01</td>
<td align="right">0.76</td>
<td align="right">0.81</td>
<td align="right">972.83</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.29</td>
<td align="right">0.02</td>
<td align="right">0.27</td>
<td align="right">0.32</td>
<td align="right">1495.86</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1738-1"><a href="rethinking-chapter-15.html#cb1738-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_primates_missing_explicit) <span class="sc">%&gt;%</span> </span>
<span id="cb1738-2"><a href="rethinking-chapter-15.html#cb1738-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.43</td>
<td align="right">0.06</td>
<td align="right">0.33</td>
<td align="right">0.52</td>
<td align="right">1148.76</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta</td>
<td align="right">0.78</td>
<td align="right">0.01</td>
<td align="right">0.76</td>
<td align="right">0.81</td>
<td align="right">1184.11</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.29</td>
<td align="right">0.02</td>
<td align="right">0.27</td>
<td align="right">0.32</td>
<td align="right">1843.00</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1739-1"><a href="rethinking-chapter-15.html#cb1739-1" aria-hidden="true" tabindex="-1"></a>data_primates_3_list <span class="ot">&lt;-</span>  data_primates <span class="sc">%&gt;%</span> </span>
<span id="cb1739-2"><a href="rethinking-chapter-15.html#cb1739-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name, brain_scl, body_scl ) <span class="sc">%&gt;%</span> </span>
<span id="cb1739-3"><a href="rethinking-chapter-15.html#cb1739-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>()</span>
<span id="cb1739-4"><a href="rethinking-chapter-15.html#cb1739-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1739-5"><a href="rethinking-chapter-15.html#cb1739-5" aria-hidden="true" tabindex="-1"></a>model_primates_missing_complete_cases <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1739-6"><a href="rethinking-chapter-15.html#cb1739-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1739-7"><a href="rethinking-chapter-15.html#cb1739-7" aria-hidden="true" tabindex="-1"></a>    brain_scl <span class="sc">~</span> <span class="fu">dlnorm</span>( mu, sigma ),</span>
<span id="cb1739-8"><a href="rethinking-chapter-15.html#cb1739-8" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> <span class="fu">log</span>( body_scl ),</span>
<span id="cb1739-9"><a href="rethinking-chapter-15.html#cb1739-9" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1739-10"><a href="rethinking-chapter-15.html#cb1739-10" aria-hidden="true" tabindex="-1"></a>    beta <span class="sc">~</span> <span class="fu">normal</span>( <span class="dv">0</span>, <span class="dv">1</span> ),</span>
<span id="cb1739-11"><a href="rethinking-chapter-15.html#cb1739-11" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">exponential</span>(<span class="dv">1</span>)</span>
<span id="cb1739-12"><a href="rethinking-chapter-15.html#cb1739-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1739-13"><a href="rethinking-chapter-15.html#cb1739-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_primates_3_list,</span>
<span id="cb1739-14"><a href="rethinking-chapter-15.html#cb1739-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1739-15"><a href="rethinking-chapter-15.html#cb1739-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1739-16"><a href="rethinking-chapter-15.html#cb1739-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>( <span class="at">brain_scl_impute =</span> <span class="fu">rep</span>( .<span class="dv">5</span>, <span class="dv">56</span> ))</span>
<span id="cb1739-17"><a href="rethinking-chapter-15.html#cb1739-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1740-1"><a href="rethinking-chapter-15.html#cb1740-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_primates_missing_complete_cases) <span class="sc">%&gt;%</span> </span>
<span id="cb1740-2"><a href="rethinking-chapter-15.html#cb1740-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.43</td>
<td align="right">0.06</td>
<td align="right">0.34</td>
<td align="right">0.52</td>
<td align="right">776.91</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta</td>
<td align="right">0.78</td>
<td align="right">0.01</td>
<td align="right">0.76</td>
<td align="right">0.81</td>
<td align="right">751.27</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.29</td>
<td align="right">0.02</td>
<td align="right">0.27</td>
<td align="right">0.32</td>
<td align="right">984.91</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1741-1"><a href="rethinking-chapter-15.html#cb1741-1" aria-hidden="true" tabindex="-1"></a>primates_impute_posterior <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_primates_missing_default) <span class="sc">%&gt;%</span> </span>
<span id="cb1741-2"><a href="rethinking-chapter-15.html#cb1741-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1741-3"><a href="rethinking-chapter-15.html#cb1741-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1741-4"><a href="rethinking-chapter-15.html#cb1741-4" aria-hidden="true" tabindex="-1"></a>primates_impute_posterior<span class="sc">$</span>brain_scl_impute <span class="sc">%&gt;%</span> </span>
<span id="cb1741-5"><a href="rethinking-chapter-15.html#cb1741-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1741-6"><a href="rethinking-chapter-15.html#cb1741-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1741-7"><a href="rethinking-chapter-15.html#cb1741-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">impute_idx =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1741-8"><a href="rethinking-chapter-15.html#cb1741-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>impute_idx) <span class="sc">%&gt;%</span> </span>
<span id="cb1741-9"><a href="rethinking-chapter-15.html#cb1741-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(impute_idx) <span class="sc">%&gt;%</span> </span>
<span id="cb1741-10"><a href="rethinking-chapter-15.html#cb1741-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pi =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">value =</span> <span class="fu">quantile</span>(value, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">055</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>, .<span class="dv">955</span>)),</span>
<span id="cb1741-11"><a href="rethinking-chapter-15.html#cb1741-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;ll&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;hh&quot;</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb1741-12"><a href="rethinking-chapter-15.html#cb1741-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pi) <span class="sc">%&gt;%</span> </span>
<span id="cb1741-13"><a href="rethinking-chapter-15.html#cb1741-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> value, <span class="at">names_from =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb1741-14"><a href="rethinking-chapter-15.html#cb1741-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_primates_2 <span class="sc">%&gt;%</span> </span>
<span id="cb1741-15"><a href="rethinking-chapter-15.html#cb1741-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(<span class="fu">is.na</span>(brain_scl)) <span class="sc">%&gt;%</span> </span>
<span id="cb1741-16"><a href="rethinking-chapter-15.html#cb1741-16" aria-hidden="true" tabindex="-1"></a>                       dplyr<span class="sc">::</span><span class="fu">select</span>(name, body_scl),.) <span class="sc">%&gt;%</span> </span>
<span id="cb1741-17"><a href="rethinking-chapter-15.html#cb1741-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_scl)) <span class="sc">+</span></span>
<span id="cb1741-18"><a href="rethinking-chapter-15.html#cb1741-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_primates_2,</span>
<span id="cb1741-19"><a href="rethinking-chapter-15.html#cb1741-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> brain_scl),</span>
<span id="cb1741-20"><a href="rethinking-chapter-15.html#cb1741-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0dd, <span class="at">fill =</span> fll0, </span>
<span id="cb1741-21"><a href="rethinking-chapter-15.html#cb1741-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb1741-22"><a href="rethinking-chapter-15.html#cb1741-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> l, <span class="at">ymax =</span> h),</span>
<span id="cb1741-23"><a href="rethinking-chapter-15.html#cb1741-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> clr_current) <span class="sc">+</span></span>
<span id="cb1741-24"><a href="rethinking-chapter-15.html#cb1741-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> m), <span class="at">color =</span> clr_current,</span>
<span id="cb1741-25"><a href="rethinking-chapter-15.html#cb1741-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="fu">clr_lighten</span>(clr_current), <span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-82-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H6</strong></p>
<div class="sourceCode" id="cb1742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1742-1"><a href="rethinking-chapter-15.html#cb1742-1" aria-hidden="true" tabindex="-1"></a>data_waffle</span>
<span id="cb1742-2"><a href="rethinking-chapter-15.html#cb1742-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1742-3"><a href="rethinking-chapter-15.html#cb1742-3" aria-hidden="true" tabindex="-1"></a>model_waffle_init <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb1742-4"><a href="rethinking-chapter-15.html#cb1742-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb1742-5"><a href="rethinking-chapter-15.html#cb1742-5" aria-hidden="true" tabindex="-1"></a>    divorce_obs <span class="sc">~</span> <span class="fu">dnorm</span>( divorce_true, divorce_sd ),</span>
<span id="cb1742-6"><a href="rethinking-chapter-15.html#cb1742-6" aria-hidden="true" tabindex="-1"></a>    vector[N]<span class="sc">:</span> divorce_true <span class="sc">~</span> <span class="fu">dnorm</span>( mu, sigma ),</span>
<span id="cb1742-7"><a href="rethinking-chapter-15.html#cb1742-7" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_age <span class="sc">*</span> median_age_std <span class="sc">+</span> beta_marriage <span class="sc">*</span> marriage_true[i],</span>
<span id="cb1742-8"><a href="rethinking-chapter-15.html#cb1742-8" aria-hidden="true" tabindex="-1"></a>    marriage_std <span class="sc">~</span> <span class="fu">dnorm</span>( marriage_true, marriage_sd ),</span>
<span id="cb1742-9"><a href="rethinking-chapter-15.html#cb1742-9" aria-hidden="true" tabindex="-1"></a>    vector[N]<span class="sc">:</span>marriage_true <span class="sc">~</span> <span class="fu">dnorm</span>(mu_marriage, sigma_marriage),</span>
<span id="cb1742-10"><a href="rethinking-chapter-15.html#cb1742-10" aria-hidden="true" tabindex="-1"></a>    mu_marriage <span class="ot">&lt;-</span> alpha_marriage <span class="sc">+</span> beta_marriage_age <span class="sc">*</span>  median_age_std,</span>
<span id="cb1742-11"><a href="rethinking-chapter-15.html#cb1742-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>( alpha, alpha_marriage ) <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> ,.<span class="dv">2</span> ),</span>
<span id="cb1742-12"><a href="rethinking-chapter-15.html#cb1742-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>( beta_age, beta_marriage, beta_marriage_age) <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, .<span class="dv">5</span> ),</span>
<span id="cb1742-13"><a href="rethinking-chapter-15.html#cb1742-13" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>),</span>
<span id="cb1742-14"><a href="rethinking-chapter-15.html#cb1742-14" aria-hidden="true" tabindex="-1"></a>    sigma_marriage <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb1742-15"><a href="rethinking-chapter-15.html#cb1742-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1742-16"><a href="rethinking-chapter-15.html#cb1742-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_waffle_list,</span>
<span id="cb1742-17"><a href="rethinking-chapter-15.html#cb1742-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1742-18"><a href="rethinking-chapter-15.html#cb1742-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb1742-19"><a href="rethinking-chapter-15.html#cb1742-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1743-1"><a href="rethinking-chapter-15.html#cb1743-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_waffle_init) <span class="sc">%&gt;%</span> </span>
<span id="cb1743-2"><a href="rethinking-chapter-15.html#cb1743-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha_marriage</td>
<td align="right">-0.11</td>
<td align="right">0.08</td>
<td align="right">-0.23</td>
<td align="right">0.01</td>
<td align="right">2269.42</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">alpha</td>
<td align="right">-0.03</td>
<td align="right">0.10</td>
<td align="right">-0.19</td>
<td align="right">0.13</td>
<td align="right">1812.57</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">beta_marriage_age</td>
<td align="right">-0.67</td>
<td align="right">0.09</td>
<td align="right">-0.81</td>
<td align="right">-0.53</td>
<td align="right">1910.76</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">beta_marriage</td>
<td align="right">0.30</td>
<td align="right">0.25</td>
<td align="right">-0.10</td>
<td align="right">0.70</td>
<td align="right">975.00</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">beta_age</td>
<td align="right">-0.46</td>
<td align="right">0.19</td>
<td align="right">-0.76</td>
<td align="right">-0.17</td>
<td align="right">1335.99</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.56</td>
<td align="right">0.11</td>
<td align="right">0.40</td>
<td align="right">0.74</td>
<td align="right">678.12</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">sigma_marriage</td>
<td align="right">0.44</td>
<td align="right">0.07</td>
<td align="right">0.34</td>
<td align="right">0.56</td>
<td align="right">1015.78</td>
<td align="right">1.01</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1744-1"><a href="rethinking-chapter-15.html#cb1744-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_divorce_error_out) <span class="sc">%&gt;%</span> </span>
<span id="cb1744-2"><a href="rethinking-chapter-15.html#cb1744-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.04</td>
<td align="right">0.10</td>
<td align="right">-0.20</td>
<td align="right">0.12</td>
<td align="right">1038.56</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">beta_age</td>
<td align="right">-0.54</td>
<td align="right">0.16</td>
<td align="right">-0.78</td>
<td align="right">-0.28</td>
<td align="right">983.30</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">beta_marriage</td>
<td align="right">0.20</td>
<td align="right">0.21</td>
<td align="right">-0.13</td>
<td align="right">0.53</td>
<td align="right">766.98</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.57</td>
<td align="right">0.11</td>
<td align="right">0.41</td>
<td align="right">0.75</td>
<td align="right">570.34</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1745-1"><a href="rethinking-chapter-15.html#cb1745-1" aria-hidden="true" tabindex="-1"></a>get_inferred_true_val <span class="ot">&lt;-</span> <span class="cf">function</span>(model){</span>
<span id="cb1745-2"><a href="rethinking-chapter-15.html#cb1745-2" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> rlang<span class="sc">::</span><span class="fu">enexpr</span>(model)</span>
<span id="cb1745-3"><a href="rethinking-chapter-15.html#cb1745-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1745-4"><a href="rethinking-chapter-15.html#cb1745-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract.samples</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb1745-5"><a href="rethinking-chapter-15.html#cb1745-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1745-6"><a href="rethinking-chapter-15.html#cb1745-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;marriage_true&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1745-7"><a href="rethinking-chapter-15.html#cb1745-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1745-8"><a href="rethinking-chapter-15.html#cb1745-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1745-9"><a href="rethinking-chapter-15.html#cb1745-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1745-10"><a href="rethinking-chapter-15.html#cb1745-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.idx =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1745-11"><a href="rethinking-chapter-15.html#cb1745-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>.idx) <span class="sc">%&gt;%</span> </span>
<span id="cb1745-12"><a href="rethinking-chapter-15.html#cb1745-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">as.character</span>(mod))</span>
<span id="cb1745-13"><a href="rethinking-chapter-15.html#cb1745-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1745-14"><a href="rethinking-chapter-15.html#cb1745-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1745-15"><a href="rethinking-chapter-15.html#cb1745-15" aria-hidden="true" tabindex="-1"></a>ls_states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DC&quot;</span>, <span class="st">&quot;DE&quot;</span>, <span class="st">&quot;HI&quot;</span>)</span>
<span id="cb1745-16"><a href="rethinking-chapter-15.html#cb1745-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1745-17"><a href="rethinking-chapter-15.html#cb1745-17" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">get_inferred_true_val</span>(model_divorce_error_out) <span class="sc">%&gt;%</span> </span>
<span id="cb1745-18"><a href="rethinking-chapter-15.html#cb1745-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">get_inferred_true_val</span>(model_waffle_init) ) <span class="sc">%&gt;%</span></span>
<span id="cb1745-19"><a href="rethinking-chapter-15.html#cb1745-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.idx, model) <span class="sc">%&gt;%</span> </span>
<span id="cb1745-20"><a href="rethinking-chapter-15.html#cb1745-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb1745-21"><a href="rethinking-chapter-15.html#cb1745-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> mean, <span class="at">names_from =</span> model) <span class="sc">%&gt;%</span></span>
<span id="cb1745-22"><a href="rethinking-chapter-15.html#cb1745-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_waffle <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Loc),. ) <span class="sc">%&gt;%</span> </span>
<span id="cb1745-23"><a href="rethinking-chapter-15.html#cb1745-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1745-24"><a href="rethinking-chapter-15.html#cb1745-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb1745-25"><a href="rethinking-chapter-15.html#cb1745-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> model_divorce_error_out,</span>
<span id="cb1745-26"><a href="rethinking-chapter-15.html#cb1745-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> model_waffle_init),</span>
<span id="cb1745-27"><a href="rethinking-chapter-15.html#cb1745-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0dd, <span class="at">fill =</span> fll0, </span>
<span id="cb1745-28"><a href="rethinking-chapter-15.html#cb1745-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb1745-29"><a href="rethinking-chapter-15.html#cb1745-29" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb1745-30"><a href="rethinking-chapter-15.html#cb1745-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span>  </span>
<span id="cb1745-31"><a href="rethinking-chapter-15.html#cb1745-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Loc <span class="sc">%in%</span> ls_states),</span>
<span id="cb1745-32"><a href="rethinking-chapter-15.html#cb1745-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> model_divorce_error_out,</span>
<span id="cb1745-33"><a href="rethinking-chapter-15.html#cb1745-33" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> model_waffle_init,</span>
<span id="cb1745-34"><a href="rethinking-chapter-15.html#cb1745-34" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label =</span> Loc))</span>
<span id="cb1745-35"><a href="rethinking-chapter-15.html#cb1745-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1745-36"><a href="rethinking-chapter-15.html#cb1745-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1745-37"><a href="rethinking-chapter-15.html#cb1745-37" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data_waffle_list  <span class="sc">%&gt;%</span></span>
<span id="cb1745-38"><a href="rethinking-chapter-15.html#cb1745-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_waffle <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Loc),. ) <span class="sc">%&gt;%</span> </span>
<span id="cb1745-39"><a href="rethinking-chapter-15.html#cb1745-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1745-40"><a href="rethinking-chapter-15.html#cb1745-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> median_age_std, <span class="at">y =</span> marriage_std)) <span class="sc">+</span></span>
<span id="cb1745-41"><a href="rethinking-chapter-15.html#cb1745-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Loc <span class="sc">%in%</span> ls_states,</span>
<span id="cb1745-42"><a href="rethinking-chapter-15.html#cb1745-42" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(<span class="fu">clr_lighten</span>(color), .<span class="dv">3</span>))),</span>
<span id="cb1745-43"><a href="rethinking-chapter-15.html#cb1745-43" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb1745-44"><a href="rethinking-chapter-15.html#cb1745-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> <span class="ot">=</span> clr_current,</span>
<span id="cb1745-45"><a href="rethinking-chapter-15.html#cb1745-45" aria-hidden="true" tabindex="-1"></a>                            <span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> <span class="ot">=</span> clr0dd),</span>
<span id="cb1745-46"><a href="rethinking-chapter-15.html#cb1745-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1745-47"><a href="rethinking-chapter-15.html#cb1745-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1745-48"><a href="rethinking-chapter-15.html#cb1745-48" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-85-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H7</strong></p>
<div class="sourceCode" id="cb1746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1746-1"><a href="rethinking-chapter-15.html#cb1746-1" aria-hidden="true" tabindex="-1"></a>data_andrew <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">freq =</span> <span class="fu">c</span>( <span class="dv">18</span> , <span class="dv">19</span> , <span class="dv">22</span> , <span class="cn">NA</span> , <span class="cn">NA</span> , <span class="dv">19</span> , <span class="dv">20</span> , <span class="dv">22</span> ),</span>
<span id="cb1746-2"><a href="rethinking-chapter-15.html#cb1746-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">value =</span> <span class="fu">seq_along</span>(freq)) <span class="sc">%&gt;%</span> </span>
<span id="cb1746-3"><a href="rethinking-chapter-15.html#cb1746-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(value, freq)</span>
<span id="cb1746-4"><a href="rethinking-chapter-15.html#cb1746-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1746-5"><a href="rethinking-chapter-15.html#cb1746-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(data_andrew<span class="sc">$</span>freq, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>#&gt; [1] 120</code></pre>
<p>Parameterizing the number of spins above 120,using a Poisson distribution with a mean of 40:</p>
<p><span class="math display">\[
S \sim \textrm{Poisson}(40) + 120
\]</span></p>
<div class="sourceCode" id="cb1748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1748-1"><a href="rethinking-chapter-15.html#cb1748-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>(<span class="fl">1e3</span>, <span class="at">alpha =</span> <span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">8</span>))</span>
<span id="cb1748-2"><a href="rethinking-chapter-15.html#cb1748-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p <span class="sc">%&gt;%</span> </span>
<span id="cb1748-3"><a href="rethinking-chapter-15.html#cb1748-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1748-4"><a href="rethinking-chapter-15.html#cb1748-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.idx =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1748-5"><a href="rethinking-chapter-15.html#cb1748-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>.idx, </span>
<span id="cb1748-6"><a href="rethinking-chapter-15.html#cb1748-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;V&quot;</span>,</span>
<span id="cb1748-7"><a href="rethinking-chapter-15.html#cb1748-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> as.integer,</span>
<span id="cb1748-8"><a href="rethinking-chapter-15.html#cb1748-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;value&quot;</span>,</span>
<span id="cb1748-9"><a href="rethinking-chapter-15.html#cb1748-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;probability&quot;</span>)   <span class="sc">%&gt;%</span> </span>
<span id="cb1748-10"><a href="rethinking-chapter-15.html#cb1748-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.idx <span class="sc">&lt;</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1748-11"><a href="rethinking-chapter-15.html#cb1748-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> probability)) <span class="sc">+</span></span>
<span id="cb1748-12"><a href="rethinking-chapter-15.html#cb1748-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> .idx), <span class="at">color =</span> clr0dd,</span>
<span id="cb1748-13"><a href="rethinking-chapter-15.html#cb1748-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> .<span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1748-14"><a href="rethinking-chapter-15.html#cb1748-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0, <span class="at">shape =</span> <span class="dv">21</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1749-1"><a href="rethinking-chapter-15.html#cb1749-1" aria-hidden="true" tabindex="-1"></a>twicer <span class="ot">&lt;-</span> <span class="cf">function</span>( p ) {</span>
<span id="cb1749-2"><a href="rethinking-chapter-15.html#cb1749-2" aria-hidden="true" tabindex="-1"></a>  o <span class="ot">&lt;-</span> <span class="fu">order</span>( p )</span>
<span id="cb1749-3"><a href="rethinking-chapter-15.html#cb1749-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ( p[o][<span class="dv">8</span>]<span class="sc">/</span>p[o][<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">2</span> ) <span class="fu">return</span>( <span class="cn">TRUE</span> ) <span class="cf">else</span> <span class="fu">return</span>( <span class="cn">FALSE</span> )</span>
<span id="cb1749-4"><a href="rethinking-chapter-15.html#cb1749-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1749-5"><a href="rethinking-chapter-15.html#cb1749-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( <span class="fu">apply</span>( p , <span class="dv">1</span> , twicer ) )</span></code></pre></div>
<pre><code>#&gt; [1] 976</code></pre>
<div class="sourceCode" id="cb1751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1751-1"><a href="rethinking-chapter-15.html#cb1751-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>( <span class="fl">1e3</span> , <span class="at">alpha =</span> <span class="fu">rep</span>(<span class="dv">50</span>, <span class="dv">8</span>) )</span>
<span id="cb1751-2"><a href="rethinking-chapter-15.html#cb1751-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( <span class="fu">apply</span>( p , <span class="dv">1</span> , twicer ) )</span></code></pre></div>
<pre><code>#&gt; [1] 15</code></pre>
<div class="sourceCode" id="cb1753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1753-1"><a href="rethinking-chapter-15.html#cb1753-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p <span class="sc">%&gt;%</span> </span>
<span id="cb1753-2"><a href="rethinking-chapter-15.html#cb1753-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1753-3"><a href="rethinking-chapter-15.html#cb1753-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.idx =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1753-4"><a href="rethinking-chapter-15.html#cb1753-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>.idx, </span>
<span id="cb1753-5"><a href="rethinking-chapter-15.html#cb1753-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;V&quot;</span>,</span>
<span id="cb1753-6"><a href="rethinking-chapter-15.html#cb1753-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> as.integer,</span>
<span id="cb1753-7"><a href="rethinking-chapter-15.html#cb1753-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;value&quot;</span>,</span>
<span id="cb1753-8"><a href="rethinking-chapter-15.html#cb1753-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;probability&quot;</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb1753-9"><a href="rethinking-chapter-15.html#cb1753-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.idx <span class="sc">&lt;</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1753-10"><a href="rethinking-chapter-15.html#cb1753-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> probability)) <span class="sc">+</span></span>
<span id="cb1753-11"><a href="rethinking-chapter-15.html#cb1753-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> .idx), <span class="at">color =</span> clr0dd,</span>
<span id="cb1753-12"><a href="rethinking-chapter-15.html#cb1753-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> .<span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1753-13"><a href="rethinking-chapter-15.html#cb1753-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0, <span class="at">shape =</span> <span class="dv">21</span>)</span>
<span id="cb1753-14"><a href="rethinking-chapter-15.html#cb1753-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1753-15"><a href="rethinking-chapter-15.html#cb1753-15" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">&amp;</span> </span>
<span id="cb1753-16"><a href="rethinking-chapter-15.html#cb1753-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">35</span>))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-87-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1754-1"><a href="rethinking-chapter-15.html#cb1754-1" aria-hidden="true" tabindex="-1"></a>code_andrew <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb1754-2"><a href="rethinking-chapter-15.html#cb1754-2" aria-hidden="true" tabindex="-1"></a><span class="st">data{</span></span>
<span id="cb1754-3"><a href="rethinking-chapter-15.html#cb1754-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int N;</span></span>
<span id="cb1754-4"><a href="rethinking-chapter-15.html#cb1754-4" aria-hidden="true" tabindex="-1"></a><span class="st">  int y[N];</span></span>
<span id="cb1754-5"><a href="rethinking-chapter-15.html#cb1754-5" aria-hidden="true" tabindex="-1"></a><span class="st">  int y_max; // consider at most this many spins for y4 and y5</span></span>
<span id="cb1754-6"><a href="rethinking-chapter-15.html#cb1754-6" aria-hidden="true" tabindex="-1"></a><span class="st">  int S_mean;</span></span>
<span id="cb1754-7"><a href="rethinking-chapter-15.html#cb1754-7" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1754-8"><a href="rethinking-chapter-15.html#cb1754-8" aria-hidden="true" tabindex="-1"></a><span class="st">parameters{</span></span>
<span id="cb1754-9"><a href="rethinking-chapter-15.html#cb1754-9" aria-hidden="true" tabindex="-1"></a><span class="st">  simplex[N] p;</span></span>
<span id="cb1754-10"><a href="rethinking-chapter-15.html#cb1754-10" aria-hidden="true" tabindex="-1"></a><span class="st">  // probabilities of each outcome</span></span>
<span id="cb1754-11"><a href="rethinking-chapter-15.html#cb1754-11" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1754-12"><a href="rethinking-chapter-15.html#cb1754-12" aria-hidden="true" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb1754-13"><a href="rethinking-chapter-15.html#cb1754-13" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[(1+y_max)*(1+y_max)] terms;</span></span>
<span id="cb1754-14"><a href="rethinking-chapter-15.html#cb1754-14" aria-hidden="true" tabindex="-1"></a><span class="st">  int k = 1;</span></span>
<span id="cb1754-15"><a href="rethinking-chapter-15.html#cb1754-15" aria-hidden="true" tabindex="-1"></a><span class="st">  p ~ dirichlet( rep_vector(50,N) );</span></span>
<span id="cb1754-16"><a href="rethinking-chapter-15.html#cb1754-16" aria-hidden="true" tabindex="-1"></a><span class="st">  // loop over possible values for unknown cells 4 and 5</span></span>
<span id="cb1754-17"><a href="rethinking-chapter-15.html#cb1754-17" aria-hidden="true" tabindex="-1"></a><span class="st">  // this code updates posterior of p</span></span>
<span id="cb1754-18"><a href="rethinking-chapter-15.html#cb1754-18" aria-hidden="true" tabindex="-1"></a><span class="st">  for ( y4 in 0:y_max ) {</span></span>
<span id="cb1754-19"><a href="rethinking-chapter-15.html#cb1754-19" aria-hidden="true" tabindex="-1"></a><span class="st">    for ( y5 in 0:y_max ) {</span></span>
<span id="cb1754-20"><a href="rethinking-chapter-15.html#cb1754-20" aria-hidden="true" tabindex="-1"></a><span class="st">      int Y[N] = y;</span></span>
<span id="cb1754-21"><a href="rethinking-chapter-15.html#cb1754-21" aria-hidden="true" tabindex="-1"></a><span class="st">      Y[4] = y4;</span></span>
<span id="cb1754-22"><a href="rethinking-chapter-15.html#cb1754-22" aria-hidden="true" tabindex="-1"></a><span class="st">      Y[5] = y5;</span></span>
<span id="cb1754-23"><a href="rethinking-chapter-15.html#cb1754-23" aria-hidden="true" tabindex="-1"></a><span class="st">      terms[k] = poisson_lpmf(y4+y5|S_mean-120) + multinomial_lpmf(Y|p);</span></span>
<span id="cb1754-24"><a href="rethinking-chapter-15.html#cb1754-24" aria-hidden="true" tabindex="-1"></a><span class="st">      k = k + 1;</span></span>
<span id="cb1754-25"><a href="rethinking-chapter-15.html#cb1754-25" aria-hidden="true" tabindex="-1"></a><span class="st">    }//y5</span></span>
<span id="cb1754-26"><a href="rethinking-chapter-15.html#cb1754-26" aria-hidden="true" tabindex="-1"></a><span class="st">  }//y4</span></span>
<span id="cb1754-27"><a href="rethinking-chapter-15.html#cb1754-27" aria-hidden="true" tabindex="-1"></a><span class="st">  target += log_sum_exp(terms);</span></span>
<span id="cb1754-28"><a href="rethinking-chapter-15.html#cb1754-28" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1754-29"><a href="rethinking-chapter-15.html#cb1754-29" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb1754-30"><a href="rethinking-chapter-15.html#cb1754-30" aria-hidden="true" tabindex="-1"></a><span class="st">  matrix[y_max+1,y_max+1] P45; // prob y4,y5 takes joint values</span></span>
<span id="cb1754-31"><a href="rethinking-chapter-15.html#cb1754-31" aria-hidden="true" tabindex="-1"></a><span class="st">  // now compute Prob(y4,y5|p)</span></span>
<span id="cb1754-32"><a href="rethinking-chapter-15.html#cb1754-32" aria-hidden="true" tabindex="-1"></a><span class="st">  {</span></span>
<span id="cb1754-33"><a href="rethinking-chapter-15.html#cb1754-33" aria-hidden="true" tabindex="-1"></a><span class="st">    matrix[(1+y_max),(1+y_max)] terms;</span></span>
<span id="cb1754-34"><a href="rethinking-chapter-15.html#cb1754-34" aria-hidden="true" tabindex="-1"></a><span class="st">    int k = 1;</span></span>
<span id="cb1754-35"><a href="rethinking-chapter-15.html#cb1754-35" aria-hidden="true" tabindex="-1"></a><span class="st">    real Z;</span></span>
<span id="cb1754-36"><a href="rethinking-chapter-15.html#cb1754-36" aria-hidden="true" tabindex="-1"></a><span class="st">    for ( y4 in 0:y_max ) {</span></span>
<span id="cb1754-37"><a href="rethinking-chapter-15.html#cb1754-37" aria-hidden="true" tabindex="-1"></a><span class="st">      for ( y5 in 0:y_max ) {</span></span>
<span id="cb1754-38"><a href="rethinking-chapter-15.html#cb1754-38" aria-hidden="true" tabindex="-1"></a><span class="st">        int Y[N] = y;</span></span>
<span id="cb1754-39"><a href="rethinking-chapter-15.html#cb1754-39" aria-hidden="true" tabindex="-1"></a><span class="st">        Y[4] = y4;</span></span>
<span id="cb1754-40"><a href="rethinking-chapter-15.html#cb1754-40" aria-hidden="true" tabindex="-1"></a><span class="st">        Y[5] = y5;</span></span>
<span id="cb1754-41"><a href="rethinking-chapter-15.html#cb1754-41" aria-hidden="true" tabindex="-1"></a><span class="st">        terms[y4+1,y5+1] = poisson_lpmf(y4+y5|S_mean-120) + multinomial_lpmf(Y|p);</span></span>
<span id="cb1754-42"><a href="rethinking-chapter-15.html#cb1754-42" aria-hidden="true" tabindex="-1"></a><span class="st">      }//y5</span></span>
<span id="cb1754-43"><a href="rethinking-chapter-15.html#cb1754-43" aria-hidden="true" tabindex="-1"></a><span class="st">    }//y4</span></span>
<span id="cb1754-44"><a href="rethinking-chapter-15.html#cb1754-44" aria-hidden="true" tabindex="-1"></a><span class="st">    Z = log_sum_exp( to_vector(terms) );</span></span>
<span id="cb1754-45"><a href="rethinking-chapter-15.html#cb1754-45" aria-hidden="true" tabindex="-1"></a><span class="st">    for ( y4 in 0:y_max )</span></span>
<span id="cb1754-46"><a href="rethinking-chapter-15.html#cb1754-46" aria-hidden="true" tabindex="-1"></a><span class="st">      for ( y5 in 0:y_max )</span></span>
<span id="cb1754-47"><a href="rethinking-chapter-15.html#cb1754-47" aria-hidden="true" tabindex="-1"></a><span class="st">        P45[y4+1,y5+1] = exp( terms[y4+1,y5+1] - Z );</span></span>
<span id="cb1754-48"><a href="rethinking-chapter-15.html#cb1754-48" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb1754-49"><a href="rethinking-chapter-15.html#cb1754-49" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1754-50"><a href="rethinking-chapter-15.html#cb1754-50" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb1754-51"><a href="rethinking-chapter-15.html#cb1754-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1754-52"><a href="rethinking-chapter-15.html#cb1754-52" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">22</span>, <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb1754-53"><a href="rethinking-chapter-15.html#cb1754-53" aria-hidden="true" tabindex="-1"></a>       <span class="sc">-</span><span class="dv">1</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb1754-54"><a href="rethinking-chapter-15.html#cb1754-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1754-55"><a href="rethinking-chapter-15.html#cb1754-55" aria-hidden="true" tabindex="-1"></a>data_andrew_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1754-56"><a href="rethinking-chapter-15.html#cb1754-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">length</span>(y),</span>
<span id="cb1754-57"><a href="rethinking-chapter-15.html#cb1754-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb1754-58"><a href="rethinking-chapter-15.html#cb1754-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">S_mean =</span> <span class="dv">160</span>,</span>
<span id="cb1754-59"><a href="rethinking-chapter-15.html#cb1754-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_max =</span> <span class="dv">40</span> )</span>
<span id="cb1754-60"><a href="rethinking-chapter-15.html#cb1754-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1754-61"><a href="rethinking-chapter-15.html#cb1754-61" aria-hidden="true" tabindex="-1"></a>model_andrew <span class="ot">&lt;-</span> <span class="fu">stan</span>(</span>
<span id="cb1754-62"><a href="rethinking-chapter-15.html#cb1754-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_code =</span> code_andrew,</span>
<span id="cb1754-63"><a href="rethinking-chapter-15.html#cb1754-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_andrew_list,</span>
<span id="cb1754-64"><a href="rethinking-chapter-15.html#cb1754-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1754-65"><a href="rethinking-chapter-15.html#cb1754-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span> )</span></code></pre></div>
<div class="sourceCode" id="cb1755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1755-1"><a href="rethinking-chapter-15.html#cb1755-1" aria-hidden="true" tabindex="-1"></a>andrew_posterior <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_andrew) <span class="sc">%&gt;%</span> </span>
<span id="cb1755-2"><a href="rethinking-chapter-15.html#cb1755-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1755-3"><a href="rethinking-chapter-15.html#cb1755-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1755-4"><a href="rethinking-chapter-15.html#cb1755-4" aria-hidden="true" tabindex="-1"></a>y_max <span class="ot">&lt;-</span> data_andrew_list<span class="sc">$</span>y_max</span>
<span id="cb1755-5"><a href="rethinking-chapter-15.html#cb1755-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1755-6"><a href="rethinking-chapter-15.html#cb1755-6" aria-hidden="true" tabindex="-1"></a>extract_k <span class="ot">&lt;-</span> <span class="cf">function</span>(y4, y5, posterior){</span>
<span id="cb1755-7"><a href="rethinking-chapter-15.html#cb1755-7" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">mean</span>( posterior<span class="sc">$</span>P45[,y4<span class="sc">+</span><span class="dv">1</span>,y5<span class="sc">+</span><span class="dv">1</span>] )<span class="sc">/</span><span class="fl">0.01</span> </span>
<span id="cb1755-8"><a href="rethinking-chapter-15.html#cb1755-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>( <span class="at">x =</span> y4 , <span class="at">y =</span> y5 , <span class="at">k =</span> k )</span>
<span id="cb1755-9"><a href="rethinking-chapter-15.html#cb1755-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1755-10"><a href="rethinking-chapter-15.html#cb1755-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1755-11"><a href="rethinking-chapter-15.html#cb1755-11" aria-hidden="true" tabindex="-1"></a>andrew_k <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">y4 =</span> <span class="dv">0</span><span class="sc">:</span>y_max, <span class="at">y5 =</span> <span class="dv">0</span><span class="sc">:</span>y_max) <span class="sc">%&gt;%</span> </span>
<span id="cb1755-12"><a href="rethinking-chapter-15.html#cb1755-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmap_df</span>(extract_k, <span class="at">posterior =</span> andrew_posterior)</span>
<span id="cb1755-13"><a href="rethinking-chapter-15.html#cb1755-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1755-14"><a href="rethinking-chapter-15.html#cb1755-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> andrew_k <span class="sc">%&gt;%</span> </span>
<span id="cb1755-15"><a href="rethinking-chapter-15.html#cb1755-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(x,<span class="dv">10</span>, <span class="dv">30</span>),</span>
<span id="cb1755-16"><a href="rethinking-chapter-15.html#cb1755-16" aria-hidden="true" tabindex="-1"></a>         <span class="fu">between</span>(y,<span class="dv">10</span>, <span class="dv">30</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1755-17"><a href="rethinking-chapter-15.html#cb1755-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x , y, <span class="at">color =</span> k)) <span class="sc">+</span></span>
<span id="cb1755-18"><a href="rethinking-chapter-15.html#cb1755-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1755-19"><a href="rethinking-chapter-15.html#cb1755-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb1755-20"><a href="rethinking-chapter-15.html#cb1755-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(color,.<span class="dv">8</span>))))<span class="sc">+</span></span>
<span id="cb1755-21"><a href="rethinking-chapter-15.html#cb1755-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot; dirichlet( rep_vector(50, N) )&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1756-1"><a href="rethinking-chapter-15.html#cb1756-1" aria-hidden="true" tabindex="-1"></a>code_andrew2 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb1756-2"><a href="rethinking-chapter-15.html#cb1756-2" aria-hidden="true" tabindex="-1"></a><span class="st">data{</span></span>
<span id="cb1756-3"><a href="rethinking-chapter-15.html#cb1756-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int N;</span></span>
<span id="cb1756-4"><a href="rethinking-chapter-15.html#cb1756-4" aria-hidden="true" tabindex="-1"></a><span class="st">  int y[N];</span></span>
<span id="cb1756-5"><a href="rethinking-chapter-15.html#cb1756-5" aria-hidden="true" tabindex="-1"></a><span class="st">  int y_max; // consider at most this many spins for y4 and y5</span></span>
<span id="cb1756-6"><a href="rethinking-chapter-15.html#cb1756-6" aria-hidden="true" tabindex="-1"></a><span class="st">  int S_mean;</span></span>
<span id="cb1756-7"><a href="rethinking-chapter-15.html#cb1756-7" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1756-8"><a href="rethinking-chapter-15.html#cb1756-8" aria-hidden="true" tabindex="-1"></a><span class="st">parameters{</span></span>
<span id="cb1756-9"><a href="rethinking-chapter-15.html#cb1756-9" aria-hidden="true" tabindex="-1"></a><span class="st">  simplex[N] p;</span></span>
<span id="cb1756-10"><a href="rethinking-chapter-15.html#cb1756-10" aria-hidden="true" tabindex="-1"></a><span class="st">  // probabilities of each outcome</span></span>
<span id="cb1756-11"><a href="rethinking-chapter-15.html#cb1756-11" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1756-12"><a href="rethinking-chapter-15.html#cb1756-12" aria-hidden="true" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb1756-13"><a href="rethinking-chapter-15.html#cb1756-13" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[(1+y_max)*(1+y_max)] terms;</span></span>
<span id="cb1756-14"><a href="rethinking-chapter-15.html#cb1756-14" aria-hidden="true" tabindex="-1"></a><span class="st">  int k = 1;</span></span>
<span id="cb1756-15"><a href="rethinking-chapter-15.html#cb1756-15" aria-hidden="true" tabindex="-1"></a><span class="st">  p ~ dirichlet( rep_vector(2,N) );</span></span>
<span id="cb1756-16"><a href="rethinking-chapter-15.html#cb1756-16" aria-hidden="true" tabindex="-1"></a><span class="st">  // loop over possible values for unknown cells 4 and 5</span></span>
<span id="cb1756-17"><a href="rethinking-chapter-15.html#cb1756-17" aria-hidden="true" tabindex="-1"></a><span class="st">  // this code updates posterior of p</span></span>
<span id="cb1756-18"><a href="rethinking-chapter-15.html#cb1756-18" aria-hidden="true" tabindex="-1"></a><span class="st">  for ( y4 in 0:y_max ) {</span></span>
<span id="cb1756-19"><a href="rethinking-chapter-15.html#cb1756-19" aria-hidden="true" tabindex="-1"></a><span class="st">    for ( y5 in 0:y_max ) {</span></span>
<span id="cb1756-20"><a href="rethinking-chapter-15.html#cb1756-20" aria-hidden="true" tabindex="-1"></a><span class="st">      int Y[N] = y;</span></span>
<span id="cb1756-21"><a href="rethinking-chapter-15.html#cb1756-21" aria-hidden="true" tabindex="-1"></a><span class="st">      Y[4] = y4;</span></span>
<span id="cb1756-22"><a href="rethinking-chapter-15.html#cb1756-22" aria-hidden="true" tabindex="-1"></a><span class="st">      Y[5] = y5;</span></span>
<span id="cb1756-23"><a href="rethinking-chapter-15.html#cb1756-23" aria-hidden="true" tabindex="-1"></a><span class="st">      terms[k] = poisson_lpmf(y4+y5|S_mean-120) + multinomial_lpmf(Y|p);</span></span>
<span id="cb1756-24"><a href="rethinking-chapter-15.html#cb1756-24" aria-hidden="true" tabindex="-1"></a><span class="st">      k = k + 1;</span></span>
<span id="cb1756-25"><a href="rethinking-chapter-15.html#cb1756-25" aria-hidden="true" tabindex="-1"></a><span class="st">    }//y5</span></span>
<span id="cb1756-26"><a href="rethinking-chapter-15.html#cb1756-26" aria-hidden="true" tabindex="-1"></a><span class="st">  }//y4</span></span>
<span id="cb1756-27"><a href="rethinking-chapter-15.html#cb1756-27" aria-hidden="true" tabindex="-1"></a><span class="st">  target += log_sum_exp(terms);</span></span>
<span id="cb1756-28"><a href="rethinking-chapter-15.html#cb1756-28" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1756-29"><a href="rethinking-chapter-15.html#cb1756-29" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb1756-30"><a href="rethinking-chapter-15.html#cb1756-30" aria-hidden="true" tabindex="-1"></a><span class="st">  matrix[y_max+1,y_max+1] P45; // prob y4,y5 takes joint values</span></span>
<span id="cb1756-31"><a href="rethinking-chapter-15.html#cb1756-31" aria-hidden="true" tabindex="-1"></a><span class="st">  // now compute Prob(y4,y5|p)</span></span>
<span id="cb1756-32"><a href="rethinking-chapter-15.html#cb1756-32" aria-hidden="true" tabindex="-1"></a><span class="st">  {</span></span>
<span id="cb1756-33"><a href="rethinking-chapter-15.html#cb1756-33" aria-hidden="true" tabindex="-1"></a><span class="st">    matrix[(1+y_max),(1+y_max)] terms;</span></span>
<span id="cb1756-34"><a href="rethinking-chapter-15.html#cb1756-34" aria-hidden="true" tabindex="-1"></a><span class="st">    int k = 1;</span></span>
<span id="cb1756-35"><a href="rethinking-chapter-15.html#cb1756-35" aria-hidden="true" tabindex="-1"></a><span class="st">    real Z;</span></span>
<span id="cb1756-36"><a href="rethinking-chapter-15.html#cb1756-36" aria-hidden="true" tabindex="-1"></a><span class="st">    for ( y4 in 0:y_max ) {</span></span>
<span id="cb1756-37"><a href="rethinking-chapter-15.html#cb1756-37" aria-hidden="true" tabindex="-1"></a><span class="st">      for ( y5 in 0:y_max ) {</span></span>
<span id="cb1756-38"><a href="rethinking-chapter-15.html#cb1756-38" aria-hidden="true" tabindex="-1"></a><span class="st">        int Y[N] = y;</span></span>
<span id="cb1756-39"><a href="rethinking-chapter-15.html#cb1756-39" aria-hidden="true" tabindex="-1"></a><span class="st">        Y[4] = y4;</span></span>
<span id="cb1756-40"><a href="rethinking-chapter-15.html#cb1756-40" aria-hidden="true" tabindex="-1"></a><span class="st">        Y[5] = y5;</span></span>
<span id="cb1756-41"><a href="rethinking-chapter-15.html#cb1756-41" aria-hidden="true" tabindex="-1"></a><span class="st">        terms[y4+1,y5+1] = poisson_lpmf(y4+y5|S_mean-120) + multinomial_lpmf(Y|p);</span></span>
<span id="cb1756-42"><a href="rethinking-chapter-15.html#cb1756-42" aria-hidden="true" tabindex="-1"></a><span class="st">      }//y5</span></span>
<span id="cb1756-43"><a href="rethinking-chapter-15.html#cb1756-43" aria-hidden="true" tabindex="-1"></a><span class="st">    }//y4</span></span>
<span id="cb1756-44"><a href="rethinking-chapter-15.html#cb1756-44" aria-hidden="true" tabindex="-1"></a><span class="st">    Z = log_sum_exp( to_vector(terms) );</span></span>
<span id="cb1756-45"><a href="rethinking-chapter-15.html#cb1756-45" aria-hidden="true" tabindex="-1"></a><span class="st">    for ( y4 in 0:y_max )</span></span>
<span id="cb1756-46"><a href="rethinking-chapter-15.html#cb1756-46" aria-hidden="true" tabindex="-1"></a><span class="st">      for ( y5 in 0:y_max )</span></span>
<span id="cb1756-47"><a href="rethinking-chapter-15.html#cb1756-47" aria-hidden="true" tabindex="-1"></a><span class="st">        P45[y4+1,y5+1] = exp( terms[y4+1,y5+1] - Z );</span></span>
<span id="cb1756-48"><a href="rethinking-chapter-15.html#cb1756-48" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb1756-49"><a href="rethinking-chapter-15.html#cb1756-49" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1756-50"><a href="rethinking-chapter-15.html#cb1756-50" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb1756-51"><a href="rethinking-chapter-15.html#cb1756-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1756-52"><a href="rethinking-chapter-15.html#cb1756-52" aria-hidden="true" tabindex="-1"></a>model_andrew2 <span class="ot">&lt;-</span> <span class="fu">stan</span>(</span>
<span id="cb1756-53"><a href="rethinking-chapter-15.html#cb1756-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_code =</span> code_andrew2,</span>
<span id="cb1756-54"><a href="rethinking-chapter-15.html#cb1756-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_andrew_list,</span>
<span id="cb1756-55"><a href="rethinking-chapter-15.html#cb1756-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1756-56"><a href="rethinking-chapter-15.html#cb1756-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span> )</span></code></pre></div>
<div class="sourceCode" id="cb1757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1757-1"><a href="rethinking-chapter-15.html#cb1757-1" aria-hidden="true" tabindex="-1"></a>andrew_posterior2 <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_andrew2) <span class="sc">%&gt;%</span> </span>
<span id="cb1757-2"><a href="rethinking-chapter-15.html#cb1757-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1757-3"><a href="rethinking-chapter-15.html#cb1757-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1757-4"><a href="rethinking-chapter-15.html#cb1757-4" aria-hidden="true" tabindex="-1"></a>andrew_k2 <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">y4 =</span> <span class="dv">0</span><span class="sc">:</span>y_max, <span class="at">y5 =</span> <span class="dv">0</span><span class="sc">:</span>y_max) <span class="sc">%&gt;%</span> </span>
<span id="cb1757-5"><a href="rethinking-chapter-15.html#cb1757-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmap_df</span>(extract_k, <span class="at">posterior =</span> andrew_posterior2)</span>
<span id="cb1757-6"><a href="rethinking-chapter-15.html#cb1757-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1757-7"><a href="rethinking-chapter-15.html#cb1757-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> andrew_k2 <span class="sc">%&gt;%</span> </span>
<span id="cb1757-8"><a href="rethinking-chapter-15.html#cb1757-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(x,<span class="dv">0</span>, <span class="dv">40</span>),</span>
<span id="cb1757-9"><a href="rethinking-chapter-15.html#cb1757-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">between</span>(y,<span class="dv">0</span>, <span class="dv">40</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1757-10"><a href="rethinking-chapter-15.html#cb1757-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x , y, <span class="at">color =</span> k)) <span class="sc">+</span></span>
<span id="cb1757-11"><a href="rethinking-chapter-15.html#cb1757-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1757-12"><a href="rethinking-chapter-15.html#cb1757-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb1757-13"><a href="rethinking-chapter-15.html#cb1757-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(color,.<span class="dv">8</span>)))) <span class="sc">+</span></span>
<span id="cb1757-14"><a href="rethinking-chapter-15.html#cb1757-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot; dirichlet( rep_vector(2, N) )&quot;</span>)</span>
<span id="cb1757-15"><a href="rethinking-chapter-15.html#cb1757-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1757-16"><a href="rethinking-chapter-15.html#cb1757-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">&amp;</span></span>
<span id="cb1757-17"><a href="rethinking-chapter-15.html#cb1757-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(clr0, clr_current),</span>
<span id="cb1757-18"><a href="rethinking-chapter-15.html#cb1757-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb1757-19"><a href="rethinking-chapter-15.html#cb1757-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;number of 4s&quot;</span>,</span>
<span id="cb1757-20"><a href="rethinking-chapter-15.html#cb1757-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;number of 5s&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb1757-21"><a href="rethinking-chapter-15.html#cb1757-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-91-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="brms-section-13" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> {brms} section<a href="rethinking-chapter-15.html#brms-section-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="measurement-error-1" class="section level3 hasAnchor" number="16.5.1">
<h3><span class="header-section-number">16.5.1</span> Measurement Error<a href="rethinking-chapter-15.html#measurement-error-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="error-on-the-outcome-1" class="section level4 hasAnchor" number="16.5.1.1">
<h4><span class="header-section-number">16.5.1.1</span> Error on the Outcome<a href="rethinking-chapter-15.html#error-on-the-outcome-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p><em>With <strong>brms</strong>, we accommodate measurement error in the criterion using the <code>mi()</code> syntax, following the general form <code>&lt;response&gt; | mi(&lt;se_response&gt;)</code>. This follows a missing data logic, resulting in Bayesian missing data imputation for the criterion values. The <code>mi()</code> syntax is based on the missing data capabilities for <strong>brms</strong>, which we will cover in greater detail in the second half of this chapter.</em></p>
</blockquote>
<div class="sourceCode" id="cb1758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1758-1"><a href="rethinking-chapter-15.html#cb1758-1" aria-hidden="true" tabindex="-1"></a>data_waffle_brms <span class="ot">&lt;-</span> data_waffle <span class="sc">%&gt;%</span> </span>
<span id="cb1758-2"><a href="rethinking-chapter-15.html#cb1758-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Loc, <span class="at">divorce_obs =</span> divorce_std,</span>
<span id="cb1758-3"><a href="rethinking-chapter-15.html#cb1758-3" aria-hidden="true" tabindex="-1"></a>                divorce_sd, marriage_std,</span>
<span id="cb1758-4"><a href="rethinking-chapter-15.html#cb1758-4" aria-hidden="true" tabindex="-1"></a>                median_age_std, marriage_sd)</span>
<span id="cb1758-5"><a href="rethinking-chapter-15.html#cb1758-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1758-6"><a href="rethinking-chapter-15.html#cb1758-6" aria-hidden="true" tabindex="-1"></a>brms_c15_model_divorce <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb1758-7"><a href="rethinking-chapter-15.html#cb1758-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_waffle_brms, </span>
<span id="cb1758-8"><a href="rethinking-chapter-15.html#cb1758-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb1758-9"><a href="rethinking-chapter-15.html#cb1758-9" aria-hidden="true" tabindex="-1"></a>  divorce_obs <span class="sc">|</span> <span class="fu">mi</span>(divorce_sd) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb1758-10"><a href="rethinking-chapter-15.html#cb1758-10" aria-hidden="true" tabindex="-1"></a>    median_age_std <span class="sc">+</span></span>
<span id="cb1758-11"><a href="rethinking-chapter-15.html#cb1758-11" aria-hidden="true" tabindex="-1"></a>    marriage_std,</span>
<span id="cb1758-12"><a href="rethinking-chapter-15.html#cb1758-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1758-13"><a href="rethinking-chapter-15.html#cb1758-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1758-14"><a href="rethinking-chapter-15.html#cb1758-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1758-15"><a href="rethinking-chapter-15.html#cb1758-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1758-16"><a href="rethinking-chapter-15.html#cb1758-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1758-17"><a href="rethinking-chapter-15.html#cb1758-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1758-18"><a href="rethinking-chapter-15.html#cb1758-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note this line</span></span>
<span id="cb1758-19"><a href="rethinking-chapter-15.html#cb1758-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">latent =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1758-20"><a href="rethinking-chapter-15.html#cb1758-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c15_model_divorce&quot;</span>)</span>
<span id="cb1758-21"><a href="rethinking-chapter-15.html#cb1758-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1758-22"><a href="rethinking-chapter-15.html#cb1758-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(brms_c15_model_divorce)</span></code></pre></div>
<pre><code>#&gt;  Family: gaussian 
#&gt;   Links: mu = identity; sigma = identity 
#&gt; Formula: divorce_obs | mi(divorce_sd) ~ 1 + median_age_std + marriage_std 
#&gt;    Data: data_waffle_brms (Number of observations: 50) 
#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
#&gt;          total post-warmup draws = 4000
#&gt; 
#&gt; Population-Level Effects: 
#&gt;                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
#&gt; Intercept         -0.06      0.09    -0.24     0.13 1.00     4477     3324
#&gt; median_age_std    -0.61      0.16    -0.92    -0.29 1.00     3686     3307
#&gt; marriage_std       0.06      0.16    -0.26     0.39 1.00     3389     3273
#&gt; 
#&gt; Family Specific Parameters: 
#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
#&gt; sigma     0.58      0.11     0.39     0.81 1.00     1278     1962
#&gt; 
#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential
#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb1760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1760-1"><a href="rethinking-chapter-15.html#cb1760-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(brms_c15_model_divorce) <span class="sc">%&gt;%</span> </span>
<span id="cb1760-2"><a href="rethinking-chapter-15.html#cb1760-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1760-3"><a href="rethinking-chapter-15.html#cb1760-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1760-4"><a href="rethinking-chapter-15.html#cb1760-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;param&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1760-5"><a href="rethinking-chapter-15.html#cb1760-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>#&gt; # A tibble: 55 × 5
#&gt;    param            Estimate Est.Error  Q2.5 Q97.5
#&gt;    &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 b_Intercept         -0.06      0.09 -0.24  0.13
#&gt;  2 b_median_age_std    -0.61      0.16 -0.92 -0.29
#&gt;  3 b_marriage_std       0.06      0.16 -0.26  0.39
#&gt;  4 sigma                0.58      0.11  0.39  0.81
#&gt;  5 Yl[1]                1.16      0.37  0.46  1.9 
#&gt;  6 Yl[2]                0.69      0.56 -0.41  1.78
#&gt;  7 Yl[3]                0.42      0.35 -0.25  1.13
#&gt;  8 Yl[4]                1.41      0.46  0.52  2.32
#&gt;  9 Yl[5]               -0.9       0.13 -1.16 -0.65
#&gt; 10 Yl[6]                0.66      0.41 -0.15  1.48
#&gt; # … with 45 more rows</code></pre>
<div class="sourceCode" id="cb1762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1762-1"><a href="rethinking-chapter-15.html#cb1762-1" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AL&quot;</span>, <span class="st">&quot;AR&quot;</span>, <span class="st">&quot;ME&quot;</span>, <span class="st">&quot;NH&quot;</span>, <span class="st">&quot;RI&quot;</span>, <span class="st">&quot;DC&quot;</span>, <span class="st">&quot;VT&quot;</span>,</span>
<span id="cb1762-2"><a href="rethinking-chapter-15.html#cb1762-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;AK&quot;</span>, <span class="st">&quot;SD&quot;</span>, <span class="st">&quot;UT&quot;</span>, <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;ND&quot;</span>, <span class="st">&quot;WY&quot;</span>)</span>
<span id="cb1762-3"><a href="rethinking-chapter-15.html#cb1762-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1762-4"><a href="rethinking-chapter-15.html#cb1762-4" aria-hidden="true" tabindex="-1"></a>divorce_est <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(brms_c15_model_divorce) <span class="sc">%&gt;%</span> </span>
<span id="cb1762-5"><a href="rethinking-chapter-15.html#cb1762-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1762-6"><a href="rethinking-chapter-15.html#cb1762-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1762-7"><a href="rethinking-chapter-15.html#cb1762-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1762-8"><a href="rethinking-chapter-15.html#cb1762-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">divorce_est =</span> Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb1762-9"><a href="rethinking-chapter-15.html#cb1762-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(term, divorce_est) <span class="sc">%&gt;%</span> </span>
<span id="cb1762-10"><a href="rethinking-chapter-15.html#cb1762-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Yl&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1762-11"><a href="rethinking-chapter-15.html#cb1762-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_waffle_brms)</span>
<span id="cb1762-12"><a href="rethinking-chapter-15.html#cb1762-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1762-13"><a href="rethinking-chapter-15.html#cb1762-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> divorce_est <span class="sc">%&gt;%</span></span>
<span id="cb1762-14"><a href="rethinking-chapter-15.html#cb1762-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> divorce_sd,</span>
<span id="cb1762-15"><a href="rethinking-chapter-15.html#cb1762-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> divorce_est <span class="sc">-</span> divorce_obs)) <span class="sc">+</span></span>
<span id="cb1762-16"><a href="rethinking-chapter-15.html#cb1762-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">3</span>,</span>
<span id="cb1762-17"><a href="rethinking-chapter-15.html#cb1762-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb1762-18"><a href="rethinking-chapter-15.html#cb1762-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb1762-19"><a href="rethinking-chapter-15.html#cb1762-19" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb1762-20"><a href="rethinking-chapter-15.html#cb1762-20" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">filter</span>(Loc <span class="sc">%in%</span> states),  </span>
<span id="cb1762-21"><a href="rethinking-chapter-15.html#cb1762-21" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">aes</span>(<span class="at">label =</span> Loc), </span>
<span id="cb1762-22"><a href="rethinking-chapter-15.html#cb1762-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1762-23"><a href="rethinking-chapter-15.html#cb1762-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family =</span> fnt_sel)</span>
<span id="cb1762-24"><a href="rethinking-chapter-15.html#cb1762-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1762-25"><a href="rethinking-chapter-15.html#cb1762-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1762-26"><a href="rethinking-chapter-15.html#cb1762-26" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AR&quot;</span>, <span class="st">&quot;ME&quot;</span>, <span class="st">&quot;RI&quot;</span>, <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;WY&quot;</span>, <span class="st">&quot;ND&quot;</span>, <span class="st">&quot;MN&quot;</span>)</span>
<span id="cb1762-27"><a href="rethinking-chapter-15.html#cb1762-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1762-28"><a href="rethinking-chapter-15.html#cb1762-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1762-29"><a href="rethinking-chapter-15.html#cb1762-29" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(brms_c15_model_divorce) <span class="sc">%&gt;%</span></span>
<span id="cb1762-30"><a href="rethinking-chapter-15.html#cb1762-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1762-31"><a href="rethinking-chapter-15.html#cb1762-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(b_Intercept, b_median_age_std),</span>
<span id="cb1762-32"><a href="rethinking-chapter-15.html#cb1762-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">median_age_std =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">to =</span> <span class="fl">3.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1762-33"><a href="rethinking-chapter-15.html#cb1762-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> b_Intercept <span class="sc">+</span></span>
<span id="cb1762-34"><a href="rethinking-chapter-15.html#cb1762-34" aria-hidden="true" tabindex="-1"></a>           b_median_age_std <span class="sc">*</span> median_age_std) <span class="sc">%&gt;%</span> </span>
<span id="cb1762-35"><a href="rethinking-chapter-15.html#cb1762-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1762-36"><a href="rethinking-chapter-15.html#cb1762-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> median_age_std)) <span class="sc">+</span></span>
<span id="cb1762-37"><a href="rethinking-chapter-15.html#cb1762-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1762-38"><a href="rethinking-chapter-15.html#cb1762-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">.width =</span> .<span class="dv">89</span>, <span class="at">size =</span> .<span class="dv">2</span>,</span>
<span id="cb1762-39"><a href="rethinking-chapter-15.html#cb1762-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr0dd, <span class="at">fill =</span> fll0) <span class="sc">+</span></span>
<span id="cb1762-40"><a href="rethinking-chapter-15.html#cb1762-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> divorce_est,</span>
<span id="cb1762-41"><a href="rethinking-chapter-15.html#cb1762-41" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xend =</span> median_age_std,</span>
<span id="cb1762-42"><a href="rethinking-chapter-15.html#cb1762-42" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> divorce_obs, <span class="at">yend =</span> divorce_est),</span>
<span id="cb1762-43"><a href="rethinking-chapter-15.html#cb1762-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1762-44"><a href="rethinking-chapter-15.html#cb1762-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> divorce_est,</span>
<span id="cb1762-45"><a href="rethinking-chapter-15.html#cb1762-45" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> divorce_obs),</span>
<span id="cb1762-46"><a href="rethinking-chapter-15.html#cb1762-46" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0dd,</span>
<span id="cb1762-47"><a href="rethinking-chapter-15.html#cb1762-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">19</span>) <span class="sc">+</span></span>
<span id="cb1762-48"><a href="rethinking-chapter-15.html#cb1762-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> divorce_est,</span>
<span id="cb1762-49"><a href="rethinking-chapter-15.html#cb1762-49" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> divorce_est),</span>
<span id="cb1762-50"><a href="rethinking-chapter-15.html#cb1762-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1762-51"><a href="rethinking-chapter-15.html#cb1762-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb1762-52"><a href="rethinking-chapter-15.html#cb1762-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0dd, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb1762-53"><a href="rethinking-chapter-15.html#cb1762-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1762-54"><a href="rethinking-chapter-15.html#cb1762-54" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> data_waffle_brms <span class="sc">%&gt;%</span></span>
<span id="cb1762-55"><a href="rethinking-chapter-15.html#cb1762-55" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">filter</span>(Loc <span class="sc">%in%</span> states),  </span>
<span id="cb1762-56"><a href="rethinking-chapter-15.html#cb1762-56" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">y =</span> divorce_obs, <span class="at">label =</span> Loc), </span>
<span id="cb1762-57"><a href="rethinking-chapter-15.html#cb1762-57" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">15</span>, <span class="at">family =</span> fnt_sel) <span class="sc">+</span></span>
<span id="cb1762-58"><a href="rethinking-chapter-15.html#cb1762-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;median age marriage (std)&quot;</span>,</span>
<span id="cb1762-59"><a href="rethinking-chapter-15.html#cb1762-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;divorce rate (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1762-60"><a href="rethinking-chapter-15.html#cb1762-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(data_waffle_brms<span class="sc">$</span>median_age_std), </span>
<span id="cb1762-61"><a href="rethinking-chapter-15.html#cb1762-61" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(data_waffle_brms<span class="sc">$</span>divorce_obs))</span>
<span id="cb1762-62"><a href="rethinking-chapter-15.html#cb1762-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1762-63"><a href="rethinking-chapter-15.html#cb1762-63" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-93-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="error-on-both-outcome-and-predictor-1" class="section level4 hasAnchor" number="16.5.1.2">
<h4><span class="header-section-number">16.5.1.2</span> Error on Both Outcome and Predictor<a href="rethinking-chapter-15.html#error-on-both-outcome-and-predictor-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1763-1"><a href="rethinking-chapter-15.html#cb1763-1" aria-hidden="true" tabindex="-1"></a>brms_c15_model_divorce_error_out <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb1763-2"><a href="rethinking-chapter-15.html#cb1763-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_waffle_brms, </span>
<span id="cb1763-3"><a href="rethinking-chapter-15.html#cb1763-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb1763-4"><a href="rethinking-chapter-15.html#cb1763-4" aria-hidden="true" tabindex="-1"></a>  divorce_obs <span class="sc">|</span> <span class="fu">mi</span>(divorce_sd) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb1763-5"><a href="rethinking-chapter-15.html#cb1763-5" aria-hidden="true" tabindex="-1"></a>    median_age_std <span class="sc">+</span></span>
<span id="cb1763-6"><a href="rethinking-chapter-15.html#cb1763-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">me</span>(marriage_std, marriage_sd),</span>
<span id="cb1763-7"><a href="rethinking-chapter-15.html#cb1763-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1763-8"><a href="rethinking-chapter-15.html#cb1763-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1763-9"><a href="rethinking-chapter-15.html#cb1763-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> meanme),</span>
<span id="cb1763-10"><a href="rethinking-chapter-15.html#cb1763-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1763-11"><a href="rethinking-chapter-15.html#cb1763-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1763-12"><a href="rethinking-chapter-15.html#cb1763-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1763-13"><a href="rethinking-chapter-15.html#cb1763-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1763-14"><a href="rethinking-chapter-15.html#cb1763-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note this line</span></span>
<span id="cb1763-15"><a href="rethinking-chapter-15.html#cb1763-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">latent =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1763-16"><a href="rethinking-chapter-15.html#cb1763-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c15_model_divorce_error_out&quot;</span>)</span>
<span id="cb1763-17"><a href="rethinking-chapter-15.html#cb1763-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1763-18"><a href="rethinking-chapter-15.html#cb1763-18" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(brms_c15_model_divorce_error_out) <span class="sc">%&gt;%</span></span>
<span id="cb1763-19"><a href="rethinking-chapter-15.html#cb1763-19" aria-hidden="true" tabindex="-1"></a> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1763-20"><a href="rethinking-chapter-15.html#cb1763-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1763-21"><a href="rethinking-chapter-15.html#cb1763-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;param&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1763-22"><a href="rethinking-chapter-15.html#cb1763-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>#&gt; # A tibble: 107 × 5
#&gt;    param                         Estimate Est.Error  Q2.5 Q97.5
#&gt;    &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 b_Intercept                      -0.03      0.1  -0.22  0.16
#&gt;  2 b_median_age_std                 -0.52      0.16 -0.82 -0.21
#&gt;  3 bsp_memarriage_stdmarriage_sd     0.26      0.22 -0.17  0.69
#&gt;  4 sigma                             0.55      0.11  0.35  0.79
#&gt;  5 Yl[1]                             1.13      0.38  0.39  1.86
#&gt;  6 Yl[2]                             0.72      0.54 -0.29  1.81
#&gt;  7 Yl[3]                             0.43      0.33 -0.21  1.1 
#&gt;  8 Yl[4]                             1.45      0.47  0.54  2.4 
#&gt;  9 Yl[5]                            -0.9       0.13 -1.15 -0.65
#&gt; 10 Yl[6]                             0.71      0.4  -0.05  1.53
#&gt; # … with 97 more rows</code></pre>
<div class="sourceCode" id="cb1765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1765-1"><a href="rethinking-chapter-15.html#cb1765-1" aria-hidden="true" tabindex="-1"></a>pull_estimate <span class="ot">&lt;-</span> <span class="cf">function</span>(model, term_q){</span>
<span id="cb1765-2"><a href="rethinking-chapter-15.html#cb1765-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_summary</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb1765-3"><a href="rethinking-chapter-15.html#cb1765-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1765-4"><a href="rethinking-chapter-15.html#cb1765-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1765-5"><a href="rethinking-chapter-15.html#cb1765-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, term_q)) <span class="sc">%&gt;%</span> </span>
<span id="cb1765-6"><a href="rethinking-chapter-15.html#cb1765-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">pull</span>(Estimate)</span>
<span id="cb1765-7"><a href="rethinking-chapter-15.html#cb1765-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1765-8"><a href="rethinking-chapter-15.html#cb1765-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1765-9"><a href="rethinking-chapter-15.html#cb1765-9" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(</span>
<span id="cb1765-10"><a href="rethinking-chapter-15.html#cb1765-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># D</span></span>
<span id="cb1765-11"><a href="rethinking-chapter-15.html#cb1765-11" aria-hidden="true" tabindex="-1"></a>  data_waffle_brms <span class="sc">%&gt;%</span></span>
<span id="cb1765-12"><a href="rethinking-chapter-15.html#cb1765-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Loc, divorce_obs) <span class="sc">%&gt;%</span> </span>
<span id="cb1765-13"><a href="rethinking-chapter-15.html#cb1765-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">marriage_est =</span> <span class="fu">pull_estimate</span>(brms_c15_model_divorce_error_out,</span>
<span id="cb1765-14"><a href="rethinking-chapter-15.html#cb1765-14" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;Yl&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1765-15"><a href="rethinking-chapter-15.html#cb1765-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>Loc, <span class="at">values_to =</span> <span class="st">&quot;divorce&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1765-16"><a href="rethinking-chapter-15.html#cb1765-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;divorce_obs&quot;</span>,</span>
<span id="cb1765-17"><a href="rethinking-chapter-15.html#cb1765-17" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;observed&quot;</span>, <span class="st">&quot;posterior&quot;</span>)),</span>
<span id="cb1765-18"><a href="rethinking-chapter-15.html#cb1765-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M</span></span>
<span id="cb1765-19"><a href="rethinking-chapter-15.html#cb1765-19" aria-hidden="true" tabindex="-1"></a>    data_waffle_brms <span class="sc">%&gt;%</span></span>
<span id="cb1765-20"><a href="rethinking-chapter-15.html#cb1765-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Loc, marriage_std) <span class="sc">%&gt;%</span> </span>
<span id="cb1765-21"><a href="rethinking-chapter-15.html#cb1765-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">marriage_est =</span> <span class="fu">pull_estimate</span>(brms_c15_model_divorce_error_out,</span>
<span id="cb1765-22"><a href="rethinking-chapter-15.html#cb1765-22" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;Xme_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1765-23"><a href="rethinking-chapter-15.html#cb1765-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>Loc, <span class="at">values_to =</span> <span class="st">&quot;marriage&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1765-24"><a href="rethinking-chapter-15.html#cb1765-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;marriage_std&quot;</span>,</span>
<span id="cb1765-25"><a href="rethinking-chapter-15.html#cb1765-25" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;observed&quot;</span>, <span class="st">&quot;posterior&quot;</span>)),</span>
<span id="cb1765-26"><a href="rethinking-chapter-15.html#cb1765-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Loc&quot;</span>, <span class="st">&quot;name&quot;</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb1765-27"><a href="rethinking-chapter-15.html#cb1765-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marriage, <span class="at">y =</span> divorce)) <span class="sc">+</span></span>
<span id="cb1765-28"><a href="rethinking-chapter-15.html#cb1765-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Loc),</span>
<span id="cb1765-29"><a href="rethinking-chapter-15.html#cb1765-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> .<span class="dv">2</span>, <span class="at">color =</span> clr0dd) <span class="sc">+</span></span>
<span id="cb1765-30"><a href="rethinking-chapter-15.html#cb1765-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> name),</span>
<span id="cb1765-31"><a href="rethinking-chapter-15.html#cb1765-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> clr0dd,  <span class="at">fill =</span> clr0) <span class="sc">+</span></span>
<span id="cb1765-32"><a href="rethinking-chapter-15.html#cb1765-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">observed =</span> <span class="dv">21</span>, <span class="at">posterior =</span> <span class="dv">19</span>), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb1765-33"><a href="rethinking-chapter-15.html#cb1765-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Shrinkage of both divorce rate and marriage rate&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-95-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="measurement-terrors-1" class="section level4 hasAnchor" number="16.5.1.3">
<h4><span class="header-section-number">16.5.1.3</span> Measurement Terrors<a href="rethinking-chapter-15.html#measurement-terrors-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1766-1"><a href="rethinking-chapter-15.html#cb1766-1" aria-hidden="true" tabindex="-1"></a>data_sim</span></code></pre></div>
<pre><code>#&gt; # A tibble: 500 × 4
#&gt;        age marriage divorce  age_obs
#&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
#&gt;  1 -0.172     1.14   0.536  -0.231  
#&gt;  2 -0.564    -1.09  -0.477  -1.24   
#&gt;  3  0.252    -0.922 -0.326  -0.746  
#&gt;  4  0.0798   -1.20  -0.696  -0.113  
#&gt;  5  0.818    -2.20   1.99    0.160  
#&gt;  6 -0.164     1.05   0.143   0.698  
#&gt;  7  0.797     0.413  1.37   -1.88   
#&gt;  8  0.435    -2.03  -1.03    1.51   
#&gt;  9 -0.254    -0.484 -0.240  -0.00495
#&gt; 10 -0.0502   -0.287 -0.0359 -0.800  
#&gt; # … with 490 more rows</code></pre>
<blockquote>
<p><em>To get a sense of the havoc ignoring measurement error can cause, we’ll fit to models. These aren’t in the text, but, you know, let’s live a little. The first model will include <code>age</code>, the true predictor for <code>divorce</code>. The second model will include <code>age_obs</code> instead, the version of <code>age</code> with measurement error added in.</em></p>
</blockquote>
<div class="sourceCode" id="cb1768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1768-1"><a href="rethinking-chapter-15.html#cb1768-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the model with age containing no measurement error</span></span>
<span id="cb1768-2"><a href="rethinking-chapter-15.html#cb1768-2" aria-hidden="true" tabindex="-1"></a>brms_c15_model_sim_a <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb1768-3"><a href="rethinking-chapter-15.html#cb1768-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_sim, </span>
<span id="cb1768-4"><a href="rethinking-chapter-15.html#cb1768-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb1768-5"><a href="rethinking-chapter-15.html#cb1768-5" aria-hidden="true" tabindex="-1"></a>  divorce <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> marriage,</span>
<span id="cb1768-6"><a href="rethinking-chapter-15.html#cb1768-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1768-7"><a href="rethinking-chapter-15.html#cb1768-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1768-8"><a href="rethinking-chapter-15.html#cb1768-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1768-9"><a href="rethinking-chapter-15.html#cb1768-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1768-10"><a href="rethinking-chapter-15.html#cb1768-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1768-11"><a href="rethinking-chapter-15.html#cb1768-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1768-12"><a href="rethinking-chapter-15.html#cb1768-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note this line</span></span>
<span id="cb1768-13"><a href="rethinking-chapter-15.html#cb1768-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">latent =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1768-14"><a href="rethinking-chapter-15.html#cb1768-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c15_model_sim_a&quot;</span>)</span>
<span id="cb1768-15"><a href="rethinking-chapter-15.html#cb1768-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1768-16"><a href="rethinking-chapter-15.html#cb1768-16" aria-hidden="true" tabindex="-1"></a><span class="co"># The model where age has measurement error, but we ignore it</span></span>
<span id="cb1768-17"><a href="rethinking-chapter-15.html#cb1768-17" aria-hidden="true" tabindex="-1"></a>brms_c15_model_sim_b <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb1768-18"><a href="rethinking-chapter-15.html#cb1768-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_sim, </span>
<span id="cb1768-19"><a href="rethinking-chapter-15.html#cb1768-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb1768-20"><a href="rethinking-chapter-15.html#cb1768-20" aria-hidden="true" tabindex="-1"></a>  divorce <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age_obs <span class="sc">+</span> marriage,</span>
<span id="cb1768-21"><a href="rethinking-chapter-15.html#cb1768-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1768-22"><a href="rethinking-chapter-15.html#cb1768-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1768-23"><a href="rethinking-chapter-15.html#cb1768-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1768-24"><a href="rethinking-chapter-15.html#cb1768-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1768-25"><a href="rethinking-chapter-15.html#cb1768-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1768-26"><a href="rethinking-chapter-15.html#cb1768-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1768-27"><a href="rethinking-chapter-15.html#cb1768-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note this line</span></span>
<span id="cb1768-28"><a href="rethinking-chapter-15.html#cb1768-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">latent =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1768-29"><a href="rethinking-chapter-15.html#cb1768-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c15_model_sim_b&quot;</span>)</span>
<span id="cb1768-30"><a href="rethinking-chapter-15.html#cb1768-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1768-31"><a href="rethinking-chapter-15.html#cb1768-31" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">posterior_summary</span>(brms_c15_model_sim_a) <span class="sc">%&gt;%</span></span>
<span id="cb1768-32"><a href="rethinking-chapter-15.html#cb1768-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1768-33"><a href="rethinking-chapter-15.html#cb1768-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1768-34"><a href="rethinking-chapter-15.html#cb1768-34" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;model_a&quot;</span>),</span>
<span id="cb1768-35"><a href="rethinking-chapter-15.html#cb1768-35" aria-hidden="true" tabindex="-1"></a>          <span class="fu">posterior_summary</span>(brms_c15_model_sim_b) <span class="sc">%&gt;%</span></span>
<span id="cb1768-36"><a href="rethinking-chapter-15.html#cb1768-36" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1768-37"><a href="rethinking-chapter-15.html#cb1768-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1768-38"><a href="rethinking-chapter-15.html#cb1768-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;model_b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1768-39"><a href="rethinking-chapter-15.html#cb1768-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;lp__&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1768-40"><a href="rethinking-chapter-15.html#cb1768-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">str_remove</span>(term,<span class="st">&quot;_obs&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1768-41"><a href="rethinking-chapter-15.html#cb1768-41" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_remove</span>(<span class="st">&quot;b_&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1768-42"><a href="rethinking-chapter-15.html#cb1768-42" aria-hidden="true" tabindex="-1"></a>           <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>,</span>
<span id="cb1768-43"><a href="rethinking-chapter-15.html#cb1768-43" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;age&quot;</span>,</span>
<span id="cb1768-44"><a href="rethinking-chapter-15.html#cb1768-44" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;marriage&quot;</span>,</span>
<span id="cb1768-45"><a href="rethinking-chapter-15.html#cb1768-45" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;sigma&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1768-46"><a href="rethinking-chapter-15.html#cb1768-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb1768-47"><a href="rethinking-chapter-15.html#cb1768-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">3</span>,</span>
<span id="cb1768-48"><a href="rethinking-chapter-15.html#cb1768-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb1768-49"><a href="rethinking-chapter-15.html#cb1768-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>,</span>
<span id="cb1768-50"><a href="rethinking-chapter-15.html#cb1768-50" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb1768-51"><a href="rethinking-chapter-15.html#cb1768-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">model_a =</span> clr0dd,</span>
<span id="cb1768-52"><a href="rethinking-chapter-15.html#cb1768-52" aria-hidden="true" tabindex="-1"></a>                                <span class="at">model_b =</span> clr0d),</span>
<span id="cb1768-53"><a href="rethinking-chapter-15.html#cb1768-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb1768-54"><a href="rethinking-chapter-15.html#cb1768-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;marginal posterior&quot;</span>,</span>
<span id="cb1768-55"><a href="rethinking-chapter-15.html#cb1768-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1768-56"><a href="rethinking-chapter-15.html#cb1768-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> term, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1768-57"><a href="rethinking-chapter-15.html#cb1768-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb1768-58"><a href="rethinking-chapter-15.html#cb1768-58" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> clr0d))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-97-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="missing-data-1" class="section level3 hasAnchor" number="16.5.2">
<h3><span class="header-section-number">16.5.2</span> Missing Data<a href="rethinking-chapter-15.html#missing-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="dag-ate-my-homework-1" class="section level4 hasAnchor" number="16.5.2.1">
<h4><span class="header-section-number">16.5.2.1</span> DAG Ate my Homework<a href="rethinking-chapter-15.html#dag-ate-my-homework-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1769-1"><a href="rethinking-chapter-15.html#cb1769-1" aria-hidden="true" tabindex="-1"></a>data_homework_c_brms <span class="ot">&lt;-</span> data_homework_c <span class="sc">%&gt;%</span> </span>
<span id="cb1769-2"><a href="rethinking-chapter-15.html#cb1769-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb1769-3"><a href="rethinking-chapter-15.html#cb1769-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1769-4"><a href="rethinking-chapter-15.html#cb1769-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> data_homework_c_brms <span class="sc">%&gt;%</span> </span>
<span id="cb1769-5"><a href="rethinking-chapter-15.html#cb1769-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> study, <span class="at">y =</span> homework)) <span class="sc">+</span></span>
<span id="cb1769-6"><a href="rethinking-chapter-15.html#cb1769-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> fll0dd) <span class="sc">+</span></span>
<span id="cb1769-7"><a href="rethinking-chapter-15.html#cb1769-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1769-8"><a href="rethinking-chapter-15.html#cb1769-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;true distribution&quot;</span>)</span>
<span id="cb1769-9"><a href="rethinking-chapter-15.html#cb1769-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1769-10"><a href="rethinking-chapter-15.html#cb1769-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data_homework_c_brms <span class="sc">%&gt;%</span> </span>
<span id="cb1769-11"><a href="rethinking-chapter-15.html#cb1769-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> study, <span class="at">y =</span> homework_missing)) <span class="sc">+</span></span>
<span id="cb1769-12"><a href="rethinking-chapter-15.html#cb1769-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> fll0dd) <span class="sc">+</span></span>
<span id="cb1769-13"><a href="rethinking-chapter-15.html#cb1769-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1769-14"><a href="rethinking-chapter-15.html#cb1769-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;missing conditional on x&quot;</span>)</span>
<span id="cb1769-15"><a href="rethinking-chapter-15.html#cb1769-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1769-16"><a href="rethinking-chapter-15.html#cb1769-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-98-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1770-1"><a href="rethinking-chapter-15.html#cb1770-1" aria-hidden="true" tabindex="-1"></a>brms_c15_model_hw_full <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb1770-2"><a href="rethinking-chapter-15.html#cb1770-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_homework_c_brms,</span>
<span id="cb1770-3"><a href="rethinking-chapter-15.html#cb1770-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb1770-4"><a href="rethinking-chapter-15.html#cb1770-4" aria-hidden="true" tabindex="-1"></a>  homework <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">10</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> study,</span>
<span id="cb1770-5"><a href="rethinking-chapter-15.html#cb1770-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1770-6"><a href="rethinking-chapter-15.html#cb1770-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b)),</span>
<span id="cb1770-7"><a href="rethinking-chapter-15.html#cb1770-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, </span>
<span id="cb1770-8"><a href="rethinking-chapter-15.html#cb1770-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1770-9"><a href="rethinking-chapter-15.html#cb1770-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1770-10"><a href="rethinking-chapter-15.html#cb1770-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c15_model_hw_full&quot;</span>)</span>
<span id="cb1770-11"><a href="rethinking-chapter-15.html#cb1770-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1770-12"><a href="rethinking-chapter-15.html#cb1770-12" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">extract_fixef</span>(brms_c15_model_hw_full)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   term      value    se lower_2.5 upper_97.5
#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
#&gt; 1 Intercept 1.25  0.025     1.20       1.30 
#&gt; 2 study     0.609 0.026     0.558      0.661</code></pre>
<div class="sourceCode" id="cb1772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1772-1"><a href="rethinking-chapter-15.html#cb1772-1" aria-hidden="true" tabindex="-1"></a>brms_c15_model_hw_missing <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb1772-2"><a href="rethinking-chapter-15.html#cb1772-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_homework_c_brms <span class="sc">%&gt;%</span></span>
<span id="cb1772-3"><a href="rethinking-chapter-15.html#cb1772-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dog <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1772-4"><a href="rethinking-chapter-15.html#cb1772-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb1772-5"><a href="rethinking-chapter-15.html#cb1772-5" aria-hidden="true" tabindex="-1"></a>  homework <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">10</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> study,</span>
<span id="cb1772-6"><a href="rethinking-chapter-15.html#cb1772-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1772-7"><a href="rethinking-chapter-15.html#cb1772-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b)),</span>
<span id="cb1772-8"><a href="rethinking-chapter-15.html#cb1772-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, </span>
<span id="cb1772-9"><a href="rethinking-chapter-15.html#cb1772-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1772-10"><a href="rethinking-chapter-15.html#cb1772-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1772-11"><a href="rethinking-chapter-15.html#cb1772-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c15_model_hw_missing&quot;</span>)</span>
<span id="cb1772-12"><a href="rethinking-chapter-15.html#cb1772-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1772-13"><a href="rethinking-chapter-15.html#cb1772-13" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">extract_fixef</span>(brms_c15_model_hw_missing)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   term      value    se lower_2.5 upper_97.5
#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
#&gt; 1 Intercept 3.06  0.076     2.92        3.21
#&gt; 2 study     0.895 0.063     0.775       1.02</code></pre>
<div class="sourceCode" id="cb1774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1774-1"><a href="rethinking-chapter-15.html#cb1774-1" aria-hidden="true" tabindex="-1"></a>data_homework_c_brms2 <span class="ot">&lt;-</span> data_homework_c_brms <span class="sc">%&gt;%</span> </span>
<span id="cb1774-2"><a href="rethinking-chapter-15.html#cb1774-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dog =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(x) <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1774-3"><a href="rethinking-chapter-15.html#cb1774-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homework_missing =</span> <span class="fu">ifelse</span>(dog <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA_integer_</span>, homework))</span>
<span id="cb1774-4"><a href="rethinking-chapter-15.html#cb1774-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1774-5"><a href="rethinking-chapter-15.html#cb1774-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> data_homework_c_brms2 <span class="sc">%&gt;%</span> </span>
<span id="cb1774-6"><a href="rethinking-chapter-15.html#cb1774-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> study, <span class="at">y =</span> homework)) <span class="sc">+</span></span>
<span id="cb1774-7"><a href="rethinking-chapter-15.html#cb1774-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> fll0dd) <span class="sc">+</span></span>
<span id="cb1774-8"><a href="rethinking-chapter-15.html#cb1774-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1774-9"><a href="rethinking-chapter-15.html#cb1774-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;true distribution&quot;</span>)</span>
<span id="cb1774-10"><a href="rethinking-chapter-15.html#cb1774-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1774-11"><a href="rethinking-chapter-15.html#cb1774-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data_homework_c_brms2 <span class="sc">%&gt;%</span> </span>
<span id="cb1774-12"><a href="rethinking-chapter-15.html#cb1774-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> study, <span class="at">y =</span> homework_missing)) <span class="sc">+</span></span>
<span id="cb1774-13"><a href="rethinking-chapter-15.html#cb1774-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> fll0dd) <span class="sc">+</span></span>
<span id="cb1774-14"><a href="rethinking-chapter-15.html#cb1774-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1774-15"><a href="rethinking-chapter-15.html#cb1774-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;missing conditional on x&quot;</span>)</span>
<span id="cb1774-16"><a href="rethinking-chapter-15.html#cb1774-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1774-17"><a href="rethinking-chapter-15.html#cb1774-17" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-100-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1775-1"><a href="rethinking-chapter-15.html#cb1775-1" aria-hidden="true" tabindex="-1"></a>brms_c15_model_hw_missing2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb1775-2"><a href="rethinking-chapter-15.html#cb1775-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_homework_c_brms2 <span class="sc">%&gt;%</span></span>
<span id="cb1775-3"><a href="rethinking-chapter-15.html#cb1775-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dog <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1775-4"><a href="rethinking-chapter-15.html#cb1775-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb1775-5"><a href="rethinking-chapter-15.html#cb1775-5" aria-hidden="true" tabindex="-1"></a>  homework <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">10</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> study,</span>
<span id="cb1775-6"><a href="rethinking-chapter-15.html#cb1775-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1775-7"><a href="rethinking-chapter-15.html#cb1775-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b)),</span>
<span id="cb1775-8"><a href="rethinking-chapter-15.html#cb1775-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, </span>
<span id="cb1775-9"><a href="rethinking-chapter-15.html#cb1775-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1775-10"><a href="rethinking-chapter-15.html#cb1775-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1775-11"><a href="rethinking-chapter-15.html#cb1775-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c15_model_hw_missing2&quot;</span>)</span>
<span id="cb1775-12"><a href="rethinking-chapter-15.html#cb1775-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1775-13"><a href="rethinking-chapter-15.html#cb1775-13" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">extract_fixef</span>(brms_c15_model_hw_missing2)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   term      value    se lower_2.5 upper_97.5
#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
#&gt; 1 Intercept 0.731 0.038     0.655      0.807
#&gt; 2 study     0.354 0.039     0.28       0.431</code></pre>
</div>
<div id="imputing-primates-1" class="section level4 hasAnchor" number="16.5.2.2">
<h4><span class="header-section-number">16.5.2.2</span> Imputing primates<a href="rethinking-chapter-15.html#imputing-primates-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1777-1"><a href="rethinking-chapter-15.html#cb1777-1" aria-hidden="true" tabindex="-1"></a>data_milk_brms <span class="ot">&lt;-</span> data_milk_full <span class="sc">%&gt;%</span> </span>
<span id="cb1777-2"><a href="rethinking-chapter-15.html#cb1777-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, kcal_std,</span>
<span id="cb1777-3"><a href="rethinking-chapter-15.html#cb1777-3" aria-hidden="true" tabindex="-1"></a>                neocortex_std, mass_std)</span></code></pre></div>
<blockquote>
<p><em>When writing a multivariate model in <strong>brms</strong>, I find it easier to save the model code by itself and then insert it into the <code>brm()</code> function. Otherwise, things start to feel cluttered.</em></p>
</blockquote>
<div class="sourceCode" id="cb1778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1778-1"><a href="rethinking-chapter-15.html#cb1778-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here&#39;s the primary `k` model</span></span>
<span id="cb1778-2"><a href="rethinking-chapter-15.html#cb1778-2" aria-hidden="true" tabindex="-1"></a>b_model <span class="ot">&lt;-</span> <span class="fu">bf</span>(kcal_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb1778-3"><a href="rethinking-chapter-15.html#cb1778-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mi</span>(neocortex_std) <span class="sc">+</span></span>
<span id="cb1778-4"><a href="rethinking-chapter-15.html#cb1778-4" aria-hidden="true" tabindex="-1"></a>                mass_std) <span class="sc">+</span> </span>
<span id="cb1778-5"><a href="rethinking-chapter-15.html#cb1778-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here&#39;s the model for the missing `b` data </span></span>
<span id="cb1778-6"><a href="rethinking-chapter-15.html#cb1778-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(neocortex_std <span class="sc">|</span> <span class="fu">mi</span>() <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb1778-7"><a href="rethinking-chapter-15.html#cb1778-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we set the residual correlations for the two models to zero</span></span>
<span id="cb1778-8"><a href="rethinking-chapter-15.html#cb1778-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>)</span></code></pre></div>
<blockquote>
<p><em>Note the<code>mi(neocortex_std)</code> syntax in the <code>kcal_std</code> model. This indicates that the predictor, <code>neocortex_std</code>, has missing values that are themselves being modeled. To get a sense of how to specify the priors for such a model in <strong>brms</strong>, use the <code>get_prior()</code> function.</em></p>
</blockquote>
<div class="sourceCode" id="cb1779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1779-1"><a href="rethinking-chapter-15.html#cb1779-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(<span class="at">data =</span> data_milk_brms, </span>
<span id="cb1779-2"><a href="rethinking-chapter-15.html#cb1779-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> gaussian,</span>
<span id="cb1779-3"><a href="rethinking-chapter-15.html#cb1779-3" aria-hidden="true" tabindex="-1"></a>          b_model)</span></code></pre></div>
<pre><code>#&gt;                    prior     class            coef group         resp dpar
#&gt;                   (flat)         b                                        
#&gt;                   (flat) Intercept                                        
#&gt;                   (flat)         b                            kcalstd     
#&gt;                   (flat)         b        mass_std            kcalstd     
#&gt;                   (flat)         b mineocortex_std            kcalstd     
#&gt;  student_t(3, -0.3, 2.5) Intercept                            kcalstd     
#&gt;     student_t(3, 0, 2.5)     sigma                            kcalstd     
#&gt;   student_t(3, 0.2, 2.5) Intercept                       neocortexstd     
#&gt;     student_t(3, 0, 2.5)     sigma                       neocortexstd     
#&gt;  nlpar bound       source
#&gt;                   default
#&gt;                   default
#&gt;              (vectorized)
#&gt;              (vectorized)
#&gt;              (vectorized)
#&gt;                   default
#&gt;                   default
#&gt;                   default
#&gt;                   default</code></pre>
<div class="sourceCode" id="cb1781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1781-1"><a href="rethinking-chapter-15.html#cb1781-1" aria-hidden="true" tabindex="-1"></a>brms_c15_model_primates_imputed <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb1781-2"><a href="rethinking-chapter-15.html#cb1781-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_milk_brms, </span>
<span id="cb1781-3"><a href="rethinking-chapter-15.html#cb1781-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb1781-4"><a href="rethinking-chapter-15.html#cb1781-4" aria-hidden="true" tabindex="-1"></a>  b_model,  <span class="co"># here we insert the model</span></span>
<span id="cb1781-5"><a href="rethinking-chapter-15.html#cb1781-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> kcalstd),</span>
<span id="cb1781-6"><a href="rethinking-chapter-15.html#cb1781-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> neocortexstd),</span>
<span id="cb1781-7"><a href="rethinking-chapter-15.html#cb1781-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b,         <span class="at">resp =</span> kcalstd),</span>
<span id="cb1781-8"><a href="rethinking-chapter-15.html#cb1781-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> kcalstd),</span>
<span id="cb1781-9"><a href="rethinking-chapter-15.html#cb1781-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> neocortexstd)),</span>
<span id="cb1781-10"><a href="rethinking-chapter-15.html#cb1781-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1781-11"><a href="rethinking-chapter-15.html#cb1781-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1781-12"><a href="rethinking-chapter-15.html#cb1781-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1781-13"><a href="rethinking-chapter-15.html#cb1781-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c15_model_primates_imputed&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1782-1"><a href="rethinking-chapter-15.html#cb1782-1" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">extract_fixef</span>(brms_c15_model_primates_imputed)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 4 × 5
#&gt;   term                     value    se lower_2.5 upper_97.5
#&gt;   &lt;chr&gt;                    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
#&gt; 1 kcalstd_Intercept        0.027 0.162    -0.303      0.345
#&gt; 2 neocortexstd_Intercept  -0.045 0.21     -0.46       0.36 
#&gt; 3 kcalstd_mass_std        -0.526 0.209    -0.93      -0.093
#&gt; 4 kcalstd_mineocortex_std  0.473 0.242    -0.018      0.935</code></pre>
<div class="sourceCode" id="cb1784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1784-1"><a href="rethinking-chapter-15.html#cb1784-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(brms_c15_model_primates_imputed) <span class="sc">%&gt;%</span></span>
<span id="cb1784-2"><a href="rethinking-chapter-15.html#cb1784-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1784-3"><a href="rethinking-chapter-15.html#cb1784-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1784-4"><a href="rethinking-chapter-15.html#cb1784-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;param&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1784-5"><a href="rethinking-chapter-15.html#cb1784-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>#&gt; # A tibble: 19 × 5
#&gt;    param                       Estimate Est.Error   Q2.5  Q97.5
#&gt;    &lt;chr&gt;                          &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt;  1 b_kcalstd_Intercept             0.03      0.16  -0.3    0.34
#&gt;  2 b_neocortexstd_Intercept       -0.05      0.21  -0.46   0.36
#&gt;  3 b_kcalstd_mass_std             -0.53      0.21  -0.93  -0.09
#&gt;  4 bsp_kcalstd_mineocortex_std     0.47      0.24  -0.02   0.93
#&gt;  5 sigma_kcalstd                   0.86      0.15   0.61   1.18
#&gt;  6 sigma_neocortexstd              1.02      0.18   0.74   1.41
#&gt;  7 Ymi_neocortexstd[2]            -0.54      0.96  -2.42   1.34
#&gt;  8 Ymi_neocortexstd[3]            -0.66      0.99  -2.6    1.29
#&gt;  9 Ymi_neocortexstd[4]            -0.68      0.96  -2.55   1.25
#&gt; 10 Ymi_neocortexstd[5]            -0.27      0.92  -2.06   1.58
#&gt; 11 Ymi_neocortexstd[9]             0.46      0.93  -1.35   2.28
#&gt; 12 Ymi_neocortexstd[14]           -0.15      0.93  -1.9    1.74
#&gt; 13 Ymi_neocortexstd[15]            0.21      0.9   -1.55   2.02
#&gt; 14 Ymi_neocortexstd[17]            0.26      0.92  -1.57   2.1 
#&gt; 15 Ymi_neocortexstd[19]            0.48      0.94  -1.38   2.31
#&gt; 16 Ymi_neocortexstd[21]           -0.43      0.92  -2.21   1.4 
#&gt; 17 Ymi_neocortexstd[23]           -0.28      0.93  -2.1    1.64
#&gt; 18 Ymi_neocortexstd[26]            0.14      0.94  -1.75   1.94
#&gt; 19 lp__                          -81.6       4.03 -90.6  -74.9</code></pre>
<div class="sourceCode" id="cb1786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1786-1"><a href="rethinking-chapter-15.html#cb1786-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(brms_c15_model_primates_imputed) <span class="sc">%&gt;%</span> </span>
<span id="cb1786-2"><a href="rethinking-chapter-15.html#cb1786-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Ymi_neocortex&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1786-3"><a href="rethinking-chapter-15.html#cb1786-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">filter</span>(data_milk_brms,</span>
<span id="cb1786-4"><a href="rethinking-chapter-15.html#cb1786-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">is.na</span>(neocortex_std)) <span class="sc">%&gt;%</span></span>
<span id="cb1786-5"><a href="rethinking-chapter-15.html#cb1786-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">pull</span>(species)) <span class="sc">%&gt;%</span> </span>
<span id="cb1786-6"><a href="rethinking-chapter-15.html#cb1786-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb1786-7"><a href="rethinking-chapter-15.html#cb1786-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;species&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1786-8"><a href="rethinking-chapter-15.html#cb1786-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, </span>
<span id="cb1786-9"><a href="rethinking-chapter-15.html#cb1786-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">reorder</span>(species, value))) <span class="sc">+</span></span>
<span id="cb1786-10"><a href="rethinking-chapter-15.html#cb1786-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(<span class="at">fill =</span> fll0, <span class="at">height =</span> <span class="fl">1.5</span>,</span>
<span id="cb1786-11"><a href="rethinking-chapter-15.html#cb1786-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">slab_color =</span> clr0dd, <span class="at">slab_size =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1786-12"><a href="rethinking-chapter-15.html#cb1786-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;imputed values for b&quot;</span>,</span>
<span id="cb1786-13"><a href="rethinking-chapter-15.html#cb1786-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1786-14"><a href="rethinking-chapter-15.html#cb1786-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">&#39;italic&#39;</span>),</span>
<span id="cb1786-15"><a href="rethinking-chapter-15.html#cb1786-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-107-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1787-1"><a href="rethinking-chapter-15.html#cb1787-1" aria-hidden="true" tabindex="-1"></a>brms_c15_model_primates_drop_na <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb1787-2"><a href="rethinking-chapter-15.html#cb1787-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_milk_brms, </span>
<span id="cb1787-3"><a href="rethinking-chapter-15.html#cb1787-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb1787-4"><a href="rethinking-chapter-15.html#cb1787-4" aria-hidden="true" tabindex="-1"></a>  kcal_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> neocortex_std <span class="sc">+</span> mass_std,</span>
<span id="cb1787-5"><a href="rethinking-chapter-15.html#cb1787-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1787-6"><a href="rethinking-chapter-15.html#cb1787-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1787-7"><a href="rethinking-chapter-15.html#cb1787-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1787-8"><a href="rethinking-chapter-15.html#cb1787-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1787-9"><a href="rethinking-chapter-15.html#cb1787-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1787-10"><a href="rethinking-chapter-15.html#cb1787-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1787-11"><a href="rethinking-chapter-15.html#cb1787-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c15_model_primates_drop_na&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; Warning message:
#&gt; Rows containing NAs were excluded from the model. </code></pre>
<div class="sourceCode" id="cb1789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1789-1"><a href="rethinking-chapter-15.html#cb1789-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">fixef</span>(brms_c15_model_primates_imputed) <span class="sc">%&gt;%</span></span>
<span id="cb1789-2"><a href="rethinking-chapter-15.html#cb1789-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1789-3"><a href="rethinking-chapter-15.html#cb1789-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1789-4"><a href="rethinking-chapter-15.html#cb1789-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">fit  =</span><span class="st">&quot;primates_imputed&quot;</span>),</span>
<span id="cb1789-5"><a href="rethinking-chapter-15.html#cb1789-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">fixef</span>(brms_c15_model_primates_drop_na) <span class="sc">%&gt;%</span></span>
<span id="cb1789-6"><a href="rethinking-chapter-15.html#cb1789-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1789-7"><a href="rethinking-chapter-15.html#cb1789-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb1789-8"><a href="rethinking-chapter-15.html#cb1789-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">fit  =</span> <span class="st">&quot;primates_drop_na&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1789-9"><a href="rethinking-chapter-15.html#cb1789-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1789-10"><a href="rethinking-chapter-15.html#cb1789-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> term <span class="sc">%&gt;%</span></span>
<span id="cb1789-11"><a href="rethinking-chapter-15.html#cb1789-11" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_remove</span>(<span class="st">&quot;kcalstd_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1789-12"><a href="rethinking-chapter-15.html#cb1789-12" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_remove</span>(<span class="st">&quot;^mi&quot;</span>) )<span class="sc">%&gt;%</span> </span>
<span id="cb1789-13"><a href="rethinking-chapter-15.html#cb1789-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="cb1789-14"><a href="rethinking-chapter-15.html#cb1789-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">3</span>,</span>
<span id="cb1789-15"><a href="rethinking-chapter-15.html#cb1789-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb1789-16"><a href="rethinking-chapter-15.html#cb1789-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1789-17"><a href="rethinking-chapter-15.html#cb1789-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr0dd, <span class="at">fill =</span> clr0,</span>
<span id="cb1789-18"><a href="rethinking-chapter-15.html#cb1789-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb1789-19"><a href="rethinking-chapter-15.html#cb1789-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> term, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1789-20"><a href="rethinking-chapter-15.html#cb1789-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;marginal posterior&quot;</span>,</span>
<span id="cb1789-21"><a href="rethinking-chapter-15.html#cb1789-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1789-22"><a href="rethinking-chapter-15.html#cb1789-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1789-23"><a href="rethinking-chapter-15.html#cb1789-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb1789-24"><a href="rethinking-chapter-15.html#cb1789-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;transparent&#39;</span>,</span>
<span id="cb1789-25"><a href="rethinking-chapter-15.html#cb1789-25" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> clr0d))</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-109-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1790-1"><a href="rethinking-chapter-15.html#cb1790-1" aria-hidden="true" tabindex="-1"></a>data_milk_brms_imputed <span class="ot">&lt;-</span> data_milk_brms <span class="sc">%&gt;%</span> </span>
<span id="cb1790-2"><a href="rethinking-chapter-15.html#cb1790-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1790-3"><a href="rethinking-chapter-15.html#cb1790-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb1790-4"><a href="rethinking-chapter-15.html#cb1790-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">posterior_summary</span>(brms_c15_model_primates_imputed) <span class="sc">%&gt;%</span></span>
<span id="cb1790-5"><a href="rethinking-chapter-15.html#cb1790-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1790-6"><a href="rethinking-chapter-15.html#cb1790-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1790-7"><a href="rethinking-chapter-15.html#cb1790-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Ymi&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1790-8"><a href="rethinking-chapter-15.html#cb1790-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">str_extract</span>(term, <span class="st">&quot;(</span><span class="sc">\\</span><span class="st">d)+&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1790-9"><a href="rethinking-chapter-15.html#cb1790-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.integer</span>()),</span>
<span id="cb1790-10"><a href="rethinking-chapter-15.html#cb1790-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">&quot;row&quot;</span>) </span>
<span id="cb1790-11"><a href="rethinking-chapter-15.html#cb1790-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1790-12"><a href="rethinking-chapter-15.html#cb1790-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> data_milk_brms_imputed <span class="sc">%&gt;%</span> </span>
<span id="cb1790-13"><a href="rethinking-chapter-15.html#cb1790-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> kcal_std)) <span class="sc">+</span></span>
<span id="cb1790-14"><a href="rethinking-chapter-15.html#cb1790-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate,</span>
<span id="cb1790-15"><a href="rethinking-chapter-15.html#cb1790-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1790-16"><a href="rethinking-chapter-15.html#cb1790-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">stroke =</span> .<span class="dv">75</span>,</span>
<span id="cb1790-17"><a href="rethinking-chapter-15.html#cb1790-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr_dark, <span class="at">fill =</span> clr0) <span class="sc">+</span></span>
<span id="cb1790-18"><a href="rethinking-chapter-15.html#cb1790-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> neocortex_std),</span>
<span id="cb1790-19"><a href="rethinking-chapter-15.html#cb1790-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0d) <span class="sc">+</span></span>
<span id="cb1790-20"><a href="rethinking-chapter-15.html#cb1790-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>,</span>
<span id="cb1790-21"><a href="rethinking-chapter-15.html#cb1790-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;kcal milk (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1790-22"><a href="rethinking-chapter-15.html#cb1790-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(data_milk_brms_imputed<span class="sc">$</span>neocortex_std, <span class="at">na.rm =</span> T))</span>
<span id="cb1790-23"><a href="rethinking-chapter-15.html#cb1790-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1790-24"><a href="rethinking-chapter-15.html#cb1790-24" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data_milk_brms_imputed <span class="sc">%&gt;%</span> </span>
<span id="cb1790-25"><a href="rethinking-chapter-15.html#cb1790-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mass_std)) <span class="sc">+</span></span>
<span id="cb1790-26"><a href="rethinking-chapter-15.html#cb1790-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate,</span>
<span id="cb1790-27"><a href="rethinking-chapter-15.html#cb1790-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1790-28"><a href="rethinking-chapter-15.html#cb1790-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">stroke =</span> .<span class="dv">75</span>,</span>
<span id="cb1790-29"><a href="rethinking-chapter-15.html#cb1790-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr_dark, <span class="at">fill =</span> clr0) <span class="sc">+</span></span>
<span id="cb1790-30"><a href="rethinking-chapter-15.html#cb1790-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> neocortex_std),</span>
<span id="cb1790-31"><a href="rethinking-chapter-15.html#cb1790-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0d) <span class="sc">+</span></span>
<span id="cb1790-32"><a href="rethinking-chapter-15.html#cb1790-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;log body mass (std)&quot;</span>,</span>
<span id="cb1790-33"><a href="rethinking-chapter-15.html#cb1790-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1790-34"><a href="rethinking-chapter-15.html#cb1790-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(data_milk_brms_imputed<span class="sc">$</span>neocortex_std, <span class="at">na.rm =</span> T))</span>
<span id="cb1790-35"><a href="rethinking-chapter-15.html#cb1790-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1790-36"><a href="rethinking-chapter-15.html#cb1790-36" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-110-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1791-1"><a href="rethinking-chapter-15.html#cb1791-1" aria-hidden="true" tabindex="-1"></a>b_model <span class="ot">&lt;-</span> <span class="fu">mvbf</span>(</span>
<span id="cb1791-2"><a href="rethinking-chapter-15.html#cb1791-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(kcal_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">mi</span>(neocortex_std) <span class="sc">+</span> mass_std), </span>
<span id="cb1791-3"><a href="rethinking-chapter-15.html#cb1791-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(neocortex_std <span class="sc">|</span> <span class="fu">mi</span>() <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> mass_std), </span>
<span id="cb1791-4"><a href="rethinking-chapter-15.html#cb1791-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">rescor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1791-5"><a href="rethinking-chapter-15.html#cb1791-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1791-6"><a href="rethinking-chapter-15.html#cb1791-6" aria-hidden="true" tabindex="-1"></a>brms_c15_model_primates_impute_covar <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb1791-7"><a href="rethinking-chapter-15.html#cb1791-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_milk_brms, </span>
<span id="cb1791-8"><a href="rethinking-chapter-15.html#cb1791-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb1791-9"><a href="rethinking-chapter-15.html#cb1791-9" aria-hidden="true" tabindex="-1"></a>  b_model,</span>
<span id="cb1791-10"><a href="rethinking-chapter-15.html#cb1791-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> kcalstd),</span>
<span id="cb1791-11"><a href="rethinking-chapter-15.html#cb1791-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> neocortexstd),</span>
<span id="cb1791-12"><a href="rethinking-chapter-15.html#cb1791-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b, <span class="at">resp =</span> kcalstd),</span>
<span id="cb1791-13"><a href="rethinking-chapter-15.html#cb1791-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b, <span class="at">resp =</span> neocortexstd),</span>
<span id="cb1791-14"><a href="rethinking-chapter-15.html#cb1791-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> kcalstd),</span>
<span id="cb1791-15"><a href="rethinking-chapter-15.html#cb1791-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> neocortexstd)),</span>
<span id="cb1791-16"><a href="rethinking-chapter-15.html#cb1791-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1791-17"><a href="rethinking-chapter-15.html#cb1791-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1791-18"><a href="rethinking-chapter-15.html#cb1791-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb1791-19"><a href="rethinking-chapter-15.html#cb1791-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c15_model_primates_impute_covar&quot;</span>)</span>
<span id="cb1791-20"><a href="rethinking-chapter-15.html#cb1791-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1791-21"><a href="rethinking-chapter-15.html#cb1791-21" aria-hidden="true" tabindex="-1"></a>data_milk_brms_imputed2 <span class="ot">&lt;-</span> data_milk_brms <span class="sc">%&gt;%</span> </span>
<span id="cb1791-22"><a href="rethinking-chapter-15.html#cb1791-22" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1791-23"><a href="rethinking-chapter-15.html#cb1791-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb1791-24"><a href="rethinking-chapter-15.html#cb1791-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">posterior_summary</span>(brms_c15_model_primates_impute_covar) <span class="sc">%&gt;%</span> </span>
<span id="cb1791-25"><a href="rethinking-chapter-15.html#cb1791-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1791-26"><a href="rethinking-chapter-15.html#cb1791-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1791-27"><a href="rethinking-chapter-15.html#cb1791-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Ymi&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1791-28"><a href="rethinking-chapter-15.html#cb1791-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">str_extract</span>(term, <span class="st">&quot;(</span><span class="sc">\\</span><span class="st">d)+&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()),</span>
<span id="cb1791-29"><a href="rethinking-chapter-15.html#cb1791-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">&quot;row&quot;</span></span>
<span id="cb1791-30"><a href="rethinking-chapter-15.html#cb1791-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1791-31"><a href="rethinking-chapter-15.html#cb1791-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1791-32"><a href="rethinking-chapter-15.html#cb1791-32" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> data_milk_brms_imputed2 <span class="sc">%&gt;%</span> </span>
<span id="cb1791-33"><a href="rethinking-chapter-15.html#cb1791-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> kcal_std)) <span class="sc">+</span></span>
<span id="cb1791-34"><a href="rethinking-chapter-15.html#cb1791-34" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate,</span>
<span id="cb1791-35"><a href="rethinking-chapter-15.html#cb1791-35" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1791-36"><a href="rethinking-chapter-15.html#cb1791-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">stroke =</span> .<span class="dv">75</span>,</span>
<span id="cb1791-37"><a href="rethinking-chapter-15.html#cb1791-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr_dark, <span class="at">fill =</span> clr0) <span class="sc">+</span></span>
<span id="cb1791-38"><a href="rethinking-chapter-15.html#cb1791-38" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> neocortex_std),</span>
<span id="cb1791-39"><a href="rethinking-chapter-15.html#cb1791-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0d) <span class="sc">+</span></span>
<span id="cb1791-40"><a href="rethinking-chapter-15.html#cb1791-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>,</span>
<span id="cb1791-41"><a href="rethinking-chapter-15.html#cb1791-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;kcal milk (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1791-42"><a href="rethinking-chapter-15.html#cb1791-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(data_milk_brms_imputed<span class="sc">$</span>neocortex_std, <span class="at">na.rm =</span> T))</span>
<span id="cb1791-43"><a href="rethinking-chapter-15.html#cb1791-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1791-44"><a href="rethinking-chapter-15.html#cb1791-44" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data_milk_brms_imputed2 <span class="sc">%&gt;%</span> </span>
<span id="cb1791-45"><a href="rethinking-chapter-15.html#cb1791-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mass_std)) <span class="sc">+</span></span>
<span id="cb1791-46"><a href="rethinking-chapter-15.html#cb1791-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate,</span>
<span id="cb1791-47"><a href="rethinking-chapter-15.html#cb1791-47" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1791-48"><a href="rethinking-chapter-15.html#cb1791-48" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">stroke =</span> .<span class="dv">75</span>,</span>
<span id="cb1791-49"><a href="rethinking-chapter-15.html#cb1791-49" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clr_dark, <span class="at">fill =</span> clr0) <span class="sc">+</span></span>
<span id="cb1791-50"><a href="rethinking-chapter-15.html#cb1791-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> neocortex_std),</span>
<span id="cb1791-51"><a href="rethinking-chapter-15.html#cb1791-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr0d) <span class="sc">+</span></span>
<span id="cb1791-52"><a href="rethinking-chapter-15.html#cb1791-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;log body mass (std)&quot;</span>,</span>
<span id="cb1791-53"><a href="rethinking-chapter-15.html#cb1791-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1791-54"><a href="rethinking-chapter-15.html#cb1791-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(data_milk_brms_imputed<span class="sc">$</span>neocortex_std, <span class="at">na.rm =</span> T))</span>
<span id="cb1791-55"><a href="rethinking-chapter-15.html#cb1791-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1791-56"><a href="rethinking-chapter-15.html#cb1791-56" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c15_files/figure-html/unnamed-chunk-111-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="categorical-errors-and-discrete-absences-1" class="section level3 hasAnchor" number="16.5.3">
<h3><span class="header-section-number">16.5.3</span> Categorical Errors and Discrete Absences<a href="rethinking-chapter-15.html#categorical-errors-and-discrete-absences-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="discrete-cats-1" class="section level4 hasAnchor" number="16.5.3.1">
<h4><span class="header-section-number">16.5.3.1</span> Discrete Cats<a href="rethinking-chapter-15.html#discrete-cats-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>😢 <em>Sadly, this is as far as I’m going in this section. I still haven’t made sense of McElreath’s <strong>weighted average</strong> approach to missing data and I’m not sure whether it’s even possible with <strong>brms</strong>.</em></p>
</blockquote>
</div>
</div>
</div>
<div id="pymc3-section-13" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> pymc3 section<a href="rethinking-chapter-15.html#pymc3-section-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<div id="myModal" class="modal">
<span class="close">×</span>
<img class="modal-content" id="img01">
<div id="caption">

</div>
</div>
<script src="./js/zoom.js"></script>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rethinking-chapter-14.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rethinking-chapter-16.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": "github"
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
