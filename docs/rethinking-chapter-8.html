<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Rethinking: Chapter 8 | Statistical Explorations</title>
  <meta name="description" content="statistical explorations by kh" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Rethinking: Chapter 8 | Statistical Explorations" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="statistical explorations by kh" />
  <meta name="github-repo" content="k-hench/statistical_explorations" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Rethinking: Chapter 8 | Statistical Explorations" />
  
  <meta name="twitter:description" content="statistical explorations by kh" />
  

<meta name="author" content="Kosmas Hench" />


<meta name="date" content="2022-01-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rethinking-chapter-7.html"/>
<link rel="next" href="rethinking-chapter-9.html"/>
<script src="libs/header-attrs-2.9.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });
  
  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    // var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeText = $('<img style="width:45px;" src="img/both.svg">');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    var buttonColK = $('<div class="check"><input type="checkbox" id="cc_' + id + '" class="btn btn-default btn-xs code-folding-btn pull-right ch1" /><label class="checktrue" for="cc_' + id + '" ></label></div>');

    buttonColK
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    //buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);
    buttonCol.append(buttonColK);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text();
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text();
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<script>
$(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>
<link rel="shortcut icon" href="img/favicon.ico" />
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>

<script>document.write('<div class="btn-group pull-right" style="position: absolute; top: 35px; right: 2%; z-index: 10"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"aria-expanded="true" data-_extension-text-contrast=""><span>global code</span><span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All</a></li><li><a id="rmd-hide-all-code" href="#">Hide All</a></li></ul></div>')</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/k-hench/statistical_explorations">github repository</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro</a></li>
<li class="chapter" data-level="2" data-path="rethinking-chapter-1.html"><a href="rethinking-chapter-1.html"><i class="fa fa-check"></i><b>2</b> Rethinking: Chapter 1</a></li>
<li class="chapter" data-level="3" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html"><i class="fa fa-check"></i><b>3</b> Rethinking: Chapter 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#counting-possibilities"><i class="fa fa-check"></i><b>3.1</b> Counting possibilities</a></li>
<li class="chapter" data-level="3.2" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#building-a-model"><i class="fa fa-check"></i><b>3.2</b> Building a Model</a></li>
<li class="chapter" data-level="3.3" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#making-the-model-go-bayes-theorem"><i class="fa fa-check"></i><b>3.3</b> Making the model go / Bayes’ Theorem</a></li>
<li class="chapter" data-level="3.4" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#motors-grid-approximation"><i class="fa fa-check"></i><b>3.4</b> Motors: Grid Approximation</a></li>
<li class="chapter" data-level="3.5" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#quadratic-approximation"><i class="fa fa-check"></i><b>3.5</b> Quadratic Approximation</a></li>
<li class="chapter" data-level="3.6" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#marcov-chain-monte-carlo-mcmc"><i class="fa fa-check"></i><b>3.6</b> Marcov Chain Monte Carlo (MCMC)</a></li>
<li class="chapter" data-level="3.7" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#homework"><i class="fa fa-check"></i><b>3.7</b> Homework</a></li>
<li class="chapter" data-level="3.8" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#brms-section"><i class="fa fa-check"></i><b>3.8</b> {brms} section</a></li>
<li class="chapter" data-level="3.9" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#pymc3-section"><i class="fa fa-check"></i><b>3.9</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html"><i class="fa fa-check"></i><b>4</b> Rethinking: Chapter 3</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>4.1</b> Sampling from a grid approximate posterior</a></li>
<li class="chapter" data-level="4.2" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#sampling-to-summarize"><i class="fa fa-check"></i><b>4.2</b> Sampling to Summarize</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#intervals-of-devined-boundaries"><i class="fa fa-check"></i><b>4.2.1</b> Intervals of devined boundaries</a></li>
<li class="chapter" data-level="4.2.2" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#intervals-of-defined-mass"><i class="fa fa-check"></i><b>4.2.2</b> Intervals of defined mass</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#point-estimates"><i class="fa fa-check"></i><b>4.3</b> Point estimates</a></li>
<li class="chapter" data-level="4.4" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#sample-to-simulate-prediction"><i class="fa fa-check"></i><b>4.4</b> sample to simulate prediction</a></li>
<li class="chapter" data-level="4.5" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#homework-1"><i class="fa fa-check"></i><b>4.5</b> Homework</a></li>
<li class="chapter" data-level="4.6" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#brms-section-1"><i class="fa fa-check"></i><b>4.6</b> {brms} section</a></li>
<li class="chapter" data-level="4.7" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#pymc3-section-1"><i class="fa fa-check"></i><b>4.7</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html"><i class="fa fa-check"></i><b>5</b> Rethinking: Chapter 4</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>5.1</b> Why normal distributions are normal</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#normal-by-addition"><i class="fa fa-check"></i><b>5.1.1</b> Normal by addition</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#normal-by-multiplication-and-by-log-multiplication"><i class="fa fa-check"></i><b>5.2</b> Normal by multiplication and by log-multiplication</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#using-the-gaussian-distribution"><i class="fa fa-check"></i><b>5.2.1</b> using the Gaussian distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>5.3</b> A language for describing models</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>5.3.1</b> Gaussian model of height</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#linear-prediction"><i class="fa fa-check"></i><b>5.4</b> Linear Prediction</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>5.4.1</b> Finding the posterior Distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#curves-from-lines"><i class="fa fa-check"></i><b>5.5</b> Curves from lines</a></li>
<li class="chapter" data-level="5.6" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#splines"><i class="fa fa-check"></i><b>5.6</b> Splines</a></li>
<li class="chapter" data-level="5.7" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#homework-2"><i class="fa fa-check"></i><b>5.7</b> Homework</a></li>
<li class="chapter" data-level="5.8" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#brms-section-2"><i class="fa fa-check"></i><b>5.8</b> {brms} section</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#linear-model-of-adult-height"><i class="fa fa-check"></i><b>5.8.1</b> linear model of adult height</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#pymc3-section-2"><i class="fa fa-check"></i><b>5.9</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html"><i class="fa fa-check"></i><b>6</b> Rethinking: Chapter 5</a>
<ul>
<li class="chapter" data-level="6.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#directed-acyclic-graphs"><i class="fa fa-check"></i><b>6.1</b> Directed Acyclic Graphs</a></li>
<li class="chapter" data-level="6.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multiple-regression-notion"><i class="fa fa-check"></i><b>6.2</b> Multiple Regression notion</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#visualizations-for-multivariate-regressions"><i class="fa fa-check"></i><b>6.2.1</b> Visualizations for multivariate regressions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#masked-relationship"><i class="fa fa-check"></i><b>6.3</b> Masked relationship</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#bi-variate-models"><i class="fa fa-check"></i><b>6.3.1</b> Bi-variate models</a></li>
<li class="chapter" data-level="6.3.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#simulate-a-masking-relationship"><i class="fa fa-check"></i><b>6.3.2</b> Simulate a masking relationship</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#categorical-variables"><i class="fa fa-check"></i><b>6.4</b> Categorical Variables</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#indicator-vs.-index-variable-binary-categories"><i class="fa fa-check"></i><b>6.4.1</b> Indicator vs. Index variable (binary categories)</a></li>
<li class="chapter" data-level="6.4.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multiple-categories"><i class="fa fa-check"></i><b>6.4.2</b> Multiple categories</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#homework-3"><i class="fa fa-check"></i><b>6.5</b> Homework</a></li>
<li class="chapter" data-level="6.6" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#brms-section-3"><i class="fa fa-check"></i><b>6.6</b> {brms} section</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#age-at-marriage-model"><i class="fa fa-check"></i><b>6.6.1</b> Age at marriage Model</a></li>
<li class="chapter" data-level="6.6.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#marriage-rate-model"><i class="fa fa-check"></i><b>6.6.2</b> Marriage rate Model</a></li>
<li class="chapter" data-level="6.6.3" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multiple-regression"><i class="fa fa-check"></i><b>6.6.3</b> Multiple regression</a></li>
<li class="chapter" data-level="6.6.4" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multivariate-posteriors"><i class="fa fa-check"></i><b>6.6.4</b> Multivariate Posteriors</a></li>
<li class="chapter" data-level="6.6.5" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#counterfactual-plots-1"><i class="fa fa-check"></i><b>6.6.5</b> Counterfactual plots</a></li>
<li class="chapter" data-level="6.6.6" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#masked-relationships"><i class="fa fa-check"></i><b>6.6.6</b> Masked Relationships</a></li>
<li class="chapter" data-level="6.6.7" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#categorical-variables-1"><i class="fa fa-check"></i><b>6.6.7</b> Categorical Variables</a></li>
<li class="chapter" data-level="6.6.8" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#alternative-ways-to-model-multiple-categories"><i class="fa fa-check"></i><b>6.6.8</b> Alternative ways to model multiple categories</a></li>
<li class="chapter" data-level="6.6.9" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multilevel-anova"><i class="fa fa-check"></i><b>6.6.9</b> Multilevel ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#pymc3-section-3"><i class="fa fa-check"></i><b>6.7</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html"><i class="fa fa-check"></i><b>7</b> Rethinking: Chapter 6</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#multicolliniarity"><i class="fa fa-check"></i><b>7.1</b> Multicolliniarity</a></li>
<li class="chapter" data-level="7.2" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#post-treatment-bias"><i class="fa fa-check"></i><b>7.2</b> Post-treatment bias</a></li>
<li class="chapter" data-level="7.3" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#collider-bias"><i class="fa fa-check"></i><b>7.3</b> Collider Bias</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#the-haunted-dag"><i class="fa fa-check"></i><b>7.3.1</b> The haunted DAG</a></li>
<li class="chapter" data-level="7.3.2" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#shutting-the-backdoor"><i class="fa fa-check"></i><b>7.3.2</b> Shutting the Backdoor</a></li>
<li class="chapter" data-level="7.3.3" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#two-roads"><i class="fa fa-check"></i><b>7.3.3</b> Two Roads</a></li>
<li class="chapter" data-level="7.3.4" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#backdoor-waffles"><i class="fa fa-check"></i><b>7.3.4</b> Backdoor Waffles</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#homework-4"><i class="fa fa-check"></i><b>7.4</b> Homework</a></li>
<li class="chapter" data-level="7.5" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#brms-section-4"><i class="fa fa-check"></i><b>7.5</b> {brms} section</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#multicolliniarity-1"><i class="fa fa-check"></i><b>7.5.1</b> Multicolliniarity</a></li>
<li class="chapter" data-level="7.5.2" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#post-treatment-bias-1"><i class="fa fa-check"></i><b>7.5.2</b> Post-treatment bias</a></li>
<li class="chapter" data-level="7.5.3" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#collider-bias-1"><i class="fa fa-check"></i><b>7.5.3</b> Collider Bias</a></li>
<li class="chapter" data-level="7.5.4" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#summary"><i class="fa fa-check"></i><b>7.5.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#pymc3-section-4"><i class="fa fa-check"></i><b>7.6</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html"><i class="fa fa-check"></i><b>8</b> Rethinking: Chapter 7</a>
<ul>
<li class="chapter" data-level="8.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>8.1</b> The Problem with Parameters</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#the-burial-of-r2"><i class="fa fa-check"></i><b>8.1.1</b> The burial of R<sup>2</sup></a></li>
<li class="chapter" data-level="8.1.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#higher-order-polynomials"><i class="fa fa-check"></i><b>8.1.2</b> Higher order polynomials</a></li>
<li class="chapter" data-level="8.1.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#underfitting"><i class="fa fa-check"></i><b>8.1.3</b> Underfitting</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>8.2</b> Entropy and Accuracy</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#entropy"><i class="fa fa-check"></i><b>8.2.1</b> Entropy</a></li>
<li class="chapter" data-level="8.2.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#accuracy"><i class="fa fa-check"></i><b>8.2.2</b> Accuracy</a></li>
<li class="chapter" data-level="8.2.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#estimating-divergence"><i class="fa fa-check"></i><b>8.2.3</b> Estimating Divergence</a></li>
<li class="chapter" data-level="8.2.4" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#scoring-the-right-data"><i class="fa fa-check"></i><b>8.2.4</b> Scoring the right data</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#golem-taming-regularization"><i class="fa fa-check"></i><b>8.3</b> Golem taming: regularization</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#cross-validataion"><i class="fa fa-check"></i><b>8.3.1</b> Cross-validataion</a></li>
<li class="chapter" data-level="8.3.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#information-criteria"><i class="fa fa-check"></i><b>8.3.2</b> Information Criteria</a></li>
<li class="chapter" data-level="8.3.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#comparing-cv-psis-and-waic"><i class="fa fa-check"></i><b>8.3.3</b> Comparing CV, PSIS and WAIC</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#model-comparison"><i class="fa fa-check"></i><b>8.4</b> Model comparison</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#model-mis-selection"><i class="fa fa-check"></i><b>8.4.1</b> Model mis-selection</a></li>
<li class="chapter" data-level="8.4.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#outliers-and-other-illusions"><i class="fa fa-check"></i><b>8.4.2</b> Outliers and other illusions</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#homework-5"><i class="fa fa-check"></i><b>8.5</b> Homework</a></li>
<li class="chapter" data-level="8.6" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#brms-section-5"><i class="fa fa-check"></i><b>8.6</b> {brms} section</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#the-problem-with-parameters-1"><i class="fa fa-check"></i><b>8.6.1</b> The problem with parameters</a></li>
<li class="chapter" data-level="8.6.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#entropy-and-accuracy-1"><i class="fa fa-check"></i><b>8.6.2</b> Entropy and accuracy</a></li>
<li class="chapter" data-level="8.6.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#information-criteria-1"><i class="fa fa-check"></i><b>8.6.3</b> Information criteria</a></li>
<li class="chapter" data-level="8.6.4" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#model-comparison-1"><i class="fa fa-check"></i><b>8.6.4</b> Model comparison</a></li>
<li class="chapter" data-level="8.6.5" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#outliers-and-other-illusions-1"><i class="fa fa-check"></i><b>8.6.5</b> Outliers and other illusions</a></li>
<li class="chapter" data-level="8.6.6" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#brms-r2"><i class="fa fa-check"></i><b>8.6.6</b> {brms} <span class="math inline">\(r^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#pymc3-section-5"><i class="fa fa-check"></i><b>8.7</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html"><i class="fa fa-check"></i><b>9</b> Rethinking: Chapter 8</a>
<ul>
<li class="chapter" data-level="9.1" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#building-an-interaction"><i class="fa fa-check"></i><b>9.1</b> Building an Interaction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#adding-an-index-variable-is-not-enough"><i class="fa fa-check"></i><b>9.1.1</b> Adding an index variable is not enough</a></li>
<li class="chapter" data-level="9.1.2" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#adding-an-interaction-does-work"><i class="fa fa-check"></i><b>9.1.2</b> Adding an interaction does work</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#symetry-of-interactions"><i class="fa fa-check"></i><b>9.2</b> Symetry of Interactions</a></li>
<li class="chapter" data-level="9.3" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#continuous-interaction"><i class="fa fa-check"></i><b>9.3</b> Continuous Interaction</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#model-without-interaction"><i class="fa fa-check"></i><b>9.3.1</b> Model without Interaction</a></li>
<li class="chapter" data-level="9.3.2" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#model-with-interaction"><i class="fa fa-check"></i><b>9.3.2</b> Model with Interaction</a></li>
<li class="chapter" data-level="9.3.3" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#plotting-the-posterior-predictions"><i class="fa fa-check"></i><b>9.3.3</b> Plotting the Posterior Predictions</a></li>
<li class="chapter" data-level="9.3.4" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#plotting-the-prior-predictions"><i class="fa fa-check"></i><b>9.3.4</b> Plotting the Prior Predictions</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#homework-6"><i class="fa fa-check"></i><b>9.4</b> Homework</a></li>
<li class="chapter" data-level="9.5" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#brms-section-6"><i class="fa fa-check"></i><b>9.5</b> {brms} section</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#building-an-interaction-1"><i class="fa fa-check"></i><b>9.5.1</b> Building an Interaction</a></li>
<li class="chapter" data-level="9.5.2" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#plotting-the-interaction"><i class="fa fa-check"></i><b>9.5.2</b> Plotting the Interaction</a></li>
<li class="chapter" data-level="9.5.3" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#symetry-of-interactions-1"><i class="fa fa-check"></i><b>9.5.3</b> Symetry of Interactions</a></li>
<li class="chapter" data-level="9.5.4" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#continuous-interactions"><i class="fa fa-check"></i><b>9.5.4</b> Continuous Interactions</a></li>
<li class="chapter" data-level="9.5.5" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#plotting-the-posterior-predictions-1"><i class="fa fa-check"></i><b>9.5.5</b> Plotting the Posterior Predictions</a></li>
<li class="chapter" data-level="9.5.6" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#plotting-prior-predictions"><i class="fa fa-check"></i><b>9.5.6</b> Plotting Prior Predictions</a></li>
<li class="chapter" data-level="9.5.7" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#brms-conditional_effects"><i class="fa fa-check"></i><b>9.5.7</b> {brms} <code>conditional_effects()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="rethinking-chapter-8.html"><a href="rethinking-chapter-8.html#pymc3-section-6"><i class="fa fa-check"></i><b>9.6</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html"><i class="fa fa-check"></i><b>10</b> Rethinking: Chapter 9</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#the-island-kingdom"><i class="fa fa-check"></i><b>10.1</b> The island Kingdom</a></li>
<li class="chapter" data-level="10.2" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#metropolis-algotithms"><i class="fa fa-check"></i><b>10.2</b> Metropolis algotithms</a></li>
<li class="chapter" data-level="10.3" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>10.3</b> Hamiltonian Monte Carlo</a></li>
<li class="chapter" data-level="10.4" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#easy-hmc-rethinkingulam"><i class="fa fa-check"></i><b>10.4</b> Easy HMC: <code>rethinking::ulam()</code></a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#checking-the-chain"><i class="fa fa-check"></i><b>10.4.1</b> Checking the Chain</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i><b>10.5</b> Care and feeding of your Markov Chain</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#non-identifiable-parameters"><i class="fa fa-check"></i><b>10.5.1</b> Non-identifiable parameters</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#homework-7"><i class="fa fa-check"></i><b>10.6</b> Homework</a></li>
<li class="chapter" data-level="10.7" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#brms-section-7"><i class="fa fa-check"></i><b>10.7</b> {brms} section</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#easy-hmc-brm"><i class="fa fa-check"></i><b>10.7.1</b> Easy HMC: <code>brm{}</code></a></li>
<li class="chapter" data-level="10.7.2" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#care-and-feeding-of-your-markov-chain-1"><i class="fa fa-check"></i><b>10.7.2</b> Care and feeding of your Markov chain</a></li>
<li class="chapter" data-level="10.7.3" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#non-identifiable-parameters-1"><i class="fa fa-check"></i><b>10.7.3</b> Non-identifiable parameters</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="rethinking-chapter-9.html"><a href="rethinking-chapter-9.html#pymc3-section-7"><i class="fa fa-check"></i><b>10.8</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html"><i class="fa fa-check"></i><b>11</b> Rethinking: Chapter 10</a>
<ul>
<li class="chapter" data-level="11.1" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#maximum-entropy"><i class="fa fa-check"></i><b>11.1</b> Maximum Entropy</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#the-gaussian-family"><i class="fa fa-check"></i><b>11.1.1</b> The Gaussian Family</a></li>
<li class="chapter" data-level="11.1.2" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#the-binomial-distribution"><i class="fa fa-check"></i><b>11.1.2</b> The Binomial Distribution</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#generalized-linear-models"><i class="fa fa-check"></i><b>11.2</b> Generalized linear Models</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#meet-the-family"><i class="fa fa-check"></i><b>11.2.1</b> Meet the Family</a></li>
<li class="chapter" data-level="11.2.2" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#linking-linear-models-to-distributions"><i class="fa fa-check"></i><b>11.2.2</b> Linking linear models to distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#homework-8"><i class="fa fa-check"></i><b>11.3</b> Homework</a></li>
<li class="chapter" data-level="11.4" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#brms-section-8"><i class="fa fa-check"></i><b>11.4</b> {brms} section</a></li>
<li class="chapter" data-level="11.5" data-path="rethinking-chapter-10.html"><a href="rethinking-chapter-10.html#pymc3-section-8"><i class="fa fa-check"></i><b>11.5</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html"><i class="fa fa-check"></i><b>12</b> Rethinking: Chapter 11</a>
<ul>
<li class="chapter" data-level="12.1" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#binomial-regression"><i class="fa fa-check"></i><b>12.1</b> Binomial Regression</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#logistic-regression-prosocial-chimpanzees"><i class="fa fa-check"></i><b>12.1.1</b> Logistic Regression: Prosocial chimpanzees</a></li>
<li class="chapter" data-level="12.1.2" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#relative-shark-and-absolute-deer"><i class="fa fa-check"></i><b>12.1.2</b> Relative Shark and Absolute Deer</a></li>
<li class="chapter" data-level="12.1.3" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#aggregated-binomial-chimpanzees-again-condensed"><i class="fa fa-check"></i><b>12.1.3</b> Aggregated binomial: Chimpanzees again, condensed</a></li>
<li class="chapter" data-level="12.1.4" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#aggregated-binomial-graduate-school-admissions"><i class="fa fa-check"></i><b>12.1.4</b> Aggregated binomial: Graduate School Admissions</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#poisson-regression"><i class="fa fa-check"></i><b>12.2</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#oceanic-tool-complexity"><i class="fa fa-check"></i><b>12.2.1</b> Oceanic Tool Complexity</a></li>
<li class="chapter" data-level="12.2.2" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#modeling-tool-innovation"><i class="fa fa-check"></i><b>12.2.2</b> Modeling Tool Innovation</a></li>
<li class="chapter" data-level="12.2.3" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#negative-binomial-gamma-poisson-models"><i class="fa fa-check"></i><b>12.2.3</b> Negative Binomial (gamma-Poisson) models</a></li>
<li class="chapter" data-level="12.2.4" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#exposure-and-the-offset"><i class="fa fa-check"></i><b>12.2.4</b> Exposure and the Offset</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#multinomial-and-categorical-models"><i class="fa fa-check"></i><b>12.3</b> Multinomial and Categorical Models</a></li>
<li class="chapter" data-level="12.4" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#homework-9"><i class="fa fa-check"></i><b>12.4</b> Homework</a></li>
<li class="chapter" data-level="12.5" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#brms-section-9"><i class="fa fa-check"></i><b>12.5</b> {brms} section</a></li>
<li class="chapter" data-level="12.6" data-path="rethinking-chapter-11.html"><a href="rethinking-chapter-11.html#pymc3-section-9"><i class="fa fa-check"></i><b>12.6</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html"><i class="fa fa-check"></i><b>13</b> Bayesian Statistics the Fun Way</a>
<ul>
<li class="chapter" data-level="13.1" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#conditioning-probabilities"><i class="fa fa-check"></i><b>13.1</b> Conditioning Probabilities</a></li>
<li class="chapter" data-level="13.2" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#combining-probailities-based-on-logic"><i class="fa fa-check"></i><b>13.2</b> Combining Probailities based on logic</a></li>
<li class="chapter" data-level="13.3" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#the-binomial-distribution-1"><i class="fa fa-check"></i><b>13.3</b> The binomial distribution</a></li>
<li class="chapter" data-level="13.4" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#the-beta-distribution"><i class="fa fa-check"></i><b>13.4</b> The beta distribution</a></li>
<li class="chapter" data-level="13.5" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#bayes-theorem"><i class="fa fa-check"></i><b>13.5</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="13.6" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#parameter-estimation-i"><i class="fa fa-check"></i><b>13.6</b> Parameter Estimation (I)</a></li>
<li class="chapter" data-level="13.7" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#the-normal-distribution"><i class="fa fa-check"></i><b>13.7</b> The normal distribution</a></li>
<li class="chapter" data-level="13.8" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#cummulative-density-and-quantile-function"><i class="fa fa-check"></i><b>13.8</b> Cummulative Density and Quantile Function</a></li>
<li class="chapter" data-level="13.9" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#parameter-estimation-with-prior-probabilities"><i class="fa fa-check"></i><b>13.9</b> Parameter estimation with prior probabilities</a></li>
<li class="chapter" data-level="13.10" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#monte-carlosimulation"><i class="fa fa-check"></i><b>13.10</b> Monte CarloSimulation</a></li>
<li class="chapter" data-level="13.11" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#posterior-odds"><i class="fa fa-check"></i><b>13.11</b> Posterior Odds</a></li>
<li class="chapter" data-level="13.12" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#parameter-estimation-ii"><i class="fa fa-check"></i><b>13.12</b> Parameter Estimation (II)</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html"><i class="fa fa-check"></i><b>14</b> Mixed Models with R</a>
<ul>
<li class="chapter" data-level="14.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#standard-regregression-model"><i class="fa fa-check"></i><b>14.1</b> Standard regregression model</a></li>
<li class="chapter" data-level="14.2" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#mixed-nodel"><i class="fa fa-check"></i><b>14.2</b> mixed nodel</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#student-specific-effect-initial-depiction"><i class="fa fa-check"></i><b>14.2.1</b> student specific effect (initial depiction)</a></li>
<li class="chapter" data-level="14.2.2" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#as-multi-level-model"><i class="fa fa-check"></i><b>14.2.2</b> as multi-level model</a></li>
<li class="chapter" data-level="14.2.3" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#mixed-model"><i class="fa fa-check"></i><b>14.2.3</b> Mixed Model</a></li>
<li class="chapter" data-level="14.2.4" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#estimation-of-random-effects"><i class="fa fa-check"></i><b>14.2.4</b> Estimation of random effects</a></li>
<li class="chapter" data-level="14.2.5" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#prediction"><i class="fa fa-check"></i><b>14.2.5</b> Prediction</a></li>
<li class="chapter" data-level="14.2.6" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#cluster-level-covariates"><i class="fa fa-check"></i><b>14.2.6</b> Cluster Level Covariates</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#add-random-slope"><i class="fa fa-check"></i><b>14.3</b> Add random slope</a></li>
<li class="chapter" data-level="14.4" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#cross-classified-models"><i class="fa fa-check"></i><b>14.4</b> Cross Classified models</a></li>
<li class="chapter" data-level="14.5" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#hierachical-structure"><i class="fa fa-check"></i><b>14.5</b> Hierachical structure</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#crossed-vs.-nested"><i class="fa fa-check"></i><b>14.5.1</b> Crossed vs. nested</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#residual-structure"><i class="fa fa-check"></i><b>14.6</b> Residual Structure</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#heterogeneous-variance"><i class="fa fa-check"></i><b>14.6.1</b> Heterogeneous variance</a></li>
<li class="chapter" data-level="14.6.2" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#autocorrelation"><i class="fa fa-check"></i><b>14.6.2</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#generalized-linear-mixed-models"><i class="fa fa-check"></i><b>14.7</b> Generalized Linear Mixed Models</a></li>
<li class="chapter" data-level="14.8" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#issues-considderations"><i class="fa fa-check"></i><b>14.8</b> Issues/ Considderations</a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#model-comparison-2"><i class="fa fa-check"></i><b>14.8.1</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#formula-summary"><i class="fa fa-check"></i><b>14.9</b> Formula summary</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="references-and-session-info.html"><a href="references-and-session-info.html"><i class="fa fa-check"></i><b>15</b> References and Session Info</a>
<ul>
<li class="chapter" data-level="15.1" data-path="references-and-session-info.html"><a href="references-and-session-info.html#session-info"><i class="fa fa-check"></i><b>15.1</b> Session Info</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="references-and-session-info.html"><a href="references-and-session-info.html#r-settings"><i class="fa fa-check"></i><b>15.1.1</b> R settings</a></li>
<li class="chapter" data-level="15.1.2" data-path="references-and-session-info.html"><a href="references-and-session-info.html#python-settings"><i class="fa fa-check"></i><b>15.1.2</b> Python settings</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="references-and-session-info.html"><a href="references-and-session-info.html#references"><i class="fa fa-check"></i><b>15.2</b> References</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Explorations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rethinking-chapter-8" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Rethinking: Chapter 8</h1>
<p><strong>Conditional Manatees</strong></p>
<p>by <a href="https://xcelab.net/rm/statistical-rethinking/">Richard McElreath</a>, building on the Summaries by <a href="https://bookdown.org/content/4857/">Solomon Kurz</a>.</p>
<div id="building-an-interaction" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Building an Interaction</h2>
<p>Investigating how ruggedness influences countries GDP, conditional on whether the country is African or not.</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="rethinking-chapter-8.html#cb725-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb725-2"><a href="rethinking-chapter-8.html#cb725-2" aria-hidden="true" tabindex="-1"></a>p_dag1 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(G <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> U,</span>
<span id="cb725-3"><a href="rethinking-chapter-8.html#cb725-3" aria-hidden="true" tabindex="-1"></a>                 R <span class="sc">~</span> U,</span>
<span id="cb725-4"><a href="rethinking-chapter-8.html#cb725-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;U&quot;</span>),</span>
<span id="cb725-5"><a href="rethinking-chapter-8.html#cb725-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>, .<span class="dv">5</span>),</span>
<span id="cb725-6"><a href="rethinking-chapter-8.html#cb725-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb725-7"><a href="rethinking-chapter-8.html#cb725-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb725-8"><a href="rethinking-chapter-8.html#cb725-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;G&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb725-9"><a href="rethinking-chapter-8.html#cb725-9" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;C&quot;</span>),</span>
<span id="cb725-10"><a href="rethinking-chapter-8.html#cb725-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb725-11"><a href="rethinking-chapter-8.html#cb725-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr3) </span>
<span id="cb725-12"><a href="rethinking-chapter-8.html#cb725-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-13"><a href="rethinking-chapter-8.html#cb725-13" aria-hidden="true" tabindex="-1"></a>p_dag2 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(G <span class="sc">~</span> R <span class="sc">+</span> H <span class="sc">+</span> U,</span>
<span id="cb725-14"><a href="rethinking-chapter-8.html#cb725-14" aria-hidden="true" tabindex="-1"></a>                 R <span class="sc">~</span> U,</span>
<span id="cb725-15"><a href="rethinking-chapter-8.html#cb725-15" aria-hidden="true" tabindex="-1"></a>                 H <span class="sc">~</span> R <span class="sc">+</span> C,</span>
<span id="cb725-16"><a href="rethinking-chapter-8.html#cb725-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;U&quot;</span>),</span>
<span id="cb725-17"><a href="rethinking-chapter-8.html#cb725-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">33</span>, <span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">66</span>, <span class="dv">0</span>),</span>
<span id="cb725-18"><a href="rethinking-chapter-8.html#cb725-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb725-19"><a href="rethinking-chapter-8.html#cb725-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb725-20"><a href="rethinking-chapter-8.html#cb725-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;G&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb725-21"><a href="rethinking-chapter-8.html#cb725-21" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;H&quot;</span>),</span>
<span id="cb725-22"><a href="rethinking-chapter-8.html#cb725-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb725-23"><a href="rethinking-chapter-8.html#cb725-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr3) </span>
<span id="cb725-24"><a href="rethinking-chapter-8.html#cb725-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-25"><a href="rethinking-chapter-8.html#cb725-25" aria-hidden="true" tabindex="-1"></a>p_dag1 <span class="sc">+</span></span>
<span id="cb725-26"><a href="rethinking-chapter-8.html#cb725-26" aria-hidden="true" tabindex="-1"></a>  p_dag2 <span class="sc">+</span></span>
<span id="cb725-27"><a href="rethinking-chapter-8.html#cb725-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;a&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb725-28"><a href="rethinking-chapter-8.html#cb725-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="sc">&amp;</span></span>
<span id="cb725-29"><a href="rethinking-chapter-8.html#cb725-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">05</span>, <span class="fl">1.05</span>)) <span class="sc">&amp;</span></span>
<span id="cb725-30"><a href="rethinking-chapter-8.html#cb725-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">55</span>) <span class="sc">&amp;</span></span>
<span id="cb725-31"><a href="rethinking-chapter-8.html#cb725-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-1-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(\rightarrow\)</span> the DAGs are agnostic to <em>interactions</em>: all they show is that in <strong>a</strong>, <span class="math inline">\(G\)</span> is a function of both <span class="math inline">\(R\)</span> and <span class="math inline">\(C\)</span> (<span class="math inline">\(G = f(R, C)\)</span>) regardless of the existence of interaction between the two influences.</p>
<p>Importing the ruggedness data:</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="rethinking-chapter-8.html#cb726-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rugged)</span>
<span id="cb726-2"><a href="rethinking-chapter-8.html#cb726-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb726-3"><a href="rethinking-chapter-8.html#cb726-3" aria-hidden="true" tabindex="-1"></a>data_rugged <span class="ot">&lt;-</span> rugged <span class="sc">%&gt;%</span> </span>
<span id="cb726-4"><a href="rethinking-chapter-8.html#cb726-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb726-5"><a href="rethinking-chapter-8.html#cb726-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_gdp =</span> <span class="fu">log</span>(rgdppc_2000)) <span class="sc">%&gt;%</span> </span>
<span id="cb726-6"><a href="rethinking-chapter-8.html#cb726-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(rgdppc_2000)) <span class="sc">%&gt;%</span> </span>
<span id="cb726-7"><a href="rethinking-chapter-8.html#cb726-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_gdp_std =</span> log_gdp <span class="sc">/</span> <span class="fu">mean</span>(log_gdp),</span>
<span id="cb726-8"><a href="rethinking-chapter-8.html#cb726-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">rugged_std =</span> rugged <span class="sc">/</span> <span class="fu">max</span>(rugged),</span>
<span id="cb726-9"><a href="rethinking-chapter-8.html#cb726-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">cont_idx =</span> <span class="fu">as.integer</span>(<span class="dv">2</span> <span class="sc">-</span> cont_africa))</span></code></pre></div>
<p>First sketch of the model (without interaction)</p>
<p><span class="math display">\[
\begin{array}{rclr}
log(y_{i}) &amp; \sim &amp; Normal( \mu_{i}, \sigma) &amp; \textrm{[likelihood]}\\
\mu_{i} &amp; = &amp; \alpha + \beta (r_{i} - \overline{r}) &amp; \textrm{[linear model]}\\
\alpha &amp; \sim &amp; Normal(1, 1) &amp; \textrm{[$\alpha$ prior]}\\
\beta &amp; \sim &amp; Normal(0, 1) &amp; \textrm{[$\beta$ prior]}\\
\sigma &amp; \sim &amp; Exponential(1)  &amp; \textrm{[$\sigma$ prior]}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="rethinking-chapter-8.html#cb727-1" aria-hidden="true" tabindex="-1"></a>(rugged_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(data_rugged<span class="sc">$</span>rugged_std))</span></code></pre></div>
<pre><code>#&gt; [1] 0.2149601</code></pre>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="rethinking-chapter-8.html#cb729-1" aria-hidden="true" tabindex="-1"></a>model_rugged_draft <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb729-2"><a href="rethinking-chapter-8.html#cb729-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb729-3"><a href="rethinking-chapter-8.html#cb729-3" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb729-4"><a href="rethinking-chapter-8.html#cb729-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> ( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ),</span>
<span id="cb729-5"><a href="rethinking-chapter-8.html#cb729-5" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb729-6"><a href="rethinking-chapter-8.html#cb729-6" aria-hidden="true" tabindex="-1"></a>    beta <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb729-7"><a href="rethinking-chapter-8.html#cb729-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb729-8"><a href="rethinking-chapter-8.html#cb729-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb729-9"><a href="rethinking-chapter-8.html#cb729-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_rugged</span>
<span id="cb729-10"><a href="rethinking-chapter-8.html#cb729-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Prior predictions</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="rethinking-chapter-8.html#cb730-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb730-2"><a href="rethinking-chapter-8.html#cb730-2" aria-hidden="true" tabindex="-1"></a>rugged_priors <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(model_rugged_draft) <span class="sc">%&gt;%</span> </span>
<span id="cb730-3"><a href="rethinking-chapter-8.html#cb730-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb730-4"><a href="rethinking-chapter-8.html#cb730-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-5"><a href="rethinking-chapter-8.html#cb730-5" aria-hidden="true" tabindex="-1"></a>prior_prediction_range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">2</span>, <span class="fl">1.2</span>)</span>
<span id="cb730-6"><a href="rethinking-chapter-8.html#cb730-6" aria-hidden="true" tabindex="-1"></a>rugged_prior_predictions <span class="ot">&lt;-</span> <span class="fu">link</span>(model_rugged_draft,</span>
<span id="cb730-7"><a href="rethinking-chapter-8.html#cb730-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">post =</span> rugged_priors,</span>
<span id="cb730-8"><a href="rethinking-chapter-8.html#cb730-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> <span class="fu">list</span>(<span class="at">rugged_std =</span> prior_prediction_range)) <span class="sc">%&gt;%</span> </span>
<span id="cb730-9"><a href="rethinking-chapter-8.html#cb730-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb730-10"><a href="rethinking-chapter-8.html#cb730-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="at">nm =</span> <span class="fu">as.character</span>(prior_prediction_range)) <span class="sc">%&gt;%</span> </span>
<span id="cb730-11"><a href="rethinking-chapter-8.html#cb730-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.draw =</span> <span class="fu">row_number</span>())</span>
<span id="cb730-12"><a href="rethinking-chapter-8.html#cb730-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-13"><a href="rethinking-chapter-8.html#cb730-13" aria-hidden="true" tabindex="-1"></a>p_prior_draft <span class="ot">&lt;-</span> rugged_prior_predictions <span class="sc">%&gt;%</span> </span>
<span id="cb730-14"><a href="rethinking-chapter-8.html#cb730-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.draw <span class="sc">&lt;</span> <span class="dv">51</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb730-15"><a href="rethinking-chapter-8.html#cb730-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb730-16"><a href="rethinking-chapter-8.html#cb730-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>.<span class="dv">2</span>, <span class="at">xend =</span> <span class="fl">1.2</span>,</span>
<span id="cb730-17"><a href="rethinking-chapter-8.html#cb730-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">`</span><span class="at">-0.2</span><span class="st">`</span>, <span class="at">yend =</span> <span class="st">`</span><span class="at">1.2</span><span class="st">`</span>,</span>
<span id="cb730-18"><a href="rethinking-chapter-8.html#cb730-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">group =</span> .draw, <span class="at">color =</span> .draw <span class="sc">==</span><span class="dv">26</span>),</span>
<span id="cb730-19"><a href="rethinking-chapter-8.html#cb730-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">4</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb730-20"><a href="rethinking-chapter-8.html#cb730-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">glue</span>(<span class="st">&quot;{mth(&#39;\U03B1 \U007E&#39;)} Normal(1, 1)&lt;br&gt;{mth(&#39;\U03B2 \U007E&#39;)}  Normal(0, 1)&quot;</span>),</span>
<span id="cb730-21"><a href="rethinking-chapter-8.html#cb730-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;ruggedness_std&quot;</span>, </span>
<span id="cb730-22"><a href="rethinking-chapter-8.html#cb730-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log GDP (prop of mean)&quot;</span>) <span class="sc">+</span></span>
<span id="cb730-23"><a href="rethinking-chapter-8.html#cb730-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> <span class="ot">=</span> clr0d, <span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> <span class="ot">=</span> clr1), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p>Proportion of extreme slopes (<span class="math inline">\(\gt 0.6\)</span>) within the prior:</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="rethinking-chapter-8.html#cb731-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">abs</span>(rugged_priors<span class="sc">$</span>beta) <span class="sc">&gt;</span> .<span class="dv">6</span>) <span class="sc">/</span> <span class="fu">length</span>(rugged_priors<span class="sc">$</span>beta)</span></code></pre></div>
<pre><code>#&gt; [1] 0.534</code></pre>
<p>Restricting the priors for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> to more reasonable ranges:</p>
<p><span class="math display">\[
\begin{array}{rclr}
\alpha &amp; \sim &amp; Normal(1, 0.1) &amp; \textrm{[$\alpha$ prior]}\\
\beta &amp; \sim &amp; Normal(0, 0.3) &amp; \textrm{[$\beta$ prior]}\\
\end{array}
\]</span></p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="rethinking-chapter-8.html#cb733-1" aria-hidden="true" tabindex="-1"></a>model_rugged_restricted <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb733-2"><a href="rethinking-chapter-8.html#cb733-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb733-3"><a href="rethinking-chapter-8.html#cb733-3" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb733-4"><a href="rethinking-chapter-8.html#cb733-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> ( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ),</span>
<span id="cb733-5"><a href="rethinking-chapter-8.html#cb733-5" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb733-6"><a href="rethinking-chapter-8.html#cb733-6" aria-hidden="true" tabindex="-1"></a>    beta <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.3</span>),</span>
<span id="cb733-7"><a href="rethinking-chapter-8.html#cb733-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb733-8"><a href="rethinking-chapter-8.html#cb733-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb733-9"><a href="rethinking-chapter-8.html#cb733-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_rugged</span>
<span id="cb733-10"><a href="rethinking-chapter-8.html#cb733-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb733-11"><a href="rethinking-chapter-8.html#cb733-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-12"><a href="rethinking-chapter-8.html#cb733-12" aria-hidden="true" tabindex="-1"></a>rugged_restricted_priors <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(model_rugged_restricted) <span class="sc">%&gt;%</span> </span>
<span id="cb733-13"><a href="rethinking-chapter-8.html#cb733-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb733-14"><a href="rethinking-chapter-8.html#cb733-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-15"><a href="rethinking-chapter-8.html#cb733-15" aria-hidden="true" tabindex="-1"></a>rugged_restricted_prior_predictions <span class="ot">&lt;-</span> <span class="fu">link</span>(model_rugged_restricted,</span>
<span id="cb733-16"><a href="rethinking-chapter-8.html#cb733-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">post =</span> rugged_restricted_priors,</span>
<span id="cb733-17"><a href="rethinking-chapter-8.html#cb733-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> <span class="fu">list</span>(<span class="at">rugged_std =</span> prior_prediction_range)) <span class="sc">%&gt;%</span> </span>
<span id="cb733-18"><a href="rethinking-chapter-8.html#cb733-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb733-19"><a href="rethinking-chapter-8.html#cb733-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="at">nm =</span> <span class="fu">as.character</span>(prior_prediction_range)) <span class="sc">%&gt;%</span> </span>
<span id="cb733-20"><a href="rethinking-chapter-8.html#cb733-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.draw =</span> <span class="fu">row_number</span>())</span>
<span id="cb733-21"><a href="rethinking-chapter-8.html#cb733-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-22"><a href="rethinking-chapter-8.html#cb733-22" aria-hidden="true" tabindex="-1"></a>p_prior_restricted <span class="ot">&lt;-</span> rugged_restricted_prior_predictions <span class="sc">%&gt;%</span> </span>
<span id="cb733-23"><a href="rethinking-chapter-8.html#cb733-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.draw <span class="sc">&lt;</span> <span class="dv">51</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb733-24"><a href="rethinking-chapter-8.html#cb733-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()  <span class="sc">+</span></span>
<span id="cb733-25"><a href="rethinking-chapter-8.html#cb733-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>.<span class="dv">2</span>, <span class="at">xend =</span> <span class="fl">1.2</span>,</span>
<span id="cb733-26"><a href="rethinking-chapter-8.html#cb733-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">`</span><span class="at">-0.2</span><span class="st">`</span>, <span class="at">yend =</span> <span class="st">`</span><span class="at">1.2</span><span class="st">`</span>),</span>
<span id="cb733-27"><a href="rethinking-chapter-8.html#cb733-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> clr0d,</span>
<span id="cb733-28"><a href="rethinking-chapter-8.html#cb733-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">4</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb733-29"><a href="rethinking-chapter-8.html#cb733-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">glue</span>(<span class="st">&quot;{mth(&#39;\U03B1 \U007E&#39;)} Normal(1, 0.1)&lt;br&gt;{mth(&#39;\U03B2 \U007E&#39;)}  Normal(0, 0.3)&quot;</span>),</span>
<span id="cb733-30"><a href="rethinking-chapter-8.html#cb733-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;ruggedness_std&quot;</span>, </span>
<span id="cb733-31"><a href="rethinking-chapter-8.html#cb733-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log GDP (prop of mean)&quot;</span>) </span>
<span id="cb733-32"><a href="rethinking-chapter-8.html#cb733-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-33"><a href="rethinking-chapter-8.html#cb733-33" aria-hidden="true" tabindex="-1"></a>p_prior_draft <span class="sc">+</span> p_prior_restricted <span class="sc">+</span></span>
<span id="cb733-34"><a href="rethinking-chapter-8.html#cb733-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;a&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb733-35"><a href="rethinking-chapter-8.html#cb733-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">range</span>(data_rugged<span class="sc">$</span>log_gdp_std), </span>
<span id="cb733-36"><a href="rethinking-chapter-8.html#cb733-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">&amp;</span></span>
<span id="cb733-37"><a href="rethinking-chapter-8.html#cb733-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="fl">1.5</span>),</span>
<span id="cb733-38"><a href="rethinking-chapter-8.html#cb733-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">2</span>, <span class="fl">1.2</span>)) <span class="sc">&amp;</span></span>
<span id="cb733-39"><a href="rethinking-chapter-8.html#cb733-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_markdown</span>(),</span>
<span id="cb733-40"><a href="rethinking-chapter-8.html#cb733-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">family =</span> fnt_sel))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-6-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="rethinking-chapter-8.html#cb734-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_rugged_restricted) <span class="sc">%&gt;%</span> </span>
<span id="cb734-2"><a href="rethinking-chapter-8.html#cb734-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">1.00</td>
<td align="right">0.01</td>
<td align="right">0.98</td>
<td align="right">1.02</td>
</tr>
<tr class="even">
<td align="left">beta</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
<td align="right">-0.09</td>
<td align="right">0.09</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.14</td>
<td align="right">0.01</td>
<td align="right">0.12</td>
<td align="right">0.15</td>
</tr>
</tbody>
</table>
<div id="adding-an-index-variable-is-not-enough" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Adding an index variable is not enough</h3>
<p>Updating the model to include a index variable:</p>
<p><span class="math display">\[
\begin{array}{rclr}
\mu_{i} &amp; = &amp; \alpha_{CID[i]} + \beta (r_{i} - \overline{r}) &amp; \textrm{[linear model]}\\
\end{array}
\]</span></p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="rethinking-chapter-8.html#cb735-1" aria-hidden="true" tabindex="-1"></a>model_rugged_index <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb735-2"><a href="rethinking-chapter-8.html#cb735-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb735-3"><a href="rethinking-chapter-8.html#cb735-3" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb735-4"><a href="rethinking-chapter-8.html#cb735-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha[cont_idx] <span class="sc">+</span> beta <span class="sc">*</span> ( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ),</span>
<span id="cb735-5"><a href="rethinking-chapter-8.html#cb735-5" aria-hidden="true" tabindex="-1"></a>    alpha[cont_idx] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb735-6"><a href="rethinking-chapter-8.html#cb735-6" aria-hidden="true" tabindex="-1"></a>    beta <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.3</span>),</span>
<span id="cb735-7"><a href="rethinking-chapter-8.html#cb735-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb735-8"><a href="rethinking-chapter-8.html#cb735-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb735-9"><a href="rethinking-chapter-8.html#cb735-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_rugged</span>
<span id="cb735-10"><a href="rethinking-chapter-8.html#cb735-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb735-11"><a href="rethinking-chapter-8.html#cb735-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-12"><a href="rethinking-chapter-8.html#cb735-12" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(model_rugged_restricted,</span>
<span id="cb735-13"><a href="rethinking-chapter-8.html#cb735-13" aria-hidden="true" tabindex="-1"></a>        model_rugged_index)</span></code></pre></div>
<pre><code>#&gt;                              WAIC       SE    dWAIC      dSE    pWAIC
#&gt; model_rugged_index      -252.2759 15.30586  0.00000       NA 4.248819
#&gt; model_rugged_restricted -188.8157 13.20582 63.46027 15.12848 2.665296
#&gt;                              weight
#&gt; model_rugged_index      1.00000e+00
#&gt; model_rugged_restricted 1.65874e-14</code></pre>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="rethinking-chapter-8.html#cb737-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_rugged_index, <span class="at">depth =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb737-2"><a href="rethinking-chapter-8.html#cb737-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha[1]</td>
<td align="right">0.88</td>
<td align="right">0.02</td>
<td align="right">0.85</td>
<td align="right">0.91</td>
</tr>
<tr class="even">
<td align="left">alpha[2]</td>
<td align="right">1.05</td>
<td align="right">0.01</td>
<td align="right">1.03</td>
<td align="right">1.07</td>
</tr>
<tr class="odd">
<td align="left">beta</td>
<td align="right">-0.05</td>
<td align="right">0.05</td>
<td align="right">-0.12</td>
<td align="right">0.03</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.11</td>
<td align="right">0.01</td>
<td align="right">0.10</td>
<td align="right">0.12</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="rethinking-chapter-8.html#cb738-1" aria-hidden="true" tabindex="-1"></a>rugged_index_posterior <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_rugged_index) <span class="sc">%&gt;%</span> </span>
<span id="cb738-2"><a href="rethinking-chapter-8.html#cb738-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb738-3"><a href="rethinking-chapter-8.html#cb738-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> alpha[,<span class="dv">1</span> ] <span class="sc">-</span> alpha[,<span class="dv">2</span>])</span>
<span id="cb738-4"><a href="rethinking-chapter-8.html#cb738-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-5"><a href="rethinking-chapter-8.html#cb738-5" aria-hidden="true" tabindex="-1"></a><span class="fu">PI</span>(rugged_index_posterior<span class="sc">$</span>diff)</span></code></pre></div>
<pre><code>#&gt;         5%        94% 
#&gt; -0.1996424 -0.1382548</code></pre>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="rethinking-chapter-8.html#cb740-1" aria-hidden="true" tabindex="-1"></a>rugged_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span>.<span class="dv">01</span>, <span class="at">to =</span> <span class="fl">1.01</span>, <span class="at">length.out =</span> <span class="dv">51</span>)</span>
<span id="cb740-2"><a href="rethinking-chapter-8.html#cb740-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-3"><a href="rethinking-chapter-8.html#cb740-3" aria-hidden="true" tabindex="-1"></a>draw_posterior_samples <span class="ot">&lt;-</span> <span class="cf">function</span>(idx, model){</span>
<span id="cb740-4"><a href="rethinking-chapter-8.html#cb740-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">link</span>(model,</span>
<span id="cb740-5"><a href="rethinking-chapter-8.html#cb740-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">cont_idx =</span> idx, <span class="at">rugged_std =</span> rugged_range)) <span class="sc">%&gt;%</span> </span>
<span id="cb740-6"><a href="rethinking-chapter-8.html#cb740-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb740-7"><a href="rethinking-chapter-8.html#cb740-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="at">nm =</span> <span class="fu">as.character</span>(rugged_range)) <span class="sc">%&gt;%</span> </span>
<span id="cb740-8"><a href="rethinking-chapter-8.html#cb740-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb740-9"><a href="rethinking-chapter-8.html#cb740-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;log_gdp_std&quot;</span>,</span>
<span id="cb740-10"><a href="rethinking-chapter-8.html#cb740-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;rugged_std&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb740-11"><a href="rethinking-chapter-8.html#cb740-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cont_idx =</span> idx,</span>
<span id="cb740-12"><a href="rethinking-chapter-8.html#cb740-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">rugged_std =</span> <span class="fu">as.numeric</span>(rugged_std))</span>
<span id="cb740-13"><a href="rethinking-chapter-8.html#cb740-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb740-14"><a href="rethinking-chapter-8.html#cb740-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-15"><a href="rethinking-chapter-8.html#cb740-15" aria-hidden="true" tabindex="-1"></a>rugged_index_posterior <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">draw_posterior_samples</span>(<span class="dv">1</span>, <span class="at">model =</span> model_rugged_index),</span>
<span id="cb740-16"><a href="rethinking-chapter-8.html#cb740-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">draw_posterior_samples</span>(<span class="dv">2</span>, <span class="at">model =</span> model_rugged_index))</span>
<span id="cb740-17"><a href="rethinking-chapter-8.html#cb740-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-18"><a href="rethinking-chapter-8.html#cb740-18" aria-hidden="true" tabindex="-1"></a>rugged_index_posterior_pi <span class="ot">&lt;-</span> rugged_index_posterior <span class="sc">%&gt;%</span> </span>
<span id="cb740-19"><a href="rethinking-chapter-8.html#cb740-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(rugged_std, cont_idx) <span class="sc">%&gt;%</span> </span>
<span id="cb740-20"><a href="rethinking-chapter-8.html#cb740-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(log_gdp_std),</span>
<span id="cb740-21"><a href="rethinking-chapter-8.html#cb740-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_lower =</span> <span class="fu">PI</span>(log_gdp_std, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">1</span>],</span>
<span id="cb740-22"><a href="rethinking-chapter-8.html#cb740-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_upper =</span> <span class="fu">PI</span>(log_gdp_std, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb740-23"><a href="rethinking-chapter-8.html#cb740-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb740-24"><a href="rethinking-chapter-8.html#cb740-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-25"><a href="rethinking-chapter-8.html#cb740-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> rugged_std)) <span class="sc">+</span></span>
<span id="cb740-26"><a href="rethinking-chapter-8.html#cb740-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> rugged_index_posterior_pi, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb740-27"><a href="rethinking-chapter-8.html#cb740-27" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> mean, <span class="at">ymin =</span> PI_lower, <span class="at">ymax =</span> PI_upper,</span>
<span id="cb740-28"><a href="rethinking-chapter-8.html#cb740-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="fu">factor</span>(cont_idx), </span>
<span id="cb740-29"><a href="rethinking-chapter-8.html#cb740-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(<span class="fu">clr_lighten</span>(color)))),</span>
<span id="cb740-30"><a href="rethinking-chapter-8.html#cb740-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb740-31"><a href="rethinking-chapter-8.html#cb740-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_rugged,</span>
<span id="cb740-32"><a href="rethinking-chapter-8.html#cb740-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> log_gdp_std,</span>
<span id="cb740-33"><a href="rethinking-chapter-8.html#cb740-33" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="fu">factor</span>(cont_idx), </span>
<span id="cb740-34"><a href="rethinking-chapter-8.html#cb740-34" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(color))),</span>
<span id="cb740-35"><a href="rethinking-chapter-8.html#cb740-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb740-36"><a href="rethinking-chapter-8.html#cb740-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;log GDP (prop of mean)&quot;</span>) <span class="sc">+</span></span>
<span id="cb740-37"><a href="rethinking-chapter-8.html#cb740-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Continent&quot;</span>,</span>
<span id="cb740-38"><a href="rethinking-chapter-8.html#cb740-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> clr1, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> clr0dd),</span>
<span id="cb740-39"><a href="rethinking-chapter-8.html#cb740-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Africa&quot;</span>, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Other&quot;</span>))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-10-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="adding-an-interaction-does-work" class="section level3" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Adding an interaction does work</h3>
<p>Updating the model to also include a random slope:</p>
<p><span class="math display">\[
\begin{array}{rclr}
\mu_{i} &amp; = &amp; \alpha_{CID[i]} + \beta_{CID[i]} (r_{i} - \overline{r}) &amp; \textrm{[linear model]}\\
\end{array}
\]</span></p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="rethinking-chapter-8.html#cb741-1" aria-hidden="true" tabindex="-1"></a>model_rugged_slope <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb741-2"><a href="rethinking-chapter-8.html#cb741-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb741-3"><a href="rethinking-chapter-8.html#cb741-3" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb741-4"><a href="rethinking-chapter-8.html#cb741-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha[cont_idx] <span class="sc">+</span> beta[cont_idx] <span class="sc">*</span> ( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ),</span>
<span id="cb741-5"><a href="rethinking-chapter-8.html#cb741-5" aria-hidden="true" tabindex="-1"></a>    alpha[cont_idx] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb741-6"><a href="rethinking-chapter-8.html#cb741-6" aria-hidden="true" tabindex="-1"></a>    beta[cont_idx] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.3</span>),</span>
<span id="cb741-7"><a href="rethinking-chapter-8.html#cb741-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb741-8"><a href="rethinking-chapter-8.html#cb741-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb741-9"><a href="rethinking-chapter-8.html#cb741-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_rugged</span>
<span id="cb741-10"><a href="rethinking-chapter-8.html#cb741-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb741-11"><a href="rethinking-chapter-8.html#cb741-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb741-12"><a href="rethinking-chapter-8.html#cb741-12" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_rugged_slope, <span class="at">depth =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb741-13"><a href="rethinking-chapter-8.html#cb741-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha[1]</td>
<td align="right">0.89</td>
<td align="right">0.02</td>
<td align="right">0.86</td>
<td align="right">0.91</td>
</tr>
<tr class="even">
<td align="left">alpha[2]</td>
<td align="right">1.05</td>
<td align="right">0.01</td>
<td align="right">1.03</td>
<td align="right">1.07</td>
</tr>
<tr class="odd">
<td align="left">beta[1]</td>
<td align="right">0.13</td>
<td align="right">0.07</td>
<td align="right">0.01</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="left">beta[2]</td>
<td align="right">-0.14</td>
<td align="right">0.05</td>
<td align="right">-0.23</td>
<td align="right">-0.06</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.11</td>
<td align="right">0.01</td>
<td align="right">0.10</td>
<td align="right">0.12</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="rethinking-chapter-8.html#cb742-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(model_rugged_restricted,</span>
<span id="cb742-2"><a href="rethinking-chapter-8.html#cb742-2" aria-hidden="true" tabindex="-1"></a>        model_rugged_index,</span>
<span id="cb742-3"><a href="rethinking-chapter-8.html#cb742-3" aria-hidden="true" tabindex="-1"></a>        model_rugged_slope,</span>
<span id="cb742-4"><a href="rethinking-chapter-8.html#cb742-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">func =</span> PSIS) <span class="sc">%&gt;%</span> </span>
<span id="cb742-5"><a href="rethinking-chapter-8.html#cb742-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>(<span class="at">param_name =</span> <span class="st">&quot;model&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="right">PSIS</th>
<th align="right">SE</th>
<th align="right">dPSIS</th>
<th align="right">dSE</th>
<th align="right">pPSIS</th>
<th align="right">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">model_rugged_slope</td>
<td align="right">-258.72</td>
<td align="right">15.27</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">5.38</td>
<td align="right">0.96</td>
</tr>
<tr class="even">
<td align="left">model_rugged_index</td>
<td align="right">-252.31</td>
<td align="right">15.31</td>
<td align="right">6.41</td>
<td align="right">6.91</td>
<td align="right">4.21</td>
<td align="right">0.04</td>
</tr>
<tr class="odd">
<td align="left">model_rugged_restricted</td>
<td align="right">-188.75</td>
<td align="right">13.39</td>
<td align="right">69.97</td>
<td align="right">15.51</td>
<td align="right">2.71</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="rethinking-chapter-8.html#cb743-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb743-2"><a href="rethinking-chapter-8.html#cb743-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb743-3"><a href="rethinking-chapter-8.html#cb743-3" aria-hidden="true" tabindex="-1"></a>(data_rugged_psis <span class="ot">&lt;-</span> <span class="fu">PSIS</span>(model_rugged_slope, <span class="at">pointwise =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb743-4"><a href="rethinking-chapter-8.html#cb743-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb743-5"><a href="rethinking-chapter-8.html#cb743-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_rugged)) <span class="sc">%&gt;%</span> </span>
<span id="cb743-6"><a href="rethinking-chapter-8.html#cb743-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cont_idx), <span class="at">y =</span> k)) <span class="sc">+</span></span>
<span id="cb743-7"><a href="rethinking-chapter-8.html#cb743-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="co">#adjust = 1,</span></span>
<span id="cb743-8"><a href="rethinking-chapter-8.html#cb743-8" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(cont_idx),</span>
<span id="cb743-9"><a href="rethinking-chapter-8.html#cb743-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(color))))<span class="sc">+</span></span>
<span id="cb743-10"><a href="rethinking-chapter-8.html#cb743-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(k <span class="sc">&gt;</span> .<span class="dv">25</span>),</span>
<span id="cb743-11"><a href="rethinking-chapter-8.html#cb743-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> cont_idx <span class="sc">+</span> .<span class="dv">1</span>, <span class="at">label =</span> country),</span>
<span id="cb743-12"><a href="rethinking-chapter-8.html#cb743-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">family =</span> fnt_sel) <span class="sc">+</span></span>
<span id="cb743-13"><a href="rethinking-chapter-8.html#cb743-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Continent&quot;</span>,</span>
<span id="cb743-14"><a href="rethinking-chapter-8.html#cb743-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> clr1, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> clr0dd),</span>
<span id="cb743-15"><a href="rethinking-chapter-8.html#cb743-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Africa&quot;</span>, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Other&quot;</span>)) <span class="sc">+</span></span>
<span id="cb743-16"><a href="rethinking-chapter-8.html#cb743-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;continent&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-12-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="rethinking-chapter-8.html#cb744-1" aria-hidden="true" tabindex="-1"></a>rugged_slope_posterior <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">draw_posterior_samples</span>(<span class="dv">1</span>, <span class="at">model =</span> model_rugged_slope),</span>
<span id="cb744-2"><a href="rethinking-chapter-8.html#cb744-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">draw_posterior_samples</span>(<span class="dv">2</span>, <span class="at">model =</span> model_rugged_slope))</span>
<span id="cb744-3"><a href="rethinking-chapter-8.html#cb744-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb744-4"><a href="rethinking-chapter-8.html#cb744-4" aria-hidden="true" tabindex="-1"></a>rugged_slope_posterior_pi <span class="ot">&lt;-</span> rugged_slope_posterior <span class="sc">%&gt;%</span> </span>
<span id="cb744-5"><a href="rethinking-chapter-8.html#cb744-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(rugged_std, cont_idx) <span class="sc">%&gt;%</span> </span>
<span id="cb744-6"><a href="rethinking-chapter-8.html#cb744-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(log_gdp_std),</span>
<span id="cb744-7"><a href="rethinking-chapter-8.html#cb744-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_lower =</span> <span class="fu">PI</span>(log_gdp_std, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">1</span>],</span>
<span id="cb744-8"><a href="rethinking-chapter-8.html#cb744-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_upper =</span> <span class="fu">PI</span>(log_gdp_std, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb744-9"><a href="rethinking-chapter-8.html#cb744-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb744-10"><a href="rethinking-chapter-8.html#cb744-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb744-11"><a href="rethinking-chapter-8.html#cb744-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> rugged_std)) <span class="sc">+</span></span>
<span id="cb744-12"><a href="rethinking-chapter-8.html#cb744-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> rugged_slope_posterior_pi, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb744-13"><a href="rethinking-chapter-8.html#cb744-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> mean, <span class="at">ymin =</span> PI_lower, <span class="at">ymax =</span> PI_upper,</span>
<span id="cb744-14"><a href="rethinking-chapter-8.html#cb744-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="fu">factor</span>(cont_idx), </span>
<span id="cb744-15"><a href="rethinking-chapter-8.html#cb744-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(<span class="fu">clr_lighten</span>(color)))),</span>
<span id="cb744-16"><a href="rethinking-chapter-8.html#cb744-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb744-17"><a href="rethinking-chapter-8.html#cb744-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_rugged,</span>
<span id="cb744-18"><a href="rethinking-chapter-8.html#cb744-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> log_gdp_std,</span>
<span id="cb744-19"><a href="rethinking-chapter-8.html#cb744-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="fu">factor</span>(cont_idx), </span>
<span id="cb744-20"><a href="rethinking-chapter-8.html#cb744-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(color))),</span>
<span id="cb744-21"><a href="rethinking-chapter-8.html#cb744-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb744-22"><a href="rethinking-chapter-8.html#cb744-22" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> data_rugged_psis <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(k <span class="sc">&gt;</span> .<span class="dv">25</span>),</span>
<span id="cb744-23"><a href="rethinking-chapter-8.html#cb744-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> log_gdp_std,</span>
<span id="cb744-24"><a href="rethinking-chapter-8.html#cb744-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> rugged_std <span class="sc">+</span> .<span class="dv">1</span>,</span>
<span id="cb744-25"><a href="rethinking-chapter-8.html#cb744-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label =</span> country),</span>
<span id="cb744-26"><a href="rethinking-chapter-8.html#cb744-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">force =</span> <span class="dv">20</span>,</span>
<span id="cb744-27"><a href="rethinking-chapter-8.html#cb744-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">family =</span> fnt_sel) <span class="sc">+</span></span>
<span id="cb744-28"><a href="rethinking-chapter-8.html#cb744-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;log GDP (prop of mean)&quot;</span>) <span class="sc">+</span></span>
<span id="cb744-29"><a href="rethinking-chapter-8.html#cb744-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(cont_idx <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb744-30"><a href="rethinking-chapter-8.html#cb744-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Continent&quot;</span>,</span>
<span id="cb744-31"><a href="rethinking-chapter-8.html#cb744-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> clr1, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> clr0dd),</span>
<span id="cb744-32"><a href="rethinking-chapter-8.html#cb744-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Africa&quot;</span>, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Other&quot;</span>))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-13-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="symetry-of-interactions" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Symetry of Interactions</h2>
<p>Rewriting the linear model to highlight the symmetry between <em>conditional slope</em> and <em>conditional intercept</em>:</p>
<p><span class="math display">\[
\mu_{i} = \underbrace{(2 - CID_{i}) \big( \alpha_{1} + \beta_{1} (r_{i} - \overline{r}) \big)}_{CID[i] = 1} + \underbrace{(CID_{i} - 1) \big( \alpha_{2} + \beta_{2} (r_{i} - \overline{r}) \big)}_{CID[i] = 2}
\]</span></p>
<p>Plotting a counterfactual effect of comparing the association of <em>log GPD</em> with <em>being in Africa</em> while holding <em>ruggedness</em> constant:</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="rethinking-chapter-8.html#cb745-1" aria-hidden="true" tabindex="-1"></a>rugged_slope_posterior_delta <span class="ot">&lt;-</span> rugged_slope_posterior <span class="sc">%&gt;%</span> </span>
<span id="cb745-2"><a href="rethinking-chapter-8.html#cb745-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cont_idx, rugged_std) <span class="sc">%&gt;%</span> </span>
<span id="cb745-3"><a href="rethinking-chapter-8.html#cb745-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.draw =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb745-4"><a href="rethinking-chapter-8.html#cb745-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb745-5"><a href="rethinking-chapter-8.html#cb745-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> cont_idx,</span>
<span id="cb745-6"><a href="rethinking-chapter-8.html#cb745-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> log_gdp_std,</span>
<span id="cb745-7"><a href="rethinking-chapter-8.html#cb745-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">&quot;log_gdp_std_&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb745-8"><a href="rethinking-chapter-8.html#cb745-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">delta_log_gdp_std =</span> log_gdp_std_1 <span class="sc">-</span> log_gdp_std_2)</span>
<span id="cb745-9"><a href="rethinking-chapter-8.html#cb745-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-10"><a href="rethinking-chapter-8.html#cb745-10" aria-hidden="true" tabindex="-1"></a>rugged_slope_posterior_delta_pi <span class="ot">&lt;-</span> rugged_slope_posterior_delta <span class="sc">%&gt;%</span> </span>
<span id="cb745-11"><a href="rethinking-chapter-8.html#cb745-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rugged_std) <span class="sc">%&gt;%</span> </span>
<span id="cb745-12"><a href="rethinking-chapter-8.html#cb745-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(delta_log_gdp_std),</span>
<span id="cb745-13"><a href="rethinking-chapter-8.html#cb745-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_lower =</span> <span class="fu">PI</span>(delta_log_gdp_std, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">1</span>],</span>
<span id="cb745-14"><a href="rethinking-chapter-8.html#cb745-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_upper =</span> <span class="fu">PI</span>(delta_log_gdp_std, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb745-15"><a href="rethinking-chapter-8.html#cb745-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb745-16"><a href="rethinking-chapter-8.html#cb745-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-17"><a href="rethinking-chapter-8.html#cb745-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-18"><a href="rethinking-chapter-8.html#cb745-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> rugged_std)) <span class="sc">+</span></span>
<span id="cb745-19"><a href="rethinking-chapter-8.html#cb745-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> clr_dark, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb745-20"><a href="rethinking-chapter-8.html#cb745-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> rugged_slope_posterior_delta_pi, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb745-21"><a href="rethinking-chapter-8.html#cb745-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> mean, <span class="at">ymin =</span> PI_lower, <span class="at">ymax =</span> PI_upper),</span>
<span id="cb745-22"><a href="rethinking-chapter-8.html#cb745-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> clr0d, </span>
<span id="cb745-23"><a href="rethinking-chapter-8.html#cb745-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> fll0,</span>
<span id="cb745-24"><a href="rethinking-chapter-8.html#cb745-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb745-25"><a href="rethinking-chapter-8.html#cb745-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">y =</span> .<span class="dv">03</span> <span class="sc">*</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb745-26"><a href="rethinking-chapter-8.html#cb745-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">lab =</span> <span class="fu">c</span>(<span class="st">&quot;Africa lower GDP&quot;</span>,</span>
<span id="cb745-27"><a href="rethinking-chapter-8.html#cb745-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;Africa higher GDP&quot;</span>)),</span>
<span id="cb745-28"><a href="rethinking-chapter-8.html#cb745-28" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">01</span>, <span class="at">y =</span> y, <span class="at">label =</span> lab),</span>
<span id="cb745-29"><a href="rethinking-chapter-8.html#cb745-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> fnt_sel, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb745-30"><a href="rethinking-chapter-8.html#cb745-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;expected difference log GDP&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-14-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>… it it simultaneously consistent with the data and the model, that <em>the influence of ruggedness depends on the continent</em> <strong>and</strong> that <em>the influence of the continent depends on ruggedness</em>.</p>
</div>
<div id="continuous-interaction" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Continuous Interaction</h2>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="rethinking-chapter-8.html#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tulips)</span>
<span id="cb746-2"><a href="rethinking-chapter-8.html#cb746-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-3"><a href="rethinking-chapter-8.html#cb746-3" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(tulips) <span class="sc">%&gt;%</span> </span>
<span id="cb746-4"><a href="rethinking-chapter-8.html#cb746-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="left">histogram</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">bed</td>
<td align="right">NaN</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">water</td>
<td align="right">2.00</td>
<td align="right">0.83</td>
<td align="right">1.00</td>
<td align="right">3.00</td>
<td align="left">▇▁▁▁▇▁▁▁▁▇</td>
</tr>
<tr class="odd">
<td align="left">shade</td>
<td align="right">2.00</td>
<td align="right">0.83</td>
<td align="right">1.00</td>
<td align="right">3.00</td>
<td align="left">▇▁▁▁▇▁▁▁▁▇</td>
</tr>
<tr class="even">
<td align="left">blooms</td>
<td align="right">128.99</td>
<td align="right">92.68</td>
<td align="right">4.31</td>
<td align="right">280.79</td>
<td align="left">▅▇▇▂▃▁▁▁</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="rethinking-chapter-8.html#cb747-1" aria-hidden="true" tabindex="-1"></a>data_tulips <span class="ot">&lt;-</span> tulips <span class="sc">%&gt;%</span> </span>
<span id="cb747-2"><a href="rethinking-chapter-8.html#cb747-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb747-3"><a href="rethinking-chapter-8.html#cb747-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">blooms_std =</span> blooms <span class="sc">/</span> <span class="fu">max</span>(blooms),</span>
<span id="cb747-4"><a href="rethinking-chapter-8.html#cb747-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">water_cent =</span> water <span class="sc">-</span> <span class="fu">mean</span>(water),</span>
<span id="cb747-5"><a href="rethinking-chapter-8.html#cb747-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">shade_cent =</span> shade <span class="sc">-</span> <span class="fu">mean</span>(shade))</span></code></pre></div>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="rethinking-chapter-8.html#cb748-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(B <span class="sc">~</span> S <span class="sc">+</span> W,</span>
<span id="cb748-2"><a href="rethinking-chapter-8.html#cb748-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;S&quot;</span>),</span>
<span id="cb748-3"><a href="rethinking-chapter-8.html#cb748-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb748-4"><a href="rethinking-chapter-8.html#cb748-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb748-5"><a href="rethinking-chapter-8.html#cb748-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb748-6"><a href="rethinking-chapter-8.html#cb748-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;B&quot;</span>, <span class="st">&quot;response&quot;</span>,</span>
<span id="cb748-7"><a href="rethinking-chapter-8.html#cb748-7" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">if_else</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;W&quot;</span>, <span class="st">&quot;S&quot;</span>),</span>
<span id="cb748-8"><a href="rethinking-chapter-8.html#cb748-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;confounds&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb748-9"><a href="rethinking-chapter-8.html#cb748-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_dag</span>(<span class="at">clr_in =</span> clr3) <span class="sc">+</span></span>
<span id="cb748-10"><a href="rethinking-chapter-8.html#cb748-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">6</span>,</span>
<span id="cb748-11"><a href="rethinking-chapter-8.html#cb748-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">05</span>, <span class="fl">1.05</span>),</span>
<span id="cb748-12"><a href="rethinking-chapter-8.html#cb748-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(.<span class="dv">9</span>, <span class="fl">1.1</span>))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-16-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>We are going to build two models, one <em>without any interaction</em> and one <em>with</em>.</p>
<div id="model-without-interaction" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Model without Interaction</h3>
<p><span class="math display">\[
\begin{array}{rclr}
B_{i} &amp; \sim &amp; Normal( \mu_{i}, \sigma) &amp; \textrm{[likelihood]}\\
\mu_{i} &amp; = &amp; \alpha + \beta_{W} (W_{i} - \overline{W}) + \beta_{S} (S_{i} - \overline{S}) &amp; \textrm{[linear model]}\\
\alpha &amp; \sim &amp; Normal(0.5, 0.25) &amp; \textrm{[$\alpha$ prior]}\\
\beta_{W} &amp; \sim &amp; Normal(0, 0.25) &amp; \textrm{[$\beta_{W}$ prior]}\\
\beta_{S} &amp; \sim &amp; Normal(0, 0.25) &amp; \textrm{[$\beta_{S}$ prior]}\\
\sigma &amp; \sim &amp; Exponential(1)  &amp; \textrm{[$\sigma$ prior]}
\end{array}
\]</span></p>
<div class="think">
<p><strong>Considerations for the priors:</strong></p>
<p>Ranges assigned if we used <span class="math inline">\(alpha = Normal(0.5, 1)\)</span> instead:</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="rethinking-chapter-8.html#cb749-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e4</span>, <span class="fl">0.5</span>, <span class="dv">1</span>);  <span class="fu">sum</span>(alpha <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> alpha <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">length</span>(alpha)</span></code></pre></div>
<pre><code>#&gt; [1] 0.6251</code></pre>
<p>updating to a more restrictive prior (used in the model):</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="rethinking-chapter-8.html#cb751-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e4</span>, <span class="fl">0.5</span>, .<span class="dv">25</span>);  <span class="fu">sum</span>(alpha <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> alpha <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">length</span>(alpha)</span></code></pre></div>
<pre><code>#&gt; [1] 0.0498</code></pre>
</div>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="rethinking-chapter-8.html#cb753-1" aria-hidden="true" tabindex="-1"></a>model_tulips_simple <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb753-2"><a href="rethinking-chapter-8.html#cb753-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb753-3"><a href="rethinking-chapter-8.html#cb753-3" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb753-4"><a href="rethinking-chapter-8.html#cb753-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_w <span class="sc">*</span> water_cent <span class="sc">+</span> beta_s <span class="sc">*</span> shade_cent,</span>
<span id="cb753-5"><a href="rethinking-chapter-8.html#cb753-5" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(.<span class="dv">5</span>, .<span class="dv">25</span>),</span>
<span id="cb753-6"><a href="rethinking-chapter-8.html#cb753-6" aria-hidden="true" tabindex="-1"></a>    beta_w <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">25</span>),</span>
<span id="cb753-7"><a href="rethinking-chapter-8.html#cb753-7" aria-hidden="true" tabindex="-1"></a>    beta_s <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">25</span>),</span>
<span id="cb753-8"><a href="rethinking-chapter-8.html#cb753-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb753-9"><a href="rethinking-chapter-8.html#cb753-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb753-10"><a href="rethinking-chapter-8.html#cb753-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_tulips</span>
<span id="cb753-11"><a href="rethinking-chapter-8.html#cb753-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb753-12"><a href="rethinking-chapter-8.html#cb753-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb753-13"><a href="rethinking-chapter-8.html#cb753-13" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_tulips_simple) <span class="sc">%&gt;%</span> </span>
<span id="cb753-14"><a href="rethinking-chapter-8.html#cb753-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.36</td>
<td align="right">0.03</td>
<td align="right">0.31</td>
<td align="right">0.41</td>
</tr>
<tr class="even">
<td align="left">beta_w</td>
<td align="right">0.21</td>
<td align="right">0.04</td>
<td align="right">0.15</td>
<td align="right">0.26</td>
</tr>
<tr class="odd">
<td align="left">beta_s</td>
<td align="right">-0.11</td>
<td align="right">0.04</td>
<td align="right">-0.17</td>
<td align="right">-0.05</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.16</td>
<td align="right">0.02</td>
<td align="right">0.12</td>
<td align="right">0.19</td>
</tr>
</tbody>
</table>
</div>
<div id="model-with-interaction" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Model with Interaction</h3>
<p>Implementing the continuous interaction</p>
<p><span class="math display">\[
\begin{array}{rcl}
\mu_{i} &amp; = &amp; \alpha + \gamma_{W,i} \beta_{W} W_{i} + \beta_{S} S_{i} \\
\gamma_{W,i} &amp; = &amp; \beta_{W} + \beta_{WS} S_{i}\\
\end{array}
\]</span></p>
<p>which allows the substitution</p>
<p><span class="math display">\[
\begin{array}{rcl}
\mu_{i} &amp; = &amp; \alpha + \underbrace{(\beta_{W} + \beta_{WS} S_{i})}_{\gamma_{W,i} } \beta_{W} W_{i}  + \beta_{S} S_{i} \\
&amp; = &amp; \alpha + \beta_{W} W_{i}  + \beta_{S} S_{i} + \beta_{WS} W_{i} S_{i}\\
\end{array}
\]</span></p>
<p>Using this for the complete model:</p>
<p><span class="math display">\[
\begin{array}{rclr}
B_{i} &amp; \sim &amp; Normal( \mu_{i}, \sigma) &amp; \textrm{[likelihood]}\\
\mu_{i} &amp; = &amp; \alpha + \beta_{W} W_{i} + \beta_{S} S_{i} + \beta_{WS}  W_{i} S_{i} &amp; \textrm{[linear model]} \\
\alpha &amp; \sim &amp; Normal(0.5, 0.25) &amp; \textrm{[$\alpha$ prior]}\\
\beta_{W} &amp; \sim &amp; Normal(0, 0.25) &amp; \textrm{[$\beta_{W}$ prior]}\\
\beta_{S} &amp; \sim &amp; Normal(0, 0.25) &amp; \textrm{[$\beta_{S}$ prior]}\\
\beta_{WS} &amp; \sim &amp; Normal(0, 0.25) &amp; \textrm{[$\beta_{S}$ prior]}\\
\sigma &amp; \sim &amp; Exponential(1)  &amp; \textrm{[$\sigma$ prior]}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="rethinking-chapter-8.html#cb754-1" aria-hidden="true" tabindex="-1"></a>model_tulips_interaction <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb754-2"><a href="rethinking-chapter-8.html#cb754-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb754-3"><a href="rethinking-chapter-8.html#cb754-3" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb754-4"><a href="rethinking-chapter-8.html#cb754-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_w <span class="sc">*</span> water_cent <span class="sc">+</span> beta_s <span class="sc">*</span> shade_cent <span class="sc">+</span> beta_ws  <span class="sc">*</span> water_cent <span class="sc">*</span> shade_cent,</span>
<span id="cb754-5"><a href="rethinking-chapter-8.html#cb754-5" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(.<span class="dv">5</span>, .<span class="dv">25</span>),</span>
<span id="cb754-6"><a href="rethinking-chapter-8.html#cb754-6" aria-hidden="true" tabindex="-1"></a>    beta_w <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">25</span>),</span>
<span id="cb754-7"><a href="rethinking-chapter-8.html#cb754-7" aria-hidden="true" tabindex="-1"></a>    beta_s <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">25</span>),</span>
<span id="cb754-8"><a href="rethinking-chapter-8.html#cb754-8" aria-hidden="true" tabindex="-1"></a>    beta_ws <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">25</span>),</span>
<span id="cb754-9"><a href="rethinking-chapter-8.html#cb754-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb754-10"><a href="rethinking-chapter-8.html#cb754-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb754-11"><a href="rethinking-chapter-8.html#cb754-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_tulips</span>
<span id="cb754-12"><a href="rethinking-chapter-8.html#cb754-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb754-13"><a href="rethinking-chapter-8.html#cb754-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-14"><a href="rethinking-chapter-8.html#cb754-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_tulips_interaction) <span class="sc">%&gt;%</span> </span>
<span id="cb754-15"><a href="rethinking-chapter-8.html#cb754-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.36</td>
<td align="right">0.02</td>
<td align="right">0.32</td>
<td align="right">0.40</td>
</tr>
<tr class="even">
<td align="left">beta_w</td>
<td align="right">0.21</td>
<td align="right">0.03</td>
<td align="right">0.16</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">beta_s</td>
<td align="right">-0.11</td>
<td align="right">0.03</td>
<td align="right">-0.16</td>
<td align="right">-0.07</td>
</tr>
<tr class="even">
<td align="left">beta_ws</td>
<td align="right">-0.14</td>
<td align="right">0.04</td>
<td align="right">-0.20</td>
<td align="right">-0.09</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.12</td>
<td align="right">0.02</td>
<td align="right">0.10</td>
<td align="right">0.15</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting-the-posterior-predictions" class="section level3" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Plotting the Posterior Predictions</h3>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="rethinking-chapter-8.html#cb755-1" aria-hidden="true" tabindex="-1"></a>tulip_range <span class="ot">&lt;-</span> <span class="fu">cross_df</span>(<span class="fu">list</span>(<span class="at">water_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb755-2"><a href="rethinking-chapter-8.html#cb755-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">shade_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb755-3"><a href="rethinking-chapter-8.html#cb755-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rn =</span> <span class="fu">row_number</span>())</span>
<span id="cb755-4"><a href="rethinking-chapter-8.html#cb755-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb755-5"><a href="rethinking-chapter-8.html#cb755-5" aria-hidden="true" tabindex="-1"></a>tulips_simple_posterior <span class="ot">&lt;-</span> <span class="fu">link</span>(model_tulips_simple, <span class="at">data =</span> tulip_range) <span class="sc">%&gt;%</span> </span>
<span id="cb755-6"><a href="rethinking-chapter-8.html#cb755-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb755-7"><a href="rethinking-chapter-8.html#cb755-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="at">nm =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb755-8"><a href="rethinking-chapter-8.html#cb755-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.draw =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb755-9"><a href="rethinking-chapter-8.html#cb755-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>.draw, <span class="at">names_to =</span> <span class="st">&quot;rn&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;blooms&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb755-10"><a href="rethinking-chapter-8.html#cb755-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rn =</span> <span class="fu">as.numeric</span>(rn), <span class="at">model =</span> <span class="st">&quot;simple&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb755-11"><a href="rethinking-chapter-8.html#cb755-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tulip_range) </span>
<span id="cb755-12"><a href="rethinking-chapter-8.html#cb755-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb755-13"><a href="rethinking-chapter-8.html#cb755-13" aria-hidden="true" tabindex="-1"></a>tulips_interaction_posterior <span class="ot">&lt;-</span> <span class="fu">link</span>(model_tulips_interaction, <span class="at">data =</span> tulip_range) <span class="sc">%&gt;%</span> </span>
<span id="cb755-14"><a href="rethinking-chapter-8.html#cb755-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb755-15"><a href="rethinking-chapter-8.html#cb755-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="at">nm =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb755-16"><a href="rethinking-chapter-8.html#cb755-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.draw =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb755-17"><a href="rethinking-chapter-8.html#cb755-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>.draw, <span class="at">names_to =</span> <span class="st">&quot;rn&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;blooms&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb755-18"><a href="rethinking-chapter-8.html#cb755-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rn =</span> <span class="fu">as.numeric</span>(rn), <span class="at">model =</span> <span class="st">&quot;interaction&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb755-19"><a href="rethinking-chapter-8.html#cb755-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tulip_range) </span>
<span id="cb755-20"><a href="rethinking-chapter-8.html#cb755-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb755-21"><a href="rethinking-chapter-8.html#cb755-21" aria-hidden="true" tabindex="-1"></a>tulips_posterior <span class="ot">&lt;-</span> tulips_simple_posterior <span class="sc">%&gt;%</span> </span>
<span id="cb755-22"><a href="rethinking-chapter-8.html#cb755-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(tulips_interaction_posterior) <span class="sc">%&gt;%</span> </span>
<span id="cb755-23"><a href="rethinking-chapter-8.html#cb755-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(model, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;simple&quot;</span>, <span class="st">&quot;interaction&quot;</span>)))</span>
<span id="cb755-24"><a href="rethinking-chapter-8.html#cb755-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb755-25"><a href="rethinking-chapter-8.html#cb755-25" aria-hidden="true" tabindex="-1"></a>tulips_posterior_pi <span class="ot">&lt;-</span> tulips_posterior <span class="sc">%&gt;%</span> </span>
<span id="cb755-26"><a href="rethinking-chapter-8.html#cb755-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model, rn,water_cent, shade_cent ) <span class="sc">%&gt;%</span> </span>
<span id="cb755-27"><a href="rethinking-chapter-8.html#cb755-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(blooms),</span>
<span id="cb755-28"><a href="rethinking-chapter-8.html#cb755-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_lower =</span> <span class="fu">PI</span>(blooms, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">1</span>],</span>
<span id="cb755-29"><a href="rethinking-chapter-8.html#cb755-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_upper =</span> <span class="fu">PI</span>(blooms, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb755-30"><a href="rethinking-chapter-8.html#cb755-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb755-31"><a href="rethinking-chapter-8.html#cb755-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb755-32"><a href="rethinking-chapter-8.html#cb755-32" aria-hidden="true" tabindex="-1"></a>tulips_posterior <span class="sc">%&gt;%</span> </span>
<span id="cb755-33"><a href="rethinking-chapter-8.html#cb755-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> water_cent)) <span class="sc">+</span></span>
<span id="cb755-34"><a href="rethinking-chapter-8.html#cb755-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb755-35"><a href="rethinking-chapter-8.html#cb755-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(.draw <span class="sc">&lt;</span> <span class="dv">21</span>),</span>
<span id="cb755-36"><a href="rethinking-chapter-8.html#cb755-36" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> blooms ,</span>
<span id="cb755-37"><a href="rethinking-chapter-8.html#cb755-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> .draw, <span class="at">color =</span> .draw <span class="sc">==</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb755-38"><a href="rethinking-chapter-8.html#cb755-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_tulips, <span class="fu">aes</span>(<span class="at">y =</span> blooms_std),</span>
<span id="cb755-39"><a href="rethinking-chapter-8.html#cb755-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb755-40"><a href="rethinking-chapter-8.html#cb755-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(model <span class="sc">~</span> shade_cent, <span class="at">labeller =</span> label_both,<span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb755-41"><a href="rethinking-chapter-8.html#cb755-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> <span class="ot">=</span> fll0, <span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> <span class="ot">=</span> fll1)) <span class="sc">+</span></span>
<span id="cb755-42"><a href="rethinking-chapter-8.html#cb755-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb755-43"><a href="rethinking-chapter-8.html#cb755-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-21-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="rethinking-chapter-8.html#cb756-1" aria-hidden="true" tabindex="-1"></a>tulips_posterior_pi <span class="sc">%&gt;%</span> </span>
<span id="cb756-2"><a href="rethinking-chapter-8.html#cb756-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> water_cent)) <span class="sc">+</span></span>
<span id="cb756-3"><a href="rethinking-chapter-8.html#cb756-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_tulips, <span class="fu">aes</span>(<span class="at">y =</span> blooms_std),</span>
<span id="cb756-4"><a href="rethinking-chapter-8.html#cb756-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb756-5"><a href="rethinking-chapter-8.html#cb756-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb756-6"><a href="rethinking-chapter-8.html#cb756-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> mean, <span class="at">ymin =</span> PI_lower, <span class="at">ymax =</span> PI_upper),</span>
<span id="cb756-7"><a href="rethinking-chapter-8.html#cb756-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> clr0dd, <span class="at">fill =</span> <span class="fu">clr_alpha</span>(clr0dd), <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb756-8"><a href="rethinking-chapter-8.html#cb756-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(model <span class="sc">~</span> shade_cent, <span class="at">labeller =</span> label_both,<span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb756-9"><a href="rethinking-chapter-8.html#cb756-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb756-10"><a href="rethinking-chapter-8.html#cb756-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-22-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="plotting-the-prior-predictions" class="section level3" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Plotting the Prior Predictions</h3>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="rethinking-chapter-8.html#cb757-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb757-2"><a href="rethinking-chapter-8.html#cb757-2" aria-hidden="true" tabindex="-1"></a>tulips_simple_prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(model_tulips_simple,</span>
<span id="cb757-3"><a href="rethinking-chapter-8.html#cb757-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">data =</span> tulip_range) <span class="sc">%&gt;%</span> </span>
<span id="cb757-4"><a href="rethinking-chapter-8.html#cb757-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb757-5"><a href="rethinking-chapter-8.html#cb757-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.draw =</span> <span class="fu">row_number</span>(),</span>
<span id="cb757-6"><a href="rethinking-chapter-8.html#cb757-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">grid =</span> <span class="fu">rep</span>(<span class="fu">list</span>(<span class="fu">cross_df</span>(<span class="fu">list</span>(<span class="at">water_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb757-7"><a href="rethinking-chapter-8.html#cb757-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">shade_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>))), <span class="fu">n</span>()),</span>
<span id="cb757-8"><a href="rethinking-chapter-8.html#cb757-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span> <span class="st">&quot;simple&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb757-9"><a href="rethinking-chapter-8.html#cb757-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(grid) <span class="sc">%&gt;%</span> </span>
<span id="cb757-10"><a href="rethinking-chapter-8.html#cb757-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">blooms =</span> alpha <span class="sc">+</span> beta_w <span class="sc">*</span> water_cent <span class="sc">+</span> beta_s <span class="sc">*</span> shade_cent)</span>
<span id="cb757-11"><a href="rethinking-chapter-8.html#cb757-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb757-12"><a href="rethinking-chapter-8.html#cb757-12" aria-hidden="true" tabindex="-1"></a>tulips_interaction_prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(model_tulips_interaction,</span>
<span id="cb757-13"><a href="rethinking-chapter-8.html#cb757-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">data =</span> tulip_range) <span class="sc">%&gt;%</span> </span>
<span id="cb757-14"><a href="rethinking-chapter-8.html#cb757-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb757-15"><a href="rethinking-chapter-8.html#cb757-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.draw =</span> <span class="fu">row_number</span>(),</span>
<span id="cb757-16"><a href="rethinking-chapter-8.html#cb757-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">grid =</span> <span class="fu">rep</span>(<span class="fu">list</span>(<span class="fu">cross_df</span>(<span class="fu">list</span>(<span class="at">water_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb757-17"><a href="rethinking-chapter-8.html#cb757-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">shade_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>))), <span class="fu">n</span>()),</span>
<span id="cb757-18"><a href="rethinking-chapter-8.html#cb757-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span> <span class="st">&quot;interaction&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb757-19"><a href="rethinking-chapter-8.html#cb757-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(grid) <span class="sc">%&gt;%</span> </span>
<span id="cb757-20"><a href="rethinking-chapter-8.html#cb757-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">blooms =</span> alpha <span class="sc">+</span> beta_w <span class="sc">*</span> water_cent <span class="sc">+</span> beta_s <span class="sc">*</span> shade_cent <span class="sc">+</span> beta_ws  <span class="sc">*</span> water_cent <span class="sc">*</span> shade_cent)</span>
<span id="cb757-21"><a href="rethinking-chapter-8.html#cb757-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb757-22"><a href="rethinking-chapter-8.html#cb757-22" aria-hidden="true" tabindex="-1"></a>tulips_prior <span class="ot">&lt;-</span> tulips_simple_prior <span class="sc">%&gt;%</span> </span>
<span id="cb757-23"><a href="rethinking-chapter-8.html#cb757-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(tulips_interaction_prior) <span class="sc">%&gt;%</span> </span>
<span id="cb757-24"><a href="rethinking-chapter-8.html#cb757-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(model, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;simple&quot;</span>, <span class="st">&quot;interaction&quot;</span>)))</span>
<span id="cb757-25"><a href="rethinking-chapter-8.html#cb757-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb757-26"><a href="rethinking-chapter-8.html#cb757-26" aria-hidden="true" tabindex="-1"></a>tulips_prior_pi <span class="ot">&lt;-</span> tulips_prior <span class="sc">%&gt;%</span> </span>
<span id="cb757-27"><a href="rethinking-chapter-8.html#cb757-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model, water_cent, shade_cent ) <span class="sc">%&gt;%</span> </span>
<span id="cb757-28"><a href="rethinking-chapter-8.html#cb757-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(blooms),</span>
<span id="cb757-29"><a href="rethinking-chapter-8.html#cb757-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_lower =</span> <span class="fu">PI</span>(blooms, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">1</span>],</span>
<span id="cb757-30"><a href="rethinking-chapter-8.html#cb757-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_upper =</span> <span class="fu">PI</span>(blooms, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb757-31"><a href="rethinking-chapter-8.html#cb757-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb757-32"><a href="rethinking-chapter-8.html#cb757-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb757-33"><a href="rethinking-chapter-8.html#cb757-33" aria-hidden="true" tabindex="-1"></a>tulips_prior <span class="sc">%&gt;%</span></span>
<span id="cb757-34"><a href="rethinking-chapter-8.html#cb757-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> water_cent)) <span class="sc">+</span></span>
<span id="cb757-35"><a href="rethinking-chapter-8.html#cb757-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb757-36"><a href="rethinking-chapter-8.html#cb757-36" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(.draw <span class="sc">&lt;</span> <span class="dv">21</span>),</span>
<span id="cb757-37"><a href="rethinking-chapter-8.html#cb757-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> blooms ,</span>
<span id="cb757-38"><a href="rethinking-chapter-8.html#cb757-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> .draw, <span class="at">color =</span> .draw <span class="sc">==</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb757-39"><a href="rethinking-chapter-8.html#cb757-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb757-40"><a href="rethinking-chapter-8.html#cb757-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(model <span class="sc">~</span> shade_cent, <span class="at">labeller =</span> label_both, <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb757-41"><a href="rethinking-chapter-8.html#cb757-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">clr_alpha</span>(clr0d), <span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> <span class="ot">=</span> fll1)) <span class="sc">+</span></span>
<span id="cb757-42"><a href="rethinking-chapter-8.html#cb757-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb757-43"><a href="rethinking-chapter-8.html#cb757-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>) <span class="sc">+</span></span>
<span id="cb757-44"><a href="rethinking-chapter-8.html#cb757-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">35</span>,<span class="fl">1.35</span>))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-23-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="rethinking-chapter-8.html#cb758-1" aria-hidden="true" tabindex="-1"></a>tulips_prior_pi <span class="sc">%&gt;%</span> </span>
<span id="cb758-2"><a href="rethinking-chapter-8.html#cb758-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> water_cent)) <span class="sc">+</span></span>
<span id="cb758-3"><a href="rethinking-chapter-8.html#cb758-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb758-4"><a href="rethinking-chapter-8.html#cb758-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> mean, <span class="at">ymin =</span> PI_lower, <span class="at">ymax =</span> PI_upper),</span>
<span id="cb758-5"><a href="rethinking-chapter-8.html#cb758-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> clr0dd, <span class="at">fill =</span> <span class="fu">clr_alpha</span>(clr0dd), <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb758-6"><a href="rethinking-chapter-8.html#cb758-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb758-7"><a href="rethinking-chapter-8.html#cb758-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(model <span class="sc">~</span> shade_cent, <span class="at">labeller =</span> label_both,<span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb758-8"><a href="rethinking-chapter-8.html#cb758-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb758-9"><a href="rethinking-chapter-8.html#cb758-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-24-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="rethinking-chapter-8.html#cb759-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb759-2"><a href="rethinking-chapter-8.html#cb759-2" aria-hidden="true" tabindex="-1"></a>chapter8_models <span class="ot">&lt;-</span> <span class="fu">env</span>(</span>
<span id="cb759-3"><a href="rethinking-chapter-8.html#cb759-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_rugged =</span> data_rugged,</span>
<span id="cb759-4"><a href="rethinking-chapter-8.html#cb759-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_rugged_draft =</span> model_rugged_draft,</span>
<span id="cb759-5"><a href="rethinking-chapter-8.html#cb759-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_rugged_restricted =</span> model_rugged_restricted,</span>
<span id="cb759-6"><a href="rethinking-chapter-8.html#cb759-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_rugged_index =</span> model_rugged_index,</span>
<span id="cb759-7"><a href="rethinking-chapter-8.html#cb759-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_rugged_slope =</span> model_rugged_slope,</span>
<span id="cb759-8"><a href="rethinking-chapter-8.html#cb759-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_tulips =</span> data_tulips</span>
<span id="cb759-9"><a href="rethinking-chapter-8.html#cb759-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb759-10"><a href="rethinking-chapter-8.html#cb759-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb759-11"><a href="rethinking-chapter-8.html#cb759-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(chapter8_models, <span class="st">&quot;envs/chapter8_models.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="homework-6" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Homework</h2>
<p><strong>E1</strong></p>
<ol style="list-style-type: decimal">
<li>Bread dough rises because of <code>yeast * temperature</code></li>
<li><code>Education * country</code> leads to higher income</li>
<li><code>Gasoline * key</code> makes car go</li>
</ol>
<p><strong>E2</strong></p>
<p>Which ones of the following explanations invoke an interaction</p>
<ol style="list-style-type: decimal">
<li>Caramelizing onions requires cooking over low heat and making sure the onions do not dry out.</li>
<li>A car will go faster when it has more cylinders and when it has a better fuel injector.</li>
<li><del>Most people acquire their political beliefs from their parents, unless they get them instead from their friends.</del></li>
<li><del>Intelligent animals tend to be either highly social or have manipulative appendages (hands, tentacles, etc.).</del></li>
</ol>
<p><strong>E3</strong></p>
<p><span class="math display">\[
\begin{array}{rrcl}
1. &amp; caramel &amp; = &amp; \alpha + \beta_{temp} \times temp + \beta_{moist} \times moist + \beta_{drying} \times temp \times  moist\\
2. &amp; max\_speed &amp; = &amp; \alpha_{[cyl]} + \beta_{efficieny[cyl]} \times inject \\
3. &amp; polit &amp; = &amp; \alpha_{[influence\_group]} \\
4. &amp; intelligence &amp; = &amp; \alpha_{[appendages]} + beta_{sociality} \times sociality\\
\end{array}
\]</span></p>
<p><strong>M1</strong></p>
<p>This could be due to a three-way interaction, where the effect of <em>water on blooms</em> and of <em>light on blooms</em>, as well as the <em>interaction effect of water and light on blooms</em> also depend on temperature, with high temperature intervening negatively on all other effects.</p>
<p><strong>M2</strong></p>
<p><span class="math display">\[
\begin{array}{rcl}
\mu_{i} &amp; = &amp; \alpha_{[temp]} + \beta_{W[temp]} W_{i} + \beta_{S[temp]} S_{i} + \beta_{WS[temp]}  W_{i} S_{i}\\
\end{array}
\]</span></p>
<p>with</p>
<ul>
<li><span class="math inline">\(\alpha_{[hot]} = 0\)</span></li>
<li><span class="math inline">\(\beta_{W[hot]} = 0\)</span></li>
<li><span class="math inline">\(\beta_{S[hot]} = 0\)</span></li>
<li><span class="math inline">\(\beta_{WS[hot]} = 0\)</span></li>
</ul>
<p><strong>M3</strong></p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="rethinking-chapter-8.html#cb760-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">5e2</span></span>
<span id="cb760-2"><a href="rethinking-chapter-8.html#cb760-2" aria-hidden="true" tabindex="-1"></a>raven_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb760-3"><a href="rethinking-chapter-8.html#cb760-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">wolves_std =</span> <span class="fu">rep</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb760-4"><a href="rethinking-chapter-8.html#cb760-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">each =</span> n), <span class="co">#rbinom(n, size = 10, .45),</span></span>
<span id="cb760-5"><a href="rethinking-chapter-8.html#cb760-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">wolve_area =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n <span class="sc">*</span> <span class="dv">3</span>),</span>
<span id="cb760-6"><a href="rethinking-chapter-8.html#cb760-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">raven =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n <span class="sc">*</span> <span class="dv">3</span>,</span>
<span id="cb760-7"><a href="rethinking-chapter-8.html#cb760-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean =</span> wolves_std <span class="sc">+</span> wolve_area <span class="sc">/</span> wolves_std, <span class="at">sd =</span> <span class="fl">1.5</span>))</span>
<span id="cb760-8"><a href="rethinking-chapter-8.html#cb760-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb760-9"><a href="rethinking-chapter-8.html#cb760-9" aria-hidden="true" tabindex="-1"></a>raven_data <span class="sc">%&gt;%</span> </span>
<span id="cb760-10"><a href="rethinking-chapter-8.html#cb760-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> wolve_area, <span class="at">y =</span> raven)) <span class="sc">+</span></span>
<span id="cb760-11"><a href="rethinking-chapter-8.html#cb760-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">clr_alpha</span>(clr0d)) <span class="sc">+</span></span>
<span id="cb760-12"><a href="rethinking-chapter-8.html#cb760-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(wolves_std<span class="sc">~</span> ., <span class="at">labeller =</span> label_both)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/M3-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>There should be non-linear effects once the wolves deplete all their food sources.</p>
<p><strong>M4</strong></p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="rethinking-chapter-8.html#cb761-1" aria-hidden="true" tabindex="-1"></a>model_tulips_interaction_restricted <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb761-2"><a href="rethinking-chapter-8.html#cb761-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb761-3"><a href="rethinking-chapter-8.html#cb761-3" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb761-4"><a href="rethinking-chapter-8.html#cb761-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_w <span class="sc">*</span> water_cent <span class="sc">+</span> beta_s <span class="sc">*</span> shade_cent <span class="sc">+</span> beta_ws  <span class="sc">*</span> water_cent <span class="sc">*</span> shade_cent,</span>
<span id="cb761-5"><a href="rethinking-chapter-8.html#cb761-5" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(.<span class="dv">5</span>, .<span class="dv">25</span>),</span>
<span id="cb761-6"><a href="rethinking-chapter-8.html#cb761-6" aria-hidden="true" tabindex="-1"></a>    beta_w <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>,.<span class="dv">5</span>),</span>
<span id="cb761-7"><a href="rethinking-chapter-8.html#cb761-7" aria-hidden="true" tabindex="-1"></a>    beta_s <span class="sc">~</span> <span class="fu">dunif</span>(<span class="sc">-</span>.<span class="dv">5</span>,<span class="dv">0</span>),</span>
<span id="cb761-8"><a href="rethinking-chapter-8.html#cb761-8" aria-hidden="true" tabindex="-1"></a>    beta_ws <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">5</span>),</span>
<span id="cb761-9"><a href="rethinking-chapter-8.html#cb761-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb761-10"><a href="rethinking-chapter-8.html#cb761-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb761-11"><a href="rethinking-chapter-8.html#cb761-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_tulips,</span>
<span id="cb761-12"><a href="rethinking-chapter-8.html#cb761-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">beta_w =</span> .<span class="dv">25</span>,<span class="at">beta_s =</span> <span class="sc">-</span>.<span class="dv">25</span>, <span class="at">beta_ws =</span> .<span class="dv">2</span>)</span>
<span id="cb761-13"><a href="rethinking-chapter-8.html#cb761-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb761-14"><a href="rethinking-chapter-8.html#cb761-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb761-15"><a href="rethinking-chapter-8.html#cb761-15" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_tulips_interaction_restricted) <span class="sc">%&gt;%</span> </span>
<span id="cb761-16"><a href="rethinking-chapter-8.html#cb761-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">beta_w</td>
<td align="right">0.21</td>
<td align="right">0.03</td>
<td align="right">0.16</td>
<td align="right">0.26</td>
</tr>
<tr class="even">
<td align="left">beta_s</td>
<td align="right">-0.12</td>
<td align="right">0.03</td>
<td align="right">-0.16</td>
<td align="right">-0.07</td>
</tr>
<tr class="odd">
<td align="left">beta_ws</td>
<td align="right">-0.15</td>
<td align="right">0.04</td>
<td align="right">-0.20</td>
<td align="right">-0.09</td>
</tr>
<tr class="even">
<td align="left">alpha</td>
<td align="right">0.36</td>
<td align="right">0.02</td>
<td align="right">0.32</td>
<td align="right">0.40</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.12</td>
<td align="right">0.02</td>
<td align="right">0.10</td>
<td align="right">0.15</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="rethinking-chapter-8.html#cb762-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(5)</span></span>
<span id="cb762-2"><a href="rethinking-chapter-8.html#cb762-2" aria-hidden="true" tabindex="-1"></a>tulips_simple_prior_restricted <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(model_tulips_interaction_restricted,</span>
<span id="cb762-3"><a href="rethinking-chapter-8.html#cb762-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">data =</span> tulip_range) <span class="sc">%&gt;%</span> </span>
<span id="cb762-4"><a href="rethinking-chapter-8.html#cb762-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb762-5"><a href="rethinking-chapter-8.html#cb762-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.draw =</span> <span class="fu">row_number</span>(),</span>
<span id="cb762-6"><a href="rethinking-chapter-8.html#cb762-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">grid =</span> <span class="fu">rep</span>(<span class="fu">list</span>(<span class="fu">cross_df</span>(<span class="fu">list</span>(<span class="at">water_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb762-7"><a href="rethinking-chapter-8.html#cb762-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">shade_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>))), <span class="fu">n</span>()),</span>
<span id="cb762-8"><a href="rethinking-chapter-8.html#cb762-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span> <span class="st">&quot;simple&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb762-9"><a href="rethinking-chapter-8.html#cb762-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(grid) <span class="sc">%&gt;%</span> </span>
<span id="cb762-10"><a href="rethinking-chapter-8.html#cb762-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">blooms =</span> alpha <span class="sc">+</span> beta_w <span class="sc">*</span> water_cent <span class="sc">+</span> beta_s <span class="sc">*</span> shade_cent)</span>
<span id="cb762-11"><a href="rethinking-chapter-8.html#cb762-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb762-12"><a href="rethinking-chapter-8.html#cb762-12" aria-hidden="true" tabindex="-1"></a>tulips_interaction_prior_restricted <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(model_tulips_interaction_restricted,</span>
<span id="cb762-13"><a href="rethinking-chapter-8.html#cb762-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">data =</span> tulip_range) <span class="sc">%&gt;%</span> </span>
<span id="cb762-14"><a href="rethinking-chapter-8.html#cb762-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb762-15"><a href="rethinking-chapter-8.html#cb762-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.draw =</span> <span class="fu">row_number</span>(),</span>
<span id="cb762-16"><a href="rethinking-chapter-8.html#cb762-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">grid =</span> <span class="fu">rep</span>(<span class="fu">list</span>(<span class="fu">cross_df</span>(<span class="fu">list</span>(<span class="at">water_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb762-17"><a href="rethinking-chapter-8.html#cb762-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">shade_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>))), <span class="fu">n</span>()),</span>
<span id="cb762-18"><a href="rethinking-chapter-8.html#cb762-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span> <span class="st">&quot;interaction&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb762-19"><a href="rethinking-chapter-8.html#cb762-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(grid) <span class="sc">%&gt;%</span> </span>
<span id="cb762-20"><a href="rethinking-chapter-8.html#cb762-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">blooms =</span> alpha <span class="sc">+</span> beta_w <span class="sc">*</span> water_cent <span class="sc">+</span> beta_s <span class="sc">*</span> shade_cent <span class="sc">+</span> beta_ws  <span class="sc">*</span> water_cent <span class="sc">*</span> shade_cent)</span>
<span id="cb762-21"><a href="rethinking-chapter-8.html#cb762-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb762-22"><a href="rethinking-chapter-8.html#cb762-22" aria-hidden="true" tabindex="-1"></a>tulips_prior_restricted_pi <span class="ot">&lt;-</span> tulips_interaction_prior_restricted <span class="sc">%&gt;%</span> </span>
<span id="cb762-23"><a href="rethinking-chapter-8.html#cb762-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>( water_cent, shade_cent ) <span class="sc">%&gt;%</span> </span>
<span id="cb762-24"><a href="rethinking-chapter-8.html#cb762-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(blooms),</span>
<span id="cb762-25"><a href="rethinking-chapter-8.html#cb762-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_lower =</span> <span class="fu">PI</span>(blooms, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">1</span>],</span>
<span id="cb762-26"><a href="rethinking-chapter-8.html#cb762-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_upper =</span> <span class="fu">PI</span>(blooms, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb762-27"><a href="rethinking-chapter-8.html#cb762-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb762-28"><a href="rethinking-chapter-8.html#cb762-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb762-29"><a href="rethinking-chapter-8.html#cb762-29" aria-hidden="true" tabindex="-1"></a>tulips_interaction_prior_restricted <span class="sc">%&gt;%</span></span>
<span id="cb762-30"><a href="rethinking-chapter-8.html#cb762-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> water_cent)) <span class="sc">+</span></span>
<span id="cb762-31"><a href="rethinking-chapter-8.html#cb762-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb762-32"><a href="rethinking-chapter-8.html#cb762-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(.draw <span class="sc">&lt;</span> <span class="dv">41</span>),</span>
<span id="cb762-33"><a href="rethinking-chapter-8.html#cb762-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> blooms ,</span>
<span id="cb762-34"><a href="rethinking-chapter-8.html#cb762-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> .draw, <span class="at">color =</span> .draw <span class="sc">==</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb762-35"><a href="rethinking-chapter-8.html#cb762-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb762-36"><a href="rethinking-chapter-8.html#cb762-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> shade_cent, <span class="at">labeller =</span> label_both, <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb762-37"><a href="rethinking-chapter-8.html#cb762-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">clr_alpha</span>(clr0d), <span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> <span class="ot">=</span> fll1)) <span class="sc">+</span></span>
<span id="cb762-38"><a href="rethinking-chapter-8.html#cb762-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb762-39"><a href="rethinking-chapter-8.html#cb762-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>) <span class="sc">+</span></span>
<span id="cb762-40"><a href="rethinking-chapter-8.html#cb762-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">35</span>,<span class="fl">1.35</span>))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/M4-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H1</strong></p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="rethinking-chapter-8.html#cb763-1" aria-hidden="true" tabindex="-1"></a>model_tulips_bed_plain <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb763-2"><a href="rethinking-chapter-8.html#cb763-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb763-3"><a href="rethinking-chapter-8.html#cb763-3" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb763-4"><a href="rethinking-chapter-8.html#cb763-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha[bed] <span class="sc">+</span> beta_w <span class="sc">*</span> water_cent <span class="sc">+</span> beta_s <span class="sc">*</span> shade_cent <span class="sc">+</span> beta_ws  <span class="sc">*</span> water_cent <span class="sc">*</span> shade_cent,</span>
<span id="cb763-5"><a href="rethinking-chapter-8.html#cb763-5" aria-hidden="true" tabindex="-1"></a>    alpha[bed] <span class="sc">~</span> <span class="fu">dnorm</span>(.<span class="dv">5</span>, .<span class="dv">25</span>),</span>
<span id="cb763-6"><a href="rethinking-chapter-8.html#cb763-6" aria-hidden="true" tabindex="-1"></a>    beta_w <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">25</span>),</span>
<span id="cb763-7"><a href="rethinking-chapter-8.html#cb763-7" aria-hidden="true" tabindex="-1"></a>    beta_s <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">25</span>),</span>
<span id="cb763-8"><a href="rethinking-chapter-8.html#cb763-8" aria-hidden="true" tabindex="-1"></a>    beta_ws <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">25</span>),</span>
<span id="cb763-9"><a href="rethinking-chapter-8.html#cb763-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb763-10"><a href="rethinking-chapter-8.html#cb763-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb763-11"><a href="rethinking-chapter-8.html#cb763-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_tulips</span>
<span id="cb763-12"><a href="rethinking-chapter-8.html#cb763-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb763-13"><a href="rethinking-chapter-8.html#cb763-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb763-14"><a href="rethinking-chapter-8.html#cb763-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_tulips_bed_plain, <span class="at">depth =</span> <span class="dv">2</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb763-15"><a href="rethinking-chapter-8.html#cb763-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha[1]</td>
<td align="right">0.27</td>
<td align="right">0.04</td>
<td align="right">0.22</td>
<td align="right">0.33</td>
</tr>
<tr class="even">
<td align="left">alpha[2]</td>
<td align="right">0.40</td>
<td align="right">0.04</td>
<td align="right">0.34</td>
<td align="right">0.45</td>
</tr>
<tr class="odd">
<td align="left">alpha[3]</td>
<td align="right">0.41</td>
<td align="right">0.04</td>
<td align="right">0.35</td>
<td align="right">0.47</td>
</tr>
<tr class="even">
<td align="left">beta_w</td>
<td align="right">0.21</td>
<td align="right">0.03</td>
<td align="right">0.17</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">beta_s</td>
<td align="right">-0.11</td>
<td align="right">0.03</td>
<td align="right">-0.15</td>
<td align="right">-0.07</td>
</tr>
<tr class="even">
<td align="left">beta_ws</td>
<td align="right">-0.14</td>
<td align="right">0.03</td>
<td align="right">-0.19</td>
<td align="right">-0.09</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.11</td>
<td align="right">0.01</td>
<td align="right">0.08</td>
<td align="right">0.13</td>
</tr>
</tbody>
</table>
<p><strong>H2</strong></p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="rethinking-chapter-8.html#cb764-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(model_tulips_interaction,</span>
<span id="cb764-2"><a href="rethinking-chapter-8.html#cb764-2" aria-hidden="true" tabindex="-1"></a>        model_tulips_bed_plain) <span class="sc">%&gt;%</span> </span>
<span id="cb764-3"><a href="rethinking-chapter-8.html#cb764-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>(<span class="at">param_name =</span> <span class="st">&quot;model&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="right">WAIC</th>
<th align="right">SE</th>
<th align="right">dWAIC</th>
<th align="right">dSE</th>
<th align="right">pWAIC</th>
<th align="right">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">model_tulips_bed_plain</td>
<td align="right">-22.98</td>
<td align="right">9.96</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">9.94</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="left">model_tulips_interaction</td>
<td align="right">-22.03</td>
<td align="right">10.49</td>
<td align="right">0.95</td>
<td align="right">7.8</td>
<td align="right">6.63</td>
<td align="right">0.38</td>
</tr>
</tbody>
</table>
<p>There seems to be some preference for the model including <code>bed</code>, but the weight is only at ~66% and the SEs are quite large compared to the <span class="math inline">\(\Delta WAIC\)</span>.</p>
<p>posterior distributions of the model parameters</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="rethinking-chapter-8.html#cb765-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb765-2"><a href="rethinking-chapter-8.html#cb765-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes.rethinking)</span>
<span id="cb765-3"><a href="rethinking-chapter-8.html#cb765-3" aria-hidden="true" tabindex="-1"></a>model_tulips_bed_plain <span class="sc">%&gt;%</span></span>
<span id="cb765-4"><a href="rethinking-chapter-8.html#cb765-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recover_types</span>(data_tulips) <span class="sc">%&gt;%</span></span>
<span id="cb765-5"><a href="rethinking-chapter-8.html#cb765-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(alpha[bed], beta_w, beta_s, beta_ws) <span class="sc">%&gt;%</span></span>
<span id="cb765-6"><a href="rethinking-chapter-8.html#cb765-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.chain, <span class="sc">-</span>.iteration) <span class="sc">%&gt;%</span> </span>
<span id="cb765-7"><a href="rethinking-chapter-8.html#cb765-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(bed, .draw),</span>
<span id="cb765-8"><a href="rethinking-chapter-8.html#cb765-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb765-9"><a href="rethinking-chapter-8.html#cb765-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> bed, <span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb765-10"><a href="rethinking-chapter-8.html#cb765-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_vline(xintercept = 0, linetype = 3, color = clr_dark) +</span></span>
<span id="cb765-11"><a href="rethinking-chapter-8.html#cb765-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">color =</span> clr_dark,<span class="fu">aes</span>( <span class="at">fill =</span> parameter)) <span class="sc">+</span></span>
<span id="cb765-12"><a href="rethinking-chapter-8.html#cb765-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(parameter <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb765-13"><a href="rethinking-chapter-8.html#cb765-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(fll0,fll1,fll2,fll3), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-25-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>The improvement of the bed model seems to stem from the fact that tulips in the ‘a’ treatment tend to have a lower blooming score.</p>
<p>posterior predictive</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="rethinking-chapter-8.html#cb766-1" aria-hidden="true" tabindex="-1"></a>model_tulips_bed_plain <span class="sc">%&gt;%</span></span>
<span id="cb766-2"><a href="rethinking-chapter-8.html#cb766-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recover_types</span>(data_tulips) <span class="sc">%&gt;%</span></span>
<span id="cb766-3"><a href="rethinking-chapter-8.html#cb766-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(alpha[bed], beta_w, beta_s, beta_ws) <span class="sc">%&gt;%</span></span>
<span id="cb766-4"><a href="rethinking-chapter-8.html#cb766-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.chain, <span class="sc">-</span>.iteration) <span class="sc">%&gt;%</span> </span>
<span id="cb766-5"><a href="rethinking-chapter-8.html#cb766-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_data =</span> <span class="fu">list</span>(<span class="fu">crossing</span>(<span class="at">water_cent =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">shade_cent =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb766-6"><a href="rethinking-chapter-8.html#cb766-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(new_data) <span class="sc">%&gt;%</span> </span>
<span id="cb766-7"><a href="rethinking-chapter-8.html#cb766-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">blooms =</span> alpha <span class="sc">+</span></span>
<span id="cb766-8"><a href="rethinking-chapter-8.html#cb766-8" aria-hidden="true" tabindex="-1"></a>           beta_w <span class="sc">*</span> water_cent <span class="sc">+</span></span>
<span id="cb766-9"><a href="rethinking-chapter-8.html#cb766-9" aria-hidden="true" tabindex="-1"></a>           beta_s <span class="sc">*</span> shade_cent <span class="sc">+</span></span>
<span id="cb766-10"><a href="rethinking-chapter-8.html#cb766-10" aria-hidden="true" tabindex="-1"></a>           beta_ws <span class="sc">*</span> water_cent <span class="sc">*</span> shade_cent) <span class="sc">%&gt;%</span> </span>
<span id="cb766-11"><a href="rethinking-chapter-8.html#cb766-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> water_cent)) <span class="sc">+</span></span>
<span id="cb766-12"><a href="rethinking-chapter-8.html#cb766-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb766-13"><a href="rethinking-chapter-8.html#cb766-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(bed) <span class="sc">%&gt;%</span> </span>
<span id="cb766-14"><a href="rethinking-chapter-8.html#cb766-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(.draw <span class="sc">&lt;</span> <span class="dv">51</span>) <span class="sc">%&gt;%</span></span>
<span id="cb766-15"><a href="rethinking-chapter-8.html#cb766-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ungroup</span>(),</span>
<span id="cb766-16"><a href="rethinking-chapter-8.html#cb766-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> blooms ,</span>
<span id="cb766-17"><a href="rethinking-chapter-8.html#cb766-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="fu">str_c</span>(shade_cent, .draw), <span class="at">color =</span> .draw <span class="sc">==</span> <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb766-18"><a href="rethinking-chapter-8.html#cb766-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_tulips, <span class="fu">aes</span>(<span class="at">y =</span> blooms_std),</span>
<span id="cb766-19"><a href="rethinking-chapter-8.html#cb766-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb766-20"><a href="rethinking-chapter-8.html#cb766-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(shade_cent <span class="sc">~</span> bed, <span class="at">labeller =</span> label_both,<span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb766-21"><a href="rethinking-chapter-8.html#cb766-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> <span class="ot">=</span> fll0, <span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> <span class="ot">=</span> fll1)) <span class="sc">+</span></span>
<span id="cb766-22"><a href="rethinking-chapter-8.html#cb766-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb766-23"><a href="rethinking-chapter-8.html#cb766-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-26-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H3</strong></p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="rethinking-chapter-8.html#cb767-1" aria-hidden="true" tabindex="-1"></a>psis_k <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">waic_penalty =</span> (<span class="cf">function</span>(){</span>
<span id="cb767-2"><a href="rethinking-chapter-8.html#cb767-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">set.seed</span>(<span class="dv">23</span>))</span>
<span id="cb767-3"><a href="rethinking-chapter-8.html#cb767-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">WAIC</span>(model_rugged_slope, <span class="at">pointwise =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>penalty})(),</span>
<span id="cb767-4"><a href="rethinking-chapter-8.html#cb767-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">psis_k =</span> (<span class="cf">function</span>(){</span>
<span id="cb767-5"><a href="rethinking-chapter-8.html#cb767-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="fu">set.seed</span>(<span class="dv">23</span>))</span>
<span id="cb767-6"><a href="rethinking-chapter-8.html#cb767-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">PSIS</span>(model_rugged_slope, <span class="at">pointwise =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>k})(),</span>
<span id="cb767-7"><a href="rethinking-chapter-8.html#cb767-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">country =</span> data_rugged<span class="sc">$</span>country,</span>
<span id="cb767-8"><a href="rethinking-chapter-8.html#cb767-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cont_africa =</span> data_rugged<span class="sc">$</span>cont_africa</span>
<span id="cb767-9"><a href="rethinking-chapter-8.html#cb767-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb767-10"><a href="rethinking-chapter-8.html#cb767-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb767-11"><a href="rethinking-chapter-8.html#cb767-11" aria-hidden="true" tabindex="-1"></a> psis_k <span class="sc">%&gt;%</span> </span>
<span id="cb767-12"><a href="rethinking-chapter-8.html#cb767-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> psis_k ,<span class="at">y =</span> waic_penalty)) <span class="sc">+</span></span>
<span id="cb767-13"><a href="rethinking-chapter-8.html#cb767-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> clr_dark, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb767-14"><a href="rethinking-chapter-8.html#cb767-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> clr0dd, <span class="at">fill =</span> fll0) <span class="sc">+</span></span>
<span id="cb767-15"><a href="rethinking-chapter-8.html#cb767-15" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> psis_k,</span>
<span id="cb767-16"><a href="rethinking-chapter-8.html#cb767-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> psis_k, <span class="at">label =</span> country),</span>
<span id="cb767-17"><a href="rethinking-chapter-8.html#cb767-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;Josefin Sans&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, <span class="at">max.overlaps =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb767-18"><a href="rethinking-chapter-8.html#cb767-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(cont_africa <span class="sc">~</span> . ) <span class="sc">+</span></span>
<span id="cb767-19"><a href="rethinking-chapter-8.html#cb767-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;gaussian&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/H3-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>The Seychelles, Tajikistan and Switzerland seem to be the most influential points.
All of those have a very rugged topography and extreme GDP values (both positive and negative)</p>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="rethinking-chapter-8.html#cb768-1" aria-hidden="true" tabindex="-1"></a>model_rugged_robust <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb768-2"><a href="rethinking-chapter-8.html#cb768-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb768-3"><a href="rethinking-chapter-8.html#cb768-3" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dstudent</span>(<span class="at">nu =</span> <span class="dv">2</span>, mu, sigma),</span>
<span id="cb768-4"><a href="rethinking-chapter-8.html#cb768-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha[cont_idx] <span class="sc">+</span> beta[cont_idx] <span class="sc">*</span> ( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ),</span>
<span id="cb768-5"><a href="rethinking-chapter-8.html#cb768-5" aria-hidden="true" tabindex="-1"></a>    alpha[cont_idx] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb768-6"><a href="rethinking-chapter-8.html#cb768-6" aria-hidden="true" tabindex="-1"></a>    beta[cont_idx] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.3</span>),</span>
<span id="cb768-7"><a href="rethinking-chapter-8.html#cb768-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb768-8"><a href="rethinking-chapter-8.html#cb768-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb768-9"><a href="rethinking-chapter-8.html#cb768-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_rugged</span>
<span id="cb768-10"><a href="rethinking-chapter-8.html#cb768-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb768-11"><a href="rethinking-chapter-8.html#cb768-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb768-12"><a href="rethinking-chapter-8.html#cb768-12" aria-hidden="true" tabindex="-1"></a>psis_k_robust <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">waic_penalty =</span> (<span class="cf">function</span>(){</span>
<span id="cb768-13"><a href="rethinking-chapter-8.html#cb768-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">set.seed</span>(<span class="dv">23</span>))</span>
<span id="cb768-14"><a href="rethinking-chapter-8.html#cb768-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">WAIC</span>(model_rugged_robust, <span class="at">pointwise =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>penalty})(),</span>
<span id="cb768-15"><a href="rethinking-chapter-8.html#cb768-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">psis_k =</span> (<span class="cf">function</span>(){</span>
<span id="cb768-16"><a href="rethinking-chapter-8.html#cb768-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="fu">set.seed</span>(<span class="dv">23</span>))</span>
<span id="cb768-17"><a href="rethinking-chapter-8.html#cb768-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">PSIS</span>(model_rugged_robust, <span class="at">pointwise =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>k})(),</span>
<span id="cb768-18"><a href="rethinking-chapter-8.html#cb768-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">country =</span> data_rugged<span class="sc">$</span>country,</span>
<span id="cb768-19"><a href="rethinking-chapter-8.html#cb768-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">cont_africa =</span> data_rugged<span class="sc">$</span>cont_africa</span>
<span id="cb768-20"><a href="rethinking-chapter-8.html#cb768-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb768-21"><a href="rethinking-chapter-8.html#cb768-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb768-22"><a href="rethinking-chapter-8.html#cb768-22" aria-hidden="true" tabindex="-1"></a> psis_k_robust <span class="sc">%&gt;%</span> </span>
<span id="cb768-23"><a href="rethinking-chapter-8.html#cb768-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> psis_k ,<span class="at">y =</span> waic_penalty)) <span class="sc">+</span></span>
<span id="cb768-24"><a href="rethinking-chapter-8.html#cb768-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> clr_dark, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb768-25"><a href="rethinking-chapter-8.html#cb768-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> clr1, <span class="at">fill =</span> fll1) <span class="sc">+</span></span>
<span id="cb768-26"><a href="rethinking-chapter-8.html#cb768-26" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> psis_k_robust,</span>
<span id="cb768-27"><a href="rethinking-chapter-8.html#cb768-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> psis_k, <span class="at">label =</span> country),</span>
<span id="cb768-28"><a href="rethinking-chapter-8.html#cb768-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;Josefin Sans&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, <span class="at">max.overlaps =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb768-29"><a href="rethinking-chapter-8.html#cb768-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(cont_africa <span class="sc">~</span> . ) <span class="sc">+</span></span>
<span id="cb768-30"><a href="rethinking-chapter-8.html#cb768-30" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;student-t&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-27-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="rethinking-chapter-8.html#cb769-1" aria-hidden="true" tabindex="-1"></a>rugged_slope_posterior_robust <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb769-2"><a href="rethinking-chapter-8.html#cb769-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_posterior_samples</span>(<span class="dv">1</span>, <span class="at">model =</span> model_rugged_robust),</span>
<span id="cb769-3"><a href="rethinking-chapter-8.html#cb769-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_posterior_samples</span>(<span class="dv">2</span>, <span class="at">model =</span> model_rugged_robust))</span>
<span id="cb769-4"><a href="rethinking-chapter-8.html#cb769-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb769-5"><a href="rethinking-chapter-8.html#cb769-5" aria-hidden="true" tabindex="-1"></a>rugged_slope_posterior_robust_pi <span class="ot">&lt;-</span> rugged_slope_posterior_robust <span class="sc">%&gt;%</span> </span>
<span id="cb769-6"><a href="rethinking-chapter-8.html#cb769-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(rugged_std, cont_idx) <span class="sc">%&gt;%</span> </span>
<span id="cb769-7"><a href="rethinking-chapter-8.html#cb769-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(log_gdp_std),</span>
<span id="cb769-8"><a href="rethinking-chapter-8.html#cb769-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_lower =</span> <span class="fu">PI</span>(log_gdp_std, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">1</span>],</span>
<span id="cb769-9"><a href="rethinking-chapter-8.html#cb769-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">PI_upper =</span> <span class="fu">PI</span>(log_gdp_std, <span class="at">prob =</span> .<span class="dv">97</span>)[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb769-10"><a href="rethinking-chapter-8.html#cb769-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb769-11"><a href="rethinking-chapter-8.html#cb769-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb769-12"><a href="rethinking-chapter-8.html#cb769-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> rugged_std)) <span class="sc">+</span></span>
<span id="cb769-13"><a href="rethinking-chapter-8.html#cb769-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> rugged_slope_posterior_robust_pi, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb769-14"><a href="rethinking-chapter-8.html#cb769-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> mean, <span class="at">ymin =</span> PI_lower, <span class="at">ymax =</span> PI_upper,</span>
<span id="cb769-15"><a href="rethinking-chapter-8.html#cb769-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="fu">factor</span>(cont_idx), </span>
<span id="cb769-16"><a href="rethinking-chapter-8.html#cb769-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(<span class="fu">clr_lighten</span>(color)))),</span>
<span id="cb769-17"><a href="rethinking-chapter-8.html#cb769-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb769-18"><a href="rethinking-chapter-8.html#cb769-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_rugged,</span>
<span id="cb769-19"><a href="rethinking-chapter-8.html#cb769-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> log_gdp_std,</span>
<span id="cb769-20"><a href="rethinking-chapter-8.html#cb769-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="fu">factor</span>(cont_idx), </span>
<span id="cb769-21"><a href="rethinking-chapter-8.html#cb769-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_alpha</span>(color))),</span>
<span id="cb769-22"><a href="rethinking-chapter-8.html#cb769-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb769-23"><a href="rethinking-chapter-8.html#cb769-23" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> data_rugged <span class="sc">%&gt;%</span> </span>
<span id="cb769-24"><a href="rethinking-chapter-8.html#cb769-24" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Seychelles&quot;</span>, <span class="st">&quot;Switzerland&quot;</span>,</span>
<span id="cb769-25"><a href="rethinking-chapter-8.html#cb769-25" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">&quot;Tajikistan&quot;</span>, <span class="st">&quot;Lesotho&quot;</span>, <span class="st">&quot;Nepal&quot;</span>)),</span>
<span id="cb769-26"><a href="rethinking-chapter-8.html#cb769-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> log_gdp_std,</span>
<span id="cb769-27"><a href="rethinking-chapter-8.html#cb769-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> rugged_std <span class="sc">+</span> .<span class="dv">1</span>,</span>
<span id="cb769-28"><a href="rethinking-chapter-8.html#cb769-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label =</span> country),</span>
<span id="cb769-29"><a href="rethinking-chapter-8.html#cb769-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">force =</span> <span class="dv">20</span>,</span>
<span id="cb769-30"><a href="rethinking-chapter-8.html#cb769-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">family =</span> fnt_sel) <span class="sc">+</span></span>
<span id="cb769-31"><a href="rethinking-chapter-8.html#cb769-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;log GDP (prop of mean)&quot;</span>) <span class="sc">+</span></span>
<span id="cb769-32"><a href="rethinking-chapter-8.html#cb769-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(cont_idx <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb769-33"><a href="rethinking-chapter-8.html#cb769-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Continent&quot;</span>,</span>
<span id="cb769-34"><a href="rethinking-chapter-8.html#cb769-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> clr1, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> clr0dd),</span>
<span id="cb769-35"><a href="rethinking-chapter-8.html#cb769-35" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Africa&quot;</span>, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Other&quot;</span>))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-28-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H4</strong></p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="rethinking-chapter-8.html#cb770-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nettle)</span>
<span id="cb770-2"><a href="rethinking-chapter-8.html#cb770-2" aria-hidden="true" tabindex="-1"></a>data_nettle <span class="ot">&lt;-</span> nettle <span class="sc">%&gt;%</span> </span>
<span id="cb770-3"><a href="rethinking-chapter-8.html#cb770-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb770-4"><a href="rethinking-chapter-8.html#cb770-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lang.per.capita =</span> num.lang <span class="sc">/</span> k.pop,</span>
<span id="cb770-5"><a href="rethinking-chapter-8.html#cb770-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lang_per_cap_log =</span> <span class="fu">log</span>(lang.per.capita),</span>
<span id="cb770-6"><a href="rethinking-chapter-8.html#cb770-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">lang_per_cap_log_std =</span> <span class="fu">standardize</span>(lang_per_cap_log),</span>
<span id="cb770-7"><a href="rethinking-chapter-8.html#cb770-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">area_log_std =</span> <span class="fu">standardize</span>(<span class="fu">log</span>(area)),</span>
<span id="cb770-8"><a href="rethinking-chapter-8.html#cb770-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">season_duration_scl =</span> mean.growing.season <span class="sc">/</span> <span class="fu">max</span>(mean.growing.season),</span>
<span id="cb770-9"><a href="rethinking-chapter-8.html#cb770-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">season_sd_scl =</span> sd.growing.season <span class="sc">/</span> <span class="fu">max</span>(sd.growing.season))</span>
<span id="cb770-10"><a href="rethinking-chapter-8.html#cb770-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb770-11"><a href="rethinking-chapter-8.html#cb770-11" aria-hidden="true" tabindex="-1"></a>data_nettle <span class="sc">%&gt;%</span> </span>
<span id="cb770-12"><a href="rethinking-chapter-8.html#cb770-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(lang_per_cap_log<span class="sc">:</span>season_sd_scl) <span class="sc">%&gt;%</span> </span>
<span id="cb770-13"><a href="rethinking-chapter-8.html#cb770-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">precis</span>()</span></code></pre></div>
<pre><code>#&gt;                               mean        sd          5.5%      94.5%
#&gt; lang_per_cap_log     -5.456606e+00 1.5207459 -7.8066714131 -3.4116252
#&gt; lang_per_cap_log_std -1.934656e-16 1.0000000 -1.5453372117  1.3447223
#&gt; area_log_std          2.619731e-17 1.0000000 -1.4475375475  1.3737581
#&gt; season_duration_scl   5.867905e-01 0.2619871  0.0692416667  0.9926458
#&gt; season_sd_scl         2.894700e-01 0.1816151  0.0008943782  0.5961755
#&gt;                          histogram
#&gt; lang_per_cap_log        ▁▁▂▅▇▂▂▁▁▁
#&gt; lang_per_cap_log_std ▁▁▁▂▃▇▇▂▃▁▁▁▁
#&gt; area_log_std           ▁▁▁▅▃▇▅▇▃▁▁
#&gt; season_duration_scl     ▃▁▃▂▃▇▇▇▃▃
#&gt; season_sd_scl           ▃▇▇▇▂▂▁▁▁▁</code></pre>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<p><span class="math display">\[
\begin{array}{rclr}
L_{i} &amp; \sim &amp; Normal( \mu_{i}, \sigma) &amp; \textrm{[likelihood]}\\
\mu_{i} &amp; = &amp; \alpha + \beta_{D} D_{i} + \beta_{A} A_{i}&amp; \textrm{[linear model]} \\
\alpha &amp; \sim &amp; Log-Normal(0, 0.15) &amp; \textrm{[$\alpha$ prior]}\\
\beta_{D} &amp; \sim &amp; Normal(0, 0.25) &amp; \textrm{[$\beta_{W}$ prior]}\\
\beta_{A} &amp; \sim &amp; Normal(0, 0.25) &amp; \textrm{[$\beta_{S}$ prior]}\\
\sigma &amp; \sim &amp; Exponential(1)  &amp; \textrm{[$\sigma$ prior]}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="rethinking-chapter-8.html#cb772-1" aria-hidden="true" tabindex="-1"></a>model_lang_dur_area <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb772-2"><a href="rethinking-chapter-8.html#cb772-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb772-3"><a href="rethinking-chapter-8.html#cb772-3" aria-hidden="true" tabindex="-1"></a>    lang_per_cap_log_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb772-4"><a href="rethinking-chapter-8.html#cb772-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb772-5"><a href="rethinking-chapter-8.html#cb772-5" aria-hidden="true" tabindex="-1"></a>      beta_d <span class="sc">*</span> season_duration_scl <span class="sc">+</span> </span>
<span id="cb772-6"><a href="rethinking-chapter-8.html#cb772-6" aria-hidden="true" tabindex="-1"></a>      beta_a <span class="sc">*</span> area_log_std ,</span>
<span id="cb772-7"><a href="rethinking-chapter-8.html#cb772-7" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.15</span>),</span>
<span id="cb772-8"><a href="rethinking-chapter-8.html#cb772-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(beta_d, beta_a) <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.25</span>),</span>
<span id="cb772-9"><a href="rethinking-chapter-8.html#cb772-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb772-10"><a href="rethinking-chapter-8.html#cb772-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb772-11"><a href="rethinking-chapter-8.html#cb772-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_nettle</span>
<span id="cb772-12"><a href="rethinking-chapter-8.html#cb772-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb772-13"><a href="rethinking-chapter-8.html#cb772-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb772-14"><a href="rethinking-chapter-8.html#cb772-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_lang_dur_area) <span class="sc">%&gt;%</span> </span>
<span id="cb772-15"><a href="rethinking-chapter-8.html#cb772-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.07</td>
<td align="right">0.11</td>
<td align="right">-0.25</td>
<td align="right">0.11</td>
</tr>
<tr class="even">
<td align="left">beta_d</td>
<td align="right">0.19</td>
<td align="right">0.18</td>
<td align="right">-0.10</td>
<td align="right">0.48</td>
</tr>
<tr class="odd">
<td align="left">beta_a</td>
<td align="right">-0.22</td>
<td align="right">0.10</td>
<td align="right">-0.38</td>
<td align="right">-0.06</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.94</td>
<td align="right">0.08</td>
<td align="right">0.81</td>
<td align="right">1.06</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="rethinking-chapter-8.html#cb773-1" aria-hidden="true" tabindex="-1"></a>area_classes <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_nettle<span class="sc">$</span>area_log_std, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out =</span> <span class="dv">4</span>))</span>
<span id="cb773-2"><a href="rethinking-chapter-8.html#cb773-2" aria-hidden="true" tabindex="-1"></a>area_means <span class="ot">&lt;-</span> (area_classes[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]<span class="sc">+</span>area_classes[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb773-3"><a href="rethinking-chapter-8.html#cb773-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb773-4"><a href="rethinking-chapter-8.html#cb773-4" aria-hidden="true" tabindex="-1"></a>model_lang_dur_area <span class="sc">%&gt;%</span></span>
<span id="cb773-5"><a href="rethinking-chapter-8.html#cb773-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(alpha, beta_d, beta_a) <span class="sc">%&gt;%</span></span>
<span id="cb773-6"><a href="rethinking-chapter-8.html#cb773-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.chain, <span class="sc">-</span>.iteration) <span class="sc">%&gt;%</span> </span>
<span id="cb773-7"><a href="rethinking-chapter-8.html#cb773-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_data =</span> <span class="fu">list</span>(<span class="fu">crossing</span>(<span class="at">season_duration_scl =</span> <span class="fu">range</span>(data_nettle<span class="sc">$</span>season_duration_scl),</span>
<span id="cb773-8"><a href="rethinking-chapter-8.html#cb773-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">area_log_std =</span> area_means))) <span class="sc">%&gt;%</span> </span>
<span id="cb773-9"><a href="rethinking-chapter-8.html#cb773-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(new_data) <span class="sc">%&gt;%</span> </span>
<span id="cb773-10"><a href="rethinking-chapter-8.html#cb773-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lang_per_cap_log_std =</span> alpha <span class="sc">+</span></span>
<span id="cb773-11"><a href="rethinking-chapter-8.html#cb773-11" aria-hidden="true" tabindex="-1"></a>           beta_d <span class="sc">*</span> season_duration_scl <span class="sc">+</span></span>
<span id="cb773-12"><a href="rethinking-chapter-8.html#cb773-12" aria-hidden="true" tabindex="-1"></a>           beta_a <span class="sc">*</span> area_log_std,</span>
<span id="cb773-13"><a href="rethinking-chapter-8.html#cb773-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">area_class =</span> <span class="fu">cut</span>(area_log_std,area_classes <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), .<span class="dv">1</span>)),</span>
<span id="cb773-14"><a href="rethinking-chapter-8.html#cb773-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">area_mean =</span> area_means[<span class="fu">as.numeric</span>(area_class)] <span class="sc">%&gt;%</span>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb773-15"><a href="rethinking-chapter-8.html#cb773-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season_duration_scl)) <span class="sc">+</span></span>
<span id="cb773-16"><a href="rethinking-chapter-8.html#cb773-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb773-17"><a href="rethinking-chapter-8.html#cb773-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(.draw <span class="sc">&lt;</span> <span class="dv">51</span>) <span class="sc">%&gt;%</span></span>
<span id="cb773-18"><a href="rethinking-chapter-8.html#cb773-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ungroup</span>(),</span>
<span id="cb773-19"><a href="rethinking-chapter-8.html#cb773-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> lang_per_cap_log_std ,</span>
<span id="cb773-20"><a href="rethinking-chapter-8.html#cb773-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="fu">str_c</span>(.draw, area_log_std), <span class="at">color =</span> area_log_std)) <span class="sc">+</span></span>
<span id="cb773-21"><a href="rethinking-chapter-8.html#cb773-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">range</span>(data_nettle<span class="sc">$</span>lang_per_cap_log_std),</span>
<span id="cb773-22"><a href="rethinking-chapter-8.html#cb773-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb773-23"><a href="rethinking-chapter-8.html#cb773-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_nettle <span class="sc">%&gt;%</span> </span>
<span id="cb773-24"><a href="rethinking-chapter-8.html#cb773-24" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">area_class =</span> <span class="fu">cut</span>(area_log_std,area_classes <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), .<span class="dv">1</span>)),</span>
<span id="cb773-25"><a href="rethinking-chapter-8.html#cb773-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">area_mean =</span> area_means[<span class="fu">as.numeric</span>(area_class)] <span class="sc">%&gt;%</span>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb773-26"><a href="rethinking-chapter-8.html#cb773-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> lang_per_cap_log_std,</span>
<span id="cb773-27"><a href="rethinking-chapter-8.html#cb773-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> area_log_std, <span class="at">color =</span> <span class="fu">after_scale</span>(<span class="fu">clr_darken</span>(fill))),</span>
<span id="cb773-28"><a href="rethinking-chapter-8.html#cb773-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb773-29"><a href="rethinking-chapter-8.html#cb773-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(fll0, fll1), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb773-30"><a href="rethinking-chapter-8.html#cb773-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(clr0, clr1), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb773-31"><a href="rethinking-chapter-8.html#cb773-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> area_mean, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb773-32"><a href="rethinking-chapter-8.html#cb773-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb773-33"><a href="rethinking-chapter-8.html#cb773-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-29-1.svg" width="672" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<p><span class="math display">\[
\begin{array}{rclr}
L_{i} &amp; \sim &amp; Normal( \mu_{i}, \sigma) &amp; \textrm{[likelihood]}\\
\mu_{i} &amp; = &amp; \alpha + \beta_{S} S_{i} + \beta_{A} A_{i}&amp; \textrm{[linear model]} \\
\alpha &amp; \sim &amp; Log-Normal(0, 0.15) &amp; \textrm{[$\alpha$ prior]}\\
\beta_{S} &amp; \sim &amp; Normal(0, 0.25) &amp; \textrm{[$\beta_{W}$ prior]}\\
\beta_{A} &amp; \sim &amp; Normal(0, 0.25) &amp; \textrm{[$\beta_{S}$ prior]}\\
\sigma &amp; \sim &amp; Exponential(1)  &amp; \textrm{[$\sigma$ prior]}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="rethinking-chapter-8.html#cb774-1" aria-hidden="true" tabindex="-1"></a>model_lang_sd_area <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb774-2"><a href="rethinking-chapter-8.html#cb774-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb774-3"><a href="rethinking-chapter-8.html#cb774-3" aria-hidden="true" tabindex="-1"></a>    lang_per_cap_log_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb774-4"><a href="rethinking-chapter-8.html#cb774-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb774-5"><a href="rethinking-chapter-8.html#cb774-5" aria-hidden="true" tabindex="-1"></a>      beta_s <span class="sc">*</span> season_sd_scl <span class="sc">+</span> </span>
<span id="cb774-6"><a href="rethinking-chapter-8.html#cb774-6" aria-hidden="true" tabindex="-1"></a>      beta_a <span class="sc">*</span> area_log_std ,</span>
<span id="cb774-7"><a href="rethinking-chapter-8.html#cb774-7" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.15</span>),</span>
<span id="cb774-8"><a href="rethinking-chapter-8.html#cb774-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(beta_s, beta_a) <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.25</span>),</span>
<span id="cb774-9"><a href="rethinking-chapter-8.html#cb774-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb774-10"><a href="rethinking-chapter-8.html#cb774-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb774-11"><a href="rethinking-chapter-8.html#cb774-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_nettle</span>
<span id="cb774-12"><a href="rethinking-chapter-8.html#cb774-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb774-13"><a href="rethinking-chapter-8.html#cb774-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb774-14"><a href="rethinking-chapter-8.html#cb774-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_lang_sd_area) <span class="sc">%&gt;%</span> </span>
<span id="cb774-15"><a href="rethinking-chapter-8.html#cb774-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.02</td>
<td align="right">0.10</td>
<td align="right">-0.14</td>
<td align="right">0.17</td>
</tr>
<tr class="even">
<td align="left">beta_s</td>
<td align="right">-0.09</td>
<td align="right">0.22</td>
<td align="right">-0.45</td>
<td align="right">0.26</td>
</tr>
<tr class="odd">
<td align="left">beta_a</td>
<td align="right">-0.23</td>
<td align="right">0.10</td>
<td align="right">-0.39</td>
<td align="right">-0.06</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.95</td>
<td align="right">0.08</td>
<td align="right">0.82</td>
<td align="right">1.07</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="rethinking-chapter-8.html#cb775-1" aria-hidden="true" tabindex="-1"></a>model_lang_sd_area <span class="sc">%&gt;%</span></span>
<span id="cb775-2"><a href="rethinking-chapter-8.html#cb775-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(alpha, beta_s, beta_a) <span class="sc">%&gt;%</span></span>
<span id="cb775-3"><a href="rethinking-chapter-8.html#cb775-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.chain, <span class="sc">-</span>.iteration) <span class="sc">%&gt;%</span> </span>
<span id="cb775-4"><a href="rethinking-chapter-8.html#cb775-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_data =</span> <span class="fu">list</span>(<span class="fu">crossing</span>(<span class="at">season_sd_scl =</span> <span class="fu">range</span>(data_nettle<span class="sc">$</span>season_sd_scl),</span>
<span id="cb775-5"><a href="rethinking-chapter-8.html#cb775-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">area_log_std =</span> area_means))) <span class="sc">%&gt;%</span> </span>
<span id="cb775-6"><a href="rethinking-chapter-8.html#cb775-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(new_data) <span class="sc">%&gt;%</span> </span>
<span id="cb775-7"><a href="rethinking-chapter-8.html#cb775-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lang_per_cap_log_std =</span> alpha <span class="sc">+</span></span>
<span id="cb775-8"><a href="rethinking-chapter-8.html#cb775-8" aria-hidden="true" tabindex="-1"></a>           beta_s <span class="sc">*</span> season_sd_scl <span class="sc">+</span></span>
<span id="cb775-9"><a href="rethinking-chapter-8.html#cb775-9" aria-hidden="true" tabindex="-1"></a>           beta_a <span class="sc">*</span> area_log_std,</span>
<span id="cb775-10"><a href="rethinking-chapter-8.html#cb775-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">area_class =</span> <span class="fu">cut</span>(area_log_std,area_classes <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), .<span class="dv">1</span>)),</span>
<span id="cb775-11"><a href="rethinking-chapter-8.html#cb775-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">area_mean =</span> area_means[<span class="fu">as.numeric</span>(area_class)] <span class="sc">%&gt;%</span>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb775-12"><a href="rethinking-chapter-8.html#cb775-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season_sd_scl)) <span class="sc">+</span></span>
<span id="cb775-13"><a href="rethinking-chapter-8.html#cb775-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb775-14"><a href="rethinking-chapter-8.html#cb775-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(.draw <span class="sc">&lt;</span> <span class="dv">51</span>) <span class="sc">%&gt;%</span></span>
<span id="cb775-15"><a href="rethinking-chapter-8.html#cb775-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ungroup</span>(),</span>
<span id="cb775-16"><a href="rethinking-chapter-8.html#cb775-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> lang_per_cap_log_std ,</span>
<span id="cb775-17"><a href="rethinking-chapter-8.html#cb775-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="fu">str_c</span>(.draw, area_log_std), <span class="at">color =</span> area_log_std)) <span class="sc">+</span></span>
<span id="cb775-18"><a href="rethinking-chapter-8.html#cb775-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">range</span>(data_nettle<span class="sc">$</span>lang_per_cap_log_std),</span>
<span id="cb775-19"><a href="rethinking-chapter-8.html#cb775-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb775-20"><a href="rethinking-chapter-8.html#cb775-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_nettle <span class="sc">%&gt;%</span> </span>
<span id="cb775-21"><a href="rethinking-chapter-8.html#cb775-21" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">area_class =</span> <span class="fu">cut</span>(area_log_std,area_classes <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), .<span class="dv">1</span>)),</span>
<span id="cb775-22"><a href="rethinking-chapter-8.html#cb775-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">area_mean =</span> area_means[<span class="fu">as.numeric</span>(area_class)] <span class="sc">%&gt;%</span>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb775-23"><a href="rethinking-chapter-8.html#cb775-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> lang_per_cap_log_std,</span>
<span id="cb775-24"><a href="rethinking-chapter-8.html#cb775-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> area_log_std, <span class="at">color =</span> <span class="fu">after_scale</span>(<span class="fu">clr_darken</span>(fill))),</span>
<span id="cb775-25"><a href="rethinking-chapter-8.html#cb775-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb775-26"><a href="rethinking-chapter-8.html#cb775-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(fll0, fll1), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb775-27"><a href="rethinking-chapter-8.html#cb775-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(clr0, clr1), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb775-28"><a href="rethinking-chapter-8.html#cb775-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> area_mean, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb775-29"><a href="rethinking-chapter-8.html#cb775-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb775-30"><a href="rethinking-chapter-8.html#cb775-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-30-1.svg" width="672" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="rethinking-chapter-8.html#cb776-1" aria-hidden="true" tabindex="-1"></a>model_lang_inter <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb776-2"><a href="rethinking-chapter-8.html#cb776-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb776-3"><a href="rethinking-chapter-8.html#cb776-3" aria-hidden="true" tabindex="-1"></a>    lang_per_cap_log_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb776-4"><a href="rethinking-chapter-8.html#cb776-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb776-5"><a href="rethinking-chapter-8.html#cb776-5" aria-hidden="true" tabindex="-1"></a>      beta_d <span class="sc">*</span> season_duration_scl <span class="sc">+</span> </span>
<span id="cb776-6"><a href="rethinking-chapter-8.html#cb776-6" aria-hidden="true" tabindex="-1"></a>      beta_s <span class="sc">*</span> season_sd_scl <span class="sc">+</span> </span>
<span id="cb776-7"><a href="rethinking-chapter-8.html#cb776-7" aria-hidden="true" tabindex="-1"></a>      beta_ds <span class="sc">*</span> season_duration_scl <span class="sc">*</span> season_sd_scl,</span>
<span id="cb776-8"><a href="rethinking-chapter-8.html#cb776-8" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.15</span>),</span>
<span id="cb776-9"><a href="rethinking-chapter-8.html#cb776-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(beta_d, beta_s) <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.25</span>),</span>
<span id="cb776-10"><a href="rethinking-chapter-8.html#cb776-10" aria-hidden="true" tabindex="-1"></a>     beta_ds  <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb776-11"><a href="rethinking-chapter-8.html#cb776-11" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb776-12"><a href="rethinking-chapter-8.html#cb776-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb776-13"><a href="rethinking-chapter-8.html#cb776-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_nettle</span>
<span id="cb776-14"><a href="rethinking-chapter-8.html#cb776-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb776-15"><a href="rethinking-chapter-8.html#cb776-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb776-16"><a href="rethinking-chapter-8.html#cb776-16" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_lang_inter) <span class="sc">%&gt;%</span> </span>
<span id="cb776-17"><a href="rethinking-chapter-8.html#cb776-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.04</td>
<td align="right">0.12</td>
<td align="right">-0.23</td>
<td align="right">0.14</td>
</tr>
<tr class="even">
<td align="left">beta_d</td>
<td align="right">0.32</td>
<td align="right">0.19</td>
<td align="right">0.02</td>
<td align="right">0.63</td>
</tr>
<tr class="odd">
<td align="left">beta_s</td>
<td align="right">-0.20</td>
<td align="right">0.23</td>
<td align="right">-0.57</td>
<td align="right">0.17</td>
</tr>
<tr class="even">
<td align="left">beta_ds</td>
<td align="right">-0.38</td>
<td align="right">0.43</td>
<td align="right">-1.07</td>
<td align="right">0.31</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.94</td>
<td align="right">0.08</td>
<td align="right">0.82</td>
<td align="right">1.07</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="rethinking-chapter-8.html#cb777-1" aria-hidden="true" tabindex="-1"></a>sd_classes <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_nettle<span class="sc">$</span>season_sd_scl, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out =</span> <span class="dv">4</span>))</span>
<span id="cb777-2"><a href="rethinking-chapter-8.html#cb777-2" aria-hidden="true" tabindex="-1"></a>sd_means <span class="ot">&lt;-</span> (sd_classes[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]<span class="sc">+</span>sd_classes[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb777-3"><a href="rethinking-chapter-8.html#cb777-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb777-4"><a href="rethinking-chapter-8.html#cb777-4" aria-hidden="true" tabindex="-1"></a>model_lang_inter <span class="sc">%&gt;%</span></span>
<span id="cb777-5"><a href="rethinking-chapter-8.html#cb777-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(alpha, beta_d, beta_s, beta_ds) <span class="sc">%&gt;%</span></span>
<span id="cb777-6"><a href="rethinking-chapter-8.html#cb777-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>.chain, <span class="sc">-</span>.iteration) <span class="sc">%&gt;%</span> </span>
<span id="cb777-7"><a href="rethinking-chapter-8.html#cb777-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_data =</span> <span class="fu">list</span>(<span class="fu">crossing</span>(<span class="at">season_duration_scl =</span> <span class="fu">range</span>(data_nettle<span class="sc">$</span>season_duration_scl),</span>
<span id="cb777-8"><a href="rethinking-chapter-8.html#cb777-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">season_sd_scl =</span> sd_means))) <span class="sc">%&gt;%</span> </span>
<span id="cb777-9"><a href="rethinking-chapter-8.html#cb777-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(new_data) <span class="sc">%&gt;%</span> </span>
<span id="cb777-10"><a href="rethinking-chapter-8.html#cb777-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lang_per_cap_log_std =</span> alpha <span class="sc">+</span></span>
<span id="cb777-11"><a href="rethinking-chapter-8.html#cb777-11" aria-hidden="true" tabindex="-1"></a>           beta_d <span class="sc">*</span> season_duration_scl <span class="sc">+</span></span>
<span id="cb777-12"><a href="rethinking-chapter-8.html#cb777-12" aria-hidden="true" tabindex="-1"></a>           beta_s <span class="sc">*</span> season_sd_scl <span class="sc">+</span></span>
<span id="cb777-13"><a href="rethinking-chapter-8.html#cb777-13" aria-hidden="true" tabindex="-1"></a>           beta_ds <span class="sc">*</span> season_duration_scl <span class="sc">*</span> season_sd_scl,</span>
<span id="cb777-14"><a href="rethinking-chapter-8.html#cb777-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd_class =</span> <span class="fu">cut</span>(season_sd_scl ,sd_classes <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), .<span class="dv">1</span>)),</span>
<span id="cb777-15"><a href="rethinking-chapter-8.html#cb777-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd_mean =</span> sd_means[<span class="fu">as.numeric</span>(sd_class)] <span class="sc">%&gt;%</span>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb777-16"><a href="rethinking-chapter-8.html#cb777-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season_duration_scl)) <span class="sc">+</span></span>
<span id="cb777-17"><a href="rethinking-chapter-8.html#cb777-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb777-18"><a href="rethinking-chapter-8.html#cb777-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(.draw <span class="sc">&lt;</span> <span class="dv">51</span>) <span class="sc">%&gt;%</span></span>
<span id="cb777-19"><a href="rethinking-chapter-8.html#cb777-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ungroup</span>(),</span>
<span id="cb777-20"><a href="rethinking-chapter-8.html#cb777-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> lang_per_cap_log_std ,</span>
<span id="cb777-21"><a href="rethinking-chapter-8.html#cb777-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> <span class="fu">str_c</span>(.draw, season_sd_scl), <span class="at">color =</span> season_sd_scl)) <span class="sc">+</span></span>
<span id="cb777-22"><a href="rethinking-chapter-8.html#cb777-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">range</span>(data_nettle<span class="sc">$</span>lang_per_cap_log_std),</span>
<span id="cb777-23"><a href="rethinking-chapter-8.html#cb777-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb777-24"><a href="rethinking-chapter-8.html#cb777-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_nettle <span class="sc">%&gt;%</span> </span>
<span id="cb777-25"><a href="rethinking-chapter-8.html#cb777-25" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">sd_class =</span> <span class="fu">cut</span>(season_sd_scl ,sd_classes <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), .<span class="dv">1</span>)),</span>
<span id="cb777-26"><a href="rethinking-chapter-8.html#cb777-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd_mean =</span> sd_means[<span class="fu">as.numeric</span>(sd_class)] <span class="sc">%&gt;%</span>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb777-27"><a href="rethinking-chapter-8.html#cb777-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> lang_per_cap_log_std,</span>
<span id="cb777-28"><a href="rethinking-chapter-8.html#cb777-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> season_sd_scl, <span class="at">color =</span> <span class="fu">after_scale</span>(<span class="fu">clr_darken</span>(fill))),</span>
<span id="cb777-29"><a href="rethinking-chapter-8.html#cb777-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb777-30"><a href="rethinking-chapter-8.html#cb777-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(fll0, fll1), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb777-31"><a href="rethinking-chapter-8.html#cb777-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(clr0, clr1), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb777-32"><a href="rethinking-chapter-8.html#cb777-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> sd_mean, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb777-33"><a href="rethinking-chapter-8.html#cb777-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb777-34"><a href="rethinking-chapter-8.html#cb777-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-31-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="rethinking-chapter-8.html#cb778-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(model_lang_dur_area,</span>
<span id="cb778-2"><a href="rethinking-chapter-8.html#cb778-2" aria-hidden="true" tabindex="-1"></a>        model_lang_sd_area,</span>
<span id="cb778-3"><a href="rethinking-chapter-8.html#cb778-3" aria-hidden="true" tabindex="-1"></a>        model_lang_inter) <span class="sc">%&gt;%</span> </span>
<span id="cb778-4"><a href="rethinking-chapter-8.html#cb778-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>(<span class="at">param_name =</span> <span class="st">&quot;model&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="right">WAIC</th>
<th align="right">SE</th>
<th align="right">dWAIC</th>
<th align="right">dSE</th>
<th align="right">pWAIC</th>
<th align="right">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">model_lang_inter</td>
<td align="right">208.31</td>
<td align="right">17.09</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">3.16</td>
<td align="right">0.46</td>
</tr>
<tr class="even">
<td align="left">model_lang_dur_area</td>
<td align="right">208.81</td>
<td align="right">16.68</td>
<td align="right">0.50</td>
<td align="right">4.13</td>
<td align="right">4.05</td>
<td align="right">0.35</td>
</tr>
<tr class="odd">
<td align="left">model_lang_sd_area</td>
<td align="right">210.06</td>
<td align="right">16.83</td>
<td align="right">1.75</td>
<td align="right">3.59</td>
<td align="right">3.99</td>
<td align="right">0.19</td>
</tr>
</tbody>
</table>
<p><strong>H5</strong></p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="rethinking-chapter-8.html#cb779-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Wines2012&quot;</span>)</span>
<span id="cb779-2"><a href="rethinking-chapter-8.html#cb779-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb779-3"><a href="rethinking-chapter-8.html#cb779-3" aria-hidden="true" tabindex="-1"></a>data_wine <span class="ot">&lt;-</span> Wines2012 <span class="sc">%&gt;%</span> </span>
<span id="cb779-4"><a href="rethinking-chapter-8.html#cb779-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb779-5"><a href="rethinking-chapter-8.html#cb779-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">score_std =</span> <span class="fu">standardize</span>(score),</span>
<span id="cb779-6"><a href="rethinking-chapter-8.html#cb779-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">wine_nat_idx =</span> wine.amer <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb779-7"><a href="rethinking-chapter-8.html#cb779-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">judge_nat_idx =</span> judge.amer <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb779-8"><a href="rethinking-chapter-8.html#cb779-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">wine_idx =</span> <span class="fu">as.numeric</span>(wine),</span>
<span id="cb779-9"><a href="rethinking-chapter-8.html#cb779-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">judge_idx =</span> <span class="fu">as.numeric</span>(judge))</span>
<span id="cb779-10"><a href="rethinking-chapter-8.html#cb779-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb779-11"><a href="rethinking-chapter-8.html#cb779-11" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(data_wine<span class="sc">$</span>wine_idx) <span class="sc">%&gt;%</span> <span class="fu">sort</span>()</span></code></pre></div>
<pre><code>#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</code></pre>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="rethinking-chapter-8.html#cb781-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(data_wine<span class="sc">$</span>judge_idx) <span class="sc">%&gt;%</span> <span class="fu">sort</span>()</span></code></pre></div>
<pre><code>#&gt; [1] 1 2 3 4 5 6 7 8 9</code></pre>
<p><span class="math display">\[
\begin{array}{rclr}
S_{i} &amp; \sim &amp; Normal( \mu_{i}, \sigma) &amp; \textrm{[likelihood]}\\
\mu_{i} &amp; = &amp; \alpha_{J} + \alpha_{W} &amp; \textrm{[linear model]} \\
\alpha_{J} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{J}$ prior]}\\
\alpha_{W} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{W}$ prior]}\\
\sigma &amp; \sim &amp; Exponential(1)  &amp; \textrm{[$\sigma$ prior]}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="rethinking-chapter-8.html#cb783-1" aria-hidden="true" tabindex="-1"></a>model_wine_static <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb783-2"><a href="rethinking-chapter-8.html#cb783-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb783-3"><a href="rethinking-chapter-8.html#cb783-3" aria-hidden="true" tabindex="-1"></a>     score_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb783-4"><a href="rethinking-chapter-8.html#cb783-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha_j[judge_idx] <span class="sc">+</span> alpha_w[wine_idx],</span>
<span id="cb783-5"><a href="rethinking-chapter-8.html#cb783-5" aria-hidden="true" tabindex="-1"></a>    alpha_j[judge_idx]<span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb783-6"><a href="rethinking-chapter-8.html#cb783-6" aria-hidden="true" tabindex="-1"></a>    alpha_w[wine_idx] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb783-7"><a href="rethinking-chapter-8.html#cb783-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb783-8"><a href="rethinking-chapter-8.html#cb783-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb783-9"><a href="rethinking-chapter-8.html#cb783-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_wine</span>
<span id="cb783-10"><a href="rethinking-chapter-8.html#cb783-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb783-11"><a href="rethinking-chapter-8.html#cb783-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb783-12"><a href="rethinking-chapter-8.html#cb783-12" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_wine_static, <span class="at">depth =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb783-13"><a href="rethinking-chapter-8.html#cb783-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha_j[1]</td>
<td align="right">-0.28</td>
<td align="right">0.19</td>
<td align="right">-0.58</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">alpha_j[2]</td>
<td align="right">0.22</td>
<td align="right">0.19</td>
<td align="right">-0.08</td>
<td align="right">0.51</td>
</tr>
<tr class="odd">
<td align="left">alpha_j[3]</td>
<td align="right">0.21</td>
<td align="right">0.19</td>
<td align="right">-0.09</td>
<td align="right">0.51</td>
</tr>
<tr class="even">
<td align="left">alpha_j[4]</td>
<td align="right">-0.55</td>
<td align="right">0.19</td>
<td align="right">-0.85</td>
<td align="right">-0.25</td>
</tr>
<tr class="odd">
<td align="left">alpha_j[5]</td>
<td align="right">0.81</td>
<td align="right">0.19</td>
<td align="right">0.51</td>
<td align="right">1.11</td>
</tr>
<tr class="even">
<td align="left">alpha_j[6]</td>
<td align="right">0.48</td>
<td align="right">0.19</td>
<td align="right">0.19</td>
<td align="right">0.78</td>
</tr>
<tr class="odd">
<td align="left">alpha_j[7]</td>
<td align="right">0.13</td>
<td align="right">0.19</td>
<td align="right">-0.16</td>
<td align="right">0.43</td>
</tr>
<tr class="even">
<td align="left">alpha_j[8]</td>
<td align="right">-0.67</td>
<td align="right">0.19</td>
<td align="right">-0.97</td>
<td align="right">-0.37</td>
</tr>
<tr class="odd">
<td align="left">alpha_j[9]</td>
<td align="right">-0.35</td>
<td align="right">0.19</td>
<td align="right">-0.65</td>
<td align="right">-0.05</td>
</tr>
<tr class="even">
<td align="left">alpha_w[1]</td>
<td align="right">0.12</td>
<td align="right">0.25</td>
<td align="right">-0.27</td>
<td align="right">0.51</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[2]</td>
<td align="right">0.09</td>
<td align="right">0.25</td>
<td align="right">-0.30</td>
<td align="right">0.48</td>
</tr>
<tr class="even">
<td align="left">alpha_w[3]</td>
<td align="right">0.24</td>
<td align="right">0.25</td>
<td align="right">-0.16</td>
<td align="right">0.63</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[4]</td>
<td align="right">0.48</td>
<td align="right">0.25</td>
<td align="right">0.09</td>
<td align="right">0.87</td>
</tr>
<tr class="even">
<td align="left">alpha_w[5]</td>
<td align="right">-0.11</td>
<td align="right">0.25</td>
<td align="right">-0.50</td>
<td align="right">0.28</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[6]</td>
<td align="right">-0.32</td>
<td align="right">0.25</td>
<td align="right">-0.71</td>
<td align="right">0.07</td>
</tr>
<tr class="even">
<td align="left">alpha_w[7]</td>
<td align="right">0.25</td>
<td align="right">0.25</td>
<td align="right">-0.14</td>
<td align="right">0.64</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[8]</td>
<td align="right">0.24</td>
<td align="right">0.25</td>
<td align="right">-0.16</td>
<td align="right">0.63</td>
</tr>
<tr class="even">
<td align="left">alpha_w[9]</td>
<td align="right">0.07</td>
<td align="right">0.25</td>
<td align="right">-0.32</td>
<td align="right">0.46</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[10]</td>
<td align="right">0.10</td>
<td align="right">0.25</td>
<td align="right">-0.29</td>
<td align="right">0.50</td>
</tr>
<tr class="even">
<td align="left">alpha_w[11]</td>
<td align="right">-0.01</td>
<td align="right">0.25</td>
<td align="right">-0.40</td>
<td align="right">0.38</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[12]</td>
<td align="right">-0.03</td>
<td align="right">0.25</td>
<td align="right">-0.42</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="left">alpha_w[13]</td>
<td align="right">-0.09</td>
<td align="right">0.25</td>
<td align="right">-0.48</td>
<td align="right">0.30</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[14]</td>
<td align="right">0.01</td>
<td align="right">0.25</td>
<td align="right">-0.39</td>
<td align="right">0.40</td>
</tr>
<tr class="even">
<td align="left">alpha_w[15]</td>
<td align="right">-0.19</td>
<td align="right">0.25</td>
<td align="right">-0.58</td>
<td align="right">0.20</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[16]</td>
<td align="right">-0.17</td>
<td align="right">0.25</td>
<td align="right">-0.57</td>
<td align="right">0.22</td>
</tr>
<tr class="even">
<td align="left">alpha_w[17]</td>
<td align="right">-0.12</td>
<td align="right">0.25</td>
<td align="right">-0.52</td>
<td align="right">0.27</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[18]</td>
<td align="right">-0.75</td>
<td align="right">0.25</td>
<td align="right">-1.14</td>
<td align="right">-0.35</td>
</tr>
<tr class="even">
<td align="left">alpha_w[19]</td>
<td align="right">-0.14</td>
<td align="right">0.25</td>
<td align="right">-0.53</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[20]</td>
<td align="right">0.33</td>
<td align="right">0.25</td>
<td align="right">-0.06</td>
<td align="right">0.73</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.79</td>
<td align="right">0.04</td>
<td align="right">0.72</td>
<td align="right">0.85</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="rethinking-chapter-8.html#cb784-1" aria-hidden="true" tabindex="-1"></a>wine_params <span class="ot">&lt;-</span> data_wine <span class="sc">%&gt;%</span> </span>
<span id="cb784-2"><a href="rethinking-chapter-8.html#cb784-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">j =</span> <span class="fu">str_c</span>(judge,<span class="st">&quot;_&quot;</span>,judge_idx),</span>
<span id="cb784-3"><a href="rethinking-chapter-8.html#cb784-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">w =</span> <span class="fu">str_c</span>(wine,<span class="st">&quot;_&quot;</span>, wine_idx)) <span class="sc">%&gt;%</span></span>
<span id="cb784-4"><a href="rethinking-chapter-8.html#cb784-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(j, w) <span class="sc">%&gt;%</span> </span>
<span id="cb784-5"><a href="rethinking-chapter-8.html#cb784-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),<span class="at">names_to =</span> <span class="st">&quot;type&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb784-6"><a href="rethinking-chapter-8.html#cb784-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb784-7"><a href="rethinking-chapter-8.html#cb784-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(type, value) <span class="sc">%&gt;%</span> </span>
<span id="cb784-8"><a href="rethinking-chapter-8.html#cb784-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(value, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;idx&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb784-9"><a href="rethinking-chapter-8.html#cb784-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb784-10"><a href="rethinking-chapter-8.html#cb784-10" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_wine_static, <span class="at">depth =</span> <span class="dv">2</span>, <span class="at">pars =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb784-11"><a href="rethinking-chapter-8.html#cb784-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble_rn</span>() <span class="sc">%&gt;%</span></span>
<span id="cb784-12"><a href="rethinking-chapter-8.html#cb784-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">str_remove</span>(param, <span class="at">pattern =</span>  <span class="st">&quot;alpha_&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">[[0-9]*</span><span class="sc">\\</span><span class="st">]&quot;</span>),</span>
<span id="cb784-13"><a href="rethinking-chapter-8.html#cb784-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">idx =</span> <span class="fu">str_extract</span>(param, <span class="st">&quot;[0-9]{1,2}&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb784-14"><a href="rethinking-chapter-8.html#cb784-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wine_params, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;type&quot;</span>, <span class="st">&quot;idx&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb784-15"><a href="rethinking-chapter-8.html#cb784-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span> </span>
<span id="cb784-16"><a href="rethinking-chapter-8.html#cb784-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">fct_reorder</span>(name, mean),</span>
<span id="cb784-17"><a href="rethinking-chapter-8.html#cb784-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_c</span>(<span class="fu">str_pad</span>(<span class="dv">30</span> <span class="sc">-</span> <span class="fu">as.numeric</span>(name), <span class="at">width =</span> <span class="dv">2</span>, <span class="at">pad =</span> <span class="dv">0</span>),<span class="st">&quot;: &quot;</span>,name)) <span class="sc">%&gt;%</span> </span>
<span id="cb784-18"><a href="rethinking-chapter-8.html#cb784-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb784-19"><a href="rethinking-chapter-8.html#cb784-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> name, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb784-20"><a href="rethinking-chapter-8.html#cb784-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb784-21"><a href="rethinking-chapter-8.html#cb784-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointinterval</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">x =</span> mean,</span>
<span id="cb784-22"><a href="rethinking-chapter-8.html#cb784-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xmax =</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb784-23"><a href="rethinking-chapter-8.html#cb784-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">j =</span> clr0d, <span class="at">w =</span> clr2), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb784-24"><a href="rethinking-chapter-8.html#cb784-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(type <span class="sc">~</span> . , <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb784-25"><a href="rethinking-chapter-8.html#cb784-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;score_std&quot;</span>) <span class="sc">+</span></span>
<span id="cb784-26"><a href="rethinking-chapter-8.html#cb784-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb784-27"><a href="rethinking-chapter-8.html#cb784-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-34-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H6</strong></p>
<p><span class="math display">\[
\begin{array}{rclr}
S_{i} &amp; \sim &amp; Normal( \mu_{i}, \sigma) &amp; \textrm{[likelihood]}\\
\mu_{i} &amp; = &amp; \alpha_{J} + \alpha_{W} + \alpha_{F} &amp; \textrm{[linear model]} \\
\alpha_{W} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{W}$ prior]}\\
\alpha_{J} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{J}$ prior]}\\
\alpha_{F} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{F}$ prior]}\\
\sigma &amp; \sim &amp; Exponential(1)  &amp; \textrm{[$\sigma$ prior]}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="rethinking-chapter-8.html#cb785-1" aria-hidden="true" tabindex="-1"></a>model_wine_nat <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb785-2"><a href="rethinking-chapter-8.html#cb785-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb785-3"><a href="rethinking-chapter-8.html#cb785-3" aria-hidden="true" tabindex="-1"></a>     score_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb785-4"><a href="rethinking-chapter-8.html#cb785-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha_j[judge_nat_idx] <span class="sc">+</span> alpha_w[wine_nat_idx] <span class="sc">+</span> alpha_f[flight],</span>
<span id="cb785-5"><a href="rethinking-chapter-8.html#cb785-5" aria-hidden="true" tabindex="-1"></a>    alpha_j[judge_nat_idx]<span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.25</span>),</span>
<span id="cb785-6"><a href="rethinking-chapter-8.html#cb785-6" aria-hidden="true" tabindex="-1"></a>    alpha_w[wine_nat_idx] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.25</span>),</span>
<span id="cb785-7"><a href="rethinking-chapter-8.html#cb785-7" aria-hidden="true" tabindex="-1"></a>    alpha_f[flight] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.25</span>),</span>
<span id="cb785-8"><a href="rethinking-chapter-8.html#cb785-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb785-9"><a href="rethinking-chapter-8.html#cb785-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb785-10"><a href="rethinking-chapter-8.html#cb785-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_wine</span>
<span id="cb785-11"><a href="rethinking-chapter-8.html#cb785-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb785-12"><a href="rethinking-chapter-8.html#cb785-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb785-13"><a href="rethinking-chapter-8.html#cb785-13" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_wine_nat, <span class="at">depth =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb785-14"><a href="rethinking-chapter-8.html#cb785-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha_j[1]</td>
<td align="right">-0.10</td>
<td align="right">0.16</td>
<td align="right">-0.36</td>
<td align="right">0.15</td>
</tr>
<tr class="even">
<td align="left">alpha_j[2]</td>
<td align="right">0.11</td>
<td align="right">0.16</td>
<td align="right">-0.15</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[1]</td>
<td align="right">0.08</td>
<td align="right">0.16</td>
<td align="right">-0.18</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="left">alpha_w[2]</td>
<td align="right">-0.08</td>
<td align="right">0.16</td>
<td align="right">-0.34</td>
<td align="right">0.18</td>
</tr>
<tr class="odd">
<td align="left">alpha_f[1]</td>
<td align="right">0.00</td>
<td align="right">0.16</td>
<td align="right">-0.26</td>
<td align="right">0.26</td>
</tr>
<tr class="even">
<td align="left">alpha_f[2]</td>
<td align="right">0.00</td>
<td align="right">0.16</td>
<td align="right">-0.25</td>
<td align="right">0.26</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.98</td>
<td align="right">0.05</td>
<td align="right">0.90</td>
<td align="right">1.07</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="rethinking-chapter-8.html#cb786-1" aria-hidden="true" tabindex="-1"></a>wine_params <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;j&quot;</span>, <span class="st">&quot;f&quot;</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb786-2"><a href="rethinking-chapter-8.html#cb786-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;america&quot;</span>, <span class="st">&quot;france&quot;</span>), <span class="dv">2</span>),</span>
<span id="cb786-3"><a href="rethinking-chapter-8.html#cb786-3" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">levels</span>(data_wine<span class="sc">$</span>flight)),</span>
<span id="cb786-4"><a href="rethinking-chapter-8.html#cb786-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">idx =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb786-5"><a href="rethinking-chapter-8.html#cb786-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb786-6"><a href="rethinking-chapter-8.html#cb786-6" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_wine_nat, <span class="at">depth =</span> <span class="dv">2</span>, <span class="at">pars =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb786-7"><a href="rethinking-chapter-8.html#cb786-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble_rn</span>() <span class="sc">%&gt;%</span></span>
<span id="cb786-8"><a href="rethinking-chapter-8.html#cb786-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">str_remove</span>(param, <span class="at">pattern =</span>  <span class="st">&quot;alpha_&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">[[0-9]*</span><span class="sc">\\</span><span class="st">]&quot;</span>),</span>
<span id="cb786-9"><a href="rethinking-chapter-8.html#cb786-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">idx =</span> <span class="fu">str_extract</span>(param, <span class="st">&quot;[0-9]{1,2}&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb786-10"><a href="rethinking-chapter-8.html#cb786-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wine_params, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;type&quot;</span>, <span class="st">&quot;idx&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb786-11"><a href="rethinking-chapter-8.html#cb786-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span> </span>
<span id="cb786-12"><a href="rethinking-chapter-8.html#cb786-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">fct_reorder</span>(name, mean),</span>
<span id="cb786-13"><a href="rethinking-chapter-8.html#cb786-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_c</span>(<span class="fu">str_pad</span>(<span class="dv">30</span> <span class="sc">-</span> <span class="fu">as.numeric</span>(name), <span class="at">width =</span> <span class="dv">2</span>, <span class="at">pad =</span> <span class="dv">0</span>),<span class="st">&quot;: &quot;</span>,name)) <span class="sc">%&gt;%</span> </span>
<span id="cb786-14"><a href="rethinking-chapter-8.html#cb786-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb786-15"><a href="rethinking-chapter-8.html#cb786-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> name, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb786-16"><a href="rethinking-chapter-8.html#cb786-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb786-17"><a href="rethinking-chapter-8.html#cb786-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointinterval</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">x =</span> mean,</span>
<span id="cb786-18"><a href="rethinking-chapter-8.html#cb786-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xmax =</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb786-19"><a href="rethinking-chapter-8.html#cb786-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">j =</span> clr0d, <span class="at">w =</span> clr2, <span class="at">f =</span> clr_dark), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb786-20"><a href="rethinking-chapter-8.html#cb786-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(type <span class="sc">~</span> . , <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb786-21"><a href="rethinking-chapter-8.html#cb786-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;score_std&quot;</span>) <span class="sc">+</span></span>
<span id="cb786-22"><a href="rethinking-chapter-8.html#cb786-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb786-23"><a href="rethinking-chapter-8.html#cb786-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-35-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p><strong>H7</strong></p>
<p><span class="math display">\[
\begin{array}{rclr}
S_{i} &amp; \sim &amp; Normal( \mu_{i}, \sigma) &amp; \textrm{[likelihood]}\\
\mu_{i} &amp; = &amp; \alpha_{J} + \alpha_{W} + \alpha_{F} + \beta_{JF} \times J + \beta_{WF} \times W + \beta_{JW} \times J &amp; \textrm{[linear model]} \\
\alpha_{W} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{W}$ prior]}\\
\alpha_{J} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{J}$ prior]}\\
\alpha_{F} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{F}$ prior]}\\
\beta_{WF} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{WF}$ prior]}\\
\beta_{JF} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{JF}$ prior]}\\
\beta_{JW} &amp; \sim &amp; Normal(0, 0.5) &amp; \textrm{[$\alpha_{JW}$ prior]}\\
\sigma &amp; \sim &amp; Exponential(1)  &amp; \textrm{[$\sigma$ prior]}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="rethinking-chapter-8.html#cb787-1" aria-hidden="true" tabindex="-1"></a>model_wine_inter <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb787-2"><a href="rethinking-chapter-8.html#cb787-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb787-3"><a href="rethinking-chapter-8.html#cb787-3" aria-hidden="true" tabindex="-1"></a>     score_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb787-4"><a href="rethinking-chapter-8.html#cb787-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha_j[judge_nat_idx] <span class="sc">+</span> alpha_w[wine_nat_idx] <span class="sc">+</span> alpha_f[flight] <span class="sc">+</span></span>
<span id="cb787-5"><a href="rethinking-chapter-8.html#cb787-5" aria-hidden="true" tabindex="-1"></a>      beta_jf[flight] <span class="sc">*</span> judge.amer <span class="sc">+</span> beta_wf[flight] <span class="sc">*</span> wine.amer <span class="sc">+</span> beta_jw[wine_nat_idx] <span class="sc">*</span> judge.amer,</span>
<span id="cb787-6"><a href="rethinking-chapter-8.html#cb787-6" aria-hidden="true" tabindex="-1"></a>    alpha_j[judge_nat_idx]<span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb787-7"><a href="rethinking-chapter-8.html#cb787-7" aria-hidden="true" tabindex="-1"></a>    alpha_w[wine_nat_idx] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb787-8"><a href="rethinking-chapter-8.html#cb787-8" aria-hidden="true" tabindex="-1"></a>    alpha_f[flight] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb787-9"><a href="rethinking-chapter-8.html#cb787-9" aria-hidden="true" tabindex="-1"></a>    beta_jf[flight] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb787-10"><a href="rethinking-chapter-8.html#cb787-10" aria-hidden="true" tabindex="-1"></a>    beta_wf[flight] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb787-11"><a href="rethinking-chapter-8.html#cb787-11" aria-hidden="true" tabindex="-1"></a>    beta_jw[wine_nat_idx] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb787-12"><a href="rethinking-chapter-8.html#cb787-12" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb787-13"><a href="rethinking-chapter-8.html#cb787-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb787-14"><a href="rethinking-chapter-8.html#cb787-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_wine</span>
<span id="cb787-15"><a href="rethinking-chapter-8.html#cb787-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb787-16"><a href="rethinking-chapter-8.html#cb787-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb787-17"><a href="rethinking-chapter-8.html#cb787-17" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_wine_inter, <span class="at">depth =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb787-18"><a href="rethinking-chapter-8.html#cb787-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha_j[1]</td>
<td align="right">-0.09</td>
<td align="right">0.33</td>
<td align="right">-0.62</td>
<td align="right">0.43</td>
</tr>
<tr class="even">
<td align="left">alpha_j[2]</td>
<td align="right">0.08</td>
<td align="right">0.39</td>
<td align="right">-0.55</td>
<td align="right">0.70</td>
</tr>
<tr class="odd">
<td align="left">alpha_w[1]</td>
<td align="right">0.04</td>
<td align="right">0.33</td>
<td align="right">-0.48</td>
<td align="right">0.57</td>
</tr>
<tr class="even">
<td align="left">alpha_w[2]</td>
<td align="right">-0.06</td>
<td align="right">0.36</td>
<td align="right">-0.64</td>
<td align="right">0.53</td>
</tr>
<tr class="odd">
<td align="left">alpha_f[1]</td>
<td align="right">0.12</td>
<td align="right">0.32</td>
<td align="right">-0.40</td>
<td align="right">0.64</td>
</tr>
<tr class="even">
<td align="left">alpha_f[2]</td>
<td align="right">-0.13</td>
<td align="right">0.32</td>
<td align="right">-0.65</td>
<td align="right">0.39</td>
</tr>
<tr class="odd">
<td align="left">beta_jf[1]</td>
<td align="right">0.06</td>
<td align="right">0.34</td>
<td align="right">-0.48</td>
<td align="right">0.61</td>
</tr>
<tr class="even">
<td align="left">beta_jf[2]</td>
<td align="right">0.02</td>
<td align="right">0.34</td>
<td align="right">-0.53</td>
<td align="right">0.56</td>
</tr>
<tr class="odd">
<td align="left">beta_wf[1]</td>
<td align="right">-0.27</td>
<td align="right">0.34</td>
<td align="right">-0.81</td>
<td align="right">0.27</td>
</tr>
<tr class="even">
<td align="left">beta_wf[2]</td>
<td align="right">0.21</td>
<td align="right">0.34</td>
<td align="right">-0.33</td>
<td align="right">0.75</td>
</tr>
<tr class="odd">
<td align="left">beta_jw[1]</td>
<td align="right">0.09</td>
<td align="right">0.35</td>
<td align="right">-0.46</td>
<td align="right">0.65</td>
</tr>
<tr class="even">
<td align="left">beta_jw[2]</td>
<td align="right">-0.01</td>
<td align="right">0.34</td>
<td align="right">-0.56</td>
<td align="right">0.54</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.97</td>
<td align="right">0.05</td>
<td align="right">0.89</td>
<td align="right">1.05</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="rethinking-chapter-8.html#cb788-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">precis</span>(model_wine_inter, <span class="at">depth =</span> <span class="dv">2</span>, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb788-2"><a href="rethinking-chapter-8.html#cb788-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble_rn</span>() <span class="sc">%&gt;%</span></span>
<span id="cb788-3"><a href="rethinking-chapter-8.html#cb788-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">str_remove</span>(param, <span class="at">pattern =</span>  <span class="st">&quot;alpha_&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">[[0-9]*</span><span class="sc">\\</span><span class="st">]&quot;</span>),</span>
<span id="cb788-4"><a href="rethinking-chapter-8.html#cb788-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">idx =</span> <span class="fu">str_extract</span>(param, <span class="st">&quot;[0-9]{1,2}&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>(),</span>
<span id="cb788-5"><a href="rethinking-chapter-8.html#cb788-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">across</span>(mean<span class="sc">:</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>,<span class="at">.fns =</span> (<span class="cf">function</span>(x){ x <span class="sc">*</span> <span class="fu">sd</span>(data_wine<span class="sc">$</span>score) <span class="sc">+</span> <span class="fu">mean</span>(data_wine<span class="sc">$</span>score)}))) <span class="sc">%&gt;%</span></span>
<span id="cb788-6"><a href="rethinking-chapter-8.html#cb788-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(wine_params, by = c(&quot;type&quot;, &quot;idx&quot;)) %&gt;%</span></span>
<span id="cb788-7"><a href="rethinking-chapter-8.html#cb788-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(type) %&gt;% </span></span>
<span id="cb788-8"><a href="rethinking-chapter-8.html#cb788-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(name = fct_reorder(name, mean),</span></span>
<span id="cb788-9"><a href="rethinking-chapter-8.html#cb788-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        name = str_c(str_pad(30 - as.numeric(name), width = 2, pad = 0),&quot;: &quot;,name)) %&gt;% </span></span>
<span id="cb788-10"><a href="rethinking-chapter-8.html#cb788-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() %&gt;% </span></span>
<span id="cb788-11"><a href="rethinking-chapter-8.html#cb788-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">factor</span>(idx), <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb788-12"><a href="rethinking-chapter-8.html#cb788-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_vline(xintercept = 0, lty = 3, color = rgb(0,0,0,.6)) +</span></span>
<span id="cb788-13"><a href="rethinking-chapter-8.html#cb788-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointinterval</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">x =</span> mean,</span>
<span id="cb788-14"><a href="rethinking-chapter-8.html#cb788-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xmax =</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb788-15"><a href="rethinking-chapter-8.html#cb788-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">j =</span> clr0d, <span class="at">w =</span> clr0d, <span class="at">f =</span> clr0d,</span>
<span id="cb788-16"><a href="rethinking-chapter-8.html#cb788-16" aria-hidden="true" tabindex="-1"></a>                                <span class="at">beta_wf =</span> clr1, <span class="at">beta_jw =</span> clr1, <span class="at">beta_jf =</span> clr1),</span>
<span id="cb788-17"><a href="rethinking-chapter-8.html#cb788-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb788-18"><a href="rethinking-chapter-8.html#cb788-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(type <span class="sc">~</span> . , <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb788-19"><a href="rethinking-chapter-8.html#cb788-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;score&quot;</span>) <span class="sc">+</span></span>
<span id="cb788-20"><a href="rethinking-chapter-8.html#cb788-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb788-21"><a href="rethinking-chapter-8.html#cb788-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb788-22"><a href="rethinking-chapter-8.html#cb788-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>)</span>
<span id="cb788-23"><a href="rethinking-chapter-8.html#cb788-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb788-24"><a href="rethinking-chapter-8.html#cb788-24" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data_wine <span class="sc">%&gt;%</span> </span>
<span id="cb788-25"><a href="rethinking-chapter-8.html#cb788-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb788-26"><a href="rethinking-chapter-8.html#cb788-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">adjust =</span> .<span class="dv">6</span>, <span class="at">color =</span> clr0dd, <span class="at">fill =</span> fll0) <span class="sc">+</span></span>
<span id="cb788-27"><a href="rethinking-chapter-8.html#cb788-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="dv">20</span>)) </span>
<span id="cb788-28"><a href="rethinking-chapter-8.html#cb788-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb788-29"><a href="rethinking-chapter-8.html#cb788-29" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>,.<span class="dv">2</span>))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-36-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="brms-section-6" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> {brms} section</h2>
<div id="building-an-interaction-1" class="section level3" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Building an Interaction</h3>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="rethinking-chapter-8.html#cb789-1" aria-hidden="true" tabindex="-1"></a>data_rugged_centered <span class="ot">&lt;-</span> data_rugged <span class="sc">%&gt;%</span> </span>
<span id="cb789-2"><a href="rethinking-chapter-8.html#cb789-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rugged_std_centered =</span> rugged_std <span class="sc">-</span> <span class="fu">mean</span>(rugged_std),</span>
<span id="cb789-3"><a href="rethinking-chapter-8.html#cb789-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">cont_idx =</span> <span class="fu">factor</span>(cont_idx))</span>
<span id="cb789-4"><a href="rethinking-chapter-8.html#cb789-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb789-5"><a href="rethinking-chapter-8.html#cb789-5" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_draft <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb789-6"><a href="rethinking-chapter-8.html#cb789-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_rugged_centered, </span>
<span id="cb789-7"><a href="rethinking-chapter-8.html#cb789-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb789-8"><a href="rethinking-chapter-8.html#cb789-8" aria-hidden="true" tabindex="-1"></a>  log_gdp_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> rugged_std_centered,</span>
<span id="cb789-9"><a href="rethinking-chapter-8.html#cb789-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb789-10"><a href="rethinking-chapter-8.html#cb789-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb789-11"><a href="rethinking-chapter-8.html#cb789-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb789-12"><a href="rethinking-chapter-8.html#cb789-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb789-13"><a href="rethinking-chapter-8.html#cb789-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb789-14"><a href="rethinking-chapter-8.html#cb789-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb789-15"><a href="rethinking-chapter-8.html#cb789-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_prior =</span> <span class="cn">TRUE</span>,</span>
<span id="cb789-16"><a href="rethinking-chapter-8.html#cb789-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c8_model_rugged_draft&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="rethinking-chapter-8.html#cb790-1" aria-hidden="true" tabindex="-1"></a>prior_rugged_draft <span class="ot">&lt;-</span> <span class="fu">prior_draws</span>(brms_c8_model_rugged_draft) <span class="sc">%&gt;%</span></span>
<span id="cb790-2"><a href="rethinking-chapter-8.html#cb790-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb790-3"><a href="rethinking-chapter-8.html#cb790-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-4"><a href="rethinking-chapter-8.html#cb790-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>)</span>
<span id="cb790-5"><a href="rethinking-chapter-8.html#cb790-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-6"><a href="rethinking-chapter-8.html#cb790-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> prior_rugged_draft <span class="sc">%&gt;%</span> </span>
<span id="cb790-7"><a href="rethinking-chapter-8.html#cb790-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb790-8"><a href="rethinking-chapter-8.html#cb790-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb790-9"><a href="rethinking-chapter-8.html#cb790-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(rowname, Intercept, b),</span>
<span id="cb790-10"><a href="rethinking-chapter-8.html#cb790-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">rugged_std_centered =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb790-11"><a href="rethinking-chapter-8.html#cb790-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_gdp_std =</span> Intercept <span class="sc">+</span> b <span class="sc">*</span> rugged_std_centered,</span>
<span id="cb790-12"><a href="rethinking-chapter-8.html#cb790-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">rugged_std  =</span> rugged_std_centered <span class="sc">+</span> <span class="fu">mean</span>(data_rugged_centered<span class="sc">$</span>rugged_std)) <span class="sc">%&gt;%</span> </span>
<span id="cb790-13"><a href="rethinking-chapter-8.html#cb790-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb790-14"><a href="rethinking-chapter-8.html#cb790-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rugged_std, <span class="at">y =</span> log_gdp_std, <span class="at">group =</span> rowname)) <span class="sc">+</span></span>
<span id="cb790-15"><a href="rethinking-chapter-8.html#cb790-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">range</span>(data_rugged_centered<span class="sc">$</span>log_gdp_std), </span>
<span id="cb790-16"><a href="rethinking-chapter-8.html#cb790-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb790-17"><a href="rethinking-chapter-8.html#cb790-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="fu">clr_alpha</span>(clr0d)) <span class="sc">+</span></span>
<span id="cb790-18"><a href="rethinking-chapter-8.html#cb790-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">1.3</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="fl">0.6</span>,</span>
<span id="cb790-19"><a href="rethinking-chapter-8.html#cb790-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> clr0dd) <span class="sc">+</span></span>
<span id="cb790-20"><a href="rethinking-chapter-8.html#cb790-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">&quot;{mth(&#39;\U03B1 \U007E&#39;)} dnorm(1, 1)&lt;br&gt;{mth(&#39;\U03B2 \U007E&#39;)} dnorm(0, 1)&quot;</span>),</span>
<span id="cb790-21"><a href="rethinking-chapter-8.html#cb790-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;ruggedness&quot;</span>,</span>
<span id="cb790-22"><a href="rethinking-chapter-8.html#cb790-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log GDP (prop of mean)&quot;</span>) <span class="sc">+</span></span>
<span id="cb790-23"><a href="rethinking-chapter-8.html#cb790-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb790-24"><a href="rethinking-chapter-8.html#cb790-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb790-25"><a href="rethinking-chapter-8.html#cb790-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb790-26"><a href="rethinking-chapter-8.html#cb790-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-27"><a href="rethinking-chapter-8.html#cb790-27" aria-hidden="true" tabindex="-1"></a>prior_rugged_draft <span class="sc">%&gt;%</span></span>
<span id="cb790-28"><a href="rethinking-chapter-8.html#cb790-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">a =</span> <span class="fu">sum</span>(<span class="fu">abs</span>(b) <span class="sc">&gt;</span> <span class="fu">abs</span>(<span class="sc">-</span><span class="fl">0.6</span>)) <span class="sc">/</span> <span class="fu">nrow</span>(prior_rugged_draft))</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 1
#&gt;       a
#&gt;   &lt;dbl&gt;
#&gt; 1 0.552</code></pre>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="rethinking-chapter-8.html#cb792-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_restricted <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb792-2"><a href="rethinking-chapter-8.html#cb792-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_rugged_centered, </span>
<span id="cb792-3"><a href="rethinking-chapter-8.html#cb792-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb792-4"><a href="rethinking-chapter-8.html#cb792-4" aria-hidden="true" tabindex="-1"></a>  log_gdp_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> rugged_std_centered,</span>
<span id="cb792-5"><a href="rethinking-chapter-8.html#cb792-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb792-6"><a href="rethinking-chapter-8.html#cb792-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, .<span class="dv">3</span>), <span class="at">class =</span> b),</span>
<span id="cb792-7"><a href="rethinking-chapter-8.html#cb792-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb792-8"><a href="rethinking-chapter-8.html#cb792-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb792-9"><a href="rethinking-chapter-8.html#cb792-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb792-10"><a href="rethinking-chapter-8.html#cb792-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb792-11"><a href="rethinking-chapter-8.html#cb792-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_prior =</span> <span class="cn">TRUE</span>,</span>
<span id="cb792-12"><a href="rethinking-chapter-8.html#cb792-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c8_model_rugged_restricted&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="rethinking-chapter-8.html#cb793-1" aria-hidden="true" tabindex="-1"></a>prior_rugged_restricted <span class="ot">&lt;-</span> <span class="fu">prior_draws</span>(brms_c8_model_rugged_restricted) <span class="sc">%&gt;%</span></span>
<span id="cb793-2"><a href="rethinking-chapter-8.html#cb793-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb793-3"><a href="rethinking-chapter-8.html#cb793-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb793-4"><a href="rethinking-chapter-8.html#cb793-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>)</span>
<span id="cb793-5"><a href="rethinking-chapter-8.html#cb793-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb793-6"><a href="rethinking-chapter-8.html#cb793-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> prior_rugged_restricted <span class="sc">%&gt;%</span> </span>
<span id="cb793-7"><a href="rethinking-chapter-8.html#cb793-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb793-8"><a href="rethinking-chapter-8.html#cb793-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb793-9"><a href="rethinking-chapter-8.html#cb793-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(rowname, Intercept, b),</span>
<span id="cb793-10"><a href="rethinking-chapter-8.html#cb793-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">rugged_std_centered =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb793-11"><a href="rethinking-chapter-8.html#cb793-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_gdp_std =</span> Intercept <span class="sc">+</span> b <span class="sc">*</span> rugged_std_centered,</span>
<span id="cb793-12"><a href="rethinking-chapter-8.html#cb793-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">rugged_std  =</span> rugged_std_centered <span class="sc">+</span> <span class="fu">mean</span>(data_rugged_centered<span class="sc">$</span>rugged_std)) <span class="sc">%&gt;%</span> </span>
<span id="cb793-13"><a href="rethinking-chapter-8.html#cb793-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb793-14"><a href="rethinking-chapter-8.html#cb793-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rugged_std, <span class="at">y =</span> log_gdp_std, <span class="at">group =</span> rowname)) <span class="sc">+</span></span>
<span id="cb793-15"><a href="rethinking-chapter-8.html#cb793-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">range</span>(data_rugged_centered<span class="sc">$</span>log_gdp_std), </span>
<span id="cb793-16"><a href="rethinking-chapter-8.html#cb793-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb793-17"><a href="rethinking-chapter-8.html#cb793-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="fu">clr_alpha</span>(clr0d)) <span class="sc">+</span></span>
<span id="cb793-18"><a href="rethinking-chapter-8.html#cb793-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">&quot;{mth(&#39;\U03B1 \U007E&#39;)} dnorm(1, 0.1)&lt;br&gt;{mth(&#39;\U03B2 \U007E&#39;)} dnorm(0, 0.3)&quot;</span>),</span>
<span id="cb793-19"><a href="rethinking-chapter-8.html#cb793-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;ruggedness&quot;</span>,</span>
<span id="cb793-20"><a href="rethinking-chapter-8.html#cb793-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log GDP (prop of mean)&quot;</span>) <span class="sc">+</span></span>
<span id="cb793-21"><a href="rethinking-chapter-8.html#cb793-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb793-22"><a href="rethinking-chapter-8.html#cb793-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb793-23"><a href="rethinking-chapter-8.html#cb793-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb793-24"><a href="rethinking-chapter-8.html#cb793-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb793-25"><a href="rethinking-chapter-8.html#cb793-25" aria-hidden="true" tabindex="-1"></a>prior_rugged_restricted <span class="sc">%&gt;%</span></span>
<span id="cb793-26"><a href="rethinking-chapter-8.html#cb793-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">a =</span> <span class="fu">sum</span>(<span class="fu">abs</span>(b) <span class="sc">&gt;</span> <span class="fu">abs</span>(<span class="sc">-</span><span class="fl">0.6</span>)) <span class="sc">/</span> <span class="fu">nrow</span>(prior_rugged_draft))</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 1
#&gt;        a
#&gt;    &lt;dbl&gt;
#&gt; 1 0.0382</code></pre>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="rethinking-chapter-8.html#cb795-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-41-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="rethinking-chapter-8.html#cb796-1" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">summarize_model</span>(brms_c8_model_rugged_restricted)</span></code></pre></div>
<pre><code>#&gt;     Group Effect Variance   SD SD_2.5 SD_97.5 Var_prop
#&gt;  Residual            0.02 0.14   0.12    0.15     1.00
#&gt;                 Term Value   SE Lower_2.5 Upper_97.5
#&gt;            Intercept  1.00 0.01      0.98       1.02
#&gt;  rugged_std_centered  0.00 0.06     -0.11       0.12</code></pre>
<div id="adding-an-indicator-variable-is-not-enough" class="section level4" number="9.5.1.1">
<h4><span class="header-section-number">9.5.1.1</span> Adding an indicator variable is not enough</h4>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="rethinking-chapter-8.html#cb798-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_index <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb798-2"><a href="rethinking-chapter-8.html#cb798-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_rugged_centered, </span>
<span id="cb798-3"><a href="rethinking-chapter-8.html#cb798-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb798-4"><a href="rethinking-chapter-8.html#cb798-4" aria-hidden="true" tabindex="-1"></a>  log_gdp_std <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> cont_idx <span class="sc">+</span> rugged_std_centered,</span>
<span id="cb798-5"><a href="rethinking-chapter-8.html#cb798-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> cont_idx1),</span>
<span id="cb798-6"><a href="rethinking-chapter-8.html#cb798-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> cont_idx2),</span>
<span id="cb798-7"><a href="rethinking-chapter-8.html#cb798-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b, <span class="at">coef =</span> rugged_std_centered),</span>
<span id="cb798-8"><a href="rethinking-chapter-8.html#cb798-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb798-9"><a href="rethinking-chapter-8.html#cb798-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb798-10"><a href="rethinking-chapter-8.html#cb798-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb798-11"><a href="rethinking-chapter-8.html#cb798-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c8_model_rugged_index&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="rethinking-chapter-8.html#cb799-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_restricted <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(brms_c8_model_rugged_restricted, <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb799-2"><a href="rethinking-chapter-8.html#cb799-2" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_index <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(brms_c8_model_rugged_index, <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb799-3"><a href="rethinking-chapter-8.html#cb799-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb799-4"><a href="rethinking-chapter-8.html#cb799-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(brms_c8_model_rugged_restricted,</span>
<span id="cb799-5"><a href="rethinking-chapter-8.html#cb799-5" aria-hidden="true" tabindex="-1"></a>            brms_c8_model_rugged_index,</span>
<span id="cb799-6"><a href="rethinking-chapter-8.html#cb799-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb799-7"><a href="rethinking-chapter-8.html#cb799-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb799-8"><a href="rethinking-chapter-8.html#cb799-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb799-9"><a href="rethinking-chapter-8.html#cb799-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>(<span class="at">param_name =</span> <span class="st">&quot;model&quot;</span>)</span></code></pre></div>
<pre><code>#&gt;                                 elpd_diff se_diff elpd_waic se_elpd_waic p_waic
#&gt; brms_c8_model_rugged_index         0.0       0.0   126.2       7.4          4.1
#&gt; brms_c8_model_rugged_restricted  -31.8       7.3    94.4       6.5          2.6
#&gt;                                 se_p_waic waic   se_waic
#&gt; brms_c8_model_rugged_index         0.8    -252.4   14.8 
#&gt; brms_c8_model_rugged_restricted    0.3    -188.8   13.0</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="right">elpd_diff</th>
<th align="right">se_diff</th>
<th align="right">elpd_waic</th>
<th align="right">se_elpd_waic</th>
<th align="right">p_waic</th>
<th align="right">se_p_waic</th>
<th align="right">waic</th>
<th align="right">se_waic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">brms_c8_model_rugged_index</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">126.21</td>
<td align="right">7.41</td>
<td align="right">4.08</td>
<td align="right">0.80</td>
<td align="right">-252.42</td>
<td align="right">14.81</td>
</tr>
<tr class="even">
<td align="left">brms_c8_model_rugged_restricted</td>
<td align="right">-31.81</td>
<td align="right">7.32</td>
<td align="right">94.40</td>
<td align="right">6.48</td>
<td align="right">2.61</td>
<td align="right">0.29</td>
<td align="right">-188.80</td>
<td align="right">12.95</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="rethinking-chapter-8.html#cb801-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(brms_c8_model_rugged_restricted,</span>
<span id="cb801-2"><a href="rethinking-chapter-8.html#cb801-2" aria-hidden="true" tabindex="-1"></a>              brms_c8_model_rugged_index,</span>
<span id="cb801-3"><a href="rethinking-chapter-8.html#cb801-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">weights =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb801-4"><a href="rethinking-chapter-8.html#cb801-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>#&gt; brms_c8_model_rugged_restricted      brms_c8_model_rugged_index 
#&gt;                               0                               1</code></pre>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="rethinking-chapter-8.html#cb803-1" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">summarize_model</span>(brms_c8_model_rugged_index)</span></code></pre></div>
<pre><code>#&gt;     Group Effect Variance   SD SD_2.5 SD_97.5 Var_prop
#&gt;  Residual            0.01 0.11   0.10    0.13     1.00
#&gt;                 Term Value   SE Lower_2.5 Upper_97.5
#&gt;            cont_idx1  0.88 0.02      0.85       0.91
#&gt;            cont_idx2  1.05 0.01      1.03       1.07
#&gt;  rugged_std_centered -0.05 0.05     -0.14       0.04</code></pre>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="rethinking-chapter-8.html#cb805-1" aria-hidden="true" tabindex="-1"></a>posterior_rugged_index <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(brms_c8_model_rugged_index) <span class="sc">%&gt;%</span></span>
<span id="cb805-2"><a href="rethinking-chapter-8.html#cb805-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb805-3"><a href="rethinking-chapter-8.html#cb805-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> b_cont_idx1 <span class="sc">-</span> b_cont_idx2)</span>
<span id="cb805-4"><a href="rethinking-chapter-8.html#cb805-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb805-5"><a href="rethinking-chapter-8.html#cb805-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb805-6"><a href="rethinking-chapter-8.html#cb805-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb805-7"><a href="rethinking-chapter-8.html#cb805-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qi</span>(posterior_rugged_index<span class="sc">$</span>diff, <span class="at">.width =</span> .<span class="dv">89</span>) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 2
#&gt;       V1     V2
#&gt;    &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1 -0.200 -0.138</code></pre>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="rethinking-chapter-8.html#cb807-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">cont_idx =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb807-2"><a href="rethinking-chapter-8.html#cb807-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">rugged_std =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">to =</span> <span class="fl">1.2</span>, <span class="at">length.out =</span> <span class="dv">30</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb807-3"><a href="rethinking-chapter-8.html#cb807-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rugged_std_centered =</span> rugged_std <span class="sc">-</span> <span class="fu">mean</span>(data_rugged_centered<span class="sc">$</span>rugged_std))</span>
<span id="cb807-4"><a href="rethinking-chapter-8.html#cb807-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb807-5"><a href="rethinking-chapter-8.html#cb807-5" aria-hidden="true" tabindex="-1"></a>fitted_rugged_index <span class="ot">&lt;-</span> <span class="fu">fitted</span>(</span>
<span id="cb807-6"><a href="rethinking-chapter-8.html#cb807-6" aria-hidden="true" tabindex="-1"></a>  brms_c8_model_rugged_index, </span>
<span id="cb807-7"><a href="rethinking-chapter-8.html#cb807-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> new_data,</span>
<span id="cb807-8"><a href="rethinking-chapter-8.html#cb807-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">015</span>, .<span class="dv">985</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb807-9"><a href="rethinking-chapter-8.html#cb807-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb807-10"><a href="rethinking-chapter-8.html#cb807-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(new_data) <span class="sc">%&gt;%</span></span>
<span id="cb807-11"><a href="rethinking-chapter-8.html#cb807-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cont_africa =</span> <span class="fu">c</span>(<span class="st">&quot;Africa&quot;</span>, <span class="st">&quot;not Africa&quot;</span>)[cont_idx])</span>
<span id="cb807-12"><a href="rethinking-chapter-8.html#cb807-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb807-13"><a href="rethinking-chapter-8.html#cb807-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> data_rugged_centered <span class="sc">%&gt;%</span></span>
<span id="cb807-14"><a href="rethinking-chapter-8.html#cb807-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cont_africa =</span> <span class="fu">c</span>(<span class="st">&quot;Africa&quot;</span>, <span class="st">&quot;not Africa&quot;</span>)[cont_idx]) <span class="sc">%&gt;%</span></span>
<span id="cb807-15"><a href="rethinking-chapter-8.html#cb807-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rugged_std, <span class="at">fill =</span> cont_africa, <span class="at">color =</span> cont_africa)) <span class="sc">+</span></span>
<span id="cb807-16"><a href="rethinking-chapter-8.html#cb807-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> fitted_rugged_index,</span>
<span id="cb807-17"><a href="rethinking-chapter-8.html#cb807-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q1<span class="fl">.5</span>, <span class="at">ymax =</span> Q98<span class="fl">.5</span>),</span>
<span id="cb807-18"><a href="rethinking-chapter-8.html#cb807-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb807-19"><a href="rethinking-chapter-8.html#cb807-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">size =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb807-20"><a href="rethinking-chapter-8.html#cb807-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> log_gdp_std),</span>
<span id="cb807-21"><a href="rethinking-chapter-8.html#cb807-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb807-22"><a href="rethinking-chapter-8.html#cb807-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Africa =</span> clr0dd, <span class="st">`</span><span class="at">not Africa</span><span class="st">`</span> <span class="ot">=</span> clr0d)) <span class="sc">+</span></span>
<span id="cb807-23"><a href="rethinking-chapter-8.html#cb807-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Africa =</span> clr0dd, <span class="st">`</span><span class="at">not Africa</span><span class="st">`</span> <span class="ot">=</span> clr0d)) <span class="sc">+</span></span>
<span id="cb807-24"><a href="rethinking-chapter-8.html#cb807-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;brms_c8_model_rugged_index&quot;</span>,</span>
<span id="cb807-25"><a href="rethinking-chapter-8.html#cb807-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;ruggedness (standardized)&quot;</span>,</span>
<span id="cb807-26"><a href="rethinking-chapter-8.html#cb807-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log GDP (as proportion of mean)&quot;</span>) <span class="sc">+</span></span>
<span id="cb807-27"><a href="rethinking-chapter-8.html#cb807-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb807-28"><a href="rethinking-chapter-8.html#cb807-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb807-29"><a href="rethinking-chapter-8.html#cb807-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb807-30"><a href="rethinking-chapter-8.html#cb807-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>Using <code>stat_lineribbon()</code> since <em>‘boundaries are meaningless’</em>:</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="rethinking-chapter-8.html#cb808-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">fitted</span>(brms_c8_model_rugged_index, </span>
<span id="cb808-2"><a href="rethinking-chapter-8.html#cb808-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> new_data,</span>
<span id="cb808-3"><a href="rethinking-chapter-8.html#cb808-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb808-4"><a href="rethinking-chapter-8.html#cb808-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb808-5"><a href="rethinking-chapter-8.html#cb808-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb808-6"><a href="rethinking-chapter-8.html#cb808-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb808-7"><a href="rethinking-chapter-8.html#cb808-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand</span>(new_data, </span>
<span id="cb808-8"><a href="rethinking-chapter-8.html#cb808-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>,</span>
<span id="cb808-9"><a href="rethinking-chapter-8.html#cb808-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nesting</span>(cont_idx, rugged_std))</span>
<span id="cb808-10"><a href="rethinking-chapter-8.html#cb808-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb808-11"><a href="rethinking-chapter-8.html#cb808-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cont_africa =</span> <span class="fu">c</span>(<span class="st">&quot;Africa&quot;</span>, <span class="st">&quot;not Africa&quot;</span>)[cont_idx]) <span class="sc">%&gt;%</span> </span>
<span id="cb808-12"><a href="rethinking-chapter-8.html#cb808-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rugged_std, <span class="at">y =</span> value, <span class="at">fill =</span> cont_africa, <span class="at">color =</span> cont_africa)) <span class="sc">+</span></span>
<span id="cb808-13"><a href="rethinking-chapter-8.html#cb808-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">03</span>, <span class="at">to =</span> .<span class="dv">99</span>, <span class="at">by =</span> .<span class="dv">03</span>),</span>
<span id="cb808-14"><a href="rethinking-chapter-8.html#cb808-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> .<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb808-15"><a href="rethinking-chapter-8.html#cb808-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_rugged_centered <span class="sc">%&gt;%</span> </span>
<span id="cb808-16"><a href="rethinking-chapter-8.html#cb808-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">cont_africa =</span> <span class="fu">c</span>(<span class="st">&quot;Africa&quot;</span>, <span class="st">&quot;not Africa&quot;</span>)[cont_idx]),</span>
<span id="cb808-17"><a href="rethinking-chapter-8.html#cb808-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> log_gdp_std),</span>
<span id="cb808-18"><a href="rethinking-chapter-8.html#cb808-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb808-19"><a href="rethinking-chapter-8.html#cb808-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Africa =</span> clr0dd, <span class="st">`</span><span class="at">not Africa</span><span class="st">`</span> <span class="ot">=</span> clr0d),</span>
<span id="cb808-20"><a href="rethinking-chapter-8.html#cb808-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb808-21"><a href="rethinking-chapter-8.html#cb808-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Africa =</span> clr0dd, <span class="st">`</span><span class="at">not Africa</span><span class="st">`</span> <span class="ot">=</span> clr0d),</span>
<span id="cb808-22"><a href="rethinking-chapter-8.html#cb808-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb808-23"><a href="rethinking-chapter-8.html#cb808-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;brms_c8_model_rugged_index&quot;</span>,</span>
<span id="cb808-24"><a href="rethinking-chapter-8.html#cb808-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;ruggedness (standardized)&quot;</span>,</span>
<span id="cb808-25"><a href="rethinking-chapter-8.html#cb808-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log GDP (as proportion of mean)&quot;</span>) <span class="sc">+</span></span>
<span id="cb808-26"><a href="rethinking-chapter-8.html#cb808-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb808-27"><a href="rethinking-chapter-8.html#cb808-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb808-28"><a href="rethinking-chapter-8.html#cb808-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb808-29"><a href="rethinking-chapter-8.html#cb808-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="rethinking-chapter-8.html#cb809-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-49-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="adding-an-interaction-does-work-1" class="section level4" number="9.5.1.2">
<h4><span class="header-section-number">9.5.1.2</span> Adding an interaction does work</h4>
<p>Remeber the <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_nonlinear.html">non-linear syntax</a> for {brms} to use with index variables.</p>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="rethinking-chapter-8.html#cb810-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_slope <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb810-2"><a href="rethinking-chapter-8.html#cb810-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_rugged_centered, </span>
<span id="cb810-3"><a href="rethinking-chapter-8.html#cb810-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb810-4"><a href="rethinking-chapter-8.html#cb810-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(log_gdp_std <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">*</span> rugged_std_centered, </span>
<span id="cb810-5"><a href="rethinking-chapter-8.html#cb810-5" aria-hidden="true" tabindex="-1"></a>     a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> cont_idx, </span>
<span id="cb810-6"><a href="rethinking-chapter-8.html#cb810-6" aria-hidden="true" tabindex="-1"></a>     b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> cont_idx,</span>
<span id="cb810-7"><a href="rethinking-chapter-8.html#cb810-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb810-8"><a href="rethinking-chapter-8.html#cb810-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> cont_idx1, <span class="at">nlpar =</span> a),</span>
<span id="cb810-9"><a href="rethinking-chapter-8.html#cb810-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> cont_idx2, <span class="at">nlpar =</span> a),</span>
<span id="cb810-10"><a href="rethinking-chapter-8.html#cb810-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b, <span class="at">coef =</span> cont_idx1, <span class="at">nlpar =</span> b),</span>
<span id="cb810-11"><a href="rethinking-chapter-8.html#cb810-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b, <span class="at">coef =</span> cont_idx2, <span class="at">nlpar =</span> b),</span>
<span id="cb810-12"><a href="rethinking-chapter-8.html#cb810-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb810-13"><a href="rethinking-chapter-8.html#cb810-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, </span>
<span id="cb810-14"><a href="rethinking-chapter-8.html#cb810-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb810-15"><a href="rethinking-chapter-8.html#cb810-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb810-16"><a href="rethinking-chapter-8.html#cb810-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c8_model_rugged_slope&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="rethinking-chapter-8.html#cb811-1" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">summarise_model</span>(brms_c8_model_rugged_slope)</span></code></pre></div>
<pre><code>#&gt;     Group Effect Variance   SD SD_2.5 SD_97.5 Var_prop
#&gt;  Residual            0.01 0.11   0.10    0.12     1.00
#&gt;         Term Value   SE Lower_2.5 Upper_97.5
#&gt;  a_cont_idx1  0.89 0.02      0.86       0.92
#&gt;  a_cont_idx2  1.05 0.01      1.03       1.07
#&gt;  b_cont_idx1  0.13 0.07     -0.01       0.28
#&gt;  b_cont_idx2 -0.14 0.06     -0.25      -0.03</code></pre>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="rethinking-chapter-8.html#cb813-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_restricted <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(brms_c8_model_rugged_restricted, <span class="st">&quot;loo&quot;</span>)</span>
<span id="cb813-2"><a href="rethinking-chapter-8.html#cb813-2" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_index <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(brms_c8_model_rugged_index, <span class="st">&quot;loo&quot;</span>)</span>
<span id="cb813-3"><a href="rethinking-chapter-8.html#cb813-3" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_slope <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(brms_c8_model_rugged_slope, <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb813-4"><a href="rethinking-chapter-8.html#cb813-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb813-5"><a href="rethinking-chapter-8.html#cb813-5" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(brms_c8_model_rugged_restricted,</span>
<span id="cb813-6"><a href="rethinking-chapter-8.html#cb813-6" aria-hidden="true" tabindex="-1"></a>            brms_c8_model_rugged_index,</span>
<span id="cb813-7"><a href="rethinking-chapter-8.html#cb813-7" aria-hidden="true" tabindex="-1"></a>            brms_c8_model_rugged_slope,</span>
<span id="cb813-8"><a href="rethinking-chapter-8.html#cb813-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb813-9"><a href="rethinking-chapter-8.html#cb813-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>#&gt;                                 elpd_diff se_diff elpd_loo se_elpd_loo p_loo 
#&gt; brms_c8_model_rugged_slope         0.0       0.0   129.7      7.3         4.9
#&gt; brms_c8_model_rugged_index        -3.5       3.2   126.2      7.4         4.1
#&gt; brms_c8_model_rugged_restricted  -35.3       7.5    94.4      6.5         2.6
#&gt;                                 se_p_loo looic  se_looic
#&gt; brms_c8_model_rugged_slope         0.9   -259.3   14.7  
#&gt; brms_c8_model_rugged_index         0.8   -252.4   14.8  
#&gt; brms_c8_model_rugged_restricted    0.3   -188.8   13.0</code></pre>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="rethinking-chapter-8.html#cb815-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(brms_c8_model_rugged_restricted,</span>
<span id="cb815-2"><a href="rethinking-chapter-8.html#cb815-2" aria-hidden="true" tabindex="-1"></a>              brms_c8_model_rugged_index,</span>
<span id="cb815-3"><a href="rethinking-chapter-8.html#cb815-3" aria-hidden="true" tabindex="-1"></a>              brms_c8_model_rugged_slope,</span>
<span id="cb815-4"><a href="rethinking-chapter-8.html#cb815-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">weights =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb815-5"><a href="rethinking-chapter-8.html#cb815-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>#&gt; brms_c8_model_rugged_restricted      brms_c8_model_rugged_index 
#&gt;                            0.00                            0.03 
#&gt;      brms_c8_model_rugged_slope 
#&gt;                            0.97</code></pre>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="rethinking-chapter-8.html#cb817-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">k =</span> brms_c8_model_rugged_slope<span class="sc">$</span>criteria<span class="sc">$</span>loo<span class="sc">$</span>diagnostics<span class="sc">$</span>pareto_k,</span>
<span id="cb817-2"><a href="rethinking-chapter-8.html#cb817-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">170</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb817-3"><a href="rethinking-chapter-8.html#cb817-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(k))</span></code></pre></div>
<pre><code>#&gt; # A tibble: 170 x 2
#&gt;        k   row
#&gt;    &lt;dbl&gt; &lt;int&gt;
#&gt;  1 0.512   145
#&gt;  2 0.494    93
#&gt;  3 0.262    35
#&gt;  4 0.240   133
#&gt;  5 0.240    36
#&gt;  6 0.195    27
#&gt;  7 0.182   144
#&gt;  8 0.149    67
#&gt;  9 0.143    99
#&gt; 10 0.139   107
#&gt; # … with 160 more rows</code></pre>
<p>Robust model variant using a student-t distribution as prior</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="rethinking-chapter-8.html#cb819-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_student <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb819-2"><a href="rethinking-chapter-8.html#cb819-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_rugged_centered, </span>
<span id="cb819-3"><a href="rethinking-chapter-8.html#cb819-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> student,</span>
<span id="cb819-4"><a href="rethinking-chapter-8.html#cb819-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(log_gdp_std <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">*</span> rugged_std_centered, </span>
<span id="cb819-5"><a href="rethinking-chapter-8.html#cb819-5" aria-hidden="true" tabindex="-1"></a>     a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> cont_idx, </span>
<span id="cb819-6"><a href="rethinking-chapter-8.html#cb819-6" aria-hidden="true" tabindex="-1"></a>     b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> cont_idx,</span>
<span id="cb819-7"><a href="rethinking-chapter-8.html#cb819-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb819-8"><a href="rethinking-chapter-8.html#cb819-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> cont_idx1, <span class="at">nlpar =</span> a),</span>
<span id="cb819-9"><a href="rethinking-chapter-8.html#cb819-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> cont_idx2, <span class="at">nlpar =</span> a),</span>
<span id="cb819-10"><a href="rethinking-chapter-8.html#cb819-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b, <span class="at">coef =</span> cont_idx1, <span class="at">nlpar =</span> b),</span>
<span id="cb819-11"><a href="rethinking-chapter-8.html#cb819-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b, <span class="at">coef =</span> cont_idx2, <span class="at">nlpar =</span> b),</span>
<span id="cb819-12"><a href="rethinking-chapter-8.html#cb819-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb819-13"><a href="rethinking-chapter-8.html#cb819-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, </span>
<span id="cb819-14"><a href="rethinking-chapter-8.html#cb819-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb819-15"><a href="rethinking-chapter-8.html#cb819-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb819-16"><a href="rethinking-chapter-8.html#cb819-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c8_model_rugged_student&quot;</span>)</span>
<span id="cb819-17"><a href="rethinking-chapter-8.html#cb819-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb819-18"><a href="rethinking-chapter-8.html#cb819-18" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_student <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(brms_c8_model_rugged_student,</span>
<span id="cb819-19"><a href="rethinking-chapter-8.html#cb819-19" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb819-20"><a href="rethinking-chapter-8.html#cb819-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb819-21"><a href="rethinking-chapter-8.html#cb819-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb819-22"><a href="rethinking-chapter-8.html#cb819-22" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(brms_c8_model_rugged_slope,</span>
<span id="cb819-23"><a href="rethinking-chapter-8.html#cb819-23" aria-hidden="true" tabindex="-1"></a>            brms_c8_model_rugged_student,</span>
<span id="cb819-24"><a href="rethinking-chapter-8.html#cb819-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb819-25"><a href="rethinking-chapter-8.html#cb819-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>#&gt;                              elpd_diff se_diff elpd_loo se_elpd_loo p_loo 
#&gt; brms_c8_model_rugged_slope      0.0       0.0   129.7      7.3         4.9
#&gt; brms_c8_model_rugged_student   -1.3       0.3   128.4      7.5         5.0
#&gt;                              se_p_loo looic  se_looic
#&gt; brms_c8_model_rugged_slope      0.9   -259.3   14.7  
#&gt; brms_c8_model_rugged_student    0.8   -256.7   14.9</code></pre>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="rethinking-chapter-8.html#cb821-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Normal =</span> brms_c8_model_rugged_slope<span class="sc">$</span>criteria<span class="sc">$</span>loo<span class="sc">$</span>diagnostics<span class="sc">$</span>pareto_k,</span>
<span id="cb821-2"><a href="rethinking-chapter-8.html#cb821-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">`</span><span class="at">Student-t</span><span class="st">`</span> <span class="ot">=</span> brms_c8_model_rugged_student<span class="sc">$</span>criteria<span class="sc">$</span>loo<span class="sc">$</span>diagnostics<span class="sc">$</span>pareto_k) <span class="sc">%&gt;%</span> </span>
<span id="cb821-3"><a href="rethinking-chapter-8.html#cb821-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb821-4"><a href="rethinking-chapter-8.html#cb821-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;pareto_k&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb821-5"><a href="rethinking-chapter-8.html#cb821-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pareto_k, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb821-6"><a href="rethinking-chapter-8.html#cb821-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">5</span>, <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb821-7"><a href="rethinking-chapter-8.html#cb821-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">slab_fill =</span> clr0, </span>
<span id="cb821-8"><a href="rethinking-chapter-8.html#cb821-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">slab_color =</span> clr0d) <span class="sc">+</span> </span>
<span id="cb821-9"><a href="rethinking-chapter-8.html#cb821-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb821-10"><a href="rethinking-chapter-8.html#cb821-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">485</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="st">&quot;threshold&quot;</span>, <span class="at">angle =</span> <span class="dv">90</span>, </span>
<span id="cb821-11"><a href="rethinking-chapter-8.html#cb821-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> fnt_sel, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb821-12"><a href="rethinking-chapter-8.html#cb821-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb821-13"><a href="rethinking-chapter-8.html#cb821-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.4</span>))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-53-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="rethinking-chapter-8.html#cb822-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(brms_c8_model_rugged_slope) <span class="sc">%&gt;%</span></span>
<span id="cb822-2"><a href="rethinking-chapter-8.html#cb822-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb822-3"><a href="rethinking-chapter-8.html#cb822-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb822-4"><a href="rethinking-chapter-8.html#cb822-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">Estimate</th>
<th align="right">Est.Error</th>
<th align="right">Q2.5</th>
<th align="right">Q97.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">a_cont_idx1</td>
<td align="right">0.89</td>
<td align="right">0.02</td>
<td align="right">0.86</td>
<td align="right">0.92</td>
</tr>
<tr class="even">
<td align="left">a_cont_idx2</td>
<td align="right">1.05</td>
<td align="right">0.01</td>
<td align="right">1.03</td>
<td align="right">1.07</td>
</tr>
<tr class="odd">
<td align="left">b_cont_idx1</td>
<td align="right">0.13</td>
<td align="right">0.07</td>
<td align="right">-0.01</td>
<td align="right">0.28</td>
</tr>
<tr class="even">
<td align="left">b_cont_idx2</td>
<td align="right">-0.14</td>
<td align="right">0.06</td>
<td align="right">-0.25</td>
<td align="right">-0.03</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="rethinking-chapter-8.html#cb823-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(brms_c8_model_rugged_student) <span class="sc">%&gt;%</span></span>
<span id="cb823-2"><a href="rethinking-chapter-8.html#cb823-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb823-3"><a href="rethinking-chapter-8.html#cb823-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb823-4"><a href="rethinking-chapter-8.html#cb823-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">Estimate</th>
<th align="right">Est.Error</th>
<th align="right">Q2.5</th>
<th align="right">Q97.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">a_cont_idx1</td>
<td align="right">0.88</td>
<td align="right">0.02</td>
<td align="right">0.85</td>
<td align="right">0.92</td>
</tr>
<tr class="even">
<td align="left">a_cont_idx2</td>
<td align="right">1.05</td>
<td align="right">0.01</td>
<td align="right">1.03</td>
<td align="right">1.07</td>
</tr>
<tr class="odd">
<td align="left">b_cont_idx1</td>
<td align="right">0.13</td>
<td align="right">0.08</td>
<td align="right">-0.02</td>
<td align="right">0.29</td>
</tr>
<tr class="even">
<td align="left">b_cont_idx2</td>
<td align="right">-0.15</td>
<td align="right">0.06</td>
<td align="right">-0.26</td>
<td align="right">-0.03</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="plotting-the-interaction" class="section level3" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> Plotting the Interaction</h3>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="rethinking-chapter-8.html#cb824-1" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Equatorial Guinea&quot;</span>, <span class="st">&quot;South Africa&quot;</span>, <span class="st">&quot;Seychelles&quot;</span>, <span class="st">&quot;Swaziland&quot;</span>,</span>
<span id="cb824-2"><a href="rethinking-chapter-8.html#cb824-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Lesotho&quot;</span>, <span class="st">&quot;Rwanda&quot;</span>, <span class="st">&quot;Burundi&quot;</span>, <span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Greece&quot;</span>,</span>
<span id="cb824-3"><a href="rethinking-chapter-8.html#cb824-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Switzerland&quot;</span>, <span class="st">&quot;Lebanon&quot;</span>, <span class="st">&quot;Yemen&quot;</span>, <span class="st">&quot;Tajikistan&quot;</span>, <span class="st">&quot;Nepal&quot;</span>)</span>
<span id="cb824-4"><a href="rethinking-chapter-8.html#cb824-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb824-5"><a href="rethinking-chapter-8.html#cb824-5" aria-hidden="true" tabindex="-1"></a>fitted_rugged_slope <span class="ot">&lt;-</span> <span class="fu">fitted</span>(brms_c8_model_rugged_slope, </span>
<span id="cb824-6"><a href="rethinking-chapter-8.html#cb824-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> new_data,</span>
<span id="cb824-7"><a href="rethinking-chapter-8.html#cb824-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">015</span>, .<span class="dv">985</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb824-8"><a href="rethinking-chapter-8.html#cb824-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb824-9"><a href="rethinking-chapter-8.html#cb824-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(new_data) <span class="sc">%&gt;%</span></span>
<span id="cb824-10"><a href="rethinking-chapter-8.html#cb824-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cont_africa =</span> <span class="fu">c</span>(<span class="st">&quot;Africa&quot;</span>, <span class="st">&quot;not Africa&quot;</span>)[cont_idx])</span>
<span id="cb824-11"><a href="rethinking-chapter-8.html#cb824-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb824-12"><a href="rethinking-chapter-8.html#cb824-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb824-13"><a href="rethinking-chapter-8.html#cb824-13" aria-hidden="true" tabindex="-1"></a>data_rugged_centered <span class="sc">%&gt;%</span></span>
<span id="cb824-14"><a href="rethinking-chapter-8.html#cb824-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cont_africa =</span> <span class="fu">c</span>(<span class="st">&quot;Africa&quot;</span>, <span class="st">&quot;not Africa&quot;</span>)[cont_idx]) <span class="sc">%&gt;%</span></span>
<span id="cb824-15"><a href="rethinking-chapter-8.html#cb824-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rugged_std, <span class="at">y =</span> log_gdp_std,</span>
<span id="cb824-16"><a href="rethinking-chapter-8.html#cb824-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> cont_africa, <span class="at">color =</span> cont_africa)) <span class="sc">+</span></span>
<span id="cb824-17"><a href="rethinking-chapter-8.html#cb824-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> fitted_rugged_slope,</span>
<span id="cb824-18"><a href="rethinking-chapter-8.html#cb824-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q1<span class="fl">.5</span>, <span class="at">ymax =</span> Q98<span class="fl">.5</span>),</span>
<span id="cb824-19"><a href="rethinking-chapter-8.html#cb824-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb824-20"><a href="rethinking-chapter-8.html#cb824-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">size =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb824-21"><a href="rethinking-chapter-8.html#cb824-21" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">%in%</span> countries),  </span>
<span id="cb824-22"><a href="rethinking-chapter-8.html#cb824-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">label =</span> country), </span>
<span id="cb824-23"><a href="rethinking-chapter-8.html#cb824-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">8</span>, </span>
<span id="cb824-24"><a href="rethinking-chapter-8.html#cb824-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.color =</span> clr_dark,</span>
<span id="cb824-25"><a href="rethinking-chapter-8.html#cb824-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">min.segment.length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb824-26"><a href="rethinking-chapter-8.html#cb824-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> log_gdp_std),</span>
<span id="cb824-27"><a href="rethinking-chapter-8.html#cb824-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb824-28"><a href="rethinking-chapter-8.html#cb824-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Africa =</span> clr0dd, <span class="st">`</span><span class="at">not Africa</span><span class="st">`</span> <span class="ot">=</span> clr0d)) <span class="sc">+</span></span>
<span id="cb824-29"><a href="rethinking-chapter-8.html#cb824-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Africa =</span> clr0dd, <span class="st">`</span><span class="at">not Africa</span><span class="st">`</span> <span class="ot">=</span> clr0d)) <span class="sc">+</span></span>
<span id="cb824-30"><a href="rethinking-chapter-8.html#cb824-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;ruggedness (standardized)&quot;</span>,</span>
<span id="cb824-31"><a href="rethinking-chapter-8.html#cb824-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log GDP (as proportion of mean)&quot;</span>) <span class="sc">+</span></span>
<span id="cb824-32"><a href="rethinking-chapter-8.html#cb824-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> cont_africa) <span class="sc">+</span></span>
<span id="cb824-33"><a href="rethinking-chapter-8.html#cb824-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb824-34"><a href="rethinking-chapter-8.html#cb824-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-55-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="symetry-of-interactions-1" class="section level3" number="9.5.3">
<h3><span class="header-section-number">9.5.3</span> Symetry of Interactions</h3>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="rethinking-chapter-8.html#cb825-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(brms_c8_model_rugged_slope,</span>
<span id="cb825-2"><a href="rethinking-chapter-8.html#cb825-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> new_data,</span>
<span id="cb825-3"><a href="rethinking-chapter-8.html#cb825-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb825-4"><a href="rethinking-chapter-8.html#cb825-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb825-5"><a href="rethinking-chapter-8.html#cb825-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb825-6"><a href="rethinking-chapter-8.html#cb825-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">expand</span>(new_data,</span>
<span id="cb825-7"><a href="rethinking-chapter-8.html#cb825-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>,</span>
<span id="cb825-8"><a href="rethinking-chapter-8.html#cb825-8" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">nesting</span>(cont_idx, rugged_std))) <span class="sc">%&gt;%</span> </span>
<span id="cb825-9"><a href="rethinking-chapter-8.html#cb825-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span> </span>
<span id="cb825-10"><a href="rethinking-chapter-8.html#cb825-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> cont_idx, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb825-11"><a href="rethinking-chapter-8.html#cb825-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">delta =</span> <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">2</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb825-12"><a href="rethinking-chapter-8.html#cb825-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rugged_std, <span class="at">y =</span> delta)) <span class="sc">+</span></span>
<span id="cb825-13"><a href="rethinking-chapter-8.html#cb825-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">fill =</span> fll0, <span class="at">color =</span> clr0d, <span class="at">size =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb825-14"><a href="rethinking-chapter-8.html#cb825-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb825-15"><a href="rethinking-chapter-8.html#cb825-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb825-16"><a href="rethinking-chapter-8.html#cb825-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">2</span>, <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb825-17"><a href="rethinking-chapter-8.html#cb825-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Africa higher GDP</span><span class="sc">\n</span><span class="st">Africa lower GDP&quot;</span>,</span>
<span id="cb825-18"><a href="rethinking-chapter-8.html#cb825-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> fnt_sel) <span class="sc">+</span></span>
<span id="cb825-19"><a href="rethinking-chapter-8.html#cb825-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;ruggedness (standardized)&quot;</span>,</span>
<span id="cb825-20"><a href="rethinking-chapter-8.html#cb825-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;expected difference log GDP&quot;</span>) <span class="sc">+</span></span>
<span id="cb825-21"><a href="rethinking-chapter-8.html#cb825-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb825-22"><a href="rethinking-chapter-8.html#cb825-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>))</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-56-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="continuous-interactions" class="section level3" number="9.5.4">
<h3><span class="header-section-number">9.5.4</span> Continuous Interactions</h3>
<p>Tulip model without interaction</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="rethinking-chapter-8.html#cb826-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_tulips_simple <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb826-2"><a href="rethinking-chapter-8.html#cb826-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_tulips, </span>
<span id="cb826-3"><a href="rethinking-chapter-8.html#cb826-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb826-4"><a href="rethinking-chapter-8.html#cb826-4" aria-hidden="true" tabindex="-1"></a>  blooms_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> water_cent <span class="sc">+</span> shade_cent,</span>
<span id="cb826-5"><a href="rethinking-chapter-8.html#cb826-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb826-6"><a href="rethinking-chapter-8.html#cb826-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span> water_cent),</span>
<span id="cb826-7"><a href="rethinking-chapter-8.html#cb826-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span> shade_cent),</span>
<span id="cb826-8"><a href="rethinking-chapter-8.html#cb826-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb826-9"><a href="rethinking-chapter-8.html#cb826-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb826-10"><a href="rethinking-chapter-8.html#cb826-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb826-11"><a href="rethinking-chapter-8.html#cb826-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c8_model_tulips_simple&quot;</span>)</span>
<span id="cb826-12"><a href="rethinking-chapter-8.html#cb826-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-13"><a href="rethinking-chapter-8.html#cb826-13" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">summarize_model</span>(brms_c8_model_tulips_simple)</span></code></pre></div>
<pre><code>#&gt;     Group Effect Variance   SD SD_2.5 SD_97.5 Var_prop
#&gt;  Residual            0.03 0.18   0.13    0.24     1.00
#&gt;        Term Value   SE Lower_2.5 Upper_97.5
#&gt;   Intercept  0.36 0.03      0.29       0.43
#&gt;  water_cent  0.20 0.04      0.12       0.28
#&gt;  shade_cent -0.11 0.04     -0.19      -0.03</code></pre>
<p>Tulip model with interaction</p>
<p><span class="math display">\[\begin{align*}
\mu_{i} &amp; = \alpha + \color{#B35136}{\gamma_{W, i}} \text{W}_{i} + \beta_{S} \text{S}_i \\
\color{#B35136}{\gamma_{W, i}} &amp; = \color{#B35136}{\beta_{W} + \beta_{WS} \text{S}_{i}},
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
\mu_{i} &amp; = \alpha + \color{#B35136}{\underbrace{(\beta_{W} + \beta_{WS} \text{S}_i)}_{\gamma_{W, i}}} \text{W}_i + \beta_{S} \text{S}_{i} \\
        &amp; = \alpha + \color{#B35136}{\beta_{W}}  \text{W}_{i} + (\color{#B35136}{\beta_{WS} \text{S}_i} \cdot \text{W}_{i}) + \beta_{S} \text{S}_{i} \\
        &amp; = \alpha + \color{#B35136}{\beta_{W}} \text{W}_{i} + \beta_{S} \text{S}_{i}  + \color{#B35136}{\beta_{WS}} (\color{#B35136}{\text{S}_{i}} \cdot \text{W}_{i}),
\end{align*}\]</span></p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="rethinking-chapter-8.html#cb828-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_tulips_interaction <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb828-2"><a href="rethinking-chapter-8.html#cb828-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_tulips, </span>
<span id="cb828-3"><a href="rethinking-chapter-8.html#cb828-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb828-4"><a href="rethinking-chapter-8.html#cb828-4" aria-hidden="true" tabindex="-1"></a>  blooms_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> water_cent <span class="sc">+</span> shade_cent <span class="sc">+</span> water_cent<span class="sc">:</span>shade_cent,</span>
<span id="cb828-5"><a href="rethinking-chapter-8.html#cb828-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb828-6"><a href="rethinking-chapter-8.html#cb828-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span> water_cent),</span>
<span id="cb828-7"><a href="rethinking-chapter-8.html#cb828-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span> shade_cent),</span>
<span id="cb828-8"><a href="rethinking-chapter-8.html#cb828-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span> <span class="st">&quot;water_cent:shade_cent&quot;</span>),</span>
<span id="cb828-9"><a href="rethinking-chapter-8.html#cb828-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb828-10"><a href="rethinking-chapter-8.html#cb828-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb828-11"><a href="rethinking-chapter-8.html#cb828-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb828-12"><a href="rethinking-chapter-8.html#cb828-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb828-13"><a href="rethinking-chapter-8.html#cb828-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c8_model_tulips_interaction&quot;</span>)</span>
<span id="cb828-14"><a href="rethinking-chapter-8.html#cb828-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb828-15"><a href="rethinking-chapter-8.html#cb828-15" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">summarize_model</span>(brms_c8_model_tulips_interaction)</span></code></pre></div>
<pre><code>#&gt;     Group Effect Variance   SD SD_2.5 SD_97.5 Var_prop
#&gt;  Residual            0.02 0.14   0.11    0.20     1.00
#&gt;                   Term Value   SE Lower_2.5 Upper_97.5
#&gt;              Intercept  0.36 0.03      0.31       0.42
#&gt;             water_cent  0.21 0.03      0.14       0.27
#&gt;             shade_cent -0.11 0.03     -0.18      -0.04
#&gt;  water_cent:shade_cent -0.14 0.04     -0.22      -0.06</code></pre>
</div>
<div id="plotting-the-posterior-predictions-1" class="section level3" number="9.5.5">
<h3><span class="header-section-number">9.5.5</span> Plotting the Posterior Predictions</h3>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="rethinking-chapter-8.html#cb830-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb830-2"><a href="rethinking-chapter-8.html#cb830-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">shade_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, </span>
<span id="cb830-3"><a href="rethinking-chapter-8.html#cb830-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">water_cent =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb830-4"><a href="rethinking-chapter-8.html#cb830-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb830-5"><a href="rethinking-chapter-8.html#cb830-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb830-6"><a href="rethinking-chapter-8.html#cb830-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">fitted</span>(brms_c8_model_tulips_simple, <span class="at">newdata =</span> new_data,</span>
<span id="cb830-7"><a href="rethinking-chapter-8.html#cb830-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">summary =</span> <span class="cn">FALSE</span>, <span class="at">ndraws =</span> <span class="dv">20</span>),</span>
<span id="cb830-8"><a href="rethinking-chapter-8.html#cb830-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fitted</span>(brms_c8_model_tulips_interaction, <span class="at">newdata =</span> new_data,</span>
<span id="cb830-9"><a href="rethinking-chapter-8.html#cb830-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">summary =</span> <span class="cn">FALSE</span>, <span class="at">ndraws =</span> <span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb830-10"><a href="rethinking-chapter-8.html#cb830-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb830-11"><a href="rethinking-chapter-8.html#cb830-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">mutate</span>(new_data,</span>
<span id="cb830-12"><a href="rethinking-chapter-8.html#cb830-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">name =</span> <span class="fu">str_c</span>(shade_cent, water_cent, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb830-13"><a href="rethinking-chapter-8.html#cb830-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb830-14"><a href="rethinking-chapter-8.html#cb830-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;simple&quot;</span>, <span class="st">&quot;interaction&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb830-15"><a href="rethinking-chapter-8.html#cb830-15" aria-hidden="true" tabindex="-1"></a>           <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;simple&quot;</span>, <span class="st">&quot;interaction&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb830-16"><a href="rethinking-chapter-8.html#cb830-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(row<span class="sc">:</span>model), <span class="at">values_to =</span> <span class="st">&quot;blooms_std&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb830-17"><a href="rethinking-chapter-8.html#cb830-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(name, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;shade_cent&quot;</span>, <span class="st">&quot;water_cent&quot;</span>),</span>
<span id="cb830-18"><a href="rethinking-chapter-8.html#cb830-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb830-19"><a href="rethinking-chapter-8.html#cb830-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> water_cent, <span class="at">y =</span> blooms_std)) <span class="sc">+</span></span>
<span id="cb830-20"><a href="rethinking-chapter-8.html#cb830-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_tulips, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb830-21"><a href="rethinking-chapter-8.html#cb830-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> row, <span class="at">color =</span> row <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">40</span>)),</span>
<span id="cb830-22"><a href="rethinking-chapter-8.html#cb830-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb830-23"><a href="rethinking-chapter-8.html#cb830-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(model <span class="sc">~</span> shade_cent, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb830-24"><a href="rethinking-chapter-8.html#cb830-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">clr_alpha</span>(clr0d),</span>
<span id="cb830-25"><a href="rethinking-chapter-8.html#cb830-25" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">clr_alpha</span>(clr_dark)),</span>
<span id="cb830-26"><a href="rethinking-chapter-8.html#cb830-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb830-27"><a href="rethinking-chapter-8.html#cb830-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb830-28"><a href="rethinking-chapter-8.html#cb830-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) </span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-59-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="plotting-prior-predictions" class="section level3" number="9.5.6">
<h3><span class="header-section-number">9.5.6</span> Plotting Prior Predictions</h3>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="rethinking-chapter-8.html#cb831-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_tulips_simple_prior <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb831-2"><a href="rethinking-chapter-8.html#cb831-2" aria-hidden="true" tabindex="-1"></a>  brms_c8_model_tulips_simple,</span>
<span id="cb831-3"><a href="rethinking-chapter-8.html#cb831-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_prior =</span> <span class="st">&quot;only&quot;</span>,</span>
<span id="cb831-4"><a href="rethinking-chapter-8.html#cb831-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb831-5"><a href="rethinking-chapter-8.html#cb831-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb831-6"><a href="rethinking-chapter-8.html#cb831-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb831-7"><a href="rethinking-chapter-8.html#cb831-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c8_model_tulips_simple_prior&quot;</span>)</span>
<span id="cb831-8"><a href="rethinking-chapter-8.html#cb831-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-9"><a href="rethinking-chapter-8.html#cb831-9" aria-hidden="true" tabindex="-1"></a>brms_c8_model_tulips_interaction_prior <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb831-10"><a href="rethinking-chapter-8.html#cb831-10" aria-hidden="true" tabindex="-1"></a>  brms_c8_model_tulips_interaction,</span>
<span id="cb831-11"><a href="rethinking-chapter-8.html#cb831-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_prior =</span> <span class="st">&quot;only&quot;</span>,</span>
<span id="cb831-12"><a href="rethinking-chapter-8.html#cb831-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb831-13"><a href="rethinking-chapter-8.html#cb831-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb831-14"><a href="rethinking-chapter-8.html#cb831-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb831-15"><a href="rethinking-chapter-8.html#cb831-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;brms/brms_c8_model_tulips_interaction_prior&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="rethinking-chapter-8.html#cb832-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb832-2"><a href="rethinking-chapter-8.html#cb832-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb832-3"><a href="rethinking-chapter-8.html#cb832-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">fitted</span>(brms_c8_model_tulips_simple_prior, <span class="at">newdata =</span> new_data,</span>
<span id="cb832-4"><a href="rethinking-chapter-8.html#cb832-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">summary =</span> <span class="cn">FALSE</span>, <span class="at">ndraws =</span> <span class="dv">20</span>),</span>
<span id="cb832-5"><a href="rethinking-chapter-8.html#cb832-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fitted</span>(brms_c8_model_tulips_interaction_prior, <span class="at">newdata =</span> new_data,</span>
<span id="cb832-6"><a href="rethinking-chapter-8.html#cb832-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">summary =</span> <span class="cn">FALSE</span>, <span class="at">ndraws =</span> <span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb832-7"><a href="rethinking-chapter-8.html#cb832-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb832-8"><a href="rethinking-chapter-8.html#cb832-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">mutate</span>(new_data, <span class="at">name =</span> <span class="fu">str_c</span>(shade_cent, water_cent, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb832-9"><a href="rethinking-chapter-8.html#cb832-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">pull</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb832-10"><a href="rethinking-chapter-8.html#cb832-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb832-11"><a href="rethinking-chapter-8.html#cb832-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;simple&quot;</span>, <span class="st">&quot;interaction&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb832-12"><a href="rethinking-chapter-8.html#cb832-12" aria-hidden="true" tabindex="-1"></a>           <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;simple&quot;</span>, <span class="st">&quot;interaction&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb832-13"><a href="rethinking-chapter-8.html#cb832-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(row<span class="sc">:</span>model), <span class="at">values_to =</span> <span class="st">&quot;blooms_std&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb832-14"><a href="rethinking-chapter-8.html#cb832-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(name, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;shade_cent&quot;</span>, <span class="st">&quot;water_cent&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>,<span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb832-15"><a href="rethinking-chapter-8.html#cb832-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> water_cent, <span class="at">y =</span> blooms_std, <span class="at">group =</span> row)) <span class="sc">+</span></span>
<span id="cb832-16"><a href="rethinking-chapter-8.html#cb832-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">color =</span> clr_dark) <span class="sc">+</span></span>
<span id="cb832-17"><a href="rethinking-chapter-8.html#cb832-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> row, <span class="at">color =</span> row <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">40</span>)),</span>
<span id="cb832-18"><a href="rethinking-chapter-8.html#cb832-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb832-19"><a href="rethinking-chapter-8.html#cb832-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(model <span class="sc">~</span> shade_cent, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb832-20"><a href="rethinking-chapter-8.html#cb832-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">clr_alpha</span>(clr0d),</span>
<span id="cb832-21"><a href="rethinking-chapter-8.html#cb832-21" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">clr_alpha</span>(clr_dark)),</span>
<span id="cb832-22"><a href="rethinking-chapter-8.html#cb832-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb832-23"><a href="rethinking-chapter-8.html#cb832-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb832-24"><a href="rethinking-chapter-8.html#cb832-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>),</span>
<span id="cb832-25"><a href="rethinking-chapter-8.html#cb832-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">expand =</span> <span class="dv">0</span>) </span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-61-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="brms-conditional_effects" class="section level3" number="9.5.7">
<h3><span class="header-section-number">9.5.7</span> {brms} <code>conditional_effects()</code></h3>
<p>specifically for simple two-way interactions</p>
<p>Simple univariate model:</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="rethinking-chapter-8.html#cb833-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_restricted<span class="sc">$</span>formula</span></code></pre></div>
<pre><code>#&gt; log_gdp_std ~ 1 + rugged_std_centered</code></pre>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="rethinking-chapter-8.html#cb835-1" aria-hidden="true" tabindex="-1"></a>c_eff <span class="ot">&lt;-</span> <span class="fu">conditional_effects</span>(brms_c8_model_rugged_restricted, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb835-2"><a href="rethinking-chapter-8.html#cb835-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-3"><a href="rethinking-chapter-8.html#cb835-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot</span>(c_eff,</span>
<span id="cb835-4"><a href="rethinking-chapter-8.html#cb835-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">line_args =</span> <span class="fu">list</span>(<span class="at">color =</span> clr0dd, <span class="at">size =</span> .<span class="dv">4</span>),</span>
<span id="cb835-5"><a href="rethinking-chapter-8.html#cb835-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">plot =</span> <span class="cn">FALSE</span>)[[<span class="dv">1</span>]] </span>
<span id="cb835-6"><a href="rethinking-chapter-8.html#cb835-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(c_eff,</span>
<span id="cb835-7"><a href="rethinking-chapter-8.html#cb835-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">line_args =</span> <span class="fu">list</span>(<span class="at">color =</span> clr0dd, <span class="at">size =</span> .<span class="dv">4</span>),</span>
<span id="cb835-8"><a href="rethinking-chapter-8.html#cb835-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">point_args =</span> <span class="fu">c</span>(<span class="at">color =</span> clr_dark),</span>
<span id="cb835-9"><a href="rethinking-chapter-8.html#cb835-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">points =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb835-10"><a href="rethinking-chapter-8.html#cb835-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-11"><a href="rethinking-chapter-8.html#cb835-11" aria-hidden="true" tabindex="-1"></a>c_eff <span class="ot">&lt;-</span> <span class="fu">conditional_effects</span>(brms_c8_model_rugged_restricted,</span>
<span id="cb835-12"><a href="rethinking-chapter-8.html#cb835-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">spaghetti =</span> <span class="cn">TRUE</span>, </span>
<span id="cb835-13"><a href="rethinking-chapter-8.html#cb835-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ndraws =</span> <span class="dv">200</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb835-14"><a href="rethinking-chapter-8.html#cb835-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-15"><a href="rethinking-chapter-8.html#cb835-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot</span>(c_eff, <span class="at">points =</span> <span class="cn">TRUE</span>,</span>
<span id="cb835-16"><a href="rethinking-chapter-8.html#cb835-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">point_args =</span> <span class="fu">c</span>(<span class="at">color =</span> clr_dark),</span>
<span id="cb835-17"><a href="rethinking-chapter-8.html#cb835-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">line_args =</span> <span class="fu">c</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb835-18"><a href="rethinking-chapter-8.html#cb835-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">spaghetti_args =</span> <span class="fu">c</span>(<span class="at">colour =</span> <span class="fu">clr_alpha</span>(clr0dd, .<span class="dv">1</span>)),</span>
<span id="cb835-19"><a href="rethinking-chapter-8.html#cb835-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> <span class="cn">FALSE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb835-20"><a href="rethinking-chapter-8.html#cb835-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb835-21"><a href="rethinking-chapter-8.html#cb835-21" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-63-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>Simple bi-variate model, no interaction:</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="rethinking-chapter-8.html#cb836-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_index<span class="sc">$</span>formula</span></code></pre></div>
<pre><code>#&gt; log_gdp_std ~ 0 + cont_idx + rugged_std_centered</code></pre>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="rethinking-chapter-8.html#cb838-1" aria-hidden="true" tabindex="-1"></a>c_eff <span class="ot">&lt;-</span> <span class="fu">conditional_effects</span>(brms_c8_model_rugged_index, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb838-2"><a href="rethinking-chapter-8.html#cb838-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb838-3"><a href="rethinking-chapter-8.html#cb838-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot</span>(c_eff, <span class="at">points =</span> <span class="cn">TRUE</span>,</span>
<span id="cb838-4"><a href="rethinking-chapter-8.html#cb838-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">point_args =</span> <span class="fu">c</span>(<span class="at">color =</span> clr_dark),</span>
<span id="cb838-5"><a href="rethinking-chapter-8.html#cb838-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">line_args =</span> <span class="fu">c</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>), <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb838-6"><a href="rethinking-chapter-8.html#cb838-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb838-7"><a href="rethinking-chapter-8.html#cb838-7" aria-hidden="true" tabindex="-1"></a>p[[<span class="dv">1</span>]] <span class="sc">+</span> p[[<span class="dv">2</span>]]</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-65-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>Non-linear interaction model:</p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="rethinking-chapter-8.html#cb839-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_slope<span class="sc">$</span>formula</span></code></pre></div>
<pre><code>#&gt; log_gdp_std ~ 0 + a + b * rugged_std_centered 
#&gt; a ~ 0 + cont_idx
#&gt; b ~ 0 + cont_idx</code></pre>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="rethinking-chapter-8.html#cb841-1" aria-hidden="true" tabindex="-1"></a>c_eff <span class="ot">&lt;-</span> <span class="fu">conditional_effects</span>(brms_c8_model_rugged_slope, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb841-2"><a href="rethinking-chapter-8.html#cb841-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb841-3"><a href="rethinking-chapter-8.html#cb841-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot</span>(c_eff, <span class="at">points =</span> <span class="cn">TRUE</span>,</span>
<span id="cb841-4"><a href="rethinking-chapter-8.html#cb841-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">point_args =</span> <span class="fu">c</span>(<span class="at">color =</span> clr_dark),</span>
<span id="cb841-5"><a href="rethinking-chapter-8.html#cb841-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">line_args =</span> <span class="fu">c</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb841-6"><a href="rethinking-chapter-8.html#cb841-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb841-7"><a href="rethinking-chapter-8.html#cb841-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb841-8"><a href="rethinking-chapter-8.html#cb841-8" aria-hidden="true" tabindex="-1"></a>p[[<span class="dv">1</span>]] <span class="sc">+</span> p[[<span class="dv">2</span>]]</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-67-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="rethinking-chapter-8.html#cb842-1" aria-hidden="true" tabindex="-1"></a>c_eff <span class="ot">&lt;-</span> <span class="fu">conditional_effects</span>(brms_c8_model_rugged_slope,</span>
<span id="cb842-2"><a href="rethinking-chapter-8.html#cb842-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">effects =</span> <span class="st">&quot;rugged_std_centered:cont_idx&quot;</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb842-3"><a href="rethinking-chapter-8.html#cb842-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb842-4"><a href="rethinking-chapter-8.html#cb842-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot</span>(c_eff, <span class="at">plot =</span> <span class="cn">FALSE</span>) </span>
<span id="cb842-5"><a href="rethinking-chapter-8.html#cb842-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-6"><a href="rethinking-chapter-8.html#cb842-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-7"><a href="rethinking-chapter-8.html#cb842-7" aria-hidden="true" tabindex="-1"></a>p[[<span class="dv">1</span>]] <span class="sc">+</span> </span>
<span id="cb842-8"><a href="rethinking-chapter-8.html#cb842-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> clr1, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> clr0dd)) <span class="sc">+</span></span>
<span id="cb842-9"><a href="rethinking-chapter-8.html#cb842-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> fll1, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">clr_alpha</span>(clr0dd))) <span class="sc">+</span></span>
<span id="cb842-10"><a href="rethinking-chapter-8.html#cb842-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-68-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="rethinking-chapter-8.html#cb843-1" aria-hidden="true" tabindex="-1"></a>c_eff <span class="ot">&lt;-</span> <span class="fu">conditional_effects</span>(brms_c8_model_rugged_slope, </span>
<span id="cb843-2"><a href="rethinking-chapter-8.html#cb843-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">effects =</span> <span class="st">&quot;cont_idx:rugged_std_centered&quot;</span>,</span>
<span id="cb843-3"><a href="rethinking-chapter-8.html#cb843-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb843-4"><a href="rethinking-chapter-8.html#cb843-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb843-5"><a href="rethinking-chapter-8.html#cb843-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(c_eff, <span class="at">plot =</span> <span class="cn">FALSE</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb843-6"><a href="rethinking-chapter-8.html#cb843-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(clr1, clr0d, clr_dark)) <span class="sc">+</span></span>
<span id="cb843-7"><a href="rethinking-chapter-8.html#cb843-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(clr1, clr0d, clr_dark) <span class="sc">%&gt;%</span> <span class="fu">clr_lighten</span>()) <span class="sc">+</span></span>
<span id="cb843-8"><a href="rethinking-chapter-8.html#cb843-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-69-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="rethinking-chapter-8.html#cb844-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_rugged_slope<span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb844-2"><a href="rethinking-chapter-8.html#cb844-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(rugged_std_centered),</span>
<span id="cb844-3"><a href="rethinking-chapter-8.html#cb844-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">mean + 1 sd</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(rugged_std_centered) <span class="sc">+</span> <span class="fu">sd</span>(rugged_std_centered),</span>
<span id="cb844-4"><a href="rethinking-chapter-8.html#cb844-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">mean - 1 sd</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(rugged_std_centered) <span class="sc">-</span> <span class="fu">sd</span>(rugged_std_centered)) <span class="sc">%&gt;%</span> </span>
<span id="cb844-5"><a href="rethinking-chapter-8.html#cb844-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>#&gt;   mean mean + 1 sd mean - 1 sd
#&gt; 1    0        0.19       -0.19</code></pre>
<p>Interaction models with two variables</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="rethinking-chapter-8.html#cb846-1" aria-hidden="true" tabindex="-1"></a>brms_c8_model_tulips_interaction<span class="sc">$</span>formula</span></code></pre></div>
<pre><code>#&gt; blooms_std ~ 1 + water_cent + shade_cent + water_cent:shade_cent</code></pre>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="rethinking-chapter-8.html#cb848-1" aria-hidden="true" tabindex="-1"></a>c_eff <span class="ot">&lt;-</span> <span class="fu">conditional_effects</span>(brms_c8_model_tulips_interaction,</span>
<span id="cb848-2"><a href="rethinking-chapter-8.html#cb848-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">effects =</span> <span class="st">&quot;water_cent:shade_cent&quot;</span>,</span>
<span id="cb848-3"><a href="rethinking-chapter-8.html#cb848-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">int_conditions =</span> <span class="fu">list</span>(<span class="at">shade_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>),</span>
<span id="cb848-4"><a href="rethinking-chapter-8.html#cb848-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb848-5"><a href="rethinking-chapter-8.html#cb848-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb848-6"><a href="rethinking-chapter-8.html#cb848-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(c_eff,</span>
<span id="cb848-7"><a href="rethinking-chapter-8.html#cb848-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">points =</span> <span class="cn">TRUE</span>,</span>
<span id="cb848-8"><a href="rethinking-chapter-8.html#cb848-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">plot =</span> <span class="cn">FALSE</span>)[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb848-9"><a href="rethinking-chapter-8.html#cb848-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(clr3, clr0d, clr_dark), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb848-10"><a href="rethinking-chapter-8.html#cb848-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(clr3, clr0d, clr_dark), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb848-11"><a href="rethinking-chapter-8.html#cb848-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb848-12"><a href="rethinking-chapter-8.html#cb848-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> shade_cent, <span class="at">labeller =</span> label_both)</span></code></pre></div>
<p><img src="rethinking_c8_files/figure-html/unnamed-chunk-72-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="pymc3-section-6" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> pymc3 section</h2>
<hr />
<div id="myModal" class="modal">
<span class="close">×</span>
<img class="modal-content" id="img01">
<div id="caption">

</div>
</div>
<script src="./js/zoom.js"></script>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rethinking-chapter-7.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rethinking-chapter-9.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": "github"
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
