<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Rethinking: Chapter 7 | Statistical Exploration</title>
  <meta name="description" content="statistical explorations by kh" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Rethinking: Chapter 7 | Statistical Exploration" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="statistical explorations by kh" />
  <meta name="github-repo" content="k-hench/statistical_explorations" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Rethinking: Chapter 7 | Statistical Exploration" />
  
  <meta name="twitter:description" content="statistical explorations by kh" />
  

<meta name="author" content="Kosmas Hench" />


<meta name="date" content="2021-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rethinking-chapter-6.html"/>
<link rel="next" href="bayesian-statistics-the-fun-way.html"/>
<script src="libs/header-attrs-2.9.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });
  
  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    // var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeText = $('<img style="width:45px;" src="img/both.svg">');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    var buttonColK = $('<div class="check"><input type="checkbox" id="cc_' + id + '" class="btn btn-default btn-xs code-folding-btn pull-right ch1" /><label class="checktrue" for="cc_' + id + '" ></label></div>');

    buttonColK
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    //buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);
    buttonCol.append(buttonColK);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text();
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text();
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<script>
$(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>
<link rel="shortcut icon" href="img/favicon.ico" />
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>

<script>document.write('<div class="btn-group pull-right" style="position: absolute; top: 35px; right: 2%; z-index: 10"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"aria-expanded="true" data-_extension-text-contrast=""><span>global code</span><span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All</a></li><li><a id="rmd-hide-all-code" href="#">Hide All</a></li></ul></div>')</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/k-hench/statistical_explorations">github repository</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro</a></li>
<li class="chapter" data-level="2" data-path="rethinking-chapter-1.html"><a href="rethinking-chapter-1.html"><i class="fa fa-check"></i><b>2</b> Rethinking: Chapter 1</a></li>
<li class="chapter" data-level="3" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html"><i class="fa fa-check"></i><b>3</b> Rethinking: Chapter 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#counting-possibilities"><i class="fa fa-check"></i><b>3.1</b> Counting possibilities</a></li>
<li class="chapter" data-level="3.2" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#building-a-model"><i class="fa fa-check"></i><b>3.2</b> Building a Model</a></li>
<li class="chapter" data-level="3.3" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#making-the-model-go-bayes-theorem"><i class="fa fa-check"></i><b>3.3</b> Making the model go / Bayes’ Theorem</a></li>
<li class="chapter" data-level="3.4" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#motors-grid-approximation"><i class="fa fa-check"></i><b>3.4</b> Motors: Grid Approximation</a></li>
<li class="chapter" data-level="3.5" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#quadratic-approximation"><i class="fa fa-check"></i><b>3.5</b> Quadratic Approximation</a></li>
<li class="chapter" data-level="3.6" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#marcov-chain-monte-carlo-mcmc"><i class="fa fa-check"></i><b>3.6</b> Marcov Chain Monte Carlo (MCMC)</a></li>
<li class="chapter" data-level="3.7" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#homework"><i class="fa fa-check"></i><b>3.7</b> Homework</a></li>
<li class="chapter" data-level="3.8" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#brms-section"><i class="fa fa-check"></i><b>3.8</b> {brms} section</a></li>
<li class="chapter" data-level="3.9" data-path="rethinking-chapter-2.html"><a href="rethinking-chapter-2.html#pymc3-section"><i class="fa fa-check"></i><b>3.9</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html"><i class="fa fa-check"></i><b>4</b> Rethinking: Chapter 3</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>4.1</b> Sampling from a grid approximate posterior</a></li>
<li class="chapter" data-level="4.2" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#sampling-to-summarize"><i class="fa fa-check"></i><b>4.2</b> Sampling to Summarize</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#intervals-of-devined-boundaries"><i class="fa fa-check"></i><b>4.2.1</b> Intervals of devined boundaries</a></li>
<li class="chapter" data-level="4.2.2" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#intervals-of-defined-mass"><i class="fa fa-check"></i><b>4.2.2</b> Intervals of defined mass</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#point-estimates"><i class="fa fa-check"></i><b>4.3</b> Point estimates</a></li>
<li class="chapter" data-level="4.4" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#sample-to-simulate-prediction"><i class="fa fa-check"></i><b>4.4</b> sample to simulate prediction</a></li>
<li class="chapter" data-level="4.5" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#homework-1"><i class="fa fa-check"></i><b>4.5</b> Homework</a></li>
<li class="chapter" data-level="4.6" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#brms-section-1"><i class="fa fa-check"></i><b>4.6</b> {brms} section</a></li>
<li class="chapter" data-level="4.7" data-path="rethinking-chapter-3.html"><a href="rethinking-chapter-3.html#pymc3-section-1"><i class="fa fa-check"></i><b>4.7</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html"><i class="fa fa-check"></i><b>5</b> Rethinking: Chapter 4</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>5.1</b> Why normal distributions are normal</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#normal-by-addition"><i class="fa fa-check"></i><b>5.1.1</b> Normal by addition</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#normal-by-multiplication-and-by-log-multiplication"><i class="fa fa-check"></i><b>5.2</b> Normal by multiplication and by log-multiplication</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#using-the-gaussian-distribution"><i class="fa fa-check"></i><b>5.2.1</b> using the Gaussian distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>5.3</b> A language for describing models</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>5.3.1</b> Gaussian model of height</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#linear-prediction"><i class="fa fa-check"></i><b>5.4</b> Linear Prediction</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>5.4.1</b> Finding the posterior Distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#curves-from-lines"><i class="fa fa-check"></i><b>5.5</b> Curves from lines</a></li>
<li class="chapter" data-level="5.6" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#splines"><i class="fa fa-check"></i><b>5.6</b> Splines</a></li>
<li class="chapter" data-level="5.7" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#homework-2"><i class="fa fa-check"></i><b>5.7</b> Homework</a></li>
<li class="chapter" data-level="5.8" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#brms-section-2"><i class="fa fa-check"></i><b>5.8</b> {brms} section</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#linear-model-of-adult-height"><i class="fa fa-check"></i><b>5.8.1</b> linear model of adult height</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="rethinking-chapter-4.html"><a href="rethinking-chapter-4.html#pymc3-section-2"><i class="fa fa-check"></i><b>5.9</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html"><i class="fa fa-check"></i><b>6</b> Rethinking: Chapter 5</a>
<ul>
<li class="chapter" data-level="6.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#directed-acyclic-graphs"><i class="fa fa-check"></i><b>6.1</b> Directed Acyclic Graphs</a></li>
<li class="chapter" data-level="6.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multiple-regression-notion"><i class="fa fa-check"></i><b>6.2</b> Multiple Regression notion</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#visualizations-for-multivariate-regressions"><i class="fa fa-check"></i><b>6.2.1</b> Visualizations for multivariate regressions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#masked-relationship"><i class="fa fa-check"></i><b>6.3</b> Masked relationship</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#bi-variate-models"><i class="fa fa-check"></i><b>6.3.1</b> Bi-variate models</a></li>
<li class="chapter" data-level="6.3.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#simulate-a-masking-relationship"><i class="fa fa-check"></i><b>6.3.2</b> Simulate a masking relationship</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#categorical-variables"><i class="fa fa-check"></i><b>6.4</b> Categorical Variables</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#indicator-vs.-index-variable-binary-categories"><i class="fa fa-check"></i><b>6.4.1</b> Indicator vs. Index variable (binary categories)</a></li>
<li class="chapter" data-level="6.4.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multiple-categories"><i class="fa fa-check"></i><b>6.4.2</b> Multiple categories</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#homework-3"><i class="fa fa-check"></i><b>6.5</b> Homework</a></li>
<li class="chapter" data-level="6.6" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#brms-section-3"><i class="fa fa-check"></i><b>6.6</b> {brms} section</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#age-at-marriage-model"><i class="fa fa-check"></i><b>6.6.1</b> Age at marriage Model</a></li>
<li class="chapter" data-level="6.6.2" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#marriage-rate-model"><i class="fa fa-check"></i><b>6.6.2</b> Marriage rate Model</a></li>
<li class="chapter" data-level="6.6.3" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multiple-regression"><i class="fa fa-check"></i><b>6.6.3</b> Multiple regression</a></li>
<li class="chapter" data-level="6.6.4" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multivariate-posteriors"><i class="fa fa-check"></i><b>6.6.4</b> Multivariate Posteriors</a></li>
<li class="chapter" data-level="6.6.5" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#counterfactual-plots-1"><i class="fa fa-check"></i><b>6.6.5</b> Counterfactual plots</a></li>
<li class="chapter" data-level="6.6.6" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#masked-relationships"><i class="fa fa-check"></i><b>6.6.6</b> Masked Relationships</a></li>
<li class="chapter" data-level="6.6.7" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#categorical-variables-1"><i class="fa fa-check"></i><b>6.6.7</b> Categorical Variables</a></li>
<li class="chapter" data-level="6.6.8" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#alternative-ways-to-model-multiple-categories"><i class="fa fa-check"></i><b>6.6.8</b> Alternative ways to model multiple categories</a></li>
<li class="chapter" data-level="6.6.9" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#multilevel-anova"><i class="fa fa-check"></i><b>6.6.9</b> Multilevel ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="rethinking-chapter-5.html"><a href="rethinking-chapter-5.html#pymc3-section-3"><i class="fa fa-check"></i><b>6.7</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html"><i class="fa fa-check"></i><b>7</b> Rethinking: Chapter 6</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#multicolliniarity"><i class="fa fa-check"></i><b>7.1</b> Multicolliniarity</a></li>
<li class="chapter" data-level="7.2" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#post-treatment-bias"><i class="fa fa-check"></i><b>7.2</b> Post-treatment bias</a></li>
<li class="chapter" data-level="7.3" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#collider-bias"><i class="fa fa-check"></i><b>7.3</b> Collider Bias</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#the-haunted-dag"><i class="fa fa-check"></i><b>7.3.1</b> The haunted DAG</a></li>
<li class="chapter" data-level="7.3.2" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#shutting-the-backdoor"><i class="fa fa-check"></i><b>7.3.2</b> Shutting the Backdoor</a></li>
<li class="chapter" data-level="7.3.3" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#two-roads"><i class="fa fa-check"></i><b>7.3.3</b> Two Roads</a></li>
<li class="chapter" data-level="7.3.4" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#backdoor-waffles"><i class="fa fa-check"></i><b>7.3.4</b> Backdoor Waffles</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#homework-4"><i class="fa fa-check"></i><b>7.4</b> Homework</a></li>
<li class="chapter" data-level="7.5" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#brms-section-4"><i class="fa fa-check"></i><b>7.5</b> {brms} section</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#multicolliniarity-1"><i class="fa fa-check"></i><b>7.5.1</b> Multicolliniarity</a></li>
<li class="chapter" data-level="7.5.2" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#post-treatment-bias-1"><i class="fa fa-check"></i><b>7.5.2</b> Post-treatment bias</a></li>
<li class="chapter" data-level="7.5.3" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#collider-bias-1"><i class="fa fa-check"></i><b>7.5.3</b> Collider Bias</a></li>
<li class="chapter" data-level="7.5.4" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#summary"><i class="fa fa-check"></i><b>7.5.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="rethinking-chapter-6.html"><a href="rethinking-chapter-6.html#pymc3-section-4"><i class="fa fa-check"></i><b>7.6</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html"><i class="fa fa-check"></i><b>8</b> Rethinking: Chapter 7</a>
<ul>
<li class="chapter" data-level="8.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>8.1</b> The Problem with Parameters</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#the-burial-of-r2"><i class="fa fa-check"></i><b>8.1.1</b> The burial of R<sup>2</sup></a></li>
<li class="chapter" data-level="8.1.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#higher-order-polynomials"><i class="fa fa-check"></i><b>8.1.2</b> Higher order polynomials</a></li>
<li class="chapter" data-level="8.1.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#underfitting"><i class="fa fa-check"></i><b>8.1.3</b> Underfitting</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>8.2</b> Entropy and Accuracy</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#entropy"><i class="fa fa-check"></i><b>8.2.1</b> Entropy</a></li>
<li class="chapter" data-level="8.2.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#accuracy"><i class="fa fa-check"></i><b>8.2.2</b> Accuracy</a></li>
<li class="chapter" data-level="8.2.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#estimating-divergence"><i class="fa fa-check"></i><b>8.2.3</b> Estimating Divergence</a></li>
<li class="chapter" data-level="8.2.4" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#scoring-the-right-data"><i class="fa fa-check"></i><b>8.2.4</b> Scoring the right data</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#golem-taming-regularization"><i class="fa fa-check"></i><b>8.3</b> Golem taming: regularization</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#cross-validataion"><i class="fa fa-check"></i><b>8.3.1</b> Cross-validataion</a></li>
<li class="chapter" data-level="8.3.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#information-criteria"><i class="fa fa-check"></i><b>8.3.2</b> Information Criteria</a></li>
<li class="chapter" data-level="8.3.3" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#comparing-cv-psis-and-waic"><i class="fa fa-check"></i><b>8.3.3</b> Comparing CV, PSIS and WAIC</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#model-comparison"><i class="fa fa-check"></i><b>8.4</b> Model comparison</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#model-mis-selection"><i class="fa fa-check"></i><b>8.4.1</b> Model mis-selection</a></li>
<li class="chapter" data-level="8.4.2" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#outliers-and-other-illusions"><i class="fa fa-check"></i><b>8.4.2</b> Outliers and other illusions</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#homework-5"><i class="fa fa-check"></i><b>8.5</b> Homework</a></li>
<li class="chapter" data-level="8.6" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#brms-section-5"><i class="fa fa-check"></i><b>8.6</b> {brms} section</a></li>
<li class="chapter" data-level="8.7" data-path="rethinking-chapter-7.html"><a href="rethinking-chapter-7.html#pymc3-section-5"><i class="fa fa-check"></i><b>8.7</b> pymc3 section</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html"><i class="fa fa-check"></i><b>9</b> Bayesian Statistics the Fun Way</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#conditioning-probabilities"><i class="fa fa-check"></i><b>9.1</b> Conditioning Probabilities</a></li>
<li class="chapter" data-level="9.2" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#combining-probailities-based-on-logic"><i class="fa fa-check"></i><b>9.2</b> Combining Probailities based on logic</a></li>
<li class="chapter" data-level="9.3" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#the-binomial-distribution"><i class="fa fa-check"></i><b>9.3</b> The binomial distribution</a></li>
<li class="chapter" data-level="9.4" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#the-beta-distribution"><i class="fa fa-check"></i><b>9.4</b> The beta distribution</a></li>
<li class="chapter" data-level="9.5" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#bayes-theorem"><i class="fa fa-check"></i><b>9.5</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="9.6" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#parameter-estimation-i"><i class="fa fa-check"></i><b>9.6</b> Parameter Estimation (I)</a></li>
<li class="chapter" data-level="9.7" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#the-normal-distribution"><i class="fa fa-check"></i><b>9.7</b> The normal distribution</a></li>
<li class="chapter" data-level="9.8" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#cummulative-density-and-quantile-function"><i class="fa fa-check"></i><b>9.8</b> Cummulative Density and Quantile Function</a></li>
<li class="chapter" data-level="9.9" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#parameter-estimation-with-prior-probabilities"><i class="fa fa-check"></i><b>9.9</b> Parameter estimation with prior probabilities</a></li>
<li class="chapter" data-level="9.10" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#monte-carlosimulation"><i class="fa fa-check"></i><b>9.10</b> Monte CarloSimulation</a></li>
<li class="chapter" data-level="9.11" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#posterior-odds"><i class="fa fa-check"></i><b>9.11</b> Posterior Odds</a></li>
<li class="chapter" data-level="9.12" data-path="bayesian-statistics-the-fun-way.html"><a href="bayesian-statistics-the-fun-way.html#parameter-estimation-ii"><i class="fa fa-check"></i><b>9.12</b> Parameter Estimation (II)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html"><i class="fa fa-check"></i><b>10</b> Mixed Models with R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#standard-regregression-model"><i class="fa fa-check"></i><b>10.1</b> Standard regregression model</a></li>
<li class="chapter" data-level="10.2" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#mixed-nodel"><i class="fa fa-check"></i><b>10.2</b> mixed nodel</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#student-specific-effect-initial-depiction"><i class="fa fa-check"></i><b>10.2.1</b> student specific effect (initial depiction)</a></li>
<li class="chapter" data-level="10.2.2" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#as-multi-level-model"><i class="fa fa-check"></i><b>10.2.2</b> as multi-level model</a></li>
<li class="chapter" data-level="10.2.3" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#mixed-model"><i class="fa fa-check"></i><b>10.2.3</b> Mixed Model</a></li>
<li class="chapter" data-level="10.2.4" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#estimation-of-random-effects"><i class="fa fa-check"></i><b>10.2.4</b> Estimation of random effects</a></li>
<li class="chapter" data-level="10.2.5" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#prediction"><i class="fa fa-check"></i><b>10.2.5</b> Prediction</a></li>
<li class="chapter" data-level="10.2.6" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#cluster-level-covariates"><i class="fa fa-check"></i><b>10.2.6</b> Cluster Level Covariates</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#add-random-slope"><i class="fa fa-check"></i><b>10.3</b> Add random slope</a></li>
<li class="chapter" data-level="10.4" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#cross-classified-models"><i class="fa fa-check"></i><b>10.4</b> Cross Classified models</a></li>
<li class="chapter" data-level="10.5" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#hierachical-structure"><i class="fa fa-check"></i><b>10.5</b> Hierachical structure</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#crossed-vs.-nested"><i class="fa fa-check"></i><b>10.5.1</b> Crossed vs. nested</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#residual-structure"><i class="fa fa-check"></i><b>10.6</b> Residual Structure</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#heterogeneous-variance"><i class="fa fa-check"></i><b>10.6.1</b> Heterogeneous variance</a></li>
<li class="chapter" data-level="10.6.2" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#autocorrelation"><i class="fa fa-check"></i><b>10.6.2</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#generalized-linear-mixed-models"><i class="fa fa-check"></i><b>10.7</b> Generalized Linear Mixed Models</a></li>
<li class="chapter" data-level="10.8" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#issues-considderations"><i class="fa fa-check"></i><b>10.8</b> Issues/ Considderations</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#model-comparison-1"><i class="fa fa-check"></i><b>10.8.1</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="mixed-models-with-r.html"><a href="mixed-models-with-r.html#formula-summary"><i class="fa fa-check"></i><b>10.9</b> Formula summary</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references-and-session-info.html"><a href="references-and-session-info.html"><i class="fa fa-check"></i><b>11</b> References and Session Info</a>
<ul>
<li class="chapter" data-level="11.1" data-path="references-and-session-info.html"><a href="references-and-session-info.html#session-info"><i class="fa fa-check"></i><b>11.1</b> Session Info</a></li>
<li class="chapter" data-level="11.2" data-path="references-and-session-info.html"><a href="references-and-session-info.html#references"><i class="fa fa-check"></i><b>11.2</b> References</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Exploration</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rethinking-chapter-7" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Rethinking: Chapter 7</h1>
<p><strong>Ulysses’ Compass</strong></p>
<p>by <a href="https://xcelab.net/rm/statistical-rethinking/">Richard McElreath</a>, building on the Summaries by <a href="https://bookdown.org/content/4857/">Solomon Kurz</a> and <a href="https://sr2-solutions.wjakethompson.com/linear-models.html">Jake Thompson</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-1"></span>
<img src="img/Skylla_and_Charybdis.svg" alt="&lt;i&gt;Between Scylla and Charybdis&lt;/i&gt; by &lt;a href='https://commons.wikimedia.org/wiki/File:Adolf_Hiremy-Hirschl_-_Zwischen_Skylla_und_Charybdis.jpg'&gt;Adolf Hirémy-Hirschl&lt;/a&gt; (1910). " width="250" />
<p class="caption">
Figure 8.1: <i>Between Scylla and Charybdis</i> by <a href='https://commons.wikimedia.org/wiki/File:Adolf_Hiremy-Hirschl_-_Zwischen_Skylla_und_Charybdis.jpg'>Adolf Hirémy-Hirschl</a> (1910).
</p>
</div>
<div id="the-problem-with-parameters" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> The Problem with Parameters</h2>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="rethinking-chapter-7.html#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb568-2"><a href="rethinking-chapter-7.html#cb568-2" aria-hidden="true" tabindex="-1"></a>data_brainsize <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb568-3"><a href="rethinking-chapter-7.html#cb568-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">species =</span> <span class="fu">c</span>(<span class="st">&quot;afarensis&quot;</span>, <span class="st">&quot;africanus&quot;</span>, <span class="st">&quot;habilis&quot;</span>, <span class="st">&quot;boisei&quot;</span>, <span class="st">&quot;rudolfensis&quot;</span>, <span class="st">&quot;ergaster&quot;</span>, <span class="st">&quot;sapiens&quot;</span>), </span>
<span id="cb568-4"><a href="rethinking-chapter-7.html#cb568-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">brain_size =</span> <span class="fu">c</span>(<span class="dv">438</span>, <span class="dv">452</span>, <span class="dv">612</span>, <span class="dv">521</span>, <span class="dv">752</span>, <span class="dv">871</span>, <span class="dv">1350</span>), </span>
<span id="cb568-5"><a href="rethinking-chapter-7.html#cb568-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mass =</span> <span class="fu">c</span>(<span class="fl">37.0</span>, <span class="fl">35.5</span>, <span class="fl">34.5</span>, <span class="fl">41.5</span>, <span class="fl">55.5</span>, <span class="fl">61.0</span>, <span class="fl">53.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb568-6"><a href="rethinking-chapter-7.html#cb568-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">brain_size_scl =</span> brain_size<span class="sc">/</span> <span class="fu">max</span>(brain_size),</span>
<span id="cb568-7"><a href="rethinking-chapter-7.html#cb568-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">mass_std =</span> <span class="fu">standardize</span>(mass))</span>
<span id="cb568-8"><a href="rethinking-chapter-7.html#cb568-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-9"><a href="rethinking-chapter-7.html#cb568-9" aria-hidden="true" tabindex="-1"></a>data_brainsize <span class="sc">%&gt;%</span> </span>
<span id="cb568-10"><a href="rethinking-chapter-7.html#cb568-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mass, <span class="at">y =</span> brain_size)) <span class="sc">+</span></span>
<span id="cb568-11"><a href="rethinking-chapter-7.html#cb568-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> clr2, <span class="at">fill =</span> fll2, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb568-12"><a href="rethinking-chapter-7.html#cb568-12" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> species),</span>
<span id="cb568-13"><a href="rethinking-chapter-7.html#cb568-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">force =</span> <span class="dv">30</span>, <span class="at">min.segment.length =</span> <span class="fu">unit</span>(.<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb568-14"><a href="rethinking-chapter-7.html#cb568-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family =</span> fnt_sel, <span class="at">fontface =</span> <span class="st">&quot;italic&quot;</span>) <span class="sc">+</span></span>
<span id="cb568-15"><a href="rethinking-chapter-7.html#cb568-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> .<span class="dv">03</span>)</span></code></pre></div>
<p><img src="rethinking_c7_files/figure-html/data_brainsize-1.svg" width="720" style="display: block; margin: auto;" /></p>
<div id="the-burial-of-r2" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> The burial of R<sup>2</sup></h3>
<p><span class="math display">\[
R^{2} = \frac{var(outcome) - var(residuals)}{var(outcome)} = 1 - \frac{var(residuals)}{var(outcome)}
\]</span></p>
<div id="linear-model" class="section level4" number="8.1.1.1">
<h4><span class="header-section-number">8.1.1.1</span> Linear Model</h4>
<p><span class="math display">\[
\begin{array}{rclr}
b_{i} &amp; \sim &amp; Normal( \mu_i, \sigma) &amp; \textrm{[likelihood]}\\
\mu_i &amp; = &amp; \alpha + \beta_{m} m_{i} &amp; \textrm{[linear model]}\\
\alpha &amp; \sim &amp; Normal(0.5, 1) &amp; \textrm{[$\alpha$ prior]}\\
\beta_{m} &amp; \sim &amp; Normal(0, 10) &amp; \textrm{[$\beta_{T}$ prior]}\\
\sigma &amp; \sim &amp; Log-Normal(0, 1) &amp; \textrm{[$\sigma$ prior]}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="rethinking-chapter-7.html#cb569-1" aria-hidden="true" tabindex="-1"></a>model_brain_size <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb569-2"><a href="rethinking-chapter-7.html#cb569-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb569-3"><a href="rethinking-chapter-7.html#cb569-3" aria-hidden="true" tabindex="-1"></a>    brain_size_scl <span class="sc">~</span> <span class="fu">dnorm</span>(mu, <span class="fu">exp</span>(log_sigma)),</span>
<span id="cb569-4"><a href="rethinking-chapter-7.html#cb569-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_m <span class="sc">*</span> mass_std,</span>
<span id="cb569-5"><a href="rethinking-chapter-7.html#cb569-5" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb569-6"><a href="rethinking-chapter-7.html#cb569-6" aria-hidden="true" tabindex="-1"></a>    beta_m <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb569-7"><a href="rethinking-chapter-7.html#cb569-7" aria-hidden="true" tabindex="-1"></a>    log_sigma <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">1</span> )</span>
<span id="cb569-8"><a href="rethinking-chapter-7.html#cb569-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb569-9"><a href="rethinking-chapter-7.html#cb569-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_brainsize</span>
<span id="cb569-10"><a href="rethinking-chapter-7.html#cb569-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb569-11"><a href="rethinking-chapter-7.html#cb569-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb569-12"><a href="rethinking-chapter-7.html#cb569-12" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_brain_size) <span class="sc">%&gt;%</span> </span>
<span id="cb569-13"><a href="rethinking-chapter-7.html#cb569-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.53</td>
<td align="right">0.07</td>
<td align="right">0.42</td>
<td align="right">0.64</td>
</tr>
<tr class="even">
<td align="left">beta_m</td>
<td align="right">0.17</td>
<td align="right">0.07</td>
<td align="right">0.05</td>
<td align="right">0.29</td>
</tr>
<tr class="odd">
<td align="left">log_sigma</td>
<td align="right">-1.71</td>
<td align="right">0.29</td>
<td align="right">-2.18</td>
<td align="right">-1.24</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="rethinking-chapter-7.html#cb570-1" aria-hidden="true" tabindex="-1"></a>extract_r2 <span class="ot">&lt;-</span> <span class="cf">function</span>(quap_fit, <span class="at">decimals =</span> <span class="dv">5</span>){</span>
<span id="cb570-2"><a href="rethinking-chapter-7.html#cb570-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">sim</span>(quap_fit) <span class="sc">%&gt;%</span> </span>
<span id="cb570-3"><a href="rethinking-chapter-7.html#cb570-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb570-4"><a href="rethinking-chapter-7.html#cb570-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="at">nm =</span> data_brainsize<span class="sc">$</span>species) <span class="sc">%&gt;%</span> </span>
<span id="cb570-5"><a href="rethinking-chapter-7.html#cb570-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), mean, <span class="at">.names =</span> <span class="st">&quot;{.col}&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb570-6"><a href="rethinking-chapter-7.html#cb570-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;species&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;mean_brainsize&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb570-7"><a href="rethinking-chapter-7.html#cb570-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">brain_size_scl =</span> data_brainsize<span class="sc">$</span>brain_size_scl,</span>
<span id="cb570-8"><a href="rethinking-chapter-7.html#cb570-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">diff =</span> mean_brainsize <span class="sc">-</span> brain_size_scl)</span>
<span id="cb570-9"><a href="rethinking-chapter-7.html#cb570-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb570-10"><a href="rethinking-chapter-7.html#cb570-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">var2</span>(data<span class="sc">$</span>diff) <span class="sc">/</span> <span class="fu">var2</span>(data<span class="sc">$</span>brain_size_scl), <span class="at">digits =</span> decimals)</span>
<span id="cb570-11"><a href="rethinking-chapter-7.html#cb570-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb570-12"><a href="rethinking-chapter-7.html#cb570-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb570-13"><a href="rethinking-chapter-7.html#cb570-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb570-14"><a href="rethinking-chapter-7.html#cb570-14" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_r2</span>(model_brain_size)</span></code></pre></div>
<pre><code>#&gt; [1] 0.47746</code></pre>
</div>
</div>
<div id="higher-order-polynomials" class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Higher order polynomials</h3>
<p><span class="math display">\[
\begin{array}{rclcr} 
b_i &amp; {\sim} &amp; Normal(\mu_i, \sigma) &amp; &amp;\textrm{[likelihood]}\\
\mu_i &amp; = &amp; \alpha + \beta_{1} m_{i} + \beta_{2} m_{i}^2 &amp; &amp;\textrm{[linear model]}\\
\alpha &amp; \sim &amp; Normal(0.5, 1) &amp; &amp; \textrm{[$\alpha$ prior]}\\
\beta_{j} &amp; \sim &amp; Normal(0, 10) &amp; \textrm{for}~j = 1..2 &amp; \textrm{[$\beta$ prior]}\\
\sigma &amp; \sim &amp; Log-Normal(0, 1) &amp; &amp;\textrm{[$\sigma$ prior]}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="rethinking-chapter-7.html#cb572-1" aria-hidden="true" tabindex="-1"></a>model_brain_size2 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb572-2"><a href="rethinking-chapter-7.html#cb572-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb572-3"><a href="rethinking-chapter-7.html#cb572-3" aria-hidden="true" tabindex="-1"></a>    brain_size_scl <span class="sc">~</span> <span class="fu">dnorm</span>(mu, <span class="fu">exp</span>(log_sigma)),</span>
<span id="cb572-4"><a href="rethinking-chapter-7.html#cb572-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb572-5"><a href="rethinking-chapter-7.html#cb572-5" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">1</span>] <span class="sc">*</span> mass_std <span class="sc">+</span> </span>
<span id="cb572-6"><a href="rethinking-chapter-7.html#cb572-6" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">2</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">2</span>,</span>
<span id="cb572-7"><a href="rethinking-chapter-7.html#cb572-7" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb572-8"><a href="rethinking-chapter-7.html#cb572-8" aria-hidden="true" tabindex="-1"></a>    beta_m <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb572-9"><a href="rethinking-chapter-7.html#cb572-9" aria-hidden="true" tabindex="-1"></a>    log_sigma <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">1</span> )</span>
<span id="cb572-10"><a href="rethinking-chapter-7.html#cb572-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb572-11"><a href="rethinking-chapter-7.html#cb572-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_brainsize,</span>
<span id="cb572-12"><a href="rethinking-chapter-7.html#cb572-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">beta_m =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb572-13"><a href="rethinking-chapter-7.html#cb572-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb572-14"><a href="rethinking-chapter-7.html#cb572-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-15"><a href="rethinking-chapter-7.html#cb572-15" aria-hidden="true" tabindex="-1"></a>model_brain_size3 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb572-16"><a href="rethinking-chapter-7.html#cb572-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb572-17"><a href="rethinking-chapter-7.html#cb572-17" aria-hidden="true" tabindex="-1"></a>    brain_size_scl <span class="sc">~</span> <span class="fu">dnorm</span>(mu, <span class="fu">exp</span>(log_sigma)),</span>
<span id="cb572-18"><a href="rethinking-chapter-7.html#cb572-18" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb572-19"><a href="rethinking-chapter-7.html#cb572-19" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">1</span>] <span class="sc">*</span> mass_std <span class="sc">+</span> </span>
<span id="cb572-20"><a href="rethinking-chapter-7.html#cb572-20" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">2</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb572-21"><a href="rethinking-chapter-7.html#cb572-21" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">3</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">3</span>,</span>
<span id="cb572-22"><a href="rethinking-chapter-7.html#cb572-22" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb572-23"><a href="rethinking-chapter-7.html#cb572-23" aria-hidden="true" tabindex="-1"></a>    beta_m <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb572-24"><a href="rethinking-chapter-7.html#cb572-24" aria-hidden="true" tabindex="-1"></a>    log_sigma <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">1</span> )</span>
<span id="cb572-25"><a href="rethinking-chapter-7.html#cb572-25" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb572-26"><a href="rethinking-chapter-7.html#cb572-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_brainsize,</span>
<span id="cb572-27"><a href="rethinking-chapter-7.html#cb572-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">beta_m =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>))</span>
<span id="cb572-28"><a href="rethinking-chapter-7.html#cb572-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb572-29"><a href="rethinking-chapter-7.html#cb572-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-30"><a href="rethinking-chapter-7.html#cb572-30" aria-hidden="true" tabindex="-1"></a>model_brain_size4 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb572-31"><a href="rethinking-chapter-7.html#cb572-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb572-32"><a href="rethinking-chapter-7.html#cb572-32" aria-hidden="true" tabindex="-1"></a>    brain_size_scl <span class="sc">~</span> <span class="fu">dnorm</span>(mu, <span class="fu">exp</span>(log_sigma)),</span>
<span id="cb572-33"><a href="rethinking-chapter-7.html#cb572-33" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb572-34"><a href="rethinking-chapter-7.html#cb572-34" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">1</span>] <span class="sc">*</span> mass_std <span class="sc">+</span> </span>
<span id="cb572-35"><a href="rethinking-chapter-7.html#cb572-35" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">2</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb572-36"><a href="rethinking-chapter-7.html#cb572-36" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">3</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">3</span> <span class="sc">+</span> </span>
<span id="cb572-37"><a href="rethinking-chapter-7.html#cb572-37" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">4</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">4</span>,</span>
<span id="cb572-38"><a href="rethinking-chapter-7.html#cb572-38" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb572-39"><a href="rethinking-chapter-7.html#cb572-39" aria-hidden="true" tabindex="-1"></a>    beta_m <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb572-40"><a href="rethinking-chapter-7.html#cb572-40" aria-hidden="true" tabindex="-1"></a>    log_sigma <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">1</span> )</span>
<span id="cb572-41"><a href="rethinking-chapter-7.html#cb572-41" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb572-42"><a href="rethinking-chapter-7.html#cb572-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_brainsize,</span>
<span id="cb572-43"><a href="rethinking-chapter-7.html#cb572-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">beta_m =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb572-44"><a href="rethinking-chapter-7.html#cb572-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb572-45"><a href="rethinking-chapter-7.html#cb572-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-46"><a href="rethinking-chapter-7.html#cb572-46" aria-hidden="true" tabindex="-1"></a>model_brain_size5 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb572-47"><a href="rethinking-chapter-7.html#cb572-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb572-48"><a href="rethinking-chapter-7.html#cb572-48" aria-hidden="true" tabindex="-1"></a>    brain_size_scl <span class="sc">~</span> <span class="fu">dnorm</span>(mu, <span class="fu">exp</span>(log_sigma)),</span>
<span id="cb572-49"><a href="rethinking-chapter-7.html#cb572-49" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb572-50"><a href="rethinking-chapter-7.html#cb572-50" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">1</span>] <span class="sc">*</span> mass_std <span class="sc">+</span> </span>
<span id="cb572-51"><a href="rethinking-chapter-7.html#cb572-51" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">2</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb572-52"><a href="rethinking-chapter-7.html#cb572-52" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">3</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">3</span> <span class="sc">+</span> </span>
<span id="cb572-53"><a href="rethinking-chapter-7.html#cb572-53" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">4</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">4</span> <span class="sc">+</span> </span>
<span id="cb572-54"><a href="rethinking-chapter-7.html#cb572-54" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">5</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">5</span>,</span>
<span id="cb572-55"><a href="rethinking-chapter-7.html#cb572-55" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb572-56"><a href="rethinking-chapter-7.html#cb572-56" aria-hidden="true" tabindex="-1"></a>    beta_m <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb572-57"><a href="rethinking-chapter-7.html#cb572-57" aria-hidden="true" tabindex="-1"></a>    log_sigma <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">1</span> )</span>
<span id="cb572-58"><a href="rethinking-chapter-7.html#cb572-58" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb572-59"><a href="rethinking-chapter-7.html#cb572-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_brainsize,</span>
<span id="cb572-60"><a href="rethinking-chapter-7.html#cb572-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">beta_m =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>))</span>
<span id="cb572-61"><a href="rethinking-chapter-7.html#cb572-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb572-62"><a href="rethinking-chapter-7.html#cb572-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-63"><a href="rethinking-chapter-7.html#cb572-63" aria-hidden="true" tabindex="-1"></a>model_brain_size6 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb572-64"><a href="rethinking-chapter-7.html#cb572-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb572-65"><a href="rethinking-chapter-7.html#cb572-65" aria-hidden="true" tabindex="-1"></a>    brain_size_scl <span class="sc">~</span> <span class="fu">dnorm</span>(mu, <span class="fu">exp</span>(log_sigma)),</span>
<span id="cb572-66"><a href="rethinking-chapter-7.html#cb572-66" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb572-67"><a href="rethinking-chapter-7.html#cb572-67" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">1</span>] <span class="sc">*</span> mass_std <span class="sc">+</span> </span>
<span id="cb572-68"><a href="rethinking-chapter-7.html#cb572-68" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">2</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb572-69"><a href="rethinking-chapter-7.html#cb572-69" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">3</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">3</span> <span class="sc">+</span> </span>
<span id="cb572-70"><a href="rethinking-chapter-7.html#cb572-70" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">4</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">4</span> <span class="sc">+</span> </span>
<span id="cb572-71"><a href="rethinking-chapter-7.html#cb572-71" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">5</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">5</span> <span class="sc">+</span> </span>
<span id="cb572-72"><a href="rethinking-chapter-7.html#cb572-72" aria-hidden="true" tabindex="-1"></a>      beta_m[<span class="dv">6</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">6</span>,</span>
<span id="cb572-73"><a href="rethinking-chapter-7.html#cb572-73" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb572-74"><a href="rethinking-chapter-7.html#cb572-74" aria-hidden="true" tabindex="-1"></a>    beta_m <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb572-75"><a href="rethinking-chapter-7.html#cb572-75" aria-hidden="true" tabindex="-1"></a>    log_sigma <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">1</span> )</span>
<span id="cb572-76"><a href="rethinking-chapter-7.html#cb572-76" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb572-77"><a href="rethinking-chapter-7.html#cb572-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_brainsize,</span>
<span id="cb572-78"><a href="rethinking-chapter-7.html#cb572-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">beta_m =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>))</span>
<span id="cb572-79"><a href="rethinking-chapter-7.html#cb572-79" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="rethinking-chapter-7.html#cb573-1" aria-hidden="true" tabindex="-1"></a>mass_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from =</span> <span class="fu">min</span>(data_brainsize<span class="sc">$</span>mass_std) <span class="sc">-</span> .<span class="dv">15</span>,</span>
<span id="cb573-2"><a href="rethinking-chapter-7.html#cb573-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">to =</span> <span class="fu">max</span>(data_brainsize<span class="sc">$</span>mass_std) <span class="sc">+</span> .<span class="dv">15</span>,</span>
<span id="cb573-3"><a href="rethinking-chapter-7.html#cb573-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">length.out =</span> <span class="dv">101</span>)</span>
<span id="cb573-4"><a href="rethinking-chapter-7.html#cb573-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-5"><a href="rethinking-chapter-7.html#cb573-5" aria-hidden="true" tabindex="-1"></a>plot_poly <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, ylim){</span>
<span id="cb573-6"><a href="rethinking-chapter-7.html#cb573-6" aria-hidden="true" tabindex="-1"></a>  model_posterior_samples <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(mod) <span class="sc">%&gt;%</span> </span>
<span id="cb573-7"><a href="rethinking-chapter-7.html#cb573-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb573-8"><a href="rethinking-chapter-7.html#cb573-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()</span>
<span id="cb573-9"><a href="rethinking-chapter-7.html#cb573-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb573-10"><a href="rethinking-chapter-7.html#cb573-10" aria-hidden="true" tabindex="-1"></a>  model_posterior_prediction_samples <span class="ot">&lt;-</span> <span class="fu">link</span>(mod, <span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">mass_std =</span> mass_seq)) <span class="sc">%&gt;%</span> </span>
<span id="cb573-11"><a href="rethinking-chapter-7.html#cb573-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb573-12"><a href="rethinking-chapter-7.html#cb573-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(<span class="at">nm =</span> mass_seq) <span class="sc">%&gt;%</span> </span>
<span id="cb573-13"><a href="rethinking-chapter-7.html#cb573-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;mass_std&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;brain_size_scl&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb573-14"><a href="rethinking-chapter-7.html#cb573-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mass_std =</span> <span class="fu">as.numeric</span>(mass_std)) </span>
<span id="cb573-15"><a href="rethinking-chapter-7.html#cb573-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb573-16"><a href="rethinking-chapter-7.html#cb573-16" aria-hidden="true" tabindex="-1"></a>  model_posterior_prediction_pi <span class="ot">&lt;-</span> model_posterior_prediction_samples <span class="sc">%&gt;%</span> </span>
<span id="cb573-17"><a href="rethinking-chapter-7.html#cb573-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(mass_std) <span class="sc">%&gt;%</span> </span>
<span id="cb573-18"><a href="rethinking-chapter-7.html#cb573-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(brain_size_scl),</span>
<span id="cb573-19"><a href="rethinking-chapter-7.html#cb573-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">PI_lower =</span> <span class="fu">PI</span>(brain_size_scl)[<span class="dv">1</span>],</span>
<span id="cb573-20"><a href="rethinking-chapter-7.html#cb573-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">PI_upper =</span> <span class="fu">PI</span>(brain_size_scl)[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb573-21"><a href="rethinking-chapter-7.html#cb573-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb573-22"><a href="rethinking-chapter-7.html#cb573-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb573-23"><a href="rethinking-chapter-7.html#cb573-23" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> mass_std <span class="sc">*</span> <span class="fu">sd</span>(data_brainsize<span class="sc">$</span>mass) <span class="sc">+</span> <span class="fu">mean</span>(data_brainsize<span class="sc">$</span>mass))) <span class="sc">+</span></span>
<span id="cb573-24"><a href="rethinking-chapter-7.html#cb573-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">data =</span> model_posterior_prediction_pi, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb573-25"><a href="rethinking-chapter-7.html#cb573-25" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">*</span> <span class="fu">max</span>(data_brainsize<span class="sc">$</span>brain_size),</span>
<span id="cb573-26"><a href="rethinking-chapter-7.html#cb573-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> PI_lower  <span class="sc">*</span> <span class="fu">max</span>(data_brainsize<span class="sc">$</span>brain_size),</span>
<span id="cb573-27"><a href="rethinking-chapter-7.html#cb573-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> PI_upper <span class="sc">*</span> <span class="fu">max</span>(data_brainsize<span class="sc">$</span>brain_size)),</span>
<span id="cb573-28"><a href="rethinking-chapter-7.html#cb573-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> clr2, <span class="at">fill =</span> fll2, <span class="at">size =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb573-29"><a href="rethinking-chapter-7.html#cb573-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> data_brainsize, <span class="fu">aes</span>(<span class="at">y =</span> brain_size_scl <span class="sc">*</span> <span class="fu">max</span>(data_brainsize<span class="sc">$</span>brain_size)),</span>
<span id="cb573-30"><a href="rethinking-chapter-7.html#cb573-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb573-31"><a href="rethinking-chapter-7.html#cb573-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;mass&quot;</span>,</span>
<span id="cb573-32"><a href="rethinking-chapter-7.html#cb573-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;brain_size&quot;</span>,</span>
<span id="cb573-33"><a href="rethinking-chapter-7.html#cb573-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="fu">glue</span>(<span class="st">&quot;*R&lt;sup&gt;2&lt;/sup&gt;:* {extract_r2(mod, decimals = 2)}&quot;</span>)) <span class="sc">+</span></span>
<span id="cb573-34"><a href="rethinking-chapter-7.html#cb573-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> ylim) <span class="sc">+</span></span>
<span id="cb573-35"><a href="rethinking-chapter-7.html#cb573-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb573-36"><a href="rethinking-chapter-7.html#cb573-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb573-37"><a href="rethinking-chapter-7.html#cb573-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">identical</span>(mod, model_brain_size6)) {</span>
<span id="cb573-38"><a href="rethinking-chapter-7.html#cb573-38" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span></span>
<span id="cb573-39"><a href="rethinking-chapter-7.html#cb573-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> clr_dark, <span class="at">linetype =</span> <span class="dv">3</span> )</span>
<span id="cb573-40"><a href="rethinking-chapter-7.html#cb573-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb573-41"><a href="rethinking-chapter-7.html#cb573-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb573-42"><a href="rethinking-chapter-7.html#cb573-42" aria-hidden="true" tabindex="-1"></a>  p</span>
<span id="cb573-43"><a href="rethinking-chapter-7.html#cb573-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb573-44"><a href="rethinking-chapter-7.html#cb573-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-45"><a href="rethinking-chapter-7.html#cb573-45" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(model_brain_size, model_brain_size2,model_brain_size3,</span>
<span id="cb573-46"><a href="rethinking-chapter-7.html#cb573-46" aria-hidden="true" tabindex="-1"></a>     model_brain_size4, model_brain_size5, model_brain_size6) <span class="sc">%&gt;%</span> </span>
<span id="cb573-47"><a href="rethinking-chapter-7.html#cb573-47" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map2</span>(<span class="at">.y =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">420</span>, <span class="dv">1400</span>), <span class="fu">c</span>(<span class="dv">420</span>, <span class="dv">1400</span>), <span class="fu">c</span>(<span class="dv">420</span>, <span class="dv">1400</span>),</span>
<span id="cb573-48"><a href="rethinking-chapter-7.html#cb573-48" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">1950</span>), <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">1950</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="dv">400</span>, <span class="dv">1500</span>)),</span>
<span id="cb573-49"><a href="rethinking-chapter-7.html#cb573-49" aria-hidden="true" tabindex="-1"></a>              plot_poly) <span class="sc">%&gt;%</span> </span>
<span id="cb573-50"><a href="rethinking-chapter-7.html#cb573-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_plots</span>() <span class="sc">+</span></span>
<span id="cb573-51"><a href="rethinking-chapter-7.html#cb573-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c7_files/figure-html/unnamed-chunk-4-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="underfitting" class="section level3" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Underfitting</h3>
<p><em>Leave one out</em> (LOO)</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="rethinking-chapter-7.html#cb574-1" aria-hidden="true" tabindex="-1"></a>model_loo <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">idx =</span> <span class="dv">0</span>, <span class="at">mod_degree =</span> <span class="dv">1</span>){</span>
<span id="cb574-2"><a href="rethinking-chapter-7.html#cb574-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data_brainsize[<span class="sc">-</span>idx, ]</span>
<span id="cb574-3"><a href="rethinking-chapter-7.html#cb574-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb574-4"><a href="rethinking-chapter-7.html#cb574-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(mod_degree <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb574-5"><a href="rethinking-chapter-7.html#cb574-5" aria-hidden="true" tabindex="-1"></a>    current_mod <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb574-6"><a href="rethinking-chapter-7.html#cb574-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb574-7"><a href="rethinking-chapter-7.html#cb574-7" aria-hidden="true" tabindex="-1"></a>        brain_size_scl <span class="sc">~</span> <span class="fu">dnorm</span>(mu, <span class="fu">exp</span>(log_sigma)),</span>
<span id="cb574-8"><a href="rethinking-chapter-7.html#cb574-8" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb574-9"><a href="rethinking-chapter-7.html#cb574-9" aria-hidden="true" tabindex="-1"></a>          beta_m[<span class="dv">1</span>] <span class="sc">*</span> mass_std,</span>
<span id="cb574-10"><a href="rethinking-chapter-7.html#cb574-10" aria-hidden="true" tabindex="-1"></a>        alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb574-11"><a href="rethinking-chapter-7.html#cb574-11" aria-hidden="true" tabindex="-1"></a>        beta_m <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb574-12"><a href="rethinking-chapter-7.html#cb574-12" aria-hidden="true" tabindex="-1"></a>        log_sigma <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">1</span> )</span>
<span id="cb574-13"><a href="rethinking-chapter-7.html#cb574-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb574-14"><a href="rethinking-chapter-7.html#cb574-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data,</span>
<span id="cb574-15"><a href="rethinking-chapter-7.html#cb574-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">start =</span> <span class="fu">list</span>(<span class="at">beta_m =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb574-16"><a href="rethinking-chapter-7.html#cb574-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb574-17"><a href="rethinking-chapter-7.html#cb574-17" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(mod_degree <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb574-18"><a href="rethinking-chapter-7.html#cb574-18" aria-hidden="true" tabindex="-1"></a>    current_mod <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb574-19"><a href="rethinking-chapter-7.html#cb574-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb574-20"><a href="rethinking-chapter-7.html#cb574-20" aria-hidden="true" tabindex="-1"></a>        brain_size_scl <span class="sc">~</span> <span class="fu">dnorm</span>(mu, <span class="fu">exp</span>(log_sigma)),</span>
<span id="cb574-21"><a href="rethinking-chapter-7.html#cb574-21" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> </span>
<span id="cb574-22"><a href="rethinking-chapter-7.html#cb574-22" aria-hidden="true" tabindex="-1"></a>          beta_m[<span class="dv">1</span>] <span class="sc">*</span> mass_std <span class="sc">+</span> </span>
<span id="cb574-23"><a href="rethinking-chapter-7.html#cb574-23" aria-hidden="true" tabindex="-1"></a>          beta_m[<span class="dv">2</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb574-24"><a href="rethinking-chapter-7.html#cb574-24" aria-hidden="true" tabindex="-1"></a>          beta_m[<span class="dv">3</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">3</span> <span class="sc">+</span> </span>
<span id="cb574-25"><a href="rethinking-chapter-7.html#cb574-25" aria-hidden="true" tabindex="-1"></a>          beta_m[<span class="dv">4</span>] <span class="sc">*</span> mass_std <span class="sc">^</span> <span class="dv">4</span>,</span>
<span id="cb574-26"><a href="rethinking-chapter-7.html#cb574-26" aria-hidden="true" tabindex="-1"></a>        alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb574-27"><a href="rethinking-chapter-7.html#cb574-27" aria-hidden="true" tabindex="-1"></a>        beta_m <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb574-28"><a href="rethinking-chapter-7.html#cb574-28" aria-hidden="true" tabindex="-1"></a>        log_sigma <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span>, <span class="dv">1</span> )</span>
<span id="cb574-29"><a href="rethinking-chapter-7.html#cb574-29" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb574-30"><a href="rethinking-chapter-7.html#cb574-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data,</span>
<span id="cb574-31"><a href="rethinking-chapter-7.html#cb574-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">start =</span> <span class="fu">list</span>(<span class="at">beta_m =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb574-32"><a href="rethinking-chapter-7.html#cb574-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb574-33"><a href="rethinking-chapter-7.html#cb574-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">stop</span>(<span class="st">&quot;`mod_degree` needs to be either 1 or 4&quot;</span>) }</span>
<span id="cb574-34"><a href="rethinking-chapter-7.html#cb574-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb574-35"><a href="rethinking-chapter-7.html#cb574-35" aria-hidden="true" tabindex="-1"></a>  model_posterior_prediction_samples <span class="ot">&lt;-</span> <span class="fu">link</span>(current_mod, <span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">mass_std =</span> mass_seq)) <span class="sc">%&gt;%</span> </span>
<span id="cb574-36"><a href="rethinking-chapter-7.html#cb574-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb574-37"><a href="rethinking-chapter-7.html#cb574-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(<span class="at">nm =</span> mass_seq) <span class="sc">%&gt;%</span> </span>
<span id="cb574-38"><a href="rethinking-chapter-7.html#cb574-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;mass_std&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;brain_size_scl&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb574-39"><a href="rethinking-chapter-7.html#cb574-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mass_std =</span> <span class="fu">as.numeric</span>(mass_std)) </span>
<span id="cb574-40"><a href="rethinking-chapter-7.html#cb574-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb574-41"><a href="rethinking-chapter-7.html#cb574-41" aria-hidden="true" tabindex="-1"></a>  model_posterior_prediction_pi <span class="ot">&lt;-</span> model_posterior_prediction_samples <span class="sc">%&gt;%</span> </span>
<span id="cb574-42"><a href="rethinking-chapter-7.html#cb574-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(mass_std) <span class="sc">%&gt;%</span> </span>
<span id="cb574-43"><a href="rethinking-chapter-7.html#cb574-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(brain_size_scl)) <span class="sc">%&gt;%</span> </span>
<span id="cb574-44"><a href="rethinking-chapter-7.html#cb574-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb574-45"><a href="rethinking-chapter-7.html#cb574-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">idx =</span> idx, <span class="at">mod_degree =</span> mod_degree)</span>
<span id="cb574-46"><a href="rethinking-chapter-7.html#cb574-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb574-47"><a href="rethinking-chapter-7.html#cb574-47" aria-hidden="true" tabindex="-1"></a>  model_posterior_prediction_pi</span>
<span id="cb574-48"><a href="rethinking-chapter-7.html#cb574-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb574-49"><a href="rethinking-chapter-7.html#cb574-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-50"><a href="rethinking-chapter-7.html#cb574-50" aria-hidden="true" tabindex="-1"></a><span class="fu">cross_df</span>(<span class="fu">list</span>(<span class="at">idx =</span> <span class="fu">seq_along</span>(data_brainsize<span class="sc">$</span>species),</span>
<span id="cb574-51"><a href="rethinking-chapter-7.html#cb574-51" aria-hidden="true" tabindex="-1"></a>              <span class="at">mod_degree =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb574-52"><a href="rethinking-chapter-7.html#cb574-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmap_dfr</span>(model_loo) <span class="sc">%&gt;%</span> </span>
<span id="cb574-53"><a href="rethinking-chapter-7.html#cb574-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> mass_std <span class="sc">*</span> <span class="fu">sd</span>(data_brainsize<span class="sc">$</span>mass) <span class="sc">+</span> <span class="fu">mean</span>(data_brainsize<span class="sc">$</span>mass))) <span class="sc">+</span></span>
<span id="cb574-54"><a href="rethinking-chapter-7.html#cb574-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">*</span> <span class="fu">max</span>(data_brainsize<span class="sc">$</span>brain_size),</span>
<span id="cb574-55"><a href="rethinking-chapter-7.html#cb574-55" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group =</span> <span class="fu">factor</span>(idx),</span>
<span id="cb574-56"><a href="rethinking-chapter-7.html#cb574-56" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> idx)) <span class="sc">+</span></span>
<span id="cb574-57"><a href="rethinking-chapter-7.html#cb574-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> data_brainsize <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">idx =</span> <span class="fu">row_number</span>()),</span>
<span id="cb574-58"><a href="rethinking-chapter-7.html#cb574-58" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> brain_size_scl <span class="sc">*</span> <span class="fu">max</span>(data_brainsize<span class="sc">$</span>brain_size),</span>
<span id="cb574-59"><a href="rethinking-chapter-7.html#cb574-59" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> idx, <span class="at">color =</span> <span class="fu">after_scale</span>(<span class="fu">clr_darken</span>(fill))),</span>
<span id="cb574-60"><a href="rethinking-chapter-7.html#cb574-60" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb574-61"><a href="rethinking-chapter-7.html#cb574-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;mass&quot;</span>,</span>
<span id="cb574-62"><a href="rethinking-chapter-7.html#cb574-62" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;brain_size&quot;</span>) <span class="sc">+</span></span>
<span id="cb574-63"><a href="rethinking-chapter-7.html#cb574-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(mod_degree <span class="sc">~</span> ., <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb574-64"><a href="rethinking-chapter-7.html#cb574-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(clr0dd, clr0, clr2), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb574-65"><a href="rethinking-chapter-7.html#cb574-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(clr0dd, clr0, clr2), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb574-66"><a href="rethinking-chapter-7.html#cb574-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2e3</span>)) <span class="sc">+</span></span>
<span id="cb574-67"><a href="rethinking-chapter-7.html#cb574-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_markdown</span>())</span></code></pre></div>
<p><img src="rethinking_c7_files/figure-html/unnamed-chunk-5-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="entropy-and-accuracy" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Entropy and Accuracy</h2>
<div id="entropy" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Entropy</h3>
<p>Definition of <em>Information Entropy</em></p>
<p><span class="math display">\[
H(p) = - E~\textrm{log}(p_{i}) = - \sum_{i = 1}^n p_{i}~\textrm{log}(p_{i})
\]</span></p>
<p>or verbally:</p>
<blockquote>
<p><em>The uncertainty contained in a probability distribution is the average log-probability of an event.</em></p>
</blockquote>
<p>which fulfills the requirements:</p>
<ul>
<li>uncertainty should be continuous</li>
<li>uncertainty should increase with the number of possible events</li>
<li>uncertainty should be additive</li>
</ul>
<p>Example for <span class="math inline">\(p_1 = 0.3\)</span> and <span class="math inline">\(p_2 = 0.7\)</span>:</p>
<p><span class="math display">\[
H(p) = - \big( p_{1} \textrm{log}(p_{1}) + p_{2} \textrm{log}(p_{2}) \big) \approx 0.61
\]</span></p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="rethinking-chapter-7.html#cb575-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>( .<span class="dv">3</span>, .<span class="dv">7</span> )</span>
<span id="cb575-2"><a href="rethinking-chapter-7.html#cb575-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> <span class="fu">sum</span>( p <span class="sc">*</span> <span class="fu">log</span>(p) )</span></code></pre></div>
<pre><code>#&gt; [1] 0.6108643</code></pre>
<p>Compared to Abu Dhabi (<em>“it hardly ever rains”</em>)</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="rethinking-chapter-7.html#cb577-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>( .<span class="dv">01</span>, .<span class="dv">99</span> )</span>
<span id="cb577-2"><a href="rethinking-chapter-7.html#cb577-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> <span class="fu">sum</span>( p <span class="sc">*</span> <span class="fu">log</span>(p) )</span></code></pre></div>
<pre><code>#&gt; [1] 0.05600153</code></pre>
<p>Entropy increases with th dimensionality of the prediction problem (eg. predicting 🌧/ 🌨 / ☀️)</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="rethinking-chapter-7.html#cb579-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>( .<span class="dv">15</span>, .<span class="dv">5</span>, .<span class="dv">7</span> )</span>
<span id="cb579-2"><a href="rethinking-chapter-7.html#cb579-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> <span class="fu">sum</span>( p <span class="sc">*</span> <span class="fu">log</span>(p) )</span></code></pre></div>
<pre><code>#&gt; [1] 0.880814</code></pre>
</div>
<div id="accuracy" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Accuracy</h3>
<blockquote>
<p><em>Divergence: The additional uncertainty induced by using probabilities from one distribution to describe another distribution.</em></p>
</blockquote>
<p>The <em>Kullback-Leibler Divergence</em> (KL):</p>
<p><span class="math display">\[
D_{KL}(p, q) = \sum_{i} p_{i} \big( \textrm{log}(p_{i}) - \textrm{log}(q_{i})\big) = \sum_{i} p_{i} \textrm{log}\left(\frac{p_{i}}{q_{i}}\right)
\]</span></p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="rethinking-chapter-7.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">p1 =</span> .<span class="dv">3</span>,</span>
<span id="cb581-2"><a href="rethinking-chapter-7.html#cb581-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">p2 =</span> .<span class="dv">7</span>,</span>
<span id="cb581-3"><a href="rethinking-chapter-7.html#cb581-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">q1 =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">01</span>, <span class="at">to =</span> .<span class="dv">99</span>, <span class="at">by =</span> .<span class="dv">01</span>),</span>
<span id="cb581-4"><a href="rethinking-chapter-7.html#cb581-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">q2 =</span> <span class="dv">1</span> <span class="sc">-</span> q1,</span>
<span id="cb581-5"><a href="rethinking-chapter-7.html#cb581-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">d_kl =</span> p1 <span class="sc">*</span> <span class="fu">log</span>(p1 <span class="sc">/</span> q1) <span class="sc">+</span> p2 <span class="sc">*</span> <span class="fu">log</span>(p2 <span class="sc">/</span> q2)) <span class="sc">%&gt;%</span> </span>
<span id="cb581-6"><a href="rethinking-chapter-7.html#cb581-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> q1, <span class="at">y =</span> d_kl)) <span class="sc">+</span></span>
<span id="cb581-7"><a href="rethinking-chapter-7.html#cb581-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> clr2) <span class="sc">+</span></span>
<span id="cb581-8"><a href="rethinking-chapter-7.html#cb581-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">3</span>, <span class="at">color =</span> clr_dark, <span class="at">linetype =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="rethinking_c7_files/figure-html/unnamed-chunk-9-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="estimating-divergence" class="section level3" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Estimating Divergence</h3>
<p><em>Log-probability score</em> to compare the predictive accuracy of different models:</p>
<p><span class="math display">\[
S(q) = \sum_{i} \textrm(log) (q_{i})
\]</span></p>
<p>where <span class="math inline">\(i\)</span> indexes each case and <span class="math inline">\(q_{i}\)</span> is the likelihood for each case.</p>
<p>A (re-scaled) equivalent is given with the <em>deviance</em>:</p>
<p><span class="math display">\[
D(q) = -2 \sum_{i} \textrm(log) (q_{i})
\]</span></p>
<p>and it’s Bayesian version the <em>Log-posterior-predictive density</em>:</p>
<p><span class="math display">\[
lppd(y, \Theta) = \sum_{i} \textrm{log} \frac{1}{S} \sum_{s} p (y_{i} | \Theta_{s}) 
\]</span></p>
<p>where <span class="math inline">\(S\)</span> is the number of samples and <span class="math inline">\(\Theta_{s}\)</span> is the s-th set of sampled parameter values in the posterior distribution.</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="rethinking-chapter-7.html#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lppd &lt;- function (fit, ...) {</span></span>
<span id="cb582-2"><a href="rethinking-chapter-7.html#cb582-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     ll &lt;- sim(fit, ll = TRUE, ...)</span></span>
<span id="cb582-3"><a href="rethinking-chapter-7.html#cb582-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     n &lt;- ncol(ll)</span></span>
<span id="cb582-4"><a href="rethinking-chapter-7.html#cb582-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     ns &lt;- nrow(ll)</span></span>
<span id="cb582-5"><a href="rethinking-chapter-7.html#cb582-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     f &lt;- function(i) log_sum_exp(ll[, i]) - log(ns)</span></span>
<span id="cb582-6"><a href="rethinking-chapter-7.html#cb582-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     lppd &lt;- sapply(1:n, f)</span></span>
<span id="cb582-7"><a href="rethinking-chapter-7.html#cb582-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     return(lppd)</span></span>
<span id="cb582-8"><a href="rethinking-chapter-7.html#cb582-8" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb582-9"><a href="rethinking-chapter-7.html#cb582-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb582-10"><a href="rethinking-chapter-7.html#cb582-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lppd</span>(model_brain_size, <span class="at">n =</span> <span class="fl">1e4</span>)</span></code></pre></div>
<pre><code>#&gt; [1]  0.6098668  0.6483438  0.5496093  0.6234934  0.4648143  0.4347605 -0.8444632</code></pre>
</div>
<div id="scoring-the-right-data" class="section level3" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> Scoring the right data</h3>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="rethinking-chapter-7.html#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">model_degree =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb584-2"><a href="rethinking-chapter-7.html#cb584-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">model =</span> <span class="fu">list</span>(model_brain_size, model_brain_size2,</span>
<span id="cb584-3"><a href="rethinking-chapter-7.html#cb584-3" aria-hidden="true" tabindex="-1"></a>                    model_brain_size3, model_brain_size4,</span>
<span id="cb584-4"><a href="rethinking-chapter-7.html#cb584-4" aria-hidden="true" tabindex="-1"></a>                    model_brain_size5, model_brain_size6)) <span class="sc">%&gt;%</span> </span>
<span id="cb584-5"><a href="rethinking-chapter-7.html#cb584-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_prob_score =</span> <span class="fu">map_dbl</span>(model, <span class="at">.f =</span> <span class="cf">function</span>(mod){<span class="fu">sum</span>(<span class="fu">lppd</span>(mod))}))</span></code></pre></div>
<pre><code>#&gt; # A tibble: 6 x 3
#&gt;   model_degree model  log_prob_score
#&gt;          &lt;int&gt; &lt;list&gt;          &lt;dbl&gt;
#&gt; 1            1 &lt;map&gt;            2.42
#&gt; 2            2 &lt;map&gt;            2.65
#&gt; 3            3 &lt;map&gt;            3.69
#&gt; 4            4 &lt;map&gt;            5.32
#&gt; 5            5 &lt;map&gt;           14.1 
#&gt; 6            6 &lt;map&gt;           39.6</code></pre>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="rethinking-chapter-7.html#cb586-1" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb586-2"><a href="rethinking-chapter-7.html#cb586-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb586-3"><a href="rethinking-chapter-7.html#cb586-3" aria-hidden="true" tabindex="-1"></a>run_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(k, n_samples, <span class="at">n_sim =</span> <span class="fl">1e3</span>, <span class="at">b_sigma =</span> <span class="dv">100</span>){</span>
<span id="cb586-4"><a href="rethinking-chapter-7.html#cb586-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mcreplicate</span>(n_sim, <span class="fu">sim_train_test</span>(<span class="at">N =</span> n_samples, <span class="at">k =</span> k, <span class="at">b_sigma =</span> b_sigma),</span>
<span id="cb586-5"><a href="rethinking-chapter-7.html#cb586-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">mc.cores =</span> n_cores) <span class="sc">%&gt;%</span> </span>
<span id="cb586-6"><a href="rethinking-chapter-7.html#cb586-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb586-7"><a href="rethinking-chapter-7.html#cb586-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb586-8"><a href="rethinking-chapter-7.html#cb586-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_p =</span> <span class="fu">mean</span>(V1),</span>
<span id="cb586-9"><a href="rethinking-chapter-7.html#cb586-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">mean_q =</span> <span class="fu">mean</span>(V2),</span>
<span id="cb586-10"><a href="rethinking-chapter-7.html#cb586-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd_p =</span> <span class="fu">sd</span>(V1),</span>
<span id="cb586-11"><a href="rethinking-chapter-7.html#cb586-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd_q =</span> <span class="fu">sd</span>(V2)) <span class="sc">%&gt;%</span> </span>
<span id="cb586-12"><a href="rethinking-chapter-7.html#cb586-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">k =</span> k, <span class="at">n_samples =</span> n_samples, <span class="at">b_sigma =</span> b_sigma)</span>
<span id="cb586-13"><a href="rethinking-chapter-7.html#cb586-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb586-14"><a href="rethinking-chapter-7.html#cb586-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb586-15"><a href="rethinking-chapter-7.html#cb586-15" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb586-16"><a href="rethinking-chapter-7.html#cb586-16" aria-hidden="true" tabindex="-1"></a>data_sim <span class="ot">&lt;-</span> <span class="fu">cross_df</span>(<span class="fu">list</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb586-17"><a href="rethinking-chapter-7.html#cb586-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">n_samples =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">100</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb586-18"><a href="rethinking-chapter-7.html#cb586-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmap_dfr</span>(run_sim)</span>
<span id="cb586-19"><a href="rethinking-chapter-7.html#cb586-19" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span>
<span id="cb586-20"><a href="rethinking-chapter-7.html#cb586-20" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(data_sim, <span class="st">&quot;data/rethinking_c6_data_sim.Rds&quot;</span>)</span>
<span id="cb586-21"><a href="rethinking-chapter-7.html#cb586-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb586-22"><a href="rethinking-chapter-7.html#cb586-22" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb586-23"><a href="rethinking-chapter-7.html#cb586-23" aria-hidden="true" tabindex="-1"></a>data_sim_var_beta <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb586-24"><a href="rethinking-chapter-7.html#cb586-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">n_samples =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">100</span>),</span>
<span id="cb586-25"><a href="rethinking-chapter-7.html#cb586-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_sigma =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb586-26"><a href="rethinking-chapter-7.html#cb586-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmap_dfr</span>(run_sim)</span>
<span id="cb586-27"><a href="rethinking-chapter-7.html#cb586-27" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span>
<span id="cb586-28"><a href="rethinking-chapter-7.html#cb586-28" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(data_sim_var_beta, <span class="st">&quot;data/rethinking_c6_data_sim_var_beta.Rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="rethinking-chapter-7.html#cb587-1" aria-hidden="true" tabindex="-1"></a>data_sim <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&quot;data/rethinking_c6_data_sim.Rds&quot;</span>)</span>
<span id="cb587-2"><a href="rethinking-chapter-7.html#cb587-2" aria-hidden="true" tabindex="-1"></a>x_dodge <span class="ot">&lt;-</span> .<span class="dv">3</span></span>
<span id="cb587-3"><a href="rethinking-chapter-7.html#cb587-3" aria-hidden="true" tabindex="-1"></a>data_sim <span class="sc">%&gt;%</span> </span>
<span id="cb587-4"><a href="rethinking-chapter-7.html#cb587-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb587-5"><a href="rethinking-chapter-7.html#cb587-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> k <span class="sc">-</span> .<span class="dv">5</span> <span class="sc">*</span> x_dodge,</span>
<span id="cb587-6"><a href="rethinking-chapter-7.html#cb587-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymin =</span> mean_p <span class="sc">-</span> sd_p, <span class="at">y =</span> mean_p, <span class="at">ymax =</span> mean_p <span class="sc">+</span> sd_p,</span>
<span id="cb587-7"><a href="rethinking-chapter-7.html#cb587-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="st">&quot;train&quot;</span>, <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_lighten</span>(color))),</span>
<span id="cb587-8"><a href="rethinking-chapter-7.html#cb587-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb587-9"><a href="rethinking-chapter-7.html#cb587-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> k <span class="sc">+</span> .<span class="dv">5</span> <span class="sc">*</span> x_dodge,</span>
<span id="cb587-10"><a href="rethinking-chapter-7.html#cb587-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymin =</span> mean_q <span class="sc">-</span> sd_q, <span class="at">y =</span> mean_q, <span class="at">ymax =</span> mean_q <span class="sc">+</span> sd_q,</span>
<span id="cb587-11"><a href="rethinking-chapter-7.html#cb587-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="st">&quot;test&quot;</span>, <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_lighten</span>(color))),</span>
<span id="cb587-12"><a href="rethinking-chapter-7.html#cb587-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb587-13"><a href="rethinking-chapter-7.html#cb587-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="at">train =</span> clr0dd, <span class="at">test =</span> clr2)) <span class="sc">+</span></span>
<span id="cb587-14"><a href="rethinking-chapter-7.html#cb587-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(n_samples <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">label =</span> label_both) <span class="sc">+</span></span>
<span id="cb587-15"><a href="rethinking-chapter-7.html#cb587-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;number of parameters&quot;</span>, <span class="at">y =</span> <span class="st">&quot;deviance&quot;</span>) <span class="sc">+</span></span>
<span id="cb587-16"><a href="rethinking-chapter-7.html#cb587-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c7_files/figure-html/unnamed-chunk-13-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="rethinking-chapter-7.html#cb588-1" aria-hidden="true" tabindex="-1"></a>p_curves <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb588-2"><a href="rethinking-chapter-7.html#cb588-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="fu">dnorm</span>(<span class="at">x =</span> x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> .<span class="dv">2</span>)},</span>
<span id="cb588-3"><a href="rethinking-chapter-7.html#cb588-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> clr0dd, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">n =</span> <span class="dv">301</span>) <span class="sc">+</span></span>
<span id="cb588-4"><a href="rethinking-chapter-7.html#cb588-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="fu">dnorm</span>(<span class="at">x =</span> x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> .<span class="dv">5</span>)},</span>
<span id="cb588-5"><a href="rethinking-chapter-7.html#cb588-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> clr0dd, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">n =</span> <span class="dv">301</span>) <span class="sc">+</span></span>
<span id="cb588-6"><a href="rethinking-chapter-7.html#cb588-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="fu">dnorm</span>(<span class="at">x =</span> x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)},</span>
<span id="cb588-7"><a href="rethinking-chapter-7.html#cb588-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> clr0dd, <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">n =</span> <span class="dv">501</span>) <span class="sc">+</span></span>
<span id="cb588-8"><a href="rethinking-chapter-7.html#cb588-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;parameter value&quot;</span>, <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb588-9"><a href="rethinking-chapter-7.html#cb588-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-10"><a href="rethinking-chapter-7.html#cb588-10" aria-hidden="true" tabindex="-1"></a>data_sim_var_beta <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&quot;data/rethinking_c6_data_sim_var_beta.Rds&quot;</span>)</span>
<span id="cb588-11"><a href="rethinking-chapter-7.html#cb588-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-12"><a href="rethinking-chapter-7.html#cb588-12" aria-hidden="true" tabindex="-1"></a>p_lines <span class="ot">&lt;-</span> data_sim_var_beta <span class="sc">%&gt;%</span></span>
<span id="cb588-13"><a href="rethinking-chapter-7.html#cb588-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mean_p, mean_q,k<span class="sc">:</span>b_sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb588-14"><a href="rethinking-chapter-7.html#cb588-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> mean_p<span class="sc">:</span>mean_q, <span class="at">names_to =</span> <span class="st">&quot;set&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb588-15"><a href="rethinking-chapter-7.html#cb588-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb588-16"><a href="rethinking-chapter-7.html#cb588-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k,</span>
<span id="cb588-17"><a href="rethinking-chapter-7.html#cb588-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> mean,</span>
<span id="cb588-18"><a href="rethinking-chapter-7.html#cb588-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="fu">factor</span>(b_sigma),</span>
<span id="cb588-19"><a href="rethinking-chapter-7.html#cb588-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> set)) <span class="sc">+</span></span>
<span id="cb588-20"><a href="rethinking-chapter-7.html#cb588-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_sim <span class="sc">%&gt;%</span></span>
<span id="cb588-21"><a href="rethinking-chapter-7.html#cb588-21" aria-hidden="true" tabindex="-1"></a>               dplyr<span class="sc">::</span><span class="fu">select</span>(mean_p, mean_q,k<span class="sc">:</span>b_sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb588-22"><a href="rethinking-chapter-7.html#cb588-22" aria-hidden="true" tabindex="-1"></a>               <span class="fu">pivot_longer</span>(<span class="at">cols =</span> mean_p<span class="sc">:</span>mean_q, <span class="at">names_to =</span> <span class="st">&quot;set&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;mean&quot;</span>),</span>
<span id="cb588-23"><a href="rethinking-chapter-7.html#cb588-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> k,</span>
<span id="cb588-24"><a href="rethinking-chapter-7.html#cb588-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> mean,</span>
<span id="cb588-25"><a href="rethinking-chapter-7.html#cb588-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> set,</span>
<span id="cb588-26"><a href="rethinking-chapter-7.html#cb588-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_lighten</span>(color))),</span>
<span id="cb588-27"><a href="rethinking-chapter-7.html#cb588-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb588-28"><a href="rethinking-chapter-7.html#cb588-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;&quot;</span>, </span>
<span id="cb588-29"><a href="rethinking-chapter-7.html#cb588-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="at">mean_p =</span> clr0dd, <span class="at">mean_q =</span> clr2),</span>
<span id="cb588-30"><a href="rethinking-chapter-7.html#cb588-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">mean_p =</span> <span class="st">&quot;test&quot;</span>, <span class="at">mean_q =</span> <span class="st">&quot;train&quot;</span>)) <span class="sc">+</span></span>
<span id="cb588-31"><a href="rethinking-chapter-7.html#cb588-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="st">&quot;beta prior width&quot;</span>,</span>
<span id="cb588-32"><a href="rethinking-chapter-7.html#cb588-32" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">`</span><span class="at">0.5</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">`</span><span class="at">0.2</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb588-33"><a href="rethinking-chapter-7.html#cb588-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(n_samples <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">label =</span> label_both) <span class="sc">+</span></span>
<span id="cb588-34"><a href="rethinking-chapter-7.html#cb588-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;number of parameters&quot;</span>, <span class="at">y =</span> <span class="st">&quot;deviance&quot;</span>) <span class="sc">+</span></span>
<span id="cb588-35"><a href="rethinking-chapter-7.html#cb588-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb588-36"><a href="rethinking-chapter-7.html#cb588-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-37"><a href="rethinking-chapter-7.html#cb588-37" aria-hidden="true" tabindex="-1"></a>p_curves <span class="sc">+</span> p_lines <span class="sc">+</span> </span>
<span id="cb588-38"><a href="rethinking-chapter-7.html#cb588-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;a&quot;</span>) <span class="sc">+</span></span>
<span id="cb588-39"><a href="rethinking-chapter-7.html#cb588-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb588-40"><a href="rethinking-chapter-7.html#cb588-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c7_files/figure-html/unnamed-chunk-14-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="golem-taming-regularization" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Golem taming: regularization</h2>
<div id="cross-validataion" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Cross-validataion</h3>
<ul>
<li><em>leave-one-out cross-validataion</em> (loocv): dropping one data point in each <em>fold</em> (resulting in <span class="math inline">\(n\)</span> test sets, so <span class="math inline">\(n\)</span> refits of the model and <span class="math inline">\(n\)</span> posterior distributions)</li>
<li><em>Pareto-smoothed importance sampling cross-validataion</em> (PSIS): approximates loocv by sampling from the original posterior while taking the <em>importance</em>/<em>weight</em> of each data point into account (provides feedback about it’s ow reliability, no model re-fitting necessary)</li>
</ul>
<p><span class="math display">\[
s_{PSIS} = \sqrt{N~\textrm{var}(\textrm{psis}_{i})}
\]</span></p>
<p>The importance sampling estimate of out-of-sample lppd:</p>
<p><span class="math display">\[
lppd_{IS} = \sum_{i=1}^{N} \textrm{log} \frac{\Sigma_{s=1}^{S} r(\theta_{s}p(y_{i}|\theta_{s}))}{\sigma_{s=1}^{S} r(\theta_{s})}
\]</span></p>
<p>The <em>Pareto distribution</em></p>
<p><span class="math display">\[
p(r | u, \sigma, k) = \sigma^{-1} \big(1 + k (r - u) \sigma ^{-1}\big)^{-\frac{1}{k}-1}
\]</span></p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="rethinking-chapter-7.html#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb589-2"><a href="rethinking-chapter-7.html#cb589-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="fu">dpareto</span>(<span class="at">x =</span> x, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="dv">1</span>)},<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;1&quot;</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">n =</span> <span class="dv">201</span>)<span class="sc">+</span></span>
<span id="cb589-3"><a href="rethinking-chapter-7.html#cb589-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="fu">dpareto</span>(<span class="at">x =</span> x, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">7</span>)},<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;0.7&quot;</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">n =</span> <span class="dv">201</span>)<span class="sc">+</span></span>
<span id="cb589-4"><a href="rethinking-chapter-7.html#cb589-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="fu">dpareto</span>(<span class="at">x =</span> x, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">3</span>)},<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;0.3&quot;</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">n =</span> <span class="dv">201</span>)<span class="sc">+</span></span>
<span id="cb589-5"><a href="rethinking-chapter-7.html#cb589-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="fu">dpareto</span>(<span class="at">x =</span> x, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">1</span>)},<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;0.1&quot;</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>),  <span class="at">n =</span> <span class="dv">201</span>) <span class="sc">+</span></span>
<span id="cb589-6"><a href="rethinking-chapter-7.html#cb589-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;alpha&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> clr0dd, <span class="st">`</span><span class="at">0.7</span><span class="st">`</span> <span class="ot">=</span> clr1, <span class="st">`</span><span class="at">0.3</span><span class="st">`</span> <span class="ot">=</span> clr2, <span class="st">`</span><span class="at">0.1</span><span class="st">`</span> <span class="ot">=</span> clr3)) <span class="sc">+</span></span>
<span id="cb589-7"><a href="rethinking-chapter-7.html#cb589-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="dv">15</span>), <span class="at">expand =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb589-8"><a href="rethinking-chapter-7.html#cb589-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c7_files/figure-html/unnamed-chunk-15-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="information-criteria" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Information Criteria</h3>
<div id="akaike-information-criterion" class="section level4" number="8.3.2.1">
<h4><span class="header-section-number">8.3.2.1</span> Akaike information criterion</h4>
<p>Only for legacy reasons</p>
<p><span class="math display">\[
AIC = D_{train} + 2p = -2 lppd + 2p
\]</span></p>
<p>AIC is an approximation that depends on</p>
<ul>
<li>flat priors</li>
<li>posterior distribution is <span class="math inline">\(\sim\)</span> gaussian</li>
<li>sample size <span class="math inline">\(N\)</span> is much greater than numbers of parameters <span class="math inline">\(k\)</span></li>
</ul>
</div>
<div id="widely-applicable-information-criterion" class="section level4" number="8.3.2.2">
<h4><span class="header-section-number">8.3.2.2</span> Widely Applicable Information Criterion</h4>
<p><span class="math display">\[
WAIC(y, \Theta) = -2 (lppd - \underbrace{\sum_{i} \textrm{var}_{\theta}~\textrm{log}~p(y_{i}|\theta)}_{\textrm{penalty term}})
\]</span></p>
<p>WAIC calculations</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="rethinking-chapter-7.html#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cars)</span>
<span id="cb590-2"><a href="rethinking-chapter-7.html#cb590-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-3"><a href="rethinking-chapter-7.html#cb590-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">94</span>)</span>
<span id="cb590-4"><a href="rethinking-chapter-7.html#cb590-4" aria-hidden="true" tabindex="-1"></a>model_cars <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb590-5"><a href="rethinking-chapter-7.html#cb590-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb590-6"><a href="rethinking-chapter-7.html#cb590-6" aria-hidden="true" tabindex="-1"></a>    dist <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb590-7"><a href="rethinking-chapter-7.html#cb590-7" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_speed <span class="sc">*</span> speed,</span>
<span id="cb590-8"><a href="rethinking-chapter-7.html#cb590-8" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb590-9"><a href="rethinking-chapter-7.html#cb590-9" aria-hidden="true" tabindex="-1"></a>    beta_speed <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb590-10"><a href="rethinking-chapter-7.html#cb590-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb590-11"><a href="rethinking-chapter-7.html#cb590-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb590-12"><a href="rethinking-chapter-7.html#cb590-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> cars</span>
<span id="cb590-13"><a href="rethinking-chapter-7.html#cb590-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb590-14"><a href="rethinking-chapter-7.html#cb590-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-15"><a href="rethinking-chapter-7.html#cb590-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">94</span>)</span>
<span id="cb590-16"><a href="rethinking-chapter-7.html#cb590-16" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb590-17"><a href="rethinking-chapter-7.html#cb590-17" aria-hidden="true" tabindex="-1"></a>n_cases <span class="ot">&lt;-</span>  <span class="fu">nrow</span>(cars)</span>
<span id="cb590-18"><a href="rethinking-chapter-7.html#cb590-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-19"><a href="rethinking-chapter-7.html#cb590-19" aria-hidden="true" tabindex="-1"></a>cars_posterior_predictive_samples <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(model_cars, <span class="at">n =</span>  n_samples) <span class="sc">%&gt;%</span> </span>
<span id="cb590-20"><a href="rethinking-chapter-7.html#cb590-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb590-21"><a href="rethinking-chapter-7.html#cb590-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-22"><a href="rethinking-chapter-7.html#cb590-22" aria-hidden="true" tabindex="-1"></a>logprob <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_samples,</span>
<span id="cb590-23"><a href="rethinking-chapter-7.html#cb590-23" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">function</span>(idx){ </span>
<span id="cb590-24"><a href="rethinking-chapter-7.html#cb590-24" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> cars_posterior_predictive_samples<span class="sc">$</span>alpha[idx] <span class="sc">+</span> cars_posterior_predictive_samples<span class="sc">$</span>beta_speed[idx] <span class="sc">*</span> cars<span class="sc">$</span>speed</span>
<span id="cb590-25"><a href="rethinking-chapter-7.html#cb590-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>( cars<span class="sc">$</span>dist, <span class="at">mean =</span> mu, <span class="at">sd =</span> cars_posterior_predictive_samples<span class="sc">$</span>sigma[idx], <span class="at">log =</span> <span class="cn">TRUE</span>)})</span>
<span id="cb590-26"><a href="rethinking-chapter-7.html#cb590-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-27"><a href="rethinking-chapter-7.html#cb590-27" aria-hidden="true" tabindex="-1"></a>lppd <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_cases, <span class="cf">function</span>(i){<span class="fu">log_sum_exp</span>(logprob[i,]) <span class="sc">-</span> <span class="fu">log</span>(n_samples)})</span>
<span id="cb590-28"><a href="rethinking-chapter-7.html#cb590-28" aria-hidden="true" tabindex="-1"></a>pWAIC <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_cases, <span class="cf">function</span>(i){<span class="fu">var</span>(logprob[i,])})</span>
<span id="cb590-29"><a href="rethinking-chapter-7.html#cb590-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-30"><a href="rethinking-chapter-7.html#cb590-30" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">sum</span>(lppd) <span class="sc">-</span> <span class="fu">sum</span>(pWAIC))</span></code></pre></div>
<pre><code>#&gt; [1] 423.3127</code></pre>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="rethinking-chapter-7.html#cb592-1" aria-hidden="true" tabindex="-1"></a>waic_vec <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (lppd <span class="sc">-</span> pWAIC)</span>
<span id="cb592-2"><a href="rethinking-chapter-7.html#cb592-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(n_cases <span class="sc">*</span> <span class="fu">var</span>(waic_vec))  </span></code></pre></div>
<pre><code>#&gt; [1] 17.81271</code></pre>
</div>
</div>
<div id="comparing-cv-psis-and-waic" class="section level3" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Comparing CV, PSIS and WAIC</h3>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="rethinking-chapter-7.html#cb594-1" aria-hidden="true" tabindex="-1"></a>make_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(n, k, b_sigma) {</span>
<span id="cb594-2"><a href="rethinking-chapter-7.html#cb594-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb594-3"><a href="rethinking-chapter-7.html#cb594-3" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">mcreplicate</span>(n_sim, </span>
<span id="cb594-4"><a href="rethinking-chapter-7.html#cb594-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">sim_train_test</span>(<span class="at">N =</span> n,</span>
<span id="cb594-5"><a href="rethinking-chapter-7.html#cb594-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">k =</span> k,</span>
<span id="cb594-6"><a href="rethinking-chapter-7.html#cb594-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">b_sigma =</span> b_sigma,</span>
<span id="cb594-7"><a href="rethinking-chapter-7.html#cb594-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">WAIC =</span> <span class="cn">TRUE</span>,</span>
<span id="cb594-8"><a href="rethinking-chapter-7.html#cb594-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">LOOCV =</span> <span class="cn">TRUE</span>, </span>
<span id="cb594-9"><a href="rethinking-chapter-7.html#cb594-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">LOOIC =</span> <span class="cn">TRUE</span>),</span>
<span id="cb594-10"><a href="rethinking-chapter-7.html#cb594-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mc.cores =</span> n_cores)</span>
<span id="cb594-11"><a href="rethinking-chapter-7.html#cb594-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb594-12"><a href="rethinking-chapter-7.html#cb594-12" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb594-13"><a href="rethinking-chapter-7.html#cb594-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">deviance_os =</span> <span class="fu">mean</span>(<span class="fu">unlist</span>(r[<span class="dv">2</span>, ])),</span>
<span id="cb594-14"><a href="rethinking-chapter-7.html#cb594-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">deviance_w =</span> <span class="fu">mean</span>(<span class="fu">unlist</span>(r[<span class="dv">3</span>, ])),</span>
<span id="cb594-15"><a href="rethinking-chapter-7.html#cb594-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">deviance_p =</span> <span class="fu">mean</span>(<span class="fu">unlist</span>(r[<span class="dv">11</span>, ])),</span>
<span id="cb594-16"><a href="rethinking-chapter-7.html#cb594-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">deviance_c =</span> <span class="fu">mean</span>(<span class="fu">unlist</span>(r[<span class="dv">19</span>, ])),</span>
<span id="cb594-17"><a href="rethinking-chapter-7.html#cb594-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">error_w =</span> <span class="fu">mean</span>(<span class="fu">unlist</span>(r[<span class="dv">7</span>, ])),</span>
<span id="cb594-18"><a href="rethinking-chapter-7.html#cb594-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">error_p =</span> <span class="fu">mean</span>(<span class="fu">unlist</span>(r[<span class="dv">15</span>, ])),</span>
<span id="cb594-19"><a href="rethinking-chapter-7.html#cb594-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">error_c =</span> <span class="fu">mean</span>(<span class="fu">unlist</span>(r[<span class="dv">20</span>, ]))</span>
<span id="cb594-20"><a href="rethinking-chapter-7.html#cb594-20" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb594-21"><a href="rethinking-chapter-7.html#cb594-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb594-22"><a href="rethinking-chapter-7.html#cb594-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(t)</span>
<span id="cb594-23"><a href="rethinking-chapter-7.html#cb594-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb594-24"><a href="rethinking-chapter-7.html#cb594-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-25"><a href="rethinking-chapter-7.html#cb594-25" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb594-26"><a href="rethinking-chapter-7.html#cb594-26" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb594-27"><a href="rethinking-chapter-7.html#cb594-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-28"><a href="rethinking-chapter-7.html#cb594-28" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb594-29"><a href="rethinking-chapter-7.html#cb594-29" aria-hidden="true" tabindex="-1"></a>data_sim_scores <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">100</span>),</span>
<span id="cb594-30"><a href="rethinking-chapter-7.html#cb594-30" aria-hidden="true" tabindex="-1"></a>                            <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb594-31"><a href="rethinking-chapter-7.html#cb594-31" aria-hidden="true" tabindex="-1"></a>                            <span class="at">b_sigma =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb594-32"><a href="rethinking-chapter-7.html#cb594-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sim =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(n, k, b_sigma), make_sim)) <span class="sc">%&gt;%</span> </span>
<span id="cb594-33"><a href="rethinking-chapter-7.html#cb594-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(sim)</span>
<span id="cb594-34"><a href="rethinking-chapter-7.html#cb594-34" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span>
<span id="cb594-35"><a href="rethinking-chapter-7.html#cb594-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 119984.727 sec elapsed</span></span>
<span id="cb594-36"><a href="rethinking-chapter-7.html#cb594-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-37"><a href="rethinking-chapter-7.html#cb594-37" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(data_sim_scores, <span class="st">&quot;data/rethinking_c6_data_sim_scores.Rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="rethinking-chapter-7.html#cb595-1" aria-hidden="true" tabindex="-1"></a>data_sim_scores <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&quot;data/rethinking_c6_data_sim_scores.Rds&quot;</span>)</span>
<span id="cb595-2"><a href="rethinking-chapter-7.html#cb595-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb595-3"><a href="rethinking-chapter-7.html#cb595-3" aria-hidden="true" tabindex="-1"></a>data_sim_scores <span class="sc">%&gt;%</span> </span>
<span id="cb595-4"><a href="rethinking-chapter-7.html#cb595-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(deviance_w<span class="sc">:</span>deviance_c) <span class="sc">%&gt;%</span> </span>
<span id="cb595-5"><a href="rethinking-chapter-7.html#cb595-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">criteria =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">&quot;deviance_w&quot;</span>, <span class="st">&quot;WAIC&quot;</span>,</span>
<span id="cb595-6"><a href="rethinking-chapter-7.html#cb595-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">&quot;deviance_p&quot;</span>, <span class="st">&quot;PSIS&quot;</span>, <span class="st">&quot;CV&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb595-7"><a href="rethinking-chapter-7.html#cb595-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> k)) <span class="sc">+</span></span>
<span id="cb595-8"><a href="rethinking-chapter-7.html#cb595-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">color =</span> criteria)) <span class="sc">+</span></span>
<span id="cb595-9"><a href="rethinking-chapter-7.html#cb595-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> deviance_os, <span class="at">shape =</span> <span class="fu">factor</span>(b_sigma)), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb595-10"><a href="rethinking-chapter-7.html#cb595-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">&quot;sigma&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb595-11"><a href="rethinking-chapter-7.html#cb595-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(clr0dd, clr1, clr2)) <span class="sc">+</span></span>
<span id="cb595-12"><a href="rethinking-chapter-7.html#cb595-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;number of parameters (k)&quot;</span>,</span>
<span id="cb595-13"><a href="rethinking-chapter-7.html#cb595-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;average deviance&quot;</span>) <span class="sc">+</span></span>
<span id="cb595-14"><a href="rethinking-chapter-7.html#cb595-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(n <span class="sc">~</span> b_sigma, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">labeller =</span> label_both)<span class="sc">+</span></span>
<span id="cb595-15"><a href="rethinking-chapter-7.html#cb595-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c7_files/figure-html/unnamed-chunk-18-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="model-comparison" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Model comparison</h2>
<div id="model-mis-selection" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Model mis-selection</h3>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="rethinking-chapter-7.html#cb596-1" aria-hidden="true" tabindex="-1"></a>chapter6_models <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&quot;envs/chapter6_models.rds&quot;</span>)</span>
<span id="cb596-2"><a href="rethinking-chapter-7.html#cb596-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-3"><a href="rethinking-chapter-7.html#cb596-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb596-4"><a href="rethinking-chapter-7.html#cb596-4" aria-hidden="true" tabindex="-1"></a><span class="fu">WAIC</span>(chapter6_models<span class="sc">$</span>model_fungus_post_treatment)</span></code></pre></div>
<pre><code>#&gt;       WAIC      lppd  penalty  std_err
#&gt; 1 361.4511 -177.1724 3.553198 14.17033</code></pre>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="rethinking-chapter-7.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">77</span>)</span>
<span id="cb598-2"><a href="rethinking-chapter-7.html#cb598-2" aria-hidden="true" tabindex="-1"></a>comp_waic <span class="ot">&lt;-</span> <span class="fu">compare</span>(chapter6_models<span class="sc">$</span>model_fungus_post_treatment,</span>
<span id="cb598-3"><a href="rethinking-chapter-7.html#cb598-3" aria-hidden="true" tabindex="-1"></a>        chapter6_models<span class="sc">$</span>model_fungus_no_treatment,</span>
<span id="cb598-4"><a href="rethinking-chapter-7.html#cb598-4" aria-hidden="true" tabindex="-1"></a>        chapter6_models<span class="sc">$</span>model_fungus_only_treatment,</span>
<span id="cb598-5"><a href="rethinking-chapter-7.html#cb598-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">func =</span> WAIC) <span class="sc">%&gt;%</span> </span>
<span id="cb598-6"><a href="rethinking-chapter-7.html#cb598-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble_rn</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb598-7"><a href="rethinking-chapter-7.html#cb598-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">str_remove</span>(param,<span class="st">&quot;.*</span><span class="sc">\\</span><span class="st">$&quot;</span>),</span>
<span id="cb598-8"><a href="rethinking-chapter-7.html#cb598-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">mod =</span> model <span class="sc">%&gt;%</span>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="at">.f =</span> <span class="cf">function</span>(m){chapter6_models[[m]]}),</span>
<span id="cb598-9"><a href="rethinking-chapter-7.html#cb598-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">deviance =</span> mod <span class="sc">%&gt;%</span> </span>
<span id="cb598-10"><a href="rethinking-chapter-7.html#cb598-10" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">map_dbl</span>(<span class="at">.f =</span> rethinking<span class="sc">::</span>deviance),</span>
<span id="cb598-11"><a href="rethinking-chapter-7.html#cb598-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> <span class="fu">str_remove</span>(model,<span class="st">&quot;model_fungus_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb598-12"><a href="rethinking-chapter-7.html#cb598-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>param)</span>
<span id="cb598-13"><a href="rethinking-chapter-7.html#cb598-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb598-14"><a href="rethinking-chapter-7.html#cb598-14" aria-hidden="true" tabindex="-1"></a>comp_waic <span class="sc">%&gt;%</span> </span>
<span id="cb598-15"><a href="rethinking-chapter-7.html#cb598-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>mod) <span class="sc">%&gt;%</span></span>
<span id="cb598-16"><a href="rethinking-chapter-7.html#cb598-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(model, <span class="fu">everything</span>())</span></code></pre></div>
<pre><code>#&gt; # A tibble: 3 x 8
#&gt;   model           WAIC    SE dWAIC   dSE pWAIC   weight deviance
#&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
#&gt; 1 post_treatment  361.  14.2   0    NA    3.57 1.00e+ 0     354.
#&gt; 2 only_treatment  403.  11.3  41.3  10.5  2.65 1.08e- 9     397.
#&gt; 3 no_treatment    406.  11.8  44.7  12.2  1.70 1.98e-10     402.</code></pre>
<p>WAIC and PSIS result in similar values:</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="rethinking-chapter-7.html#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(chapter6_models<span class="sc">$</span>model_fungus_post_treatment,</span>
<span id="cb600-2"><a href="rethinking-chapter-7.html#cb600-2" aria-hidden="true" tabindex="-1"></a>        chapter6_models<span class="sc">$</span>model_fungus_no_treatment,</span>
<span id="cb600-3"><a href="rethinking-chapter-7.html#cb600-3" aria-hidden="true" tabindex="-1"></a>        chapter6_models<span class="sc">$</span>model_fungus_only_treatment,</span>
<span id="cb600-4"><a href="rethinking-chapter-7.html#cb600-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">func =</span> PSIS) <span class="sc">%&gt;%</span> </span>
<span id="cb600-5"><a href="rethinking-chapter-7.html#cb600-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble_rn</span>()</span></code></pre></div>
<pre><code>#&gt; # A tibble: 3 x 7
#&gt;    PSIS    SE dPSIS   dSE pPSIS   weight param                                  
#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;                                  
#&gt; 1  362.  14.3   0    NA    3.93 1.00e+ 0 chapter6_models$model_fungus_post_trea…
#&gt; 2  403.  11.3  40.6  10.4  2.69 1.50e- 9 chapter6_models$model_fungus_only_trea…
#&gt; 3  406.  11.7  43.9  12.2  1.63 2.99e-10 chapter6_models$model_fungus_no_treatm…</code></pre>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="rethinking-chapter-7.html#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">post_treatment =</span> <span class="fu">WAIC</span>(chapter6_models<span class="sc">$</span>model_fungus_post_treatment, <span class="at">pointwise =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>WAIC,</span>
<span id="cb602-2"><a href="rethinking-chapter-7.html#cb602-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">only_treatment =</span> <span class="fu">WAIC</span>(chapter6_models<span class="sc">$</span>model_fungus_only_treatment, <span class="at">pointwise =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>WAIC,</span>
<span id="cb602-3"><a href="rethinking-chapter-7.html#cb602-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">no_treatment =</span> <span class="fu">WAIC</span>(chapter6_models<span class="sc">$</span>model_fungus_no_treatment, <span class="at">pointwise =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>WAIC) <span class="sc">%&gt;%</span> </span>
<span id="cb602-4"><a href="rethinking-chapter-7.html#cb602-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model_difference_post_only =</span> post_treatment <span class="sc">-</span> only_treatment,</span>
<span id="cb602-5"><a href="rethinking-chapter-7.html#cb602-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_difference_no_only =</span> no_treatment <span class="sc">-</span> only_treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb602-6"><a href="rethinking-chapter-7.html#cb602-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">post-only</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()[[<span class="dv">1</span>]] <span class="sc">*</span> <span class="fu">var</span>(model_difference_post_only)),</span>
<span id="cb602-7"><a href="rethinking-chapter-7.html#cb602-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">no-only</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()[[<span class="dv">1</span>]] <span class="sc">*</span> <span class="fu">var</span>(model_difference_no_only))) <span class="sc">%&gt;%</span> </span>
<span id="cb602-8"><a href="rethinking-chapter-7.html#cb602-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb602-9"><a href="rethinking-chapter-7.html#cb602-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;comparison&quot;</span>,</span>
<span id="cb602-10"><a href="rethinking-chapter-7.html#cb602-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;se_of_model_differnce&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 x 2
#&gt;   comparison se_of_model_differnce
#&gt;   &lt;chr&gt;                      &lt;dbl&gt;
#&gt; 1 post-only                  10.5 
#&gt; 2 no-only                     4.90</code></pre>
<p><span class="math inline">\(\rightarrow\)</span> compare to WAIC table <code>$dSE[[2]]</code></p>
<p>estimating the model difference for a <em>z-score</em> of <span class="math inline">\(\sim\)</span> 2.6 (99%)"</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="rethinking-chapter-7.html#cb604-1" aria-hidden="true" tabindex="-1"></a>comp_waic<span class="sc">$</span>dWAIC[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> comp_waic<span class="sc">$</span>dSE[[<span class="dv">2</span>]] <span class="sc">*</span> <span class="fl">2.6</span></span></code></pre></div>
<pre><code>#&gt; [1] 14.12572 68.47753</code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="rethinking-chapter-7.html#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb606-2"><a href="rethinking-chapter-7.html#cb606-2" aria-hidden="true" tabindex="-1"></a>comp_waic <span class="sc">%&gt;%</span> </span>
<span id="cb606-3"><a href="rethinking-chapter-7.html#cb606-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb606-4"><a href="rethinking-chapter-7.html#cb606-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> comp_waic<span class="sc">$</span>WAIC[[<span class="dv">1</span>]], <span class="at">color =</span> clr_dark, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb606-5"><a href="rethinking-chapter-7.html#cb606-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointinterval</span>(<span class="fu">aes</span>(<span class="at">y =</span> model, <span class="at">x =</span> WAIC, <span class="at">xmin =</span> WAIC <span class="sc">-</span> SE, <span class="at">xmax =</span> WAIC <span class="sc">+</span> SE,</span>
<span id="cb606-6"><a href="rethinking-chapter-7.html#cb606-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="st">&quot;WAIC&quot;</span>, <span class="at">fill =</span> <span class="fu">after_scale</span>(<span class="fu">clr_lighten</span>(color))), </span>
<span id="cb606-7"><a href="rethinking-chapter-7.html#cb606-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb606-8"><a href="rethinking-chapter-7.html#cb606-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> model, <span class="at">x =</span> deviance, <span class="at">color =</span> <span class="st">&quot;WAIC&quot;</span>)) <span class="sc">+</span></span>
<span id="cb606-9"><a href="rethinking-chapter-7.html#cb606-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">data =</span> comp_waic <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">&gt;</span> <span class="dv">1</span>),</span>
<span id="cb606-10"><a href="rethinking-chapter-7.html#cb606-10" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(model)) <span class="sc">+</span> .<span class="dv">25</span>, </span>
<span id="cb606-11"><a href="rethinking-chapter-7.html#cb606-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x =</span> WAIC, <span class="at">xmin =</span> WAIC <span class="sc">-</span> dSE, <span class="at">xmax =</span> WAIC <span class="sc">+</span> dSE,</span>
<span id="cb606-12"><a href="rethinking-chapter-7.html#cb606-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color =</span> <span class="st">&quot;dSE&quot;</span>), </span>
<span id="cb606-13"><a href="rethinking-chapter-7.html#cb606-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">size =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb606-14"><a href="rethinking-chapter-7.html#cb606-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">WAIC =</span> clr2, <span class="at">dSE =</span> clr0dd)) <span class="sc">+</span></span>
<span id="cb606-15"><a href="rethinking-chapter-7.html#cb606-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c7_files/figure-html/unnamed-chunk-24-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="rethinking-chapter-7.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">93</span>)</span>
<span id="cb607-2"><a href="rethinking-chapter-7.html#cb607-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(chapter6_models<span class="sc">$</span>model_fungus_post_treatment,</span>
<span id="cb607-3"><a href="rethinking-chapter-7.html#cb607-3" aria-hidden="true" tabindex="-1"></a>        chapter6_models<span class="sc">$</span>model_fungus_no_treatment,</span>
<span id="cb607-4"><a href="rethinking-chapter-7.html#cb607-4" aria-hidden="true" tabindex="-1"></a>        chapter6_models<span class="sc">$</span>model_fungus_only_treatment)<span class="sc">@</span>dSE <span class="sc">%&gt;%</span></span>
<span id="cb607-5"><a href="rethinking-chapter-7.html#cb607-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb607-6"><a href="rethinking-chapter-7.html#cb607-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb607-7"><a href="rethinking-chapter-7.html#cb607-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(., <span class="at">nm =</span>  <span class="fu">names</span>(.) <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="at">pattern =</span> <span class="st">&quot;.*model_fungus_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb607-8"><a href="rethinking-chapter-7.html#cb607-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at"> </span><span class="st">`</span> <span class="ot">=</span> comp_waic<span class="sc">$</span>model) <span class="sc">%&gt;%</span> </span>
<span id="cb607-9"><a href="rethinking-chapter-7.html#cb607-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at"> </span><span class="st">`</span>, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb607-10"><a href="rethinking-chapter-7.html#cb607-10" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">post_treatment</th>
<th align="right">no_treatment</th>
<th align="right">only_treatment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">post_treatment</td>
<td align="right">NA</td>
<td align="right">12.22</td>
<td align="right">10.49</td>
</tr>
<tr class="even">
<td align="left">only_treatment</td>
<td align="right">12.22</td>
<td align="right">NA</td>
<td align="right">4.86</td>
</tr>
<tr class="odd">
<td align="left">no_treatment</td>
<td align="right">10.49</td>
<td align="right">4.86</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>Weight of a model (last column of <code>compare()</code>, the relative support for each model):</p>
<p><span class="math display">\[
w_{i} = \frac{\textrm{exp}(-0.5\Delta_{i})}{\Sigma_{j}\textrm{exp}(-0.5\Delta_{j})}
\]</span></p>
<p>These weights are important for <em>model averaging</em>.</p>
</div>
<div id="outliers-and-other-illusions" class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Outliers and other illusions</h3>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="rethinking-chapter-7.html#cb608-1" aria-hidden="true" tabindex="-1"></a>chapter5_models <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&quot;envs/chapter5_models.rds&quot;</span>)</span>
<span id="cb608-2"><a href="rethinking-chapter-7.html#cb608-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-3"><a href="rethinking-chapter-7.html#cb608-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24071847</span>)</span>
<span id="cb608-4"><a href="rethinking-chapter-7.html#cb608-4" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(chapter5_models<span class="sc">$</span>model_age,</span>
<span id="cb608-5"><a href="rethinking-chapter-7.html#cb608-5" aria-hidden="true" tabindex="-1"></a>        chapter5_models<span class="sc">$</span>model_marriage,</span>
<span id="cb608-6"><a href="rethinking-chapter-7.html#cb608-6" aria-hidden="true" tabindex="-1"></a>        chapter5_models<span class="sc">$</span>model_multiple) <span class="sc">%&gt;%</span> </span>
<span id="cb608-7"><a href="rethinking-chapter-7.html#cb608-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble_rn</span>()</span></code></pre></div>
<pre><code>#&gt; # A tibble: 3 x 7
#&gt;    WAIC    SE dWAIC    dSE pWAIC   weight param                         
#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;                         
#&gt; 1  127.  14.2  0    NA      4.41 0.679    chapter5_models$model_age     
#&gt; 2  129.  14.4  1.51  0.883  5.48 0.320    chapter5_models$model_multiple
#&gt; 3  141.  11.0 13.5  10.4    3.71 0.000805 chapter5_models$model_marriage</code></pre>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="rethinking-chapter-7.html#cb610-1" aria-hidden="true" tabindex="-1"></a>psis_k <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">waic_penalty =</span> (<span class="cf">function</span>(){<span class="fu">set.seed</span>(<span class="fu">set.seed</span>(<span class="dv">23</span>)); <span class="fu">WAIC</span>(chapter5_models<span class="sc">$</span>model_multiple, <span class="at">pointwise =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>penalty})(),</span>
<span id="cb610-2"><a href="rethinking-chapter-7.html#cb610-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">psis_k =</span> (<span class="cf">function</span>(){<span class="fu">set.seed</span>(<span class="fu">set.seed</span>(<span class="dv">23</span>)); <span class="fu">PSIS</span>(chapter5_models<span class="sc">$</span>model_multiple, <span class="at">pointwise =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>k})(),</span>
<span id="cb610-3"><a href="rethinking-chapter-7.html#cb610-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">location =</span> chapter5_models<span class="sc">$</span>data_waffle<span class="sc">$</span>Loc)</span>
<span id="cb610-4"><a href="rethinking-chapter-7.html#cb610-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-5"><a href="rethinking-chapter-7.html#cb610-5" aria-hidden="true" tabindex="-1"></a>p_psis_k <span class="ot">&lt;-</span> psis_k <span class="sc">%&gt;%</span> </span>
<span id="cb610-6"><a href="rethinking-chapter-7.html#cb610-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> psis_k ,<span class="at">y =</span> waic_penalty)) <span class="sc">+</span></span>
<span id="cb610-7"><a href="rethinking-chapter-7.html#cb610-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> clr_dark, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb610-8"><a href="rethinking-chapter-7.html#cb610-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> clr2, <span class="at">fill =</span> fll2) <span class="sc">+</span></span>
<span id="cb610-9"><a href="rethinking-chapter-7.html#cb610-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> psis_k <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ME&quot;</span>, <span class="st">&quot;ID&quot;</span>)),</span>
<span id="cb610-10"><a href="rethinking-chapter-7.html#cb610-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> psis_k <span class="sc">-</span> .<span class="dv">15</span>, <span class="at">label =</span> location))</span>
<span id="cb610-11"><a href="rethinking-chapter-7.html#cb610-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-12"><a href="rethinking-chapter-7.html#cb610-12" aria-hidden="true" tabindex="-1"></a>p_dens <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb610-13"><a href="rethinking-chapter-7.html#cb610-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="fu">dnorm</span>(<span class="at">x =</span> x, <span class="at">sd =</span> .<span class="dv">8</span>)}, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">n =</span> <span class="dv">201</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;gaussian&quot;</span>), <span class="at">linetype =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb610-14"><a href="rethinking-chapter-7.html#cb610-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="fu">dstudent</span>(<span class="at">x =</span> x, <span class="at">nu =</span> <span class="dv">2</span>, <span class="at">sigma =</span> .<span class="dv">55</span>)}, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">n =</span> <span class="dv">201</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;student t&quot;</span>)) <span class="sc">+</span></span>
<span id="cb610-15"><a href="rethinking-chapter-7.html#cb610-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;density&quot;</span>, <span class="at">x =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb610-16"><a href="rethinking-chapter-7.html#cb610-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-17"><a href="rethinking-chapter-7.html#cb610-17" aria-hidden="true" tabindex="-1"></a>p_logdens <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb610-18"><a href="rethinking-chapter-7.html#cb610-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="sc">-</span><span class="fu">log</span>(<span class="fu">dnorm</span>(<span class="at">x =</span> x, <span class="at">sd =</span> .<span class="dv">8</span>))}, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">n =</span> <span class="dv">201</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;gaussian&quot;</span>), <span class="at">linetype =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb610-19"><a href="rethinking-chapter-7.html#cb610-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x){<span class="sc">-</span><span class="fu">log</span>(<span class="fu">dstudent</span>(<span class="at">x =</span> x, <span class="at">nu =</span> <span class="dv">2</span>, <span class="at">sigma =</span> .<span class="dv">55</span>))}, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">n =</span> <span class="dv">201</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;student t&quot;</span>)) <span class="sc">+</span></span>
<span id="cb610-20"><a href="rethinking-chapter-7.html#cb610-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;- log density&quot;</span>, <span class="at">x =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb610-21"><a href="rethinking-chapter-7.html#cb610-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-22"><a href="rethinking-chapter-7.html#cb610-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-23"><a href="rethinking-chapter-7.html#cb610-23" aria-hidden="true" tabindex="-1"></a>p_psis_k <span class="sc">+</span> p_dens <span class="sc">+</span> p_logdens <span class="sc">+</span></span>
<span id="cb610-24"><a href="rethinking-chapter-7.html#cb610-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb610-25"><a href="rethinking-chapter-7.html#cb610-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;distribution&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="at">gaussian =</span> clr0dd, <span class="st">`</span><span class="at">student t</span><span class="st">`</span> <span class="ot">=</span> clr2)) <span class="sc">&amp;</span></span>
<span id="cb610-26"><a href="rethinking-chapter-7.html#cb610-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="rethinking_c7_files/figure-html/unnamed-chunk-26-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="rethinking-chapter-7.html#cb611-1" aria-hidden="true" tabindex="-1"></a>chapter5_models<span class="sc">$</span>model_multiple</span></code></pre></div>
<pre><code>#&gt; 
#&gt; Quadratic approximate posterior distribution
#&gt; 
#&gt; Formula:
#&gt; divorce_std ~ dnorm(mu, sigma)
#&gt; mu &lt;- alpha + beta_M * marriage_std + beta_A * median_age_std
#&gt; alpha ~ dnorm(0, 0.2)
#&gt; beta_A ~ dnorm(0, 0.5)
#&gt; beta_M ~ dnorm(0, 0.5)
#&gt; sigma ~ dexp(1)
#&gt; 
#&gt; Posterior means:
#&gt;         alpha        beta_A        beta_M         sigma 
#&gt; -2.484974e-08 -6.135134e-01 -6.538068e-02  7.851183e-01 
#&gt; 
#&gt; Log-likelihood: -59.24</code></pre>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="rethinking-chapter-7.html#cb613-1" aria-hidden="true" tabindex="-1"></a>model_multiple_sudent <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb613-2"><a href="rethinking-chapter-7.html#cb613-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> <span class="fu">alist</span>(</span>
<span id="cb613-3"><a href="rethinking-chapter-7.html#cb613-3" aria-hidden="true" tabindex="-1"></a>    divorce_std <span class="sc">~</span> <span class="fu">dstudent</span>(<span class="dv">2</span>, mu, sigma),</span>
<span id="cb613-4"><a href="rethinking-chapter-7.html#cb613-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta_M <span class="sc">*</span> marriage_std <span class="sc">+</span> beta_A <span class="sc">*</span> median_age_std,</span>
<span id="cb613-5"><a href="rethinking-chapter-7.html#cb613-5" aria-hidden="true" tabindex="-1"></a>    alpha <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb613-6"><a href="rethinking-chapter-7.html#cb613-6" aria-hidden="true" tabindex="-1"></a>    beta_A <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb613-7"><a href="rethinking-chapter-7.html#cb613-7" aria-hidden="true" tabindex="-1"></a>    beta_M <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb613-8"><a href="rethinking-chapter-7.html#cb613-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb613-9"><a href="rethinking-chapter-7.html#cb613-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb613-10"><a href="rethinking-chapter-7.html#cb613-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> chapter5_models<span class="sc">$</span>data_waffle</span>
<span id="cb613-11"><a href="rethinking-chapter-7.html#cb613-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="rethinking-chapter-7.html#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PSIS</span>(chapter5_models<span class="sc">$</span>model_multiple)</span></code></pre></div>
<pre><code>#&gt;       PSIS      lppd  penalty  std_err
#&gt; 1 129.9063 -64.95313 6.163206 15.44562</code></pre>
<p>With the <em>Student T</em> distribution as a the likelihood, <span class="math inline">\(k\)</span> is reduced as there is more mass in the tails of the distribution (thus, Idaho is less <em>surprising</em>)</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="rethinking-chapter-7.html#cb616-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PSIS</span>(model_multiple_sudent)</span></code></pre></div>
<pre><code>#&gt;       PSIS      lppd  penalty  std_err
#&gt; 1 134.1951 -67.09757 7.260108 11.90006</code></pre>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="rethinking-chapter-7.html#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(chapter5_models<span class="sc">$</span>model_multiple) <span class="sc">%&gt;%</span> </span>
<span id="cb618-2"><a href="rethinking-chapter-7.html#cb618-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.00</td>
<td align="right">0.10</td>
<td align="right">-0.16</td>
<td align="right">0.16</td>
</tr>
<tr class="even">
<td align="left">beta_A</td>
<td align="right">-0.61</td>
<td align="right">0.15</td>
<td align="right">-0.85</td>
<td align="right">-0.37</td>
</tr>
<tr class="odd">
<td align="left">beta_M</td>
<td align="right">-0.07</td>
<td align="right">0.15</td>
<td align="right">-0.31</td>
<td align="right">0.18</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.79</td>
<td align="right">0.08</td>
<td align="right">0.66</td>
<td align="right">0.91</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="rethinking-chapter-7.html#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(model_multiple_sudent) <span class="sc">%&gt;%</span> </span>
<span id="cb619-2"><a href="rethinking-chapter-7.html#cb619-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knit_precis</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.02</td>
<td align="right">0.10</td>
<td align="right">-0.14</td>
<td align="right">0.17</td>
</tr>
<tr class="even">
<td align="left">beta_A</td>
<td align="right">-0.70</td>
<td align="right">0.13</td>
<td align="right">-0.91</td>
<td align="right">-0.49</td>
</tr>
<tr class="odd">
<td align="left">beta_M</td>
<td align="right">0.00</td>
<td align="right">0.21</td>
<td align="right">-0.33</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="right">0.55</td>
<td align="right">0.08</td>
<td align="right">0.42</td>
<td align="right">0.68</td>
</tr>
</tbody>
</table>
<p>Also, as the influence of Idaho is reduced, the estimate of <code>beta_A</code> is decreased in the updated model.</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="rethinking-chapter-7.html#cb620-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb620-2"><a href="rethinking-chapter-7.html#cb620-2" aria-hidden="true" tabindex="-1"></a>chapter7_models <span class="ot">&lt;-</span> <span class="fu">env</span>(</span>
<span id="cb620-3"><a href="rethinking-chapter-7.html#cb620-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_brain_size =</span> model_brain_size</span>
<span id="cb620-4"><a href="rethinking-chapter-7.html#cb620-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="homework-5" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Homework</h2>
<p><strong>E1</strong></p>
<p><strong>E2</strong></p>
<p><strong>E3</strong></p>
<p><strong>E4</strong></p>
<p><strong>M1</strong></p>
<p><strong>M2</strong></p>
<p><strong>M3</strong></p>
<p><strong>M4</strong></p>
<p><strong>M5</strong></p>
<p><strong>M6</strong></p>
<p><strong>H1</strong></p>
<p><strong>H2</strong></p>
<p><strong>H3</strong></p>
<p><strong>H4</strong></p>
<p><strong>H5</strong></p>
</div>
<div id="brms-section-5" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> {brms} section</h2>
</div>
<div id="pymc3-section-5" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> pymc3 section</h2>
<hr />
<div id="myModal" class="modal">
<span class="close">×</span>
<img class="modal-content" id="img01">
<div id="caption">

</div>
</div>
<script src="./js/zoom.js"></script>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rethinking-chapter-6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-statistics-the-fun-way.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": "github"
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
